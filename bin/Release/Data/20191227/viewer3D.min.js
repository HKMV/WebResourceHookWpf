/*!
 * LMV v7.9.0
 * 
 * Copyright 2019 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
var LMV=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=361)}([function(e,t,n){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,i,r,o,a,s,l,c,u,h,d,f,p,m,g,v,y,_,b,x,w,A,E,M,T,S,C,P,L,D,R,I,O,N,k,F,V,B,U,z,G,H,W,j,X,q={REVISION:"71"};"object"===t(e)&&(e.exports=q),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),q.log=function(){console.log.apply(console,arguments)},q.warn=function(){console.warn.apply(console,arguments)},q.error=function(){console.error.apply(console,arguments)},q.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},q.CullFaceNone=0,q.CullFaceBack=1,q.CullFaceFront=2,q.CullFaceFrontBack=3,q.FrontFaceDirectionCW=0,q.FrontFaceDirectionCCW=1,q.BasicShadowMap=0,q.PCFShadowMap=1,q.PCFSoftShadowMap=2,q.FrontSide=0,q.BackSide=1,q.DoubleSide=2,q.NoShading=0,q.FlatShading=1,q.SmoothShading=2,q.NoColors=0,q.FaceColors=1,q.VertexColors=2,q.NoBlending=0,q.NormalBlending=1,q.AdditiveBlending=2,q.SubtractiveBlending=3,q.MultiplyBlending=4,q.CustomBlending=5,q.AddEquation=100,q.SubtractEquation=101,q.ReverseSubtractEquation=102,q.MinEquation=103,q.MaxEquation=104,q.ZeroFactor=200,q.OneFactor=201,q.SrcColorFactor=202,q.OneMinusSrcColorFactor=203,q.SrcAlphaFactor=204,q.OneMinusSrcAlphaFactor=205,q.DstAlphaFactor=206,q.OneMinusDstAlphaFactor=207,q.DstColorFactor=208,q.OneMinusDstColorFactor=209,q.SrcAlphaSaturateFactor=210,q.MultiplyOperation=0,q.MixOperation=1,q.AddOperation=2,q.UVMapping=300,q.CubeReflectionMapping=301,q.CubeRefractionMapping=302,q.EquirectangularReflectionMapping=303,q.EquirectangularRefractionMapping=304,q.SphericalReflectionMapping=305,q.RepeatWrapping=1e3,q.ClampToEdgeWrapping=1001,q.MirroredRepeatWrapping=1002,q.NearestFilter=1003,q.NearestMipMapNearestFilter=1004,q.NearestMipMapLinearFilter=1005,q.LinearFilter=1006,q.LinearMipMapNearestFilter=1007,q.LinearMipMapLinearFilter=1008,q.UnsignedByteType=1009,q.ByteType=1010,q.ShortType=1011,q.UnsignedShortType=1012,q.IntType=1013,q.UnsignedIntType=1014,q.FloatType=1015,q.HalfFloatType=1025,q.UnsignedShort4444Type=1016,q.UnsignedShort5551Type=1017,q.UnsignedShort565Type=1018,q.AlphaFormat=1019,q.RGBFormat=1020,q.RGBAFormat=1021,q.LuminanceFormat=1022,q.LuminanceAlphaFormat=1023,q.RGBEFormat=q.RGBAFormat,q.RGB_S3TC_DXT1_Format=2001,q.RGBA_S3TC_DXT1_Format=2002,q.RGBA_S3TC_DXT3_Format=2003,q.RGBA_S3TC_DXT5_Format=2004,q.RGB_PVRTC_4BPPV1_Format=2100,q.RGB_PVRTC_2BPPV1_Format=2101,q.RGBA_PVRTC_4BPPV1_Format=2102,q.RGBA_PVRTC_2BPPV1_Format=2103,q.Projector=function(){q.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){q.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){q.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){q.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},q.CanvasRenderer=function(){q.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},q.Color=function(e){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(e)},q.Color.prototype={constructor:q.Color,r:1,g:1,b:1,set:function(e){return e instanceof q.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(0===t)this.r=this.g=this.b=n;else{var i=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e},r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=i(o,r,e+1/3),this.g=i(o,r,e),this.b=i(o,r,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var t=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)){t=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(e)){t=/^\#([0-9a-f]{6})$/i.exec(e);return this.setHex(parseInt(t[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){t=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return this.setHex(parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3],16)),this}if(/^(\w+)$/i.test(e))return this.setHex(q.ColorKeywords[e]),this},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,n,i=e||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),l=Math.min(r,o,a),c=(l+s)/2;if(l===s)t=0,n=0;else{var u=s-l;switch(n=c<=.5?u/(s+l):u/(2-s-l),s){case r:t=(o-a)/u+(o<a?6:0);break;case o:t=(a-r)/u+2;break;case a:t=(r-o)/u+4}t/=6}return i.h=t,i.s=n,i.l=c,i},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){var i=this.getHSL();return i.h+=e,i.s+=t,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e){return this.r=e[0],this.g=e[1],this.b=e[2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},clone:function(){return(new q.Color).setRGB(this.r,this.g,this.b)}},q.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},q.Quaternion=function(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==i?i:1},q.Quaternion.prototype={constructor:q.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get w(){return this._w},set w(e){this._w=e,this.onChangeCallback()},set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this.onChangeCallback(),this},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(e instanceof q.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(e._x/2),i=Math.cos(e._y/2),r=Math.cos(e._z/2),o=Math.sin(e._x/2),a=Math.sin(e._y/2),s=Math.sin(e._z/2);return"XYZ"===e.order?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"YXZ"===e.order?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"ZXY"===e.order?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"ZYX"===e.order?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"YZX"===e.order?(this._x=o*i*r+n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r-o*a*s):"XZY"===e.order&&(this._x=o*i*r-n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r+o*a*s),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],l=n[9],c=n[2],u=n[6],h=n[10],d=i+s+h;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(u-l)*t,this._y=(o-c)*t,this._z=(a-r)*t):i>s&&i>h?(t=2*Math.sqrt(1+i-s-h),this._w=(u-l)/t,this._x=.25*t,this._y=(r+a)/t,this._z=(o+c)/t):s>h?(t=2*Math.sqrt(1+s-i-h),this._w=(o-c)/t,this._x=(r+a)/t,this._y=.25*t,this._z=(l+u)/t):(t=2*Math.sqrt(1+h-i-s),this._w=(a-r)/t,this._x=(o+c)/t,this._y=(l+u)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(e,t){return void 0===n&&(n=new q.Vector3),(i=e.dot(t)+1)<1e-6?(i=0,Math.abs(e.x)>Math.abs(e.z)?n.set(-e.y,e.x,0):n.set(0,-e.z,e.y)):n.crossVectors(e,t),this._x=n.x,this._y=n.y,this._z=n.z,this._w=i,this.normalize(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(q.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,r=e._z,o=e._w,a=t._x,s=t._y,l=t._z,c=t._w;return this._x=n*c+o*a+i*l-r*s,this._y=i*c+o*s+r*a-n*l,this._z=r*c+o*l+n*s-i*a,this._w=o*c-n*a-i*s-r*l,this.onChangeCallback(),this},multiplyVector3:function(e){return q.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.acos(a),l=Math.sqrt(1-a*a);if(Math.abs(l)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var c=Math.sin((1-t)*s)/l,u=Math.sin(t*s)/l;return this._w=o*c+this._w*u,this._x=n*c+this._x*u,this._y=i*c+this._y*u,this._z=r*c+this._z*u,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new q.Quaternion(this._x,this._y,this._z,this._w)}},q.Quaternion.slerp=function(e,t,n,i){return n.copy(e).slerp(t,i)},q.Vector2=function(e,t){this.x=e||0,this.y=t||0},q.Vector2.prototype={constructor:q.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(q.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},sub:function(e,t){return void 0!==t?(q.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t}else this.x=0,this.y=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},clampScalar:function(e,t){return void 0===r&&(r=new q.Vector2,o=new q.Vector2),r.set(e,e),o.set(t,t),this.clamp(r,o)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this},clone:function(){return new q.Vector2(this.x,this.y)}},q.Vector3=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0},q.Vector3.prototype={constructor:q.Vector3,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(q.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(q.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(q.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e instanceof q.Euler==0&&q.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===s&&(s=new q.Quaternion),this.applyQuaternion(s.setFromEuler(e)),this},applyAxisAngle:function(){var e;return function(t,n){return void 0===e&&(e=new q.Quaternion),this.applyQuaternion(e.setFromAxisAngle(t,n)),this}}(),applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i+r[12],this.y=r[1]*t+r[5]*n+r[9]*i+r[13],this.z=r[2]*t+r[6]*n+r[10]*i+r[14],this},applyProjection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*i-a*n,c=s*n+a*t-r*i,u=s*i+r*n-o*t,h=-r*t-o*n-a*i;return this.x=l*s+h*-r+c*-a-u*-o,this.y=c*s+h*-o+u*-r-l*-a,this.z=u*s+h*-a+l*-o-c*-r,this},project:function(e){return void 0===a&&(a=new q.Matrix4),a.multiplyMatrices(e.projectionMatrix,a.getInverse(e.matrixWorld)),this.applyProjection(a)},unproject:function(){var e;return function(t){return void 0===e&&(e=new q.Matrix4),e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyProjection(e)}}(),transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(){var e,t;return function(n,i){return void 0===e&&(e=new q.Vector3,t=new q.Vector3),e.set(n,n,n),t.set(i,i,i),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},cross:function(e,t){if(void 0!==t)return q.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,i=this.y,r=this.z;return this.x=i*e.z-r*e.y,this.y=r*e.x-n*e.z,this.z=n*e.y-i*e.x,this},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(){var e,t;return function(n){return void 0===e&&(e=new q.Vector3),e.copy(n).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new q.Vector3),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new q.Vector3),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/(this.length()*e.length());return Math.acos(q.Math.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},setEulerFromRotationMatrix:function(e,t){q.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){q.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return q.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return q.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return q.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),i=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){var n=4*e,i=t.elements;return this.x=i[n],this.y=i[n+1],this.z=i[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this},clone:function(){return new q.Vector3(this.x,this.y,this.z)}},q.Vector4=function(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==i?i:1},q.Vector4.prototype={constructor:q.Vector4,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(q.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(q.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t,this.w*=t}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,i,r,o=e.elements,a=o[0],s=o[4],l=o[8],c=o[1],u=o[5],h=o[9],d=o[2],f=o[6],p=o[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-f)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+f)<.1&&Math.abs(a+u+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,g=(u+1)/2,v=(p+1)/2,y=(s+c)/4,_=(l+d)/4,b=(h+f)/4;return m>g&&m>v?m<.01?(n=0,i=.707106781,r=.707106781):(i=y/(n=Math.sqrt(m)),r=_/n):g>v?g<.01?(n=.707106781,i=0,r=.707106781):(n=y/(i=Math.sqrt(g)),r=b/i):v<.01?(n=.707106781,i=.707106781,r=0):(n=_/(r=Math.sqrt(v)),i=b/r),this.set(n,i,r,t),this}var x=Math.sqrt((f-h)*(f-h)+(l-d)*(l-d)+(c-s)*(c-s));return Math.abs(x)<.001&&(x=1),this.x=(f-h)/x,this.y=(l-d)/x,this.z=(c-s)/x,this.w=Math.acos((a+u+p-1)/2),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},clampScalar:function(){var e,t;return function(n,i){return void 0===e&&(e=new q.Vector4,t=new q.Vector4),e.set(n,n,n,n),t.set(i,i,i,i),this.clamp(e,t)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this.w=e.array[t+3],this},clone:function(){return new q.Vector4(this.x,this.y,this.z,this.w)}},q.Euler=function(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||q.Euler.DefaultOrder},q.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],q.Euler.DefaultOrder="XYZ",q.Euler.prototype={constructor:q.Euler,_x:0,_y:0,_z:0,_order:q.Euler.DefaultOrder,get x(){return this._x},set x(e){this._x=e,this.onChangeCallback()},get y(){return this._y},set y(e){this._y=e,this.onChangeCallback()},get z(){return this._z},set z(e){this._z=e,this.onChangeCallback()},get order(){return this._order},set order(e){this._order=e,this.onChangeCallback()},set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=q.Math.clamp,r=e.elements,o=r[0],a=r[4],s=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],f=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-i(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,o))):"ZYX"===t?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===t?(this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-i(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-u,f),this._y=0)):q.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var e;return function(t,n,i){return void 0===e&&(e=new q.Matrix4),e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,n,i),this}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(l=new q.Quaternion,function(e){l.setFromEuler(this),this.setFromQuaternion(l,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new q.Vector3(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){},clone:function(){return new q.Euler(this._x,this._y,this._z,this._order)}},q.Line3=function(e,t){this.start=void 0!==e?e:new q.Vector3,this.end=void 0!==t?t:new q.Vector3},q.Line3.prototype={constructor:q.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){return(e||new q.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new q.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var n=t||new q.Vector3;return this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(c=new q.Vector3,u=new q.Vector3,function(e,t){c.subVectors(e,this.start),u.subVectors(this.end,this.start);var n=u.dot(u),i=u.dot(c)/n;return t&&(i=q.Math.clamp(i,0,1)),i}),closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t),r=n||new q.Vector3;return this.delta(r).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new q.Line3).copy(this)}},q.Box2=function(e,t){this.min=void 0!==e?e:new q.Vector2(1/0,1/0),this.max=void 0!==t?t:new q.Vector2(-1/0,-1/0)},q.Box2.prototype={constructor:q.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new q.Vector2;return function(t,n){var i=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){return(e||new q.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new q.Vector2).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new q.Vector2).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new q.Vector2).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new q.Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new q.Box2).copy(this)}},q.Box3=function(e,t){this.min=void 0!==e?e:new q.Vector3(1/0,1/0,1/0),this.max=void 0!==t?t:new q.Vector3(-1/0,-1/0,-1/0)},q.Box3.prototype={constructor:q.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new q.Vector3;return function(t,n){var i=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}}(),setFromObject:function(){var e=new q.Vector3;return function(t){var n=this;return t.updateMatrixWorld(!0),this.makeEmpty(),t.traverse((function(t){var i=t.geometry;if(void 0!==i)if(i instanceof q.Geometry)for(var r=i.vertices,o=0,a=r.length;o<a;o++)e.copy(r[o]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e);else if(i instanceof q.BufferGeometry&&void 0!==i.attributes.position){var s=i.attributes.position.array;for(o=0,a=s.length;o<a;o+=3)e.set(s[o],s[o+1],s[o+2]),e.applyMatrix4(t.matrixWorld),n.expandByPoint(e)}})),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return(e||new q.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new q.Vector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new q.Vector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},clampPoint:function(e,t){return(t||new q.Vector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new q.Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new q.Vector3;return function(t){var n=t||new q.Sphere;return n.center=this.center(),n.radius=.5*this.size(e).length(),n}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(h=[new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3,new q.Vector3],function(e){return h[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),h[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),h[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),h[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),h[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),h[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),h[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),h[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(h),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new q.Box3).copy(this)}},q.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&q.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},q.Matrix3.prototype={constructor:q.Matrix3,set:function(e,t,n,i,r,o,a,s,l){var c=this.elements;return c[0]=e,c[3]=t,c[6]=n,c[1]=i,c[4]=r,c[7]=o,c[2]=a,c[5]=s,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this},multiplyVector3:function(e){return q.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(e){return q.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new q.Vector3;return function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=t.length);for(var r=0,o=n;r<i;r+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix3(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],l=e[7],c=e[8];return t*o*c-t*a*l-n*r*c+n*a*s+i*r*l-i*o*s},getInverse:function(e,t){var n=e.elements,i=this.elements;i[0]=n[10]*n[5]-n[6]*n[9],i[1]=-n[10]*n[1]+n[2]*n[9],i[2]=n[6]*n[1]-n[2]*n[5],i[3]=-n[10]*n[4]+n[6]*n[8],i[4]=n[10]*n[0]-n[2]*n[8],i[5]=-n[6]*n[0]+n[2]*n[4],i[6]=n[9]*n[4]-n[5]*n[8],i[7]=-n[9]*n[0]+n[1]*n[8],i[8]=n[5]*n[0]-n[1]*n[4];var r=n[0]*i[0]+n[1]*i[3]+n[2]*i[6];if(0===r){var o="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(o);return q.warn(o),this.identity(),this}return this.multiplyScalar(1/r),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},clone:function(){return(new q.Matrix3).fromArray(this.elements)}},q.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&q.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},q.Matrix4.prototype={constructor:q.Matrix4,set:function(e,t,n,i,r,o,a,s,l,c,u,h,d,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},extractPosition:function(e){return q.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){var i=this.elements;return e.set(i[0],i[1],i[2]),t.set(i[4],i[5],i[6]),n.set(i[8],i[9],i[10]),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(){var e=new q.Vector3;return function(t){var n=this.elements,i=t.elements,r=1/e.set(i[0],i[1],i[2]).length(),o=1/e.set(i[4],i[5],i[6]).length(),a=1/e.set(i[8],i[9],i[10]).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,this}}(),makeRotationFromEuler:function(e){e instanceof q.Euler==!1&&q.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){var h=o*c,d=o*u,f=a*c,p=a*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=d+f*l,t[5]=h-p*l,t[9]=-a*s,t[2]=p-h*l,t[6]=f+d*l,t[10]=o*s}else if("YXZ"===e.order){var m=s*c,g=s*u,v=l*c,y=l*u;t[0]=m+y*a,t[4]=v*a-g,t[8]=o*l,t[1]=o*u,t[5]=o*c,t[9]=-a,t[2]=g*a-v,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*c,g=s*u,v=l*c,y=l*u;t[0]=m-y*a,t[4]=-o*u,t[8]=v+g*a,t[1]=g+v*a,t[5]=o*c,t[9]=y-m*a,t[2]=-o*l,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){h=o*c,d=o*u,f=a*c,p=a*u;t[0]=s*c,t[4]=f*l-d,t[8]=h*l+p,t[1]=s*u,t[5]=p*l+h,t[9]=d*l-f,t[2]=-l,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var _=o*s,b=o*l,x=a*s,w=a*l;t[0]=s*c,t[4]=w-_*u,t[8]=x*u+b,t[1]=u,t[5]=o*c,t[9]=-a*c,t[2]=-l*c,t[6]=b*u+x,t[10]=_-w*u}else if("XZY"===e.order){_=o*s,b=o*l,x=a*s,w=a*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=_*u+w,t[5]=o*c,t[9]=b*u-x,t[2]=x*u-b,t[6]=a*c,t[10]=w*u+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},setRotationFromQuaternion:function(e){return q.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=e.w,a=n+n,s=i+i,l=r+r,c=n*a,u=n*s,h=n*l,d=i*s,f=i*l,p=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+p),t[4]=u-v,t[8]=h+g,t[1]=u+v,t[5]=1-(c+p),t[9]=f-m,t[2]=h-g,t[6]=f+m,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new q.Vector3,t=new q.Vector3,n=new q.Vector3;return function(i,r,o){var a=this.elements;return n.subVectors(i,r).normalize(),0===n.length()&&(n.z=1),e.crossVectors(o,n).normalize(),0===e.length()&&(n.x+=1e-4,e.crossVectors(o,n).normalize()),t.crossVectors(n,e),a[0]=e.x,a[4]=t.x,a[8]=n.x,a[1]=e.y,a[5]=t.y,a[9]=n.y,a[2]=e.z,a[6]=t.z,a[10]=n.z,this}}(),multiply:function(e,t){return void 0!==t?(q.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],x=i[0],w=i[4],A=i[8],E=i[12],M=i[1],T=i[5],S=i[9],C=i[13],P=i[2],L=i[6],D=i[10],R=i[14],I=i[3],O=i[7],N=i[11],k=i[15];return r[0]=o*x+a*M+s*P+l*I,r[4]=o*w+a*T+s*L+l*O,r[8]=o*A+a*S+s*D+l*N,r[12]=o*E+a*C+s*R+l*k,r[1]=c*x+u*M+h*P+d*I,r[5]=c*w+u*T+h*L+d*O,r[9]=c*A+u*S+h*D+d*N,r[13]=c*E+u*C+h*R+d*k,r[2]=f*x+p*M+m*P+g*I,r[6]=f*w+p*T+m*L+g*O,r[10]=f*A+p*S+m*D+g*N,r[14]=f*E+p*C+m*R+g*k,r[3]=v*x+y*M+_*P+b*I,r[7]=v*w+y*T+_*L+b*O,r[11]=v*A+y*S+_*D+b*N,r[15]=v*E+y*C+_*R+b*k,this},multiplyToArray:function(e,t,n){var i=this.elements;return this.multiplyMatrices(e,t),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return q.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return q.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(e){return q.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(e)},applyToVector3Array:function(){var e=new q.Vector3;return function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=t.length);for(var r=0,o=n;r<i;r+=3,o+=3)e.x=t[o],e.y=t[o+1],e.z=t[o+2],e.applyMatrix4(this),t[o]=e.x,t[o+1]=e.y,t[o+2]=e.z;return t}}(),rotateAxis:function(e){q.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return q.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*s*u-i*l*u-r*a*h+n*l*h+i*a*d-n*s*d)+e[7]*(+t*s*d-t*l*h+r*o*h-i*o*d+i*l*c-r*s*c)+e[11]*(+t*l*u-t*a*d-r*o*u+n*o*d+r*a*c-n*l*c)+e[15]*(-i*a*c-t*s*u+t*a*h+i*o*u-n*o*h+n*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},getPosition:function(){var e=new q.Vector3;return function(){q.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,i=e.elements,r=i[0],o=i[4],a=i[8],s=i[12],l=i[1],c=i[5],u=i[9],h=i[13],d=i[2],f=i[6],p=i[10],m=i[14],g=i[3],v=i[7],y=i[11],_=i[15];n[0]=u*m*v-h*p*v+h*f*y-c*m*y-u*f*_+c*p*_,n[4]=s*p*v-a*m*v-s*f*y+o*m*y+a*f*_-o*p*_,n[8]=a*h*v-s*u*v+s*c*y-o*h*y-a*c*_+o*u*_,n[12]=s*u*f-a*h*f-s*c*p+o*h*p+a*c*m-o*u*m,n[1]=h*p*g-u*m*g-h*d*y+l*m*y+u*d*_-l*p*_,n[5]=a*m*g-s*p*g+s*d*y-r*m*y-a*d*_+r*p*_,n[9]=s*u*g-a*h*g-s*l*y+r*h*y+a*l*_-r*u*_,n[13]=a*h*d-s*u*d+s*l*p-r*h*p-a*l*m+r*u*m,n[2]=c*m*g-h*f*g+h*d*v-l*m*v-c*d*_+l*f*_,n[6]=s*f*g-o*m*g-s*d*v+r*m*v+o*d*_-r*f*_,n[10]=o*h*g-s*c*g+s*l*v-r*h*v-o*l*_+r*c*_,n[14]=s*c*d-o*h*d-s*l*f+r*h*f+o*l*m-r*c*m,n[3]=u*f*g-c*p*g-u*d*v+l*p*v+c*d*y-l*f*y,n[7]=o*p*g-a*f*g+a*d*v-r*p*v-o*d*y+r*f*y,n[11]=a*c*g-o*u*g-a*l*v+r*u*v+o*l*y-r*c*y,n[15]=o*u*d-a*c*d+a*l*f-r*u*f-o*l*p+r*c*p;var b=r*n[0]+l*n[4]+d*n[8]+g*n[12];if(0==b){var x="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(x);return q.warn(x),this.identity(),this}return this.multiplyScalar(1/b),this},translate:function(e){q.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(e){q.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(e){q.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(e){q.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(e,t){q.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,Math.max(n,i)))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,s=e.z,l=r*o,c=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,c*a+n,c*s-i*o,0,l*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},decompose:function(){var e=new q.Vector3,t=new q.Matrix4;return function(n,i,r){var o=this.elements,a=e.set(o[0],o[1],o[2]).length(),s=e.set(o[4],o[5],o[6]).length(),l=e.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],t.elements.set(this.elements);var c=1/a,u=1/s,h=1/l;return t.elements[0]*=c,t.elements[1]*=c,t.elements[2]*=c,t.elements[4]*=u,t.elements[5]*=u,t.elements[6]*=u,t.elements[8]*=h,t.elements[9]*=h,t.elements[10]*=h,i.setFromRotationMatrix(t),r.x=a,r.y=s,r.z=l,this}}(),makeFrustum:function(e,t,n,i,r,o){var a=this.elements,s=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),u=(i+n)/(i-n),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,t,n,i){var r=n*Math.tan(q.Math.degToRad(.5*e)),o=-r,a=o*t,s=r*t;return this.makeFrustum(a,s,o,r,n,i)},makeOrthographic:function(e,t,n,i,r,o){var a=this.elements,s=t-e,l=n-i,c=o-r,u=(t+e)/s,h=(n+i)/l,d=(o+r)/c;return a[0]=2/s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2/l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2/c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return(new q.Matrix4).fromArray(this.elements)}},q.Ray=function(e,t){this.origin=void 0!==e?e:new q.Vector3,this.direction=void 0!==t?t:new q.Vector3},q.Ray.prototype={constructor:q.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new q.Vector3).copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new q.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var n=t||new q.Vector3;n.subVectors(e,this.origin);var i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(){var e=new q.Vector3;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceTo(t):(e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceTo(t))}}(),distanceSqToSegment:(f=new q.Vector3,p=new q.Vector3,m=new q.Vector3,function(e,t,n,i){f.copy(e).add(t).multiplyScalar(.5),p.copy(t).sub(e).normalize(),m.copy(this.origin).sub(f);var r,o,a,s,l=.5*e.distanceTo(t),c=-this.direction.dot(p),u=m.dot(this.direction),h=-m.dot(p),d=m.lengthSq(),g=Math.abs(1-c*c);if(g>0)if(o=c*u-h,s=l*g,(r=c*h-u)>=0)if(o>=-s)if(o<=s){var v=1/g;a=(r*=v)*(r+c*(o*=v)+2*u)+o*(c*r+o+2*h)+d}else o=l,a=-(r=Math.max(0,-(c*o+u)))*r+o*(o+2*h)+d;else o=-l,a=-(r=Math.max(0,-(c*o+u)))*r+o*(o+2*h)+d;else o<=-s?a=-(r=Math.max(0,-(-c*l+u)))*r+(o=r>0?-l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d:o<=s?(r=0,a=(o=Math.min(Math.max(-l,-h),l))*(o+2*h)+d):a=-(r=Math.max(0,-(c*l+u)))*r+(o=r>0?l:Math.min(Math.max(-l,-h),l))*(o+2*h)+d;else o=c>0?-l:l,a=-(r=Math.max(0,-(c*o+u)))*r+o*(o+2*h)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(p).multiplyScalar(o).add(f),a}),isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},intersectSphere:function(){var e=new q.Vector3;return function(t,n){e.subVectors(t.center,this.origin);var i=e.dot(this.direction),r=e.dot(e)-i*i,o=t.radius*t.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=i-a,l=i+a;return s<0&&l<0?null:s<0?this.at(l,n):this.at(s,n)}}(),isIntersectionPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0==t)return 0==e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},isIntersectionBox:(d=new q.Vector3,function(e){return null!==this.intersectBox(e,d)}),intersectBox:function(e,t){var n,i,r,o,a,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||r>i?null:((r>n||n!=n)&&(n=r),(o<i||i!=i)&&(i=o),u>=0?(a=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),n>s||a>i?null:((a>n||n!=n)&&(n=a),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,t)))},intersectTriangle:function(){var e=new q.Vector3,t=new q.Vector3,n=new q.Vector3,i=new q.Vector3;return function(r,o,a,s,l){t.subVectors(o,r),n.subVectors(a,r),i.crossVectors(t,n);var c,u=this.direction.dot(i);if(u>0){if(s)return null;c=1}else{if(!(u<0))return null;c=-1,u=-u}e.subVectors(this.origin,r);var h=c*this.direction.dot(n.crossVectors(e,n));if(h<0)return null;var d=c*this.direction.dot(t.cross(e));if(d<0)return null;if(h+d>u)return null;var f=-c*e.dot(i);return f<0?null:this.at(f/u,l)}}(),applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new q.Ray).copy(this)}},q.Sphere=function(e,t){this.center=void 0!==e?e:new q.Vector3,this.radius=void 0!==t?t:0},q.Sphere.prototype={constructor:q.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(g=new q.Box3,function(e,t){var n=this.center;void 0!==t?n.copy(t):g.setFromPoints(e).center(n);for(var i=0,r=0,o=e.length;r<o;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}),copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var n=this.center.distanceToSquared(e),i=t||new q.Vector3;return i.copy(e),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(e){var t=e||new q.Box3;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new q.Sphere).copy(this)}},q.Frustum=function(e,t,n,i,r,o){this.planes=[void 0!==e?e:new q.Plane,void 0!==t?t:new q.Plane,void 0!==n?n:new q.Plane,void 0!==i?i:new q.Plane,void 0!==r?r:new q.Plane,void 0!==o?o:new q.Plane]},q.Frustum.prototype={constructor:q.Frustum,set:function(e,t,n,i,r,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(a-i,u-s,p-h,y-m).normalize(),t[1].setComponents(a+i,u+s,p+h,y+m).normalize(),t[2].setComponents(a+r,u+l,p+d,y+g).normalize(),t[3].setComponents(a-r,u-l,p-d,y-g).normalize(),t[4].setComponents(a-o,u-c,p-f,y-v).normalize(),t[5].setComponents(a+o,u+c,p+f,y+v).normalize(),this},intersectsObject:(_=new q.Sphere,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),_.copy(t.boundingSphere),_.applyMatrix4(e.matrixWorld),this.intersectsSphere(_)}),intersectsSphere:function(e){for(var t=this.planes,n=e.center,i=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0},intersectsBox:(v=new q.Vector3,y=new q.Vector3,function(e){for(var t=this.planes,n=0;n<6;n++){var i=t[n];v.x=i.normal.x>0?e.min.x:e.max.x,y.x=i.normal.x>0?e.max.x:e.min.x,v.y=i.normal.y>0?e.min.y:e.max.y,y.y=i.normal.y>0?e.max.y:e.min.y,v.z=i.normal.z>0?e.min.z:e.max.z,y.z=i.normal.z>0?e.max.z:e.min.z;var r=i.distanceToPoint(v),o=i.distanceToPoint(y);if(r<0&&o<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0},clone:function(){return(new q.Frustum).copy(this)}},q.Plane=function(e,t){this.normal=void 0!==e?e:new q.Vector3(1,0,0),this.constant=void 0!==t?t:0},q.Plane.prototype={constructor:q.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new q.Vector3,t=new q.Vector3;return function(n,i,r){var o=e.subVectors(r,i).cross(t.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e);return(t||new q.Vector3).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectLine:function(){var e=new q.Vector3;return function(t,n){var i=n||new q.Vector3,r=t.delta(e),o=this.normal.dot(r);if(0==o)return 0==this.distanceToPoint(t.start)?i.copy(t.start):void 0;var a=-(t.start.dot(this.normal)+this.constant)/o;return a<0||a>1?void 0:i.copy(r).multiplyScalar(a).add(t.start)}}(),coplanarPoint:function(e){return(e||new q.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new q.Vector3,t=new q.Vector3,n=new q.Matrix3;return function(i,r){var o=r||n.getNormalMatrix(i),a=e.copy(this.normal).applyMatrix3(o);a.normalize();var s=this.coplanarPoint(t);return s.applyMatrix4(i),this.setFromNormalAndCoplanarPoint(a,s),this}}(),translate:function(e){return this.constant=this.constant-e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new q.Plane).copy(this)}},q.Math={generateUUID:function(){var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0;return function(){for(var r=0;r<36;r++)8==r||13==r||18==r||23==r?n[r]="-":14==r?n[r]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),e=15&i,i>>=4,n[r]=t[19==r?3&e|8:e]);return n.join("")}}(),clamp:function(e,t,n){return e<t?t:e>n?n:e},clampBottom:function(e,t){return e<t?t:e},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return Math.floor(this.randFloat(e,t))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:(x=Math.PI/180,function(e){return e*x}),radToDeg:(b=180/Math.PI,function(e){return e*b}),isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},nextPowerOfTwo:function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}},q.Spline=function(e){this.points=e;var t,n,i,r,o,a,s,l,c,u=[],h={x:0,y:0,z:0};function d(e,t,n,i,r,o,a){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*r+t}this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return t=(this.points.length-1)*e,n=Math.floor(t),i=t-n,u[0]=0===n?n:n-1,u[1]=n,u[2]=n>this.points.length-2?this.points.length-1:n+1,u[3]=n>this.points.length-3?this.points.length-1:n+2,a=this.points[u[0]],s=this.points[u[1]],l=this.points[u[2]],c=this.points[u[3]],o=i*(r=i*i),h.x=d(a.x,s.x,l.x,c.x,i,r,o),h.y=d(a.y,s.y,l.y,c.y,i,r,o),h.z=d(a.z,s.z,l.z,c.z,i,r,o),h},this.getControlPointsArray=function(){var e,t,n=this.points.length,i=[];for(e=0;e<n;e++)t=this.points[e],i[e]=[t.x,t.y,t.z];return i},this.getLength=function(e){var t,n,i,r,o=0,a=0,s=0,l=new q.Vector3,c=new q.Vector3,u=[],h=0;for(u[0]=0,e||(e=100),i=this.points.length*e,l.copy(this.points[0]),t=1;t<i;t++)n=t/i,r=this.getPoint(n),c.copy(r),h+=c.distanceTo(l),l.copy(r),o=(this.points.length-1)*n,(a=Math.floor(o))!=s&&(u[a]=h,s=a);return u[u.length]=h,{chunks:u,total:h}},this.reparametrizeByArcLength=function(e){var t,n,i,r,o,a,s,l,c=[],u=new q.Vector3,h=this.getLength();for(c.push(u.copy(this.points[0]).clone()),t=1;t<this.points.length;t++){for(a=h.chunks[t]-h.chunks[t-1],s=Math.ceil(e*a/h.total),r=(t-1)/(this.points.length-1),o=t/(this.points.length-1),n=1;n<s-1;n++)i=r+n*(1/s)*(o-r),l=this.getPoint(i),c.push(u.copy(l).clone());c.push(u.copy(this.points[t]).clone())}this.points=c}},q.Triangle=function(e,t,n){this.a=void 0!==e?e:new q.Vector3,this.b=void 0!==t?t:new q.Vector3,this.c=void 0!==n?n:new q.Vector3},q.Triangle.normal=(w=new q.Vector3,function(e,t,n,i){var r=i||new q.Vector3;r.subVectors(n,t),w.subVectors(e,t),r.cross(w);var o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}),q.Triangle.barycoordFromPoint=function(){var e=new q.Vector3,t=new q.Vector3,n=new q.Vector3;return function(i,r,o,a,s){e.subVectors(a,r),t.subVectors(o,r),n.subVectors(i,r);var l=e.dot(e),c=e.dot(t),u=e.dot(n),h=t.dot(t),d=t.dot(n),f=l*h-c*c,p=s||new q.Vector3;if(0==f)return p.set(-2,-1,-1);var m=1/f,g=(h*u-c*d)*m,v=(l*d-c*u)*m;return p.set(1-g-v,v,g)}}(),q.Triangle.containsPoint=function(){var e=new q.Vector3;return function(t,n,i,r){var o=q.Triangle.barycoordFromPoint(t,n,i,r,e);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),q.Triangle.prototype={constructor:q.Triangle,set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new q.Vector3,t=new q.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new q.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return q.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new q.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return q.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return q.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new q.Triangle).copy(this)}},q.Clock=function(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},q.Clock.prototype={constructor:q.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running&&this.start(),this.running){var t=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();e=.001*(t-this.oldTime),this.oldTime=t,this.elapsedTime+=e}return e}},q.EventDispatcher=function(){},q.EventDispatcher.prototype={constructor:q.EventDispatcher,apply:function(e){e.addEventListener=q.EventDispatcher.prototype.addEventListener,e.hasEventListener=q.EventDispatcher.prototype.hasEventListener,e.removeEventListener=q.EventDispatcher.prototype.removeEventListener,e.dispatchEvent=q.EventDispatcher.prototype.dispatchEvent},addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var i=n.indexOf(t);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=[],i=t.length,r=0;r<i;r++)n[r]=t[r];for(r=0;r<i;r++)n[r].call(this,e)}}}},function(e){e.Raycaster=function(t,n,i,r){this.ray=new e.Ray(t,n),this.near=i||0,this.far=r||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var t=function(e,t){return e.distance-t.distance},n=function(e,t,i,r){if(e.raycast(t,i),!0===r)for(var o=e.children,a=0,s=o.length;a<s;a++)n(o[a],t,i,!0)};e.Raycaster.prototype={constructor:e.Raycaster,precision:1e-4,linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(t,n){n instanceof e.PerspectiveCamera?(this.ray.origin.copy(n.position),this.ray.direction.set(t.x,t.y,.5).unproject(n).sub(n.position).normalize()):n instanceof e.OrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld)):e.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,i){var r=[];return n(e,this,r,i),r.sort(t),r},intersectObjects:function(i,r){var o=[];if(i instanceof Array==!1)return e.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),o;for(var a=0,s=i.length;a<s;a++)n(i[a],this,o,r);return o.sort(t),o}}}(q),q.Object3D=function(){Object.defineProperty(this,"id",{value:q.Object3DIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=void 0,this.children=[],this.up=q.Object3D.DefaultUp.clone();var e=new q.Vector3,t=new q.Euler,n=new q.Quaternion,i=new q.Vector3(1,1,1);t.onChange((function(){n.setFromEuler(t,!1)})),n.onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:i}}),this.rotationAutoUpdate=!0,this.matrix=new q.Matrix4,this.matrixWorld=new q.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},q.Object3D.DefaultUp=new q.Vector3(0,1,0),q.Object3D.prototype={constructor:q.Object3D,get eulerOrder(){return q.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(e){q.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=e},get useQuaternion(){q.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(e){q.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(T=new q.Quaternion,function(e,t){return T.setFromAxisAngle(e,t),this.quaternion.multiply(T),this}),rotateX:function(){var e=new q.Vector3(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new q.Vector3(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new q.Vector3(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new q.Vector3;return function(t,n){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(n)),this}}(),translate:function(e,t){return q.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},translateX:function(){var e=new q.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new q.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new q.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(M=new q.Matrix4,function(e){return e.applyMatrix4(M.getInverse(this.matrixWorld))}),lookAt:function(){var e=new q.Matrix4;return function(t){e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(q.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e instanceof q.Object3D?(void 0!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):q.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);var n=this.children.indexOf(e);-1!==n&&(e.parent=void 0,e.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getChildByName:function(e){return q.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){var t=e||new q.Vector3;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(A=new q.Vector3,E=new q.Vector3,function(e){var t=e||new q.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(A,t,E),t}),getWorldRotation:function(){var e=new q.Quaternion;return function(t){var n=t||new q.Euler;return this.getWorldQuaternion(e),n.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new q.Vector3,t=new q.Quaternion;return function(n){var i=n||new q.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,i),i}}(),getWorldDirection:function(){var e=new q.Quaternion;return function(t){var n=t||new q.Vector3;return this.getWorldQuaternion(e),n.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=0,n=this.children.length;t<n;t++)this.children[t].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=0,n=this.children.length;t<n;t++)this.children[t].traverseVisible(e)}},traverseAncestors:function(e){this.parent&&(e(this.parent),this.parent.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==e||(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)},toJSON:function(){var e={metadata:{version:4.3,type:"Object",generator:"ObjectExporter"}},t={},n={},i=function(t){if(void 0===e.materials&&(e.materials=[]),void 0===n[t.uuid]){var i=t.toJSON();delete i.metadata,n[t.uuid]=i,e.materials.push(i)}return t.uuid};return e.object=function n(r){var o={};if(o.uuid=r.uuid,o.type=r.type,""!==r.name&&(o.name=r.name),"{}"!==JSON.stringify(r.userData)&&(o.userData=r.userData),!0!==r.visible&&(o.visible=r.visible),r instanceof q.PerspectiveCamera?(o.fov=r.fov,o.aspect=r.aspect,o.near=r.near,o.far=r.far):r instanceof q.OrthographicCamera?(o.left=r.left,o.right=r.right,o.top=r.top,o.bottom=r.bottom,o.near=r.near,o.far=r.far):r instanceof q.AmbientLight?o.color=r.color.getHex():r instanceof q.DirectionalLight?(o.color=r.color.getHex(),o.intensity=r.intensity):r instanceof q.PointLight?(o.color=r.color.getHex(),o.intensity=r.intensity,o.distance=r.distance,o.decay=r.decay):r instanceof q.SpotLight?(o.color=r.color.getHex(),o.intensity=r.intensity,o.distance=r.distance,o.angle=r.angle,o.exponent=r.exponent,o.decay=r.decay):r instanceof q.HemisphereLight?(o.color=r.color.getHex(),o.groundColor=r.groundColor.getHex()):r instanceof q.Mesh||r instanceof q.Line||r instanceof q.PointCloud?(o.geometry=function(n){if(void 0===e.geometries&&(e.geometries=[]),void 0===t[n.uuid]){var i=n.toJSON();delete i.metadata,t[n.uuid]=i,e.geometries.push(i)}return n.uuid}(r.geometry),o.material=i(r.material),r instanceof q.Line&&(o.mode=r.mode)):r instanceof q.Sprite&&(o.material=i(r.material)),o.matrix=r.matrix.toArray(),r.children.length>0){o.children=[];for(var a=0;a<r.children.length;a++)o.children.push(n(r.children[a]))}return o}(this),e},clone:function(e,t){if(void 0===e&&(e=new q.Object3D),void 0===t&&(t=!0),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.quaternion.copy(this.quaternion),e.scale.copy(this.scale),e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData)),!0===t)for(var n=0;n<this.children.length;n++){var i=this.children[n];e.add(i.clone())}return e}},q.EventDispatcher.prototype.apply(q.Object3D.prototype),q.Object3DIdCount=0,q.Face3=function(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.normal=i instanceof q.Vector3?i:new q.Vector3,this.vertexNormals=i instanceof Array?i:[],this.color=r instanceof q.Color?r:new q.Color,this.vertexColors=r instanceof Array?r:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0},q.Face3.prototype={constructor:q.Face3,clone:function(){var e=new q.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.materialIndex=this.materialIndex;for(var t=0,n=this.vertexNormals.length;t<n;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();for(t=0,n=this.vertexColors.length;t<n;t++)e.vertexColors[t]=this.vertexColors[t].clone();for(t=0,n=this.vertexTangents.length;t<n;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},q.Face4=function(e,t,n,i,r,o,a){return q.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new q.Face3(e,t,n,r,o,a)},q.BufferAttribute=function(e,t){this.array=e,this.itemSize=t,this.needsUpdate=!1},q.BufferAttribute.prototype={constructor:q.BufferAttribute,get length(){return this.array.length},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},setX:function(e,t){return this.array[e*this.itemSize]=t,this},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},clone:function(){return new q.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}},q.Int8Attribute=function(e,t){return q.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Uint8Attribute=function(e,t){return q.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Uint8ClampedAttribute=function(e,t){return q.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Int16Attribute=function(e,t){return q.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Uint16Attribute=function(e,t){return q.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Int32Attribute=function(e,t){return q.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Uint32Attribute=function(e,t){return q.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Float32Attribute=function(e,t){return q.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.Float64Attribute=function(e,t){return q.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new q.BufferAttribute(e,t)},q.DynamicBufferAttribute=function(e,t){q.BufferAttribute.call(this,e,t),this.updateRange={offset:0,count:-1}},q.DynamicBufferAttribute.prototype=Object.create(q.BufferAttribute.prototype),q.DynamicBufferAttribute.prototype.constructor=q.DynamicBufferAttribute,q.DynamicBufferAttribute.prototype.clone=function(){return new q.DynamicBufferAttribute(new this.array.constructor(this.array),this.itemSize)},q.BufferGeometry=function(){Object.defineProperty(this,"id",{value:q.GeometryIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.attributes={},this.attributesKeys=[],this.drawcalls=[],this.offsets=this.drawcalls,this.boundingBox=null,this.boundingSphere=null},q.BufferGeometry.prototype={constructor:q.BufferGeometry,addAttribute:function(e,t){if(t instanceof q.BufferAttribute==!1)return q.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void(this.attributes[e]={array:arguments[1],itemSize:arguments[2]});this.attributes[e]=t,this.attributesKeys=Object.keys(this.attributes)},getAttribute:function(e){return this.attributes[e]},addDrawCall:function(e,t,n){this.drawcalls.push({start:e,count:t,index:void 0!==n?n:0})},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToVector3Array(t.array),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new q.Matrix3).getNormalMatrix(e).applyToVector3Array(n.array),n.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.applyMatrix((new q.Matrix4).setPosition(e)),e},fromGeometry:function(e,t){t=t||{vertexColors:q.NoColors};var n=e.vertices,i=e.faces,r=e.faceVertexUvs,o=t.vertexColors,a=r[0].length>0,s=3==i[0].vertexNormals.length,l=new Float32Array(3*i.length*3);this.addAttribute("position",new q.BufferAttribute(l,3));var c=new Float32Array(3*i.length*3);if(this.addAttribute("normal",new q.BufferAttribute(c,3)),o!==q.NoColors){var u=new Float32Array(3*i.length*3);this.addAttribute("color",new q.BufferAttribute(u,3))}if(!0===a){var h=new Float32Array(3*i.length*2);this.addAttribute("uv",new q.BufferAttribute(h,2))}for(var d=0,f=0,p=0;d<i.length;d++,f+=6,p+=9){var m=i[d],g=n[m.a],v=n[m.b],y=n[m.c];if(l[p]=g.x,l[p+1]=g.y,l[p+2]=g.z,l[p+3]=v.x,l[p+4]=v.y,l[p+5]=v.z,l[p+6]=y.x,l[p+7]=y.y,l[p+8]=y.z,!0===s){var _=m.vertexNormals[0],b=m.vertexNormals[1],x=m.vertexNormals[2];c[p]=_.x,c[p+1]=_.y,c[p+2]=_.z,c[p+3]=b.x,c[p+4]=b.y,c[p+5]=b.z,c[p+6]=x.x,c[p+7]=x.y,c[p+8]=x.z}else{var w=m.normal;c[p]=w.x,c[p+1]=w.y,c[p+2]=w.z,c[p+3]=w.x,c[p+4]=w.y,c[p+5]=w.z,c[p+6]=w.x,c[p+7]=w.y,c[p+8]=w.z}if(o===q.FaceColors){var A=m.color;u[p]=A.r,u[p+1]=A.g,u[p+2]=A.b,u[p+3]=A.r,u[p+4]=A.g,u[p+5]=A.b,u[p+6]=A.r,u[p+7]=A.g,u[p+8]=A.b}else if(o===q.VertexColors){var E=m.vertexColors[0],M=m.vertexColors[1],T=m.vertexColors[2];u[p]=E.r,u[p+1]=E.g,u[p+2]=E.b,u[p+3]=M.r,u[p+4]=M.g,u[p+5]=M.b,u[p+6]=T.r,u[p+7]=T.g,u[p+8]=T.b}if(!0===a){var S=r[0][d][0],C=r[0][d][1],P=r[0][d][2];h[f]=S.x,h[f+1]=S.y,h[f+2]=C.x,h[f+3]=C.y,h[f+4]=P.x,h[f+5]=P.y}}return this.computeBoundingSphere(),this},computeBoundingBox:function(){var e=new q.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new q.Box3);var t=this.attributes.position.array;if(t){var n=this.boundingBox;n.makeEmpty();for(var i=0,r=t.length;i<r;i+=3)e.set(t[i],t[i+1],t[i+2]),n.expandByPoint(e)}void 0!==t&&0!==t.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&q.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var e=new q.Box3,t=new q.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new q.Sphere);var n=this.attributes.position.array;if(n){e.makeEmpty();for(var i=this.boundingSphere.center,r=0,o=n.length;r<o;r+=3)t.set(n[r],n[r+1],n[r+2]),e.expandByPoint(t);e.center(i);var a=0;for(r=0,o=n.length;r<o;r+=3)t.set(n[r],n[r+1],n[r+2]),a=Math.max(a,i.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&q.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.attributes;if(e.position){var t=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new q.BufferAttribute(new Float32Array(t.length),3));else for(var n=0,i=(s=e.normal.array).length;n<i;n++)s[n]=0;var r,o,a,s=e.normal.array,l=new q.Vector3,c=new q.Vector3,u=new q.Vector3,h=new q.Vector3,d=new q.Vector3;if(e.index)for(var f=e.index.array,p=this.offsets.length>0?this.offsets:[{start:0,count:f.length,index:0}],m=0,g=p.length;m<g;++m){var v=p[m].start,y=p[m].count,_=p[m].index;for(n=v,i=v+y;n<i;n+=3)r=3*(_+f[n]),o=3*(_+f[n+1]),a=3*(_+f[n+2]),l.fromArray(t,r),c.fromArray(t,o),u.fromArray(t,a),h.subVectors(u,c),d.subVectors(l,c),h.cross(d),s[r]+=h.x,s[r+1]+=h.y,s[r+2]+=h.z,s[o]+=h.x,s[o+1]+=h.y,s[o+2]+=h.z,s[a]+=h.x,s[a+1]+=h.y,s[a+2]+=h.z}else for(n=0,i=t.length;n<i;n+=9)l.fromArray(t,n),c.fromArray(t,n+3),u.fromArray(t,n+6),h.subVectors(u,c),d.subVectors(l,c),h.cross(d),s[n]=h.x,s[n+1]=h.y,s[n+2]=h.z,s[n+3]=h.x,s[n+4]=h.y,s[n+5]=h.z,s[n+6]=h.x,s[n+7]=h.y,s[n+8]=h.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},computeTangents:function(){if(void 0!==this.attributes.index&&void 0!==this.attributes.position&&void 0!==this.attributes.normal&&void 0!==this.attributes.uv){var e=this.attributes.index.array,t=this.attributes.position.array,n=this.attributes.normal.array,i=this.attributes.uv.array,r=t.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new q.BufferAttribute(new Float32Array(4*r),4));for(var o=this.attributes.tangent.array,a=[],s=[],l=0;l<r;l++)a[l]=new q.Vector3,s[l]=new q.Vector3;var c,u,h,d,f,p,m,g,v,y,_,b,x,w,A,E,M,T,S=new q.Vector3,C=new q.Vector3,P=new q.Vector3,L=new q.Vector2,D=new q.Vector2,R=new q.Vector2,I=new q.Vector3,O=new q.Vector3;0===this.drawcalls.length&&this.addDrawCall(0,e.length,0);var N,k,F,V=this.drawcalls;for(w=0,A=V.length;w<A;++w){var B=V[w].start,U=V[w].count,z=V[w].index;for(b=B,x=B+U;b<x;b+=3)E=z+e[b],M=z+e[b+1],T=z+e[b+2],N=E,k=M,F=T,S.fromArray(t,3*N),C.fromArray(t,3*k),P.fromArray(t,3*F),L.fromArray(i,2*N),D.fromArray(i,2*k),R.fromArray(i,2*F),c=C.x-S.x,u=P.x-S.x,h=C.y-S.y,d=P.y-S.y,f=C.z-S.z,p=P.z-S.z,m=D.x-L.x,g=R.x-L.x,v=D.y-L.y,y=R.y-L.y,_=1/(m*y-g*v),I.set((y*c-v*u)*_,(y*h-v*d)*_,(y*f-v*p)*_),O.set((m*u-g*c)*_,(m*d-g*h)*_,(m*p-g*f)*_),a[N].add(I),a[k].add(I),a[F].add(I),s[N].add(O),s[k].add(O),s[F].add(O)}var G,H,W,j=new q.Vector3,X=new q.Vector3,Y=new q.Vector3,K=new q.Vector3;for(w=0,A=V.length;w<A;++w){B=V[w].start,U=V[w].count,z=V[w].index;for(b=B,x=B+U;b<x;b+=3)E=z+e[b],M=z+e[b+1],T=z+e[b+2],Z(E),Z(M),Z(T)}}else q.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function Z(e){Y.fromArray(n,3*e),K.copy(Y),H=a[e],j.copy(H),j.sub(Y.multiplyScalar(Y.dot(H))).normalize(),X.crossVectors(K,H),W=X.dot(s[e]),G=W<0?-1:1,o[4*e]=j.x,o[4*e+1]=j.y,o[4*e+2]=j.z,o[4*e+3]=G}},computeOffsets:function(e){void 0===e&&(e=65535);for(var t=this.attributes.index.array,n=this.attributes.position.array,i=t.length/3,r=new Uint16Array(t.length),o=0,a=0,s=[{start:0,count:0,index:0}],l=s[0],c=0,u=new Int32Array(6),h=new Int32Array(n.length),d=new Int32Array(n.length),f=0;f<n.length;f++)h[f]=-1,d[f]=-1;for(var p=0;p<i;p++){c=0;for(var m=0;m<3;m++){-1==h[_=t[3*p+m]]?(u[2*m]=_,u[2*m+1]=-1,c++):h[_]<l.index?(u[2*m]=_,u[2*m+1]=-1,0):(u[2*m]=_,u[2*m+1]=h[_])}if(a+c>l.index+e){var g={start:o,count:0,index:a};s.push(g),l=g;for(var v=0;v<6;v+=2){(y=u[v+1])>-1&&y<l.index&&(u[v+1]=-1)}}for(v=0;v<6;v+=2){var y,_=u[v];-1===(y=u[v+1])&&(y=a++),h[_]=y,d[y]=_,r[o++]=y-l.index,l.count++}}return this.reorderBuffers(r,d,a),this.offsets=s,this.drawcalls=s,s},merge:function(e,t){if(e instanceof q.BufferGeometry!=!1){void 0===t&&(t=0);var n=this.attributes;for(var i in n)if(void 0!==e.attributes[i])for(var r=n[i].array,o=e.attributes[i],a=o.array,s=0,l=o.itemSize*t;s<a.length;s++,l++)r[l]=a[s];return this}q.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e,t,n,i,r=this.attributes.normal.array,o=0,a=r.length;o<a;o+=3)e=r[o],t=r[o+1],n=r[o+2],i=1/Math.sqrt(e*e+t*t+n*n),r[o]*=i,r[o+1]*=i,r[o+2]*=i},reorderBuffers:function(e,t,n){var i={};for(var r in this.attributes)if("index"!=r){var o=this.attributes[r].array;i[r]=new o.constructor(this.attributes[r].itemSize*n)}for(var a=0;a<n;a++){var s=t[a];for(var r in this.attributes)if("index"!=r)for(var l=this.attributes[r].array,c=this.attributes[r].itemSize,u=i[r],h=0;h<c;h++)u[a*c+h]=l[s*c+h]}for(var r in this.attributes.index.array=e,this.attributes)"index"!=r&&(this.attributes[r].array=i[r],this.attributes[r].numItems=this.attributes[r].itemSize*n)},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type,data:{attributes:{}}},t=this.attributes,n=this.offsets,i=this.boundingSphere;for(var r in t){var o=t[r],a=Array.prototype.slice.call(o.array);e.data.attributes[r]={itemSize:o.itemSize,type:o.array.constructor.name,array:a}}return n.length>0&&(e.data.offsets=JSON.parse(JSON.stringify(n))),null!==i&&(e.data.boundingSphere={center:i.center.toArray(),radius:i.radius}),e},clone:function(){var e=new q.BufferGeometry;for(var t in this.attributes){var n=this.attributes[t];e.addAttribute(t,n.clone())}for(var i=0,r=this.offsets.length;i<r;i++){var o=this.offsets[i];e.offsets.push({start:o.start,index:o.index,count:o.count})}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},q.EventDispatcher.prototype.apply(q.BufferGeometry.prototype),q.Geometry=function(){Object.defineProperty(this,"id",{value:q.GeometryIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},q.Geometry.prototype={constructor:q.Geometry,applyMatrix:function(e){for(var t=(new q.Matrix3).getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++){this.vertices[n].applyMatrix4(e)}for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(t).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(t).normalize()}null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0},fromBufferGeometry:function(e){for(var t=this,n=e.attributes,i=n.position.array,r=void 0!==n.index?n.index.array:void 0,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,l=[],c=[],u=0,h=0;u<i.length;u+=3,h+=2)t.vertices.push(new q.Vector3(i[u],i[u+1],i[u+2])),void 0!==o&&l.push(new q.Vector3(o[u],o[u+1],o[u+2])),void 0!==a&&t.colors.push(new q.Color(a[u],a[u+1],a[u+2])),void 0!==s&&c.push(new q.Vector2(s[h],s[h+1]));var d=function(e,n,i){var r=void 0!==o?[l[e].clone(),l[n].clone(),l[i].clone()]:[],u=void 0!==a?[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()]:[];t.faces.push(new q.Face3(e,n,i,r,u)),void 0!==s&&t.faceVertexUvs[0].push([c[e].clone(),c[n].clone(),c[i].clone()])};if(void 0!==r){var f=e.drawcalls;if(f.length>0)for(u=0;u<f.length;u++)for(var p=f[u],m=p.start,g=p.count,v=p.index,y=(h=m,m+g);h<y;h+=3)d(v+r[h],v+r[h+1],v+r[h+2]);else for(u=0;u<r.length;u+=3)d(r[u],r[u+1],r[u+2])}else for(u=0;u<i.length/3;u+=3)d(u,u+1,u+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.center().negate();return this.applyMatrix((new q.Matrix4).setPosition(e)),e},computeFaceNormals:function(){for(var e=new q.Vector3,t=new q.Vector3,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,n,i,r,o,a;for(a=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)a[t]=new q.Vector3;if(e){var s,l,c,u=new q.Vector3,h=new q.Vector3;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c],u.subVectors(c,l),h.subVectors(s,l),u.cross(h),a[o.a].add(u),a[o.b].add(u),a[o.c].add(u)}else for(i=0,r=this.faces.length;i<r;i++)a[(o=this.faces[i]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)a[t].normalize();for(i=0,r=this.faces.length;i<r;i++)(o=this.faces[i]).vertexNormals[0]=a[o.a].clone(),o.vertexNormals[1]=a[o.b].clone(),o.vertexNormals[2]=a[o.c].clone()},computeMorphNormals:function(){var e,t,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for((r=this.faces[n]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new q.Geometry;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)l=new q.Vector3,c={a:new q.Vector3,b:new q.Vector3,c:new q.Vector3},a.push(l),s.push(c)}var l,c,u=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],l=u.faceNormals[n],c=u.vertexNormals[n],l.copy(r.normal),c.a.copy(r.vertexNormals[0]),c.b.copy(r.vertexNormals[1]),c.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)(r=this.faces[n]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){var e,t,n,i,r,o,a,s,l,c,u,h,d,f,p,m,g,v,y,_,b,x,w,A,E,M,T,S,C,P,L,D,R,I,O=[],N=[],k=new q.Vector3,F=new q.Vector3,V=new q.Vector3,B=new q.Vector3,U=new q.Vector3;for(n=0,i=this.vertices.length;n<i;n++)O[n]=new q.Vector3,N[n]=new q.Vector3;for(e=0,t=this.faces.length;e<t;e++)a=this.faces[e],s=this.faceVertexUvs[0][e],S=this,C=a.a,P=a.b,L=a.c,D=0,R=1,I=2,l=S.vertices[C],c=S.vertices[P],u=S.vertices[L],h=s[D],d=s[R],f=s[I],p=c.x-l.x,m=u.x-l.x,g=c.y-l.y,v=u.y-l.y,y=c.z-l.z,_=u.z-l.z,b=d.x-h.x,x=f.x-h.x,w=d.y-h.y,A=f.y-h.y,E=1/(b*A-x*w),k.set((A*p-w*m)*E,(A*g-w*v)*E,(A*y-w*_)*E),F.set((b*m-x*p)*E,(b*v-x*g)*E,(b*_-x*y)*E),O[C].add(k),O[P].add(k),O[L].add(k),N[C].add(F),N[P].add(F),N[L].add(F);var z=["a","b","c","d"];for(e=0,t=this.faces.length;e<t;e++)for(a=this.faces[e],r=0;r<Math.min(a.vertexNormals.length,3);r++)U.copy(a.vertexNormals[r]),o=a[z[r]],M=O[o],V.copy(M),V.sub(U.multiplyScalar(U.dot(M))).normalize(),B.crossVectors(a.vertexNormals[r],M),T=B.dot(N[o])<0?-1:1,a.vertexTangents[r]=new q.Vector4(V.x,V.y,V.z,T);this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,n=0,i=t.length;n<i;n++)n>0&&(e+=t[n].distanceTo(t[n-1])),this.lineDistances[n]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new q.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new q.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e instanceof q.Geometry!=!1){var i,r=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,l=e.faces,c=this.faceVertexUvs[0],u=e.faceVertexUvs[0];void 0===n&&(n=0),void 0!==t&&(i=(new q.Matrix3).getNormalMatrix(t));for(var h=0,d=a.length;h<d;h++){var f=a[h].clone();void 0!==t&&f.applyMatrix4(t),o.push(f)}for(h=0,d=l.length;h<d;h++){var p,m,g,v=l[h],y=v.vertexNormals,_=v.vertexColors;(p=new q.Face3(v.a+r,v.b+r,v.c+r)).normal.copy(v.normal),void 0!==i&&p.normal.applyMatrix3(i).normalize();for(var b=0,x=y.length;b<x;b++)m=y[b].clone(),void 0!==i&&m.applyMatrix3(i).normalize(),p.vertexNormals.push(m);p.color.copy(v.color);for(b=0,x=_.length;b<x;b++)g=_[b],p.vertexColors.push(g.clone());p.materialIndex=v.materialIndex+n,s.push(p)}for(h=0,d=u.length;h<d;h++){var w=u[h],A=[];if(void 0!==w){for(b=0,x=w.length;b<x;b++)A.push(w[b].clone());c.push(A)}}}else q.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e instanceof q.Mesh!=!1?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):q.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,i,r,o,a,s,l={},c=[],u=[],h=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)e=this.vertices[n],void 0===l[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(l[t]=n,c.push(this.vertices[n]),u[n]=c.length-1):u[n]=u[l[t]];var d=[];for(n=0,i=this.faces.length;n<i;n++){(r=this.faces[n]).a=u[r.a],r.b=u[r.b],r.c=u[r.c],o=[r.a,r.b,r.c];for(var f=0;f<3;f++)if(o[f]==o[(f+1)%3]){f,d.push(n);break}}for(n=d.length-1;n>=0;n--){var p=d[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},toJSON:function(){var e={metadata:{version:4,type:"BufferGeometry",generator:"BufferGeometryExporter"},uuid:this.uuid,type:this.type};if(""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var i=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];i.push(o.x,o.y,o.z)}var a=[],s=[],l={},c=[],u={},h=[],d={};for(r=0;r<this.faces.length;r++){var f=this.faces[r],p=void 0!==this.faceVertexUvs[0][r],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,_=0;if(_=A(_,0,0),_=A(_,1,!1),_=A(_,2,!1),_=A(_,3,p),_=A(_,4,m),_=A(_,5,g),_=A(_,6,v),_=A(_,7,y),a.push(_),a.push(f.a,f.b,f.c),p){var b=this.faceVertexUvs[0][r];a.push(T(b[0]),T(b[1]),T(b[2]))}if(m&&a.push(E(f.normal)),g){var x=f.vertexNormals;a.push(E(x[0]),E(x[1]),E(x[2]))}if(v&&a.push(M(f.color)),y){var w=f.vertexColors;a.push(M(w[0]),M(w[1]),M(w[2]))}}function A(e,t,n){return n?e|1<<t:e&~(1<<t)}function E(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]?l[t]:(l[t]=s.length/3,s.push(e.x,e.y,e.z),l[t])}function M(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==u[t]?u[t]:(u[t]=c.length,c.push(e.getHex()),u[t])}function T(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=h.length/2,h.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=i,e.data.normals=s,c.length>0&&(e.data.colors=c),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){for(var e=new q.Geometry,t=this.vertices,n=0,i=t.length;n<i;n++)e.vertices.push(t[n].clone());var r=this.faces;for(n=0,i=r.length;n<i;n++)e.faces.push(r[n].clone());for(n=0,i=this.faceVertexUvs.length;n<i;n++){var o=this.faceVertexUvs[n];void 0===e.faceVertexUvs[n]&&(e.faceVertexUvs[n]=[]);for(var a=0,s=o.length;a<s;a++){for(var l=o[a],c=[],u=0,h=l.length;u<h;u++){var d=l[u];c.push(d.clone())}e.faceVertexUvs[n].push(c)}}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},q.EventDispatcher.prototype.apply(q.Geometry.prototype),q.GeometryIdCount=0,q.Camera=function(){q.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new q.Matrix4,this.projectionMatrix=new q.Matrix4},q.Camera.prototype=Object.create(q.Object3D.prototype),q.Camera.prototype.constructor=q.Camera,q.Camera.prototype.getWorldDirection=function(){var e=new q.Quaternion;return function(t){var n=t||new q.Vector3;return this.getWorldQuaternion(e),n.set(0,0,-1).applyQuaternion(e)}}(),q.Camera.prototype.lookAt=function(){var e=new q.Matrix4;return function(t){e.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(e)}}(),q.Camera.prototype.clone=function(e){return void 0===e&&(e=new q.Camera),q.Object3D.prototype.clone.call(this,e),e.matrixWorldInverse.copy(this.matrixWorldInverse),e.projectionMatrix.copy(this.projectionMatrix),e},q.CubeCamera=function(e,t,n){q.Object3D.call(this),this.type="CubeCamera";var i=new q.PerspectiveCamera(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new q.Vector3(1,0,0)),this.add(i);var r=new q.PerspectiveCamera(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new q.Vector3(-1,0,0)),this.add(r);var o=new q.PerspectiveCamera(90,1,e,t);o.up.set(0,0,1),o.lookAt(new q.Vector3(0,1,0)),this.add(o);var a=new q.PerspectiveCamera(90,1,e,t);a.up.set(0,0,-1),a.lookAt(new q.Vector3(0,-1,0)),this.add(a);var s=new q.PerspectiveCamera(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new q.Vector3(0,0,1)),this.add(s);var l=new q.PerspectiveCamera(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new q.Vector3(0,0,-1)),this.add(l),this.renderTarget=new q.WebGLRenderTargetCube(n,n,{format:q.RGBFormat,magFilter:q.LinearFilter,minFilter:q.LinearFilter}),this.updateCubeMap=function(e,t){var n=this.renderTarget,c=n.generateMipmaps;n.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,i,n),n.activeCubeFace=1,e.render(t,r,n),n.activeCubeFace=2,e.render(t,o,n),n.activeCubeFace=3,e.render(t,a,n),n.activeCubeFace=4,e.render(t,s,n),n.generateMipmaps=c,n.activeCubeFace=5,e.render(t,l,n)}},q.CubeCamera.prototype=Object.create(q.Object3D.prototype),q.CubeCamera.prototype.constructor=q.CubeCamera,q.OrthographicCamera=function(e,t,n,i,r,o){q.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()},q.OrthographicCamera.prototype=Object.create(q.Camera.prototype),q.OrthographicCamera.prototype.constructor=q.OrthographicCamera,q.OrthographicCamera.prototype.updateProjectionMatrix=function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(n-e,n+e,i+t,i-t,this.near,this.far)},q.OrthographicCamera.prototype.clone=function(){var e=new q.OrthographicCamera;return q.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},q.PerspectiveCamera=function(e,t,n,i){q.Camera.call(this),this.type="PerspectiveCamera",this.zoom=1,this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.updateProjectionMatrix()},q.PerspectiveCamera.prototype=Object.create(q.Camera.prototype),q.PerspectiveCamera.prototype.constructor=q.PerspectiveCamera,q.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*q.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},q.PerspectiveCamera.prototype.setViewOffset=function(e,t,n,i,r,o){this.fullWidth=e,this.fullHeight=t,this.x=n,this.y=i,this.width=r,this.height=o,this.updateProjectionMatrix()},q.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var e=q.Math.radToDeg(2*Math.atan(Math.tan(.5*q.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var t=this.fullWidth/this.fullHeight,n=Math.tan(q.Math.degToRad(.5*e))*this.near,i=-n,r=t*i,o=t*n,a=Math.abs(o-r),s=Math.abs(n-i);this.projectionMatrix.makeFrustum(r+this.x*a/this.fullWidth,r+(this.x+this.width)*a/this.fullWidth,n-(this.y+this.height)*s/this.fullHeight,n-this.y*s/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(e,this.aspect,this.near,this.far)},q.PerspectiveCamera.prototype.clone=function(){var e=new q.PerspectiveCamera;return q.Camera.prototype.clone.call(this,e),e.zoom=this.zoom,e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e.projectionMatrix.copy(this.projectionMatrix),e},q.Light=function(e){q.Object3D.call(this),this.type="Light",this.color=new q.Color(e)},q.Light.prototype=Object.create(q.Object3D.prototype),q.Light.prototype.constructor=q.Light,q.Light.prototype.clone=function(e){return void 0===e&&(e=new q.Light),q.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},q.AmbientLight=function(e){q.Light.call(this,e),this.type="AmbientLight"},q.AmbientLight.prototype=Object.create(q.Light.prototype),q.AmbientLight.prototype.constructor=q.AmbientLight,q.AmbientLight.prototype.clone=function(){var e=new q.AmbientLight;return q.Light.prototype.clone.call(this,e),e},q.AreaLight=function(e,t){q.Light.call(this,e),this.type="AreaLight",this.normal=new q.Vector3(0,-1,0),this.right=new q.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},q.AreaLight.prototype=Object.create(q.Light.prototype),q.AreaLight.prototype.constructor=q.AreaLight,q.DirectionalLight=function(e,t){q.Light.call(this,e),this.type="DirectionalLight",this.position.set(0,1,0),this.target=new q.Object3D,this.intensity=void 0!==t?t:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new q.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},q.DirectionalLight.prototype=Object.create(q.Light.prototype),q.DirectionalLight.prototype.constructor=q.DirectionalLight,q.DirectionalLight.prototype.clone=function(){var e=new q.DirectionalLight;return q.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraLeft=this.shadowCameraLeft,e.shadowCameraRight=this.shadowCameraRight,e.shadowCameraTop=this.shadowCameraTop,e.shadowCameraBottom=this.shadowCameraBottom,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e.shadowCascade=this.shadowCascade,e.shadowCascadeOffset.copy(this.shadowCascadeOffset),e.shadowCascadeCount=this.shadowCascadeCount,e.shadowCascadeBias=this.shadowCascadeBias.slice(0),e.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),e.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),e.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),e.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),e},q.HemisphereLight=function(e,t,n){q.Light.call(this,e),this.type="HemisphereLight",this.position.set(0,100,0),this.groundColor=new q.Color(t),this.intensity=void 0!==n?n:1},q.HemisphereLight.prototype=Object.create(q.Light.prototype),q.HemisphereLight.prototype.constructor=q.HemisphereLight,q.HemisphereLight.prototype.clone=function(){var e=new q.HemisphereLight;return q.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},q.PointLight=function(e,t,n,i){q.Light.call(this,e),this.type="PointLight",this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1},q.PointLight.prototype=Object.create(q.Light.prototype),q.PointLight.prototype.constructor=q.PointLight,q.PointLight.prototype.clone=function(){var e=new q.PointLight;return q.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e.decay=this.decay,e},q.SpotLight=function(e,t,n,i,r,o){q.Light.call(this,e),this.type="SpotLight",this.position.set(0,1,0),this.target=new q.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.exponent=void 0!==r?r:10,this.decay=void 0!==o?o:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},q.SpotLight.prototype=Object.create(q.Light.prototype),q.SpotLight.prototype.constructor=q.SpotLight,q.SpotLight.prototype.clone=function(){var e=new q.SpotLight;return q.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.decay=this.decay,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e.shadowCameraNear=this.shadowCameraNear,e.shadowCameraFar=this.shadowCameraFar,e.shadowCameraFov=this.shadowCameraFov,e.shadowCameraVisible=this.shadowCameraVisible,e.shadowBias=this.shadowBias,e.shadowDarkness=this.shadowDarkness,e.shadowMapWidth=this.shadowMapWidth,e.shadowMapHeight=this.shadowMapHeight,e},q.Cache={files:{},add:function(e,t){this.files[e]=t},get:function(e){return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},q.Loader=function(e){this.showStatus=e,this.statusDomElement=e?q.Loader.prototype.addStatusElement():null,this.imageLoader=new q.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},q.Loader.prototype={constructor:q.Loader,crossOrigin:void 0,addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ";e.total?t+=(100*e.loaded/e.total).toFixed(0)+"%":t+=(e.loaded/1024).toFixed(2)+" KB",this.statusDomElement.innerHTML=t},extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(e,t){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t);return n},needsTangents:function(e){for(var t=0,n=e.length;t<n;t++){if(e[t]instanceof q.ShaderMaterial)return!0}return!1},createMaterial:function(e,t){var n=this;function i(e){var t=Math.log(e)/Math.LN2;return Math.pow(2,Math.round(t))}function r(e,r,o,a,s,l,c){var u,h=t+o,d=q.Loader.Handlers.get(h);if(null!==d?u=d.load(h):(u=new q.Texture,(d=n.imageLoader).crossOrigin=n.crossOrigin,d.load(h,(function(e){if(!1===q.Math.isPowerOfTwo(e.width)||!1===q.Math.isPowerOfTwo(e.height)){var t=i(e.width),n=i(e.height),r=document.createElement("canvas");r.width=t,r.height=n,r.getContext("2d").drawImage(e,0,0,t,n),u.image=r}else u.image=e;u.needsUpdate=!0}))),u.sourceFile=o,a&&(u.repeat.set(a[0],a[1]),1!==a[0]&&(u.wrapS=q.RepeatWrapping),1!==a[1]&&(u.wrapT=q.RepeatWrapping)),s&&u.offset.set(s[0],s[1]),l){var f={repeat:q.RepeatWrapping,mirror:q.MirroredRepeatWrapping};void 0!==f[l[0]]&&(u.wrapS=f[l[0]]),void 0!==f[l[1]]&&(u.wrapT=f[l[1]])}c&&(u.anisotropy=c),e[r]=u}function o(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var a="MeshLambertMaterial",s={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var l=e.shading.toLowerCase();"phong"===l?a="MeshPhongMaterial":"basic"===l&&(a="MeshBasicMaterial")}void 0!==e.blending&&void 0!==q[e.blending]&&(s.blending=q[e.blending]),void 0!==e.transparent&&(s.transparent=e.transparent),void 0!==e.opacity&&e.opacity<1&&(s.transparent=!0),void 0!==e.depthTest&&(s.depthTest=e.depthTest),void 0!==e.depthWrite&&(s.depthWrite=e.depthWrite),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.flipSided&&(s.side=q.BackSide),void 0!==e.doubleSided&&(s.side=q.DoubleSide),void 0!==e.wireframe&&(s.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?s.vertexColors=q.FaceColors:e.vertexColors&&(s.vertexColors=q.VertexColors)),e.colorDiffuse?s.color=o(e.colorDiffuse):e.DbgColor&&(s.color=e.DbgColor),e.colorSpecular&&(s.specular=o(e.colorSpecular)),e.colorEmissive&&(s.emissive=o(e.colorEmissive)),void 0!==e.transparency&&(console.warn("THREE.Loader: transparency has been renamed to opacity"),e.opacity=e.transparency),void 0!==e.opacity&&(s.opacity=e.opacity),e.specularCoef&&(s.shininess=e.specularCoef),e.mapDiffuse&&t&&r(s,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&r(s,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&r(s,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&r(s,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&r(s,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapAlpha&&t&&r(s,"alphaMap",e.mapAlpha,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy),e.mapBumpScale&&(s.bumpScale=e.mapBumpScale),e.mapNormalFactor&&(s.normalScale=new q.Vector2(e.mapNormalFactor,e.mapNormalFactor));var c=new q[a](s);return void 0!==e.DbgName&&(c.name=e.DbgName),c}},q.Loader.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=0,n=this.handlers.length;t<n;t+=2){var i=this.handlers[t],r=this.handlers[t+1];if(i.test(e))return r}return null}},q.XHRLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},q.XHRLoader.prototype={constructor:q.XHRLoader,load:function(e,t,n,i){var r=this,o=q.Cache.get(e);if(void 0===o){var a=new XMLHttpRequest;a.open("GET",e,!0),a.addEventListener("load",(function(n){q.Cache.add(e,this.response),t&&t(this.response),r.manager.itemEnd(e)}),!1),void 0!==n&&a.addEventListener("progress",(function(e){n(e)}),!1),void 0!==i&&a.addEventListener("error",(function(e){i(e)}),!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(a.responseType=this.responseType),a.send(null),r.manager.itemStart(e)}else t&&t(o)},setResponseType:function(e){this.responseType=e},setCrossOrigin:function(e){this.crossOrigin=e}},q.ImageLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},q.ImageLoader.prototype={constructor:q.ImageLoader,load:function(e,t,n,i){var r=this,o=q.Cache.get(e);if(void 0===o){var a=document.createElement("img");return a.addEventListener("load",(function(n){q.Cache.add(e,this),t&&t(this),r.manager.itemEnd(e)}),!1),void 0!==n&&a.addEventListener("progress",(function(e){n(e)}),!1),void 0!==i&&a.addEventListener("error",(function(e){i(e)}),!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),a.src=e,r.manager.itemStart(e),a}t(o)},setCrossOrigin:function(e){this.crossOrigin=e}},q.JSONLoader=function(e){q.Loader.call(this,e),this.withCredentials=!1},q.JSONLoader.prototype=Object.create(q.Loader.prototype),q.JSONLoader.prototype.constructor=q.JSONLoader,q.JSONLoader.prototype.load=function(e,t,n){n=n&&"string"==typeof n?n:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,n)},q.JSONLoader.prototype.loadAjaxJSON=function(e,t,n,i,r){var o=new XMLHttpRequest,a=0;o.onreadystatechange=function(){if(o.readyState===o.DONE)if(200===o.status||0===o.status){if(o.responseText){var s=JSON.parse(o.responseText),l=s.metadata;if(void 0!==l){if("object"===l.type)return void q.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===l.type)return void q.error("THREE.JSONLoader: "+t+" seems to be a Scene. Use THREE.SceneLoader instead.")}var c=e.parse(s,i);n(c.geometry,c.materials)}else q.error("THREE.JSONLoader: "+t+" seems to be unreachable or the file is empty.");e.onLoadComplete()}else q.error("THREE.JSONLoader: Couldn't load "+t+" ("+o.status+")");else o.readyState===o.LOADING?r&&(0===a&&(a=o.getResponseHeader("Content-Length")),r({total:a,loaded:o.responseText.length})):o.readyState===o.HEADERS_RECEIVED&&void 0!==r&&(a=o.getResponseHeader("Content-Length"))},o.open("GET",t,!0),o.withCredentials=this.withCredentials,o.send(null)},q.JSONLoader.prototype.parse=function(e,t){var n=new q.Geometry,i=void 0!==e.scale?1/e.scale:1;if(function(t){function i(e,t){return e&1<<t}var r,o,a,s,l,c,u,h,d,f,p,m,g,v,y,_,b,x,w,A,E,M,T,S,C,P,L,D=e.faces,R=e.vertices,I=e.normals,O=e.colors,N=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)e.uvs[r].length&&N++;for(r=0;r<N;r++)n.faceVertexUvs[r]=[]}s=0,l=R.length;for(;s<l;)(x=new q.Vector3).x=R[s++]*t,x.y=R[s++]*t,x.z=R[s++]*t,n.vertices.push(x);s=0,l=D.length;for(;s<l;)if(f=D[s++],p=i(f,0),m=i(f,1),g=i(f,3),v=i(f,4),y=i(f,5),_=i(f,6),b=i(f,7),p){if((A=new q.Face3).a=D[s],A.b=D[s+1],A.c=D[s+3],(E=new q.Face3).a=D[s+1],E.b=D[s+2],E.c=D[s+3],s+=4,m&&(d=D[s++],A.materialIndex=d,E.materialIndex=d),a=n.faces.length,g)for(r=0;r<N;r++)for(S=e.uvs[r],n.faceVertexUvs[r][a]=[],n.faceVertexUvs[r][a+1]=[],o=0;o<4;o++)h=D[s++],P=S[2*h],L=S[2*h+1],C=new q.Vector2(P,L),2!==o&&n.faceVertexUvs[r][a].push(C),0!==o&&n.faceVertexUvs[r][a+1].push(C);if(v&&(u=3*D[s++],A.normal.set(I[u++],I[u++],I[u]),E.normal.copy(A.normal)),y)for(r=0;r<4;r++)u=3*D[s++],T=new q.Vector3(I[u++],I[u++],I[u]),2!==r&&A.vertexNormals.push(T),0!==r&&E.vertexNormals.push(T);if(_&&(c=D[s++],M=O[c],A.color.setHex(M),E.color.setHex(M)),b)for(r=0;r<4;r++)c=D[s++],M=O[c],2!==r&&A.vertexColors.push(new q.Color(M)),0!==r&&E.vertexColors.push(new q.Color(M));n.faces.push(A),n.faces.push(E)}else{if((w=new q.Face3).a=D[s++],w.b=D[s++],w.c=D[s++],m&&(d=D[s++],w.materialIndex=d),a=n.faces.length,g)for(r=0;r<N;r++)for(S=e.uvs[r],n.faceVertexUvs[r][a]=[],o=0;o<3;o++)h=D[s++],P=S[2*h],L=S[2*h+1],C=new q.Vector2(P,L),n.faceVertexUvs[r][a].push(C);if(v&&(u=3*D[s++],w.normal.set(I[u++],I[u++],I[u])),y)for(r=0;r<3;r++)u=3*D[s++],T=new q.Vector3(I[u++],I[u++],I[u]),w.vertexNormals.push(T);if(_&&(c=D[s++],w.color.setHex(O[c])),b)for(r=0;r<3;r++)c=D[s++],w.vertexColors.push(new q.Color(O[c]));n.faces.push(w)}}(i),function(){var t=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var i=0,r=e.skinWeights.length;i<r;i+=t){var o=e.skinWeights[i],a=t>1?e.skinWeights[i+1]:0,s=t>2?e.skinWeights[i+2]:0,l=t>3?e.skinWeights[i+3]:0;n.skinWeights.push(new q.Vector4(o,a,s,l))}if(e.skinIndices)for(i=0,r=e.skinIndices.length;i<r;i+=t){var c=e.skinIndices[i],u=t>1?e.skinIndices[i+1]:0,h=t>2?e.skinIndices[i+2]:0,d=t>3?e.skinIndices[i+3]:0;n.skinIndices.push(new q.Vector4(c,u,h,d))}n.bones=e.bones,n.bones&&n.bones.length>0&&(n.skinWeights.length!==n.skinIndices.length||n.skinIndices.length!==n.vertices.length)&&q.warn("THREE.JSONLoader: When skinning, number of vertices ("+n.vertices.length+"), skinIndices ("+n.skinIndices.length+"), and skinWeights ("+n.skinWeights.length+") should match.");n.animation=e.animation,n.animations=e.animations}(),function(t){var i,r,o,a,s,l,c,u,h,d,f;if(void 0!==e.morphTargets)for(s=0,l=e.morphTargets.length;s<l;s++)for(n.morphTargets[s]={},n.morphTargets[s].name=e.morphTargets[s].name,n.morphTargets[s].vertices=[],o=n.morphTargets[s].vertices,a=e.morphTargets[s].vertices,i=0,r=a.length;i<r;i+=3){var p=new q.Vector3;p.x=a[i]*t,p.y=a[i+1]*t,p.z=a[i+2]*t,o.push(p)}if(void 0!==e.morphColors)for(s=0,l=e.morphColors.length;s<l;s++)for(n.morphColors[s]={},n.morphColors[s].name=e.morphColors[s].name,n.morphColors[s].colors=[],h=n.morphColors[s].colors,d=e.morphColors[s].colors,c=0,u=d.length;c<u;c+=3)(f=new q.Color(16755200)).setRGB(d[c],d[c+1],d[c+2]),h.push(f)}(i),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials||0===e.materials.length)return{geometry:n};var r=this.initMaterials(e.materials,t);return this.needsTangents(r)&&n.computeTangents(),{geometry:n,materials:r}},q.LoadingManager=function(e,t,n){var i=this,r=0,o=0;this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++},this.itemEnd=function(e){r++,void 0!==i.onProgress&&i.onProgress(e,r,o),r===o&&void 0!==i.onLoad&&i.onLoad()}},q.DefaultLoadingManager=new q.LoadingManager,q.BufferGeometryLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},q.BufferGeometryLoader.prototype={constructor:q.BufferGeometryLoader,load:function(e,t,n,i){var r=this,o=new q.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,(function(e){t(r.parse(JSON.parse(e)))}),n,i)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new q.BufferGeometry,n=e.data.attributes;for(var i in n){var r=n[i],o=new self[r.type](r.array);t.addAttribute(i,new q.BufferAttribute(o,r.itemSize))}var a=e.data.offsets;void 0!==a&&(t.offsets=JSON.parse(JSON.stringify(a)));var s=e.data.boundingSphere;if(void 0!==s){var l=new q.Vector3;void 0!==s.center&&l.fromArray(s.center),t.boundingSphere=new q.Sphere(l,s.radius)}return t}},q.MaterialLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},q.MaterialLoader.prototype={constructor:q.MaterialLoader,load:function(e,t,n,i){var r=this,o=new q.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,(function(e){t(r.parse(JSON.parse(e)))}),n,i)},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e){var t=new q[e.type];if(void 0!==e.color&&t.color.setHex(e.color),void 0!==e.emissive&&t.emissive.setHex(e.emissive),void 0!==e.specular&&t.specular.setHex(e.specular),void 0!==e.shininess&&(t.shininess=e.shininess),void 0!==e.uniforms&&(t.uniforms=e.uniforms),void 0!==e.vertexShader&&(t.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(t.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(t.vertexColors=e.vertexColors),void 0!==e.shading&&(t.shading=e.shading),void 0!==e.blending&&(t.blending=e.blending),void 0!==e.side&&(t.side=e.side),void 0!==e.opacity&&(t.opacity=e.opacity),void 0!==e.transparent&&(t.transparent=e.transparent),void 0!==e.wireframe&&(t.wireframe=e.wireframe),void 0!==e.size&&(t.size=e.size),void 0!==e.sizeAttenuation&&(t.sizeAttenuation=e.sizeAttenuation),void 0!==e.materials)for(var n=0,i=e.materials.length;n<i;n++)t.materials.push(this.parse(e.materials[n]));return t}},q.ObjectLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager,this.texturePath=""},q.ObjectLoader.prototype={constructor:q.ObjectLoader,load:function(e,t,n,i){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var r=this,o=new q.XHRLoader(r.manager);o.setCrossOrigin(this.crossOrigin),o.load(e,(function(e){r.parse(JSON.parse(e),t)}),n,i)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var n=this.parseGeometries(e.geometries),i=this.parseImages(e.images,(function(){void 0!==t&&t(a)})),r=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,r),a=this.parseObject(e.object,n,o);return void 0!==e.images&&0!==e.images.length||void 0!==t&&t(a),a},parseGeometries:function(e){var t={};if(void 0!==e)for(var n=new q.JSONLoader,i=new q.BufferGeometryLoader,r=0,o=e.length;r<o;r++){var a,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new q[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"CubeGeometry":a=new q.BoxGeometry(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":a=new q.CircleGeometry(s.radius,s.segments);break;case"CylinderGeometry":a=new q.CylinderGeometry(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded);break;case"SphereGeometry":a=new q.SphereGeometry(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"IcosahedronGeometry":a=new q.IcosahedronGeometry(s.radius,s.detail);break;case"TorusGeometry":a=new q.TorusGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":a=new q.TorusKnotGeometry(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.p,s.q,s.heightScale);break;case"BufferGeometry":a=i.parse(s);break;case"Geometry":a=n.parse(s.data).geometry}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),t[s.uuid]=a}return t},parseMaterials:function(e,t){var n={};if(void 0!==e)for(var i=function(e){return void 0===t[e]&&q.warn("THREE.ObjectLoader: Undefined texture",e),t[e]},r=new q.MaterialLoader,o=0,a=e.length;o<a;o++){var s=e[o],l=r.parse(s);l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.map&&(l.map=i(s.map)),void 0!==s.bumpMap&&(l.bumpMap=i(s.bumpMap),s.bumpScale&&(l.bumpScale=new q.Vector2(s.bumpScale,s.bumpScale))),void 0!==s.alphaMap&&(l.alphaMap=i(s.alphaMap)),void 0!==s.envMap&&(l.envMap=i(s.envMap)),void 0!==s.normalMap&&(l.normalMap=i(s.normalMap),s.normalScale&&(l.normalScale=new q.Vector2(s.normalScale,s.normalScale))),void 0!==s.lightMap&&(l.lightMap=i(s.lightMap)),void 0!==s.specularMap&&(l.specularMap=i(s.specularMap)),n[s.uuid]=l}return n},parseImages:function(e,t){var n=this,i={};if(void 0!==e&&e.length>0){var r=new q.LoadingManager(t),o=new q.ImageLoader(r);o.setCrossOrigin(this.crossOrigin);for(var a=function(e){return n.manager.itemStart(e),o.load(e,(function(){n.manager.itemEnd(e)}))},s=0,l=e.length;s<l;s++){var c=e[s],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.texturePath+c.url;i[c.uuid]=a(u)}}return i},parseTextures:function(e,t){var n={};if(void 0!==e)for(var i=0,r=e.length;i<r;i++){var o=e[i];void 0===o.image&&q.warn('THREE.ObjectLoader: No "image" speficied for',o.uuid),void 0===t[o.image]&&q.warn("THREE.ObjectLoader: Undefined image",o.image);var a=new q.Texture(t[o.image]);a.needsUpdate=!0,a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.repeat&&(a.repeat=new q.Vector2(o.repeat[0],o.repeat[1])),void 0!==o.minFilter&&(a.minFilter=q[o.minFilter]),void 0!==o.magFilter&&(a.magFilter=q[o.magFilter]),void 0!==o.anisotropy&&(a.anisotropy=o.anisotropy),o.wrap instanceof Array&&(a.wrapS=q[o.wrap[0]],a.wrapT=q[o.wrap[1]]),n[o.uuid]=a}return n},parseObject:function(){var e=new q.Matrix4;return function(t,n,i){var r,o=function(e){return void 0===n[e]&&q.warn("THREE.ObjectLoader: Undefined geometry",e),n[e]},a=function(e){return void 0===i[e]&&q.warn("THREE.ObjectLoader: Undefined material",e),i[e]};switch(t.type){case"Scene":r=new q.Scene;break;case"PerspectiveCamera":r=new q.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":r=new q.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":r=new q.AmbientLight(t.color);break;case"DirectionalLight":r=new q.DirectionalLight(t.color,t.intensity);break;case"PointLight":r=new q.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":r=new q.SpotLight(t.color,t.intensity,t.distance,t.angle,t.exponent,t.decay);break;case"HemisphereLight":r=new q.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":r=new q.Mesh(o(t.geometry),a(t.material));break;case"Line":r=new q.Line(o(t.geometry),a(t.material),t.mode);break;case"PointCloud":r=new q.PointCloud(o(t.geometry),a(t.material));break;case"Sprite":r=new q.Sprite(a(t.material));break;case"Group":r=new q.Group;break;default:r=new q.Object3D}if(r.uuid=t.uuid,void 0!==t.name&&(r.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(r.position,r.quaternion,r.scale)):(void 0!==t.position&&r.position.fromArray(t.position),void 0!==t.rotation&&r.rotation.fromArray(t.rotation),void 0!==t.scale&&r.scale.fromArray(t.scale)),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.children)for(var s in t.children)r.add(this.parseObject(t.children[s],n,i));return r}}()},q.TextureLoader=function(e){this.manager=void 0!==e?e:q.DefaultLoadingManager},q.TextureLoader.prototype={constructor:q.TextureLoader,load:function(e,t,n,i){var r=new q.ImageLoader(this.manager);r.setCrossOrigin(this.crossOrigin),r.load(e,(function(e){var n=new q.Texture(e);n.needsUpdate=!0,void 0!==t&&t(n)}),n,i)},setCrossOrigin:function(e){this.crossOrigin=e}},q.DataTextureLoader=q.BinaryTextureLoader=function(){this._parser=null},q.BinaryTextureLoader.prototype={constructor:q.BinaryTextureLoader,load:function(e,t,n,i){var r=this,o=new q.DataTexture,a=new q.XHRLoader;return a.setResponseType("arraybuffer"),a.load(e,(function(e){var n=r._parser(e);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:q.ClampToEdgeWrapping,o.wrapT=void 0!==n.wrapT?n.wrapT:q.ClampToEdgeWrapping,o.magFilter=void 0!==n.magFilter?n.magFilter:q.LinearFilter,o.minFilter=void 0!==n.minFilter?n.minFilter:q.LinearMipMapLinearFilter,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=q.LinearFilter),o.needsUpdate=!0,t&&t(o,n))}),n,i),o}},q.CompressedTextureLoader=function(){this._parser=null},q.CompressedTextureLoader.prototype={constructor:q.CompressedTextureLoader,load:function(e,t,n){var i=this,r=[],o=new q.CompressedTexture;o.image=r;var a=new q.XHRLoader;if(a.setResponseType("arraybuffer"),e instanceof Array)for(var s=0,l=function(n){a.load(e[n],(function(e){var a=i._parser(e,!0);r[n]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps},6===(s+=1)&&(1==a.mipmapCount&&(o.minFilter=q.LinearFilter),o.format=a.format,o.needsUpdate=!0,t&&t(o))}))},c=0,u=e.length;c<u;++c)l(c);else a.load(e,(function(e){var n=i._parser(e,!0);if(n.isCubemap)for(var a=n.mipmaps.length/n.mipmapCount,s=0;s<a;s++){r[s]={mipmaps:[]};for(var l=0;l<n.mipmapCount;l++)r[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+l]),r[s].format=n.format,r[s].width=n.width,r[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=q.LinearFilter),o.format=n.format,o.needsUpdate=!0,t&&t(o)}));return o}},q.Material=function(){Object.defineProperty(this,"id",{value:q.MaterialIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.type="Material",this.side=q.FrontSide,this.opacity=1,this.transparent=!1,this.blending=q.NormalBlending,this.blendSrc=q.SrcAlphaFactor,this.blendDst=q.OneMinusSrcAlphaFactor,this.blendEquation=q.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},q.Material.prototype={constructor:q.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){!0===e&&this.update(),this._needsUpdate=e},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){if(t in this){var i=this[t];i instanceof q.Color?i.set(n):i instanceof q.Vector3&&n instanceof q.Vector3?i.copy(n):this[t]="overdraw"==t?Number(n):n}}else q.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(){var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type};return""!==this.name&&(e.name=this.name),this instanceof q.MeshBasicMaterial?(e.color=this.color.getHex(),this.vertexColors!==q.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==q.NormalBlending&&(e.blending=this.blending),this.side!==q.FrontSide&&(e.side=this.side)):this instanceof q.MeshLambertMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),this.vertexColors!==q.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==q.SmoothShading&&(e.shading=this.shading),this.blending!==q.NormalBlending&&(e.blending=this.blending),this.side!==q.FrontSide&&(e.side=this.side)):this instanceof q.MeshPhongMaterial?(e.color=this.color.getHex(),e.emissive=this.emissive.getHex(),e.specular=this.specular.getHex(),e.shininess=this.shininess,this.vertexColors!==q.NoColors&&(e.vertexColors=this.vertexColors),this.shading!==q.SmoothShading&&(e.shading=this.shading),this.blending!==q.NormalBlending&&(e.blending=this.blending),this.side!==q.FrontSide&&(e.side=this.side)):this instanceof q.MeshNormalMaterial?(this.blending!==q.NormalBlending&&(e.blending=this.blending),this.side!==q.FrontSide&&(e.side=this.side)):this instanceof q.MeshDepthMaterial?(this.blending!==q.NormalBlending&&(e.blending=this.blending),this.side!==q.FrontSide&&(e.side=this.side)):this instanceof q.PointCloudMaterial?(e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.color=this.color.getHex(),this.vertexColors!==q.NoColors&&(e.vertexColors=this.vertexColors),this.blending!==q.NormalBlending&&(e.blending=this.blending)):this instanceof q.ShaderMaterial?(e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader):this instanceof q.SpriteMaterial&&(e.color=this.color.getHex()),this.opacity<1&&(e.opacity=this.opacity),!1!==this.transparent&&(e.transparent=this.transparent),!1!==this.wireframe&&(e.wireframe=this.wireframe),e},clone:function(e){return void 0===e&&(e=new q.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.blendSrcAlpha=this.blendSrcAlpha,e.blendDstAlpha=this.blendDstAlpha,e.blendEquationAlpha=this.blendEquationAlpha,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},q.EventDispatcher.prototype.apply(q.Material.prototype),q.MaterialIdCount=0,q.LineBasicMaterial=function(e){q.Material.call(this),this.type="LineBasicMaterial",this.color=new q.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=q.NoColors,this.fog=!0,this.setValues(e)},q.LineBasicMaterial.prototype=Object.create(q.Material.prototype),q.LineBasicMaterial.prototype.constructor=q.LineBasicMaterial,q.LineBasicMaterial.prototype.clone=function(){var e=new q.LineBasicMaterial;return q.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},q.LineDashedMaterial=function(e){q.Material.call(this),this.type="LineDashedMaterial",this.color=new q.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},q.LineDashedMaterial.prototype=Object.create(q.Material.prototype),q.LineDashedMaterial.prototype.constructor=q.LineDashedMaterial,q.LineDashedMaterial.prototype.clone=function(){var e=new q.LineDashedMaterial;return q.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},q.MeshBasicMaterial=function(e){q.Material.call(this),this.type="MeshBasicMaterial",this.color=new q.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=q.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=q.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(e)},q.MeshBasicMaterial.prototype=Object.create(q.Material.prototype),q.MeshBasicMaterial.prototype.constructor=q.MeshBasicMaterial,q.MeshBasicMaterial.prototype.clone=function(){var e=new q.MeshBasicMaterial;return q.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},q.MeshLambertMaterial=function(e){q.Material.call(this),this.type="MeshLambertMaterial",this.color=new q.Color(16777215),this.emissive=new q.Color(0),this.wrapAround=!1,this.wrapRGB=new q.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=q.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=q.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},q.MeshLambertMaterial.prototype=Object.create(q.Material.prototype),q.MeshLambertMaterial.prototype.constructor=q.MeshLambertMaterial,q.MeshLambertMaterial.prototype.clone=function(){var e=new q.MeshLambertMaterial;return q.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},q.MeshPhongMaterial=function(e){q.Material.call(this),this.type="MeshPhongMaterial",this.color=new q.Color(16777215),this.emissive=new q.Color(0),this.specular=new q.Color(1118481),this.shininess=30,this.metal=!1,this.wrapAround=!1,this.wrapRGB=new q.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new q.Vector2(1,1),this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=q.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=q.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=q.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)},q.MeshPhongMaterial.prototype=Object.create(q.Material.prototype),q.MeshPhongMaterial.prototype.constructor=q.MeshPhongMaterial,q.MeshPhongMaterial.prototype.clone=function(){var e=new q.MeshPhongMaterial;return q.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.alphaMap=this.alphaMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},q.MeshDepthMaterial=function(e){q.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},q.MeshDepthMaterial.prototype=Object.create(q.Material.prototype),q.MeshDepthMaterial.prototype.constructor=q.MeshDepthMaterial,q.MeshDepthMaterial.prototype.clone=function(){var e=new q.MeshDepthMaterial;return q.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},q.MeshNormalMaterial=function(e){q.Material.call(this,e),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},q.MeshNormalMaterial.prototype=Object.create(q.Material.prototype),q.MeshNormalMaterial.prototype.constructor=q.MeshNormalMaterial,q.MeshNormalMaterial.prototype.clone=function(){var e=new q.MeshNormalMaterial;return q.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},q.MeshFaceMaterial=function(e){this.uuid=q.Math.generateUUID(),this.type="MeshFaceMaterial",this.materials=e instanceof Array?e:[]},q.MeshFaceMaterial.prototype={constructor:q.MeshFaceMaterial,toJSON:function(){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},t=0,n=this.materials.length;t<n;t++)e.materials.push(this.materials[t].toJSON());return e},clone:function(){for(var e=new q.MeshFaceMaterial,t=0;t<this.materials.length;t++)e.materials.push(this.materials[t].clone());return e}},q.PointCloudMaterial=function(e){q.Material.call(this),this.type="PointCloudMaterial",this.color=new q.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=q.NoColors,this.fog=!0,this.setValues(e)},q.PointCloudMaterial.prototype=Object.create(q.Material.prototype),q.PointCloudMaterial.prototype.constructor=q.PointCloudMaterial,q.PointCloudMaterial.prototype.clone=function(){var e=new q.PointCloudMaterial;return q.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},q.ParticleBasicMaterial=function(e){return q.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new q.PointCloudMaterial(e)},q.ParticleSystemMaterial=function(e){return q.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new q.PointCloudMaterial(e)},q.ShaderMaterial=function(e){q.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.attributes=null,this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=q.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=q.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(e)},q.ShaderMaterial.prototype=Object.create(q.Material.prototype),q.ShaderMaterial.prototype.constructor=q.ShaderMaterial,q.ShaderMaterial.prototype.clone=function(){var e=new q.ShaderMaterial;return q.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=q.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},q.RawShaderMaterial=function(e){q.ShaderMaterial.call(this,e),this.type="RawShaderMaterial"},q.RawShaderMaterial.prototype=Object.create(q.ShaderMaterial.prototype),q.RawShaderMaterial.prototype.constructor=q.RawShaderMaterial,q.RawShaderMaterial.prototype.clone=function(){var e=new q.RawShaderMaterial;return q.ShaderMaterial.prototype.clone.call(this,e),e},q.SpriteMaterial=function(e){q.Material.call(this),this.type="SpriteMaterial",this.color=new q.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(e)},q.SpriteMaterial.prototype=Object.create(q.Material.prototype),q.SpriteMaterial.prototype.constructor=q.SpriteMaterial,q.SpriteMaterial.prototype.clone=function(){var e=new q.SpriteMaterial;return q.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.rotation=this.rotation,e.fog=this.fog,e},q.Texture=function(e,t,n,i,r,o,a,s,l){Object.defineProperty(this,"id",{value:q.TextureIdCount++}),this.uuid=q.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:q.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:q.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:q.ClampToEdgeWrapping,this.wrapT=void 0!==i?i:q.ClampToEdgeWrapping,this.magFilter=void 0!==r?r:q.LinearFilter,this.minFilter=void 0!==o?o:q.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:q.RGBAFormat,this.type=void 0!==s?s:q.UnsignedByteType,this.offset=new q.Vector2(0,0),this.repeat=new q.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},q.Texture.DEFAULT_IMAGE=void 0,q.Texture.DEFAULT_MAPPING=q.UVMapping,q.Texture.prototype={constructor:q.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(e){!0===e&&this.update(),this._needsUpdate=e},clone:function(e){return void 0===e&&(e=new q.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},q.EventDispatcher.prototype.apply(q.Texture.prototype),q.TextureIdCount=0,q.CubeTexture=function(e,t,n,i,r,o,a,s,l){t=void 0!==t?t:q.CubeReflectionMapping,q.Texture.call(this,e,t,n,i,r,o,a,s,l),this.images=e},q.CubeTexture.prototype=Object.create(q.Texture.prototype),q.CubeTexture.prototype.constructor=q.CubeTexture,q.CubeTexture.clone=function(e){return void 0===e&&(e=new q.CubeTexture),q.Texture.prototype.clone.call(this,e),e.images=this.images,e},q.CompressedTexture=function(e,t,n,i,r,o,a,s,l,c,u){q.Texture.call(this,null,o,a,s,l,c,i,r,u),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1},q.CompressedTexture.prototype=Object.create(q.Texture.prototype),q.CompressedTexture.prototype.constructor=q.CompressedTexture,q.CompressedTexture.prototype.clone=function(){var e=new q.CompressedTexture;return q.Texture.prototype.clone.call(this,e),e},q.DataTexture=function(e,t,n,i,r,o,a,s,l,c,u){q.Texture.call(this,null,o,a,s,l,c,i,r,u),this.image={data:e,width:t,height:n}},q.DataTexture.prototype=Object.create(q.Texture.prototype),q.DataTexture.prototype.constructor=q.DataTexture,q.DataTexture.prototype.clone=function(){var e=new q.DataTexture;return q.Texture.prototype.clone.call(this,e),e},q.VideoTexture=function(e,t,n,i,r,o,a,s,l){q.Texture.call(this,e,t,n,i,r,o,a,s,l),this.generateMipmaps=!1;var c=this;!function t(){requestAnimationFrame(t),e.readyState===e.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0)}()},q.VideoTexture.prototype=Object.create(q.Texture.prototype),q.VideoTexture.prototype.constructor=q.VideoTexture,q.Group=function(){q.Object3D.call(this),this.type="Group"},q.Group.prototype=Object.create(q.Object3D.prototype),q.Group.prototype.constructor=q.Group,q.PointCloud=function(e,t){q.Object3D.call(this),this.type="PointCloud",this.geometry=void 0!==e?e:new q.Geometry,this.material=void 0!==t?t:new q.PointCloudMaterial({color:16777215*Math.random()})},q.PointCloud.prototype=Object.create(q.Object3D.prototype),q.PointCloud.prototype.constructor=q.PointCloud,q.PointCloud.prototype.raycast=(S=new q.Matrix4,C=new q.Ray,function(e,t){var n=this,i=n.geometry,r=e.params.PointCloud.threshold;if(S.getInverse(this.matrixWorld),C.copy(e.ray).applyMatrix4(S),null===i.boundingBox||!1!==C.isIntersectionBox(i.boundingBox)){var o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=new q.Vector3,s=function(i,r){var a=C.distanceToPoint(i);if(a<o){var s=C.closestPointToPoint(i);s.applyMatrix4(n.matrixWorld);var l=e.ray.origin.distanceTo(s);t.push({distance:l,distanceToRay:a,point:s.clone(),index:r,face:null,object:n})}};if(i instanceof q.BufferGeometry){var l=i.attributes,c=l.position.array;if(void 0!==l.index){var u=l.index.array,h=i.offsets;0===h.length&&(h=[{start:0,count:u.length,index:0}]);for(var d=0,f=h.length;d<f;++d)for(var p=h[d].start,m=h[d].count,g=h[d].index,v=p,y=p+m;v<y;v++){var _=g+u[v];a.fromArray(c,3*_),s(a,_)}}else{var b=c.length/3;for(v=0;v<b;v++)a.set(c[3*v],c[3*v+1],c[3*v+2]),s(a,v)}}else{var x=this.geometry.vertices;for(v=0;v<x.length;v++)s(x[v],v)}}}),q.PointCloud.prototype.clone=function(e){return void 0===e&&(e=new q.PointCloud(this.geometry,this.material)),q.Object3D.prototype.clone.call(this,e),e},q.ParticleSystem=function(e,t){return q.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new q.PointCloud(e,t)},q.Line=function(e,t,n){q.Object3D.call(this),this.type="Line",this.geometry=void 0!==e?e:new q.Geometry,this.material=void 0!==t?t:new q.LineBasicMaterial({color:16777215*Math.random()}),this.mode=void 0!==n?n:q.LineStrip},q.LineStrip=0,q.LinePieces=1,q.Line.prototype=Object.create(q.Object3D.prototype),q.Line.prototype.constructor=q.Line,q.Line.prototype.raycast=function(){var e=new q.Matrix4,t=new q.Ray,n=new q.Sphere;return function(i,r){var o=i.linePrecision,a=o*o,s=this.geometry;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(this.matrixWorld),!1!==i.ray.isIntersectionSphere(n)){e.getInverse(this.matrixWorld),t.copy(i.ray).applyMatrix4(e);var l=new q.Vector3,c=new q.Vector3,u=new q.Vector3,h=new q.Vector3,d=this.mode===q.LineStrip?1:2;if(s instanceof q.BufferGeometry){var f=s.attributes;if(void 0!==f.index){var p=f.index.array,m=f.position.array,g=s.offsets;0===g.length&&(g=[{start:0,count:p.length,index:0}]);for(var v=0;v<g.length;v++)for(var y=g[v].start,_=g[v].count,b=g[v].index,x=y;x<y+_-1;x+=d){var w=b+p[x],A=b+p[x+1];if(l.fromArray(m,3*w),c.fromArray(m,3*A),!(t.distanceSqToSegment(l,c,h,u)>a))(T=t.origin.distanceTo(h))<i.near||T>i.far||r.push({distance:T,point:u.clone().applyMatrix4(this.matrixWorld),index:x,offsetIndex:v,face:null,faceIndex:null,object:this})}}else for(m=f.position.array,x=0;x<m.length/3-1;x+=d){if(l.fromArray(m,3*x),c.fromArray(m,3*x+3),!(t.distanceSqToSegment(l,c,h,u)>a))(T=t.origin.distanceTo(h))<i.near||T>i.far||r.push({distance:T,point:u.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else if(s instanceof q.Geometry){var E=s.vertices,M=E.length;for(x=0;x<M-1;x+=d){var T;if(!(t.distanceSqToSegment(E[x],E[x+1],h,u)>a))(T=t.origin.distanceTo(h))<i.near||T>i.far||r.push({distance:T,point:u.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}}}(),q.Line.prototype.clone=function(e){return void 0===e&&(e=new q.Line(this.geometry,this.material,this.mode)),q.Object3D.prototype.clone.call(this,e),e},q.Mesh=function(e,t){q.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new q.Geometry,this.material=void 0!==t?t:new q.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},q.Mesh.prototype=Object.create(q.Object3D.prototype),q.Mesh.prototype.constructor=q.Mesh,q.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;e<t;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},q.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(q.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},q.Mesh.prototype.raycast=function(){var e=new q.Matrix4,t=new q.Ray,n=new q.Sphere,i=new q.Vector3,r=new q.Vector3,o=new q.Vector3;return function(a,s){var l=this.geometry;if(null===l.boundingSphere&&l.computeBoundingSphere(),n.copy(l.boundingSphere),n.applyMatrix4(this.matrixWorld),!1!==a.ray.isIntersectionSphere(n)&&(e.getInverse(this.matrixWorld),t.copy(a.ray).applyMatrix4(e),null===l.boundingBox||!1!==t.isIntersectionBox(l.boundingBox)))if(l instanceof q.BufferGeometry){if(void 0===(D=this.material))return;var c=l.attributes,u=a.precision;if(void 0!==c.index){var h=c.index.array,d=c.position.array,f=l.offsets;0===f.length&&(f=[{start:0,count:h.length,index:0}]);for(var p=0,m=f.length;p<m;++p)for(var g=f[p].start,v=f[p].count,y=f[p].index,_=g,b=g+v;_<b;_+=3){if(A=y+h[_],E=y+h[_+1],M=y+h[_+2],i.fromArray(d,3*A),r.fromArray(d,3*E),o.fromArray(d,3*M),D.side===q.BackSide)var x=t.intersectTriangle(o,r,i,!0);else x=t.intersectTriangle(i,r,o,D.side!==q.DoubleSide);if(null!==x)x.applyMatrix4(this.matrixWorld),(B=a.ray.origin.distanceTo(x))<u||B<a.near||B>a.far||s.push({distance:B,point:x,face:new q.Face3(A,E,M,q.Triangle.normal(i,r,o)),faceIndex:null,object:this})}}else{_=0;var w=0;for(b=(d=c.position.array).length;_<b;_+=3,w+=9){if(A=_,E=_+1,M=_+2,i.fromArray(d,w),r.fromArray(d,w+3),o.fromArray(d,w+6),D.side===q.BackSide)x=t.intersectTriangle(o,r,i,!0);else x=t.intersectTriangle(i,r,o,D.side!==q.DoubleSide);if(null!==x)x.applyMatrix4(this.matrixWorld),(B=a.ray.origin.distanceTo(x))<u||B<a.near||B>a.far||s.push({distance:B,point:x,face:new q.Face3(A,E,M,q.Triangle.normal(i,r,o)),faceIndex:null,object:this})}}}else if(l instanceof q.Geometry)for(var A,E,M,T=this.material instanceof q.MeshFaceMaterial,S=!0===T?this.material.materials:null,C=(u=a.precision,l.vertices),P=0,L=l.faces.length;P<L;P++){var D,R=l.faces[P];if(void 0!==(D=!0===T?S[R.materialIndex]:this.material)){if(A=C[R.a],E=C[R.b],M=C[R.c],!0===D.morphTargets){var I=l.morphTargets,O=this.morphTargetInfluences;i.set(0,0,0),r.set(0,0,0),o.set(0,0,0);for(var N=0,k=I.length;N<k;N++){var F=O[N];if(0!==F){var V=I[N].vertices;i.x+=(V[R.a].x-A.x)*F,i.y+=(V[R.a].y-A.y)*F,i.z+=(V[R.a].z-A.z)*F,r.x+=(V[R.b].x-E.x)*F,r.y+=(V[R.b].y-E.y)*F,r.z+=(V[R.b].z-E.z)*F,o.x+=(V[R.c].x-M.x)*F,o.y+=(V[R.c].y-M.y)*F,o.z+=(V[R.c].z-M.z)*F}}i.add(A),r.add(E),o.add(M),A=i,E=r,M=o}if(D.side===q.BackSide)x=t.intersectTriangle(M,E,A,!0);else x=t.intersectTriangle(A,E,M,D.side!==q.DoubleSide);var B;if(null!==x)x.applyMatrix4(this.matrixWorld),(B=a.ray.origin.distanceTo(x))<u||B<a.near||B>a.far||s.push({distance:B,point:x,face:R,faceIndex:P,object:this})}}}}(),q.Mesh.prototype.clone=function(e,t){return void 0===e&&(e=new q.Mesh(this.geometry,this.material)),q.Object3D.prototype.clone.call(this,e,t),e},q.Bone=function(e){q.Object3D.call(this),this.type="Bone",this.skin=e},q.Bone.prototype=Object.create(q.Object3D.prototype),q.Bone.prototype.constructor=q.Bone,q.Skeleton=function(e,t,n){var i;(this.useVertexTexture=void 0===n||n,this.identityMatrix=new q.Matrix4,e=e||[],this.bones=e.slice(0),this.useVertexTexture)?(i=this.bones.length>256?64:this.bones.length>64?32:this.bones.length>16?16:8,this.boneTextureWidth=i,this.boneTextureHeight=i,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new q.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,q.RGBAFormat,q.FloatType),this.boneTexture.minFilter=q.NearestFilter,this.boneTexture.magFilter=q.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{q.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var r=0,o=this.bones.length;r<o;r++)this.boneInverses.push(new q.Matrix4)}},q.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new q.Matrix4;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},q.Skeleton.prototype.pose=function(){for(var e,t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},q.Skeleton.prototype.update=(P=new q.Matrix4,function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e]?this.bones[e].matrixWorld:this.identityMatrix;P.multiplyMatrices(n,this.boneInverses[e]),P.flattenToArrayOffset(this.boneMatrices,16*e)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}),q.SkinnedMesh=function(e,t,n){q.Mesh.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new q.Matrix4,this.bindMatrixInverse=new q.Matrix4;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var r,o,a,s,l,c=0,u=this.geometry.bones.length;c<u;++c)a=(o=this.geometry.bones[c]).pos,s=o.rotq,l=o.scl,r=new q.Bone(this),i.push(r),r.name=o.name,r.position.set(a[0],a[1],a[2]),r.quaternion.set(s[0],s[1],s[2],s[3]),void 0!==l?r.scale.set(l[0],l[1],l[2]):r.scale.set(1,1,1);for(c=0,u=this.geometry.bones.length;c<u;++c)-1!==(o=this.geometry.bones[c]).parent?i[o.parent].add(i[c]):this.add(i[c])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new q.Skeleton(i,void 0,n))},q.SkinnedMesh.prototype=Object.create(q.Mesh.prototype),q.SkinnedMesh.prototype.constructor=q.SkinnedMesh,q.SkinnedMesh.prototype.bind=function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},q.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},q.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof q.Geometry)for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],n=1/t.lengthManhattan();n!==1/0?t.multiplyScalar(n):t.set(1)}},q.SkinnedMesh.prototype.updateMatrixWorld=function(e){q.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):q.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},q.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new q.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),q.Mesh.prototype.clone.call(this,e),e},q.MorphAnimMesh=function(e,t){q.Mesh.call(this,e,t),this.type="MorphAnimMesh",this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},q.MorphAnimMesh.prototype=Object.create(q.Mesh.prototype),q.MorphAnimMesh.prototype.constructor=q.MorphAnimMesh,q.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},q.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},q.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},q.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,n=e.animations,i=/([a-z]+)_?(\d+)/,r=0,o=e.morphTargets.length;r<o;r++){var a=e.morphTargets[r].name.match(i);if(a&&a.length>1){var s=a[1];n[s]||(n[s]={start:1/0,end:-1/0});var l=n[s];r<l.start&&(l.start=r),r>l.end&&(l.end=r),t||(t=s)}}e.firstAnimation=t},q.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,n){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:n}},q.MorphAnimMesh.prototype.playAnimation=function(e,t){var n=this.geometry.animations[e];n?(this.setFrameRange(n.start,n.end),this.duration=(n.end-n.start)/t*1e3,this.time=0):q.warn("THREE.MorphAnimMesh: animation["+e+"] undefined in .playAnimation()")},q.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var n=this.startKeyframe+q.Math.clamp(Math.floor(this.time/t),0,this.length-1);n!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[n]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=n);var i=this.time%t/t;this.directionBackwards&&(i=1-i),this.morphTargetInfluences[this.currentKeyframe]=i,this.morphTargetInfluences[this.lastKeyframe]=1-i},q.MorphAnimMesh.prototype.interpolateTargets=function(e,t,n){for(var i=this.morphTargetInfluences,r=0,o=i.length;r<o;r++)i[r]=0;e>-1&&(i[e]=1-n),t>-1&&(i[t]=n)},q.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new q.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,q.Mesh.prototype.clone.call(this,e),e},q.LOD=function(){q.Object3D.call(this),this.objects=[]},q.LOD.prototype=Object.create(q.Object3D.prototype),q.LOD.prototype.constructor=q.LOD,q.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=0;n<this.objects.length&&!(t<this.objects[n].distance);n++);this.objects.splice(n,0,{distance:t,object:e}),this.add(e)},q.LOD.prototype.getObjectForDistance=function(e){for(var t=1,n=this.objects.length;t<n&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},q.LOD.prototype.raycast=(L=new q.Vector3,function(e,t){L.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(L);this.getObjectForDistance(n).raycast(e,t)}),q.LOD.prototype.update=function(){var e=new q.Vector3,t=new q.Vector3;return function(n){if(this.objects.length>1){e.setFromMatrixPosition(n.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);this.objects[0].object.visible=!0;for(var r=1,o=this.objects.length;r<o&&i>=this.objects[r].distance;r++)this.objects[r-1].object.visible=!1,this.objects[r].object.visible=!0;for(;r<o;r++)this.objects[r].object.visible=!1}}}(),q.LOD.prototype.clone=function(e){void 0===e&&(e=new q.LOD),q.Object3D.prototype.clone.call(this,e);for(var t=0,n=this.objects.length;t<n;t++){var i=this.objects[t].object.clone();i.visible=0===t,e.addLevel(i,this.objects[t].distance)}return e},q.Sprite=(D=new Uint16Array([0,1,2,0,2,3]),R=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),I=new Float32Array([0,0,1,0,1,1,0,1]),(O=new q.BufferGeometry).addAttribute("index",new q.BufferAttribute(D,1)),O.addAttribute("position",new q.BufferAttribute(R,3)),O.addAttribute("uv",new q.BufferAttribute(I,2)),function(e){q.Object3D.call(this),this.type="Sprite",this.geometry=O,this.material=void 0!==e?e:new q.SpriteMaterial}),q.Sprite.prototype=Object.create(q.Object3D.prototype),q.Sprite.prototype.constructor=q.Sprite,q.Sprite.prototype.raycast=function(){var e=new q.Vector3;return function(t,n){e.setFromMatrixPosition(this.matrixWorld);var i=t.ray.distanceToPoint(e);i>this.scale.x||n.push({distance:i,point:this.position,face:null,object:this})}}(),q.Sprite.prototype.clone=function(e){return void 0===e&&(e=new q.Sprite(this.material)),q.Object3D.prototype.clone.call(this,e),e},q.Particle=q.Sprite,q.LensFlare=function(e,t,n,i,r){q.Object3D.call(this),this.lensFlares=[],this.positionScreen=new q.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,n,i,r)},q.LensFlare.prototype=Object.create(q.Object3D.prototype),q.LensFlare.prototype.constructor=q.LensFlare,q.LensFlare.prototype.add=function(e,t,n,i,r,o){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=new q.Color(16777215)),void 0===i&&(i=q.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:1,opacity:o,color:r,blending:i})},q.LensFlare.prototype.updateLensFlares=function(){var e,t,n=this.lensFlares.length,i=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(e=0;e<n;e++)(t=this.lensFlares[e]).x=this.positionScreen.x+i*t.distance,t.y=this.positionScreen.y+r*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)},q.Scene=function(){q.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},q.Scene.prototype=Object.create(q.Object3D.prototype),q.Scene.prototype.constructor=q.Scene,q.Scene.prototype.clone=function(e){return void 0===e&&(e=new q.Scene),q.Object3D.prototype.clone.call(this,e),null!==this.fog&&(e.fog=this.fog.clone()),null!==this.overrideMaterial&&(e.overrideMaterial=this.overrideMaterial.clone()),e.autoUpdate=this.autoUpdate,e.matrixAutoUpdate=this.matrixAutoUpdate,e},q.Fog=function(e,t,n){this.name="",this.color=new q.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3},q.Fog.prototype.clone=function(){return new q.Fog(this.color.getHex(),this.near,this.far)},q.FogExp2=function(e,t){this.name="",this.color=new q.Color(e),this.density=void 0!==t?t:25e-5},q.FogExp2.prototype.clone=function(){return new q.FogExp2(this.color.getHex(),this.density)},q.ShaderChunk={},q.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n\tfloat distance = dot( planeNormal, point-pointOnPlane );\n\treturn point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\tif ( decayExponent > 0.0 ) {\n\t  return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n\t}\n\treturn 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n\treturn a;\n#endif\n}\n",q.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",q.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\tfloat dotProduct = dot( transformedNormal, dirVector );\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t#endif\n\n\t#endif\n\n\t#ifdef WRAP_AROUND\n\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n\t\t#endif\n\n\t#endif\n\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n\t#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * attenuation;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * attenuation;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tlVector = normalize( lVector );\n\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n\t\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * attenuation * spotEffect;\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * attenuation * spotEffect;\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n\nvLightFront += ambientLightColor;\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack += ambientLightColor;\n\n#endif\n",q.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n",q.ShaderChunk.default_vertex="#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n\n\tvec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n",q.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif",q.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\t#ifdef USE_MORPHNORMALS\n\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n\t#else\n\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n\t#endif\n\n#endif\n",q.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif",q.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\n#endif",q.ShaderChunk.lights_phong_fragment="#ifndef FLAT_SHADED\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n\t#endif\n\n#else\n\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n\t\t\t\t// specular\n\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\tlVector = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\t// diffuse\n\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n\t\t\t#else\n\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t\t#endif\n\n\t\t\ttotalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n\t\t\t// specular\n\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\ttotalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, dirVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\ttotalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n\t\t// specular\n\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n\t\t/*\n\t\t// fresnel term from skin shader\n\t\tconst float F0 = 0.128;\n\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\n\t\tfloat exponential = pow( base, 5.0 );\n\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\n\t\t*/\n\n\t\t/*\n\t\t// fresnel term from fresnel shader\n\t\tconst float mFresnelBias = 0.08;\n\t\tconst float mFresnelScale = 0.3;\n\t\tconst float mFresnelPower = 5.0;\n\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n\t\t*/\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\ttotalDiffuseLight += hemiColor;\n\n\t\t// specular (sky light)\n\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n\t\t// specular (ground light)\n\n\t\tvec3 lVectorGround = -lVector;\n\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\ttotalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n\t}\n\n#endif\n\n#ifdef METAL\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n",q.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif",q.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tvec3 morphedNormal = vec3( 0.0 );\n\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n\tmorphedNormal += normal;\n\n#endif",q.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif\n",q.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",q.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",q.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n",q.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\tuniform sampler2D lightMap;\n\n#endif",q.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif",q.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif",q.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\n\tdiffuseColor *= texelColor;\n\n#endif",q.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n\tvUv2 = uv2;\n\n#endif",q.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n",q.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",q.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n\tvColor.xyz = inputToLinear( color.xyz );\n\n#endif",q.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n\t#ifdef USE_MORPHTARGETS\n\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n",q.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\n#endif\n",q.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n",q.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif",q.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n",q.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n",q.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",q.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif",q.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif",q.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif",q.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif",q.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n\t\tfogFactor = whiteCompliment( fogFactor );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif",q.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",q.ShaderChunk.defaultnormal_vertex="#ifdef USE_SKINNING\n\n\tvec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n\tvec3 objectNormal = morphedNormal;\n\n#else\n\n\tvec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n",q.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n",q.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",q.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",q.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\toutgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif",q.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",q.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif",q.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\tvec3 morphed = vec3( 0.0 );\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n\tmorphed += position;\n\n#endif",q.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t#else\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t#endif\n\n#endif\n",q.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\t#ifdef SHADOWMAP_DEBUG\n\n\t\tvec3 frustumColors[3];\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n\t#endif\n\n\t#ifdef SHADOWMAP_CASCADE\n\n\t\tint inFrustumCount = 0;\n\n\t#endif\n\n\tfloat fDepth;\n\tvec3 shadowColor = vec3( 1.0 );\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\t\t// don't shadow pixels outside of light frustum\n\t\t\t\t// use just first frustum (for cascades)\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\n\n\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\tinFrustumCount += int( inFrustum );\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n\t\t#else\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t#endif\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t/*\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n\t\t\t\t\t\t// must enroll loop manually\n\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\tshadow += 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tshadow /= 9.0;\n\n\t\t*/\n\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#else\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\n\t\t// spot with multiple shadows is darker\n\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n\t\t// spot with multiple shadows has the same color as single shadow spot\n\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n\t\t\t#endif\n\n\t\t}\n\n\n\t\t#ifdef SHADOWMAP_DEBUG\n\n\t\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t}\n\n\t// NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n\tshadowColor = inputToLinear( shadowColor );\n\n\toutgoingLight = outgoingLight * shadowColor;\n\n#endif\n",q.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#elif defined( USE_MORPHTARGETS )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n#endif\n",q.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n#endif",q.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",q.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t#extension GL_EXT_frag_depth : enable\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif",q.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",q.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",q.UniformsUtils={merge:function(e){for(var t={},n=0;n<e.length;n++){var i=this.clone(e[n]);for(var r in i)t[r]=i[r]}return t},clone:function(e){var t={};for(var n in e)for(var i in t[n]={},e[n]){var r=e[n][i];r instanceof q.Color||r instanceof q.Vector2||r instanceof q.Vector3||r instanceof q.Vector4||r instanceof q.Matrix4||r instanceof q.Texture?t[n][i]=r.clone():r instanceof Array?t[n][i]=r.slice():t[n][i]=r}return t}},q.UniformsLib={common:{diffuse:{type:"c",value:new q.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new q.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new q.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new q.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new q.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new q.Vector4(0,0,1,1)},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new q.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},q.ShaderLib={basic:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.fog,q.UniformsLib.shadowmap]),vertexShader:[q.ShaderChunk.common,q.ShaderChunk.map_pars_vertex,q.ShaderChunk.lightmap_pars_vertex,q.ShaderChunk.envmap_pars_vertex,q.ShaderChunk.color_pars_vertex,q.ShaderChunk.morphtarget_pars_vertex,q.ShaderChunk.skinning_pars_vertex,q.ShaderChunk.shadowmap_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",q.ShaderChunk.map_vertex,q.ShaderChunk.lightmap_vertex,q.ShaderChunk.color_vertex,q.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",q.ShaderChunk.morphnormal_vertex,q.ShaderChunk.skinnormal_vertex,q.ShaderChunk.defaultnormal_vertex,"\t#endif",q.ShaderChunk.morphtarget_vertex,q.ShaderChunk.skinning_vertex,q.ShaderChunk.default_vertex,q.ShaderChunk.logdepthbuf_vertex,q.ShaderChunk.worldpos_vertex,q.ShaderChunk.envmap_vertex,q.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",q.ShaderChunk.common,q.ShaderChunk.color_pars_fragment,q.ShaderChunk.map_pars_fragment,q.ShaderChunk.alphamap_pars_fragment,q.ShaderChunk.lightmap_pars_fragment,q.ShaderChunk.envmap_pars_fragment,q.ShaderChunk.fog_pars_fragment,q.ShaderChunk.shadowmap_pars_fragment,q.ShaderChunk.specularmap_pars_fragment,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",q.ShaderChunk.logdepthbuf_fragment,q.ShaderChunk.map_fragment,q.ShaderChunk.color_fragment,q.ShaderChunk.alphamap_fragment,q.ShaderChunk.alphatest_fragment,q.ShaderChunk.specularmap_fragment,"\toutgoingLight = diffuseColor.rgb;",q.ShaderChunk.lightmap_fragment,q.ShaderChunk.envmap_fragment,q.ShaderChunk.shadowmap_fragment,q.ShaderChunk.linear_to_gamma_fragment,q.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},lambert:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.fog,q.UniformsLib.lights,q.UniformsLib.shadowmap,{emissive:{type:"c",value:new q.Color(0)},wrapRGB:{type:"v3",value:new q.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",q.ShaderChunk.common,q.ShaderChunk.map_pars_vertex,q.ShaderChunk.lightmap_pars_vertex,q.ShaderChunk.envmap_pars_vertex,q.ShaderChunk.lights_lambert_pars_vertex,q.ShaderChunk.color_pars_vertex,q.ShaderChunk.morphtarget_pars_vertex,q.ShaderChunk.skinning_pars_vertex,q.ShaderChunk.shadowmap_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",q.ShaderChunk.map_vertex,q.ShaderChunk.lightmap_vertex,q.ShaderChunk.color_vertex,q.ShaderChunk.morphnormal_vertex,q.ShaderChunk.skinbase_vertex,q.ShaderChunk.skinnormal_vertex,q.ShaderChunk.defaultnormal_vertex,q.ShaderChunk.morphtarget_vertex,q.ShaderChunk.skinning_vertex,q.ShaderChunk.default_vertex,q.ShaderChunk.logdepthbuf_vertex,q.ShaderChunk.worldpos_vertex,q.ShaderChunk.envmap_vertex,q.ShaderChunk.lights_lambert_vertex,q.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform vec3 emissive;","uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","#endif",q.ShaderChunk.common,q.ShaderChunk.color_pars_fragment,q.ShaderChunk.map_pars_fragment,q.ShaderChunk.alphamap_pars_fragment,q.ShaderChunk.lightmap_pars_fragment,q.ShaderChunk.envmap_pars_fragment,q.ShaderChunk.fog_pars_fragment,q.ShaderChunk.shadowmap_pars_fragment,q.ShaderChunk.specularmap_pars_fragment,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",q.ShaderChunk.logdepthbuf_fragment,q.ShaderChunk.map_fragment,q.ShaderChunk.color_fragment,q.ShaderChunk.alphamap_fragment,q.ShaderChunk.alphatest_fragment,q.ShaderChunk.specularmap_fragment,"\t#ifdef DOUBLE_SIDED","\t\tif ( gl_FrontFacing )","\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t\telse","\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;","\t#else","\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;","\t#endif",q.ShaderChunk.lightmap_fragment,q.ShaderChunk.envmap_fragment,q.ShaderChunk.shadowmap_fragment,q.ShaderChunk.linear_to_gamma_fragment,q.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},phong:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.bump,q.UniformsLib.normalmap,q.UniformsLib.fog,q.UniformsLib.lights,q.UniformsLib.shadowmap,{emissive:{type:"c",value:new q.Color(0)},specular:{type:"c",value:new q.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new q.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif",q.ShaderChunk.common,q.ShaderChunk.map_pars_vertex,q.ShaderChunk.lightmap_pars_vertex,q.ShaderChunk.envmap_pars_vertex,q.ShaderChunk.lights_phong_pars_vertex,q.ShaderChunk.color_pars_vertex,q.ShaderChunk.morphtarget_pars_vertex,q.ShaderChunk.skinning_pars_vertex,q.ShaderChunk.shadowmap_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",q.ShaderChunk.map_vertex,q.ShaderChunk.lightmap_vertex,q.ShaderChunk.color_vertex,q.ShaderChunk.morphnormal_vertex,q.ShaderChunk.skinbase_vertex,q.ShaderChunk.skinnormal_vertex,q.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif",q.ShaderChunk.morphtarget_vertex,q.ShaderChunk.skinning_vertex,q.ShaderChunk.default_vertex,q.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = -mvPosition.xyz;",q.ShaderChunk.worldpos_vertex,q.ShaderChunk.envmap_vertex,q.ShaderChunk.lights_phong_vertex,q.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",q.ShaderChunk.common,q.ShaderChunk.color_pars_fragment,q.ShaderChunk.map_pars_fragment,q.ShaderChunk.alphamap_pars_fragment,q.ShaderChunk.lightmap_pars_fragment,q.ShaderChunk.envmap_pars_fragment,q.ShaderChunk.fog_pars_fragment,q.ShaderChunk.lights_phong_pars_fragment,q.ShaderChunk.shadowmap_pars_fragment,q.ShaderChunk.bumpmap_pars_fragment,q.ShaderChunk.normalmap_pars_fragment,q.ShaderChunk.specularmap_pars_fragment,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",q.ShaderChunk.logdepthbuf_fragment,q.ShaderChunk.map_fragment,q.ShaderChunk.color_fragment,q.ShaderChunk.alphamap_fragment,q.ShaderChunk.alphatest_fragment,q.ShaderChunk.specularmap_fragment,q.ShaderChunk.lights_phong_fragment,q.ShaderChunk.lightmap_fragment,q.ShaderChunk.envmap_fragment,q.ShaderChunk.shadowmap_fragment,q.ShaderChunk.linear_to_gamma_fragment,q.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},particle_basic:{uniforms:q.UniformsUtils.merge([q.UniformsLib.particle,q.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",q.ShaderChunk.common,q.ShaderChunk.color_pars_vertex,q.ShaderChunk.shadowmap_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",q.ShaderChunk.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\t#ifdef USE_SIZEATTENUATION","\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );","\t#else","\t\tgl_PointSize = size;","\t#endif","\tgl_Position = projectionMatrix * mvPosition;",q.ShaderChunk.logdepthbuf_vertex,q.ShaderChunk.worldpos_vertex,q.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",q.ShaderChunk.common,q.ShaderChunk.color_pars_fragment,q.ShaderChunk.map_particle_pars_fragment,q.ShaderChunk.fog_pars_fragment,q.ShaderChunk.shadowmap_pars_fragment,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( psColor, opacity );",q.ShaderChunk.logdepthbuf_fragment,q.ShaderChunk.map_particle_fragment,q.ShaderChunk.color_fragment,q.ShaderChunk.alphatest_fragment,"\toutgoingLight = diffuseColor.rgb;",q.ShaderChunk.shadowmap_fragment,q.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},dashed:{uniforms:q.UniformsUtils.merge([q.UniformsLib.common,q.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",q.ShaderChunk.common,q.ShaderChunk.color_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",q.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",q.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",q.ShaderChunk.common,q.ShaderChunk.color_pars_fragment,q.ShaderChunk.fog_pars_fragment,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tif ( mod( vLineDistance, totalSize ) > dashSize ) {","\t\tdiscard;","\t}","\tvec3 outgoingLight = vec3( 0.0 );","\tvec4 diffuseColor = vec4( diffuse, opacity );",q.ShaderChunk.logdepthbuf_fragment,q.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",q.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[q.ShaderChunk.common,q.ShaderChunk.morphtarget_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",q.ShaderChunk.morphtarget_vertex,q.ShaderChunk.default_vertex,q.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",q.ShaderChunk.common,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",q.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );","\tgl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",q.ShaderChunk.common,q.ShaderChunk.morphtarget_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvNormal = normalize( normalMatrix * normal );",q.ShaderChunk.morphtarget_vertex,q.ShaderChunk.default_vertex,q.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",q.ShaderChunk.common,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",q.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",q.ShaderChunk.common,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",q.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",q.ShaderChunk.common,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",q.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",q.ShaderChunk.common,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","\tvWorldPosition = transformDirection( position, modelMatrix );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",q.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","uniform float tFlip;","varying vec3 vWorldPosition;",q.ShaderChunk.common,q.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","vec3 direction = normalize( vWorldPosition );","vec2 sampleUV;","sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );","sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","gl_FragColor = texture2D( tEquirect, sampleUV );",q.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[q.ShaderChunk.common,q.ShaderChunk.morphtarget_pars_vertex,q.ShaderChunk.skinning_pars_vertex,q.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",q.ShaderChunk.skinbase_vertex,q.ShaderChunk.morphtarget_vertex,q.ShaderChunk.skinning_vertex,q.ShaderChunk.default_vertex,q.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[q.ShaderChunk.common,q.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","\tres -= res.xxyz * bit_mask;","\treturn res;","}","void main() {",q.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","\t#else","\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","\t#endif","}"].join("\n")}},q.WebGLRenderer=function(e){console.log("THREE.WebGLRenderer",q.REVISION);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElement("canvas"),n=void 0!==e.context?e.context:null,i=1,r=void 0!==e.precision?e.precision:"highp",o=void 0!==e.alpha&&e.alpha,a=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,l=void 0!==e.antialias&&e.antialias,c=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,h=void 0!==e.logarithmicDepthBuffer&&e.logarithmicDepthBuffer,d=new q.Color(0),f=0,p=[],m={},g=[],v=[],y=[],_=[],b=[];this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapType=q.PCFShadowMap,this.shadowMapCullFace=q.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var x,w=this,A=[],E=null,M=null,T=-1,S="",C=null,P=0,L=0,D=0,R=t.width,I=t.height,O=0,N=0,k=new q.Frustum,F=new q.Matrix4,V=new q.Vector3,B=new q.Vector3,U=!0,z={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};try{var G={alpha:o,depth:a,stencil:s,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u};if(null===(x=n||t.getContext("webgl",G)||t.getContext("experimental-webgl",G)))throw null!==t.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";t.addEventListener("webglcontextlost",(function(e){e.preventDefault(),Y(),X(),m={}}),!1)}catch(e){q.error("THREE.WebGLRenderer: "+e)}var H=new q.WebGLState(x,ot);void 0===x.getShaderPrecisionFormat&&(x.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var W=new q.WebGLExtensions(x);W.get("OES_texture_float"),W.get("OES_texture_float_linear"),W.get("OES_texture_half_float"),W.get("OES_texture_half_float_linear"),W.get("OES_standard_derivatives"),h&&W.get("EXT_frag_depth");var j=function(e,t,n,i){!0===c&&(e*=i,t*=i,n*=i),x.clearColor(e,t,n,i)},X=function(){x.clearColor(0,0,0,1),x.clearDepth(1),x.clearStencil(0),x.enable(x.DEPTH_TEST),x.depthFunc(x.LEQUAL),x.frontFace(x.CCW),x.cullFace(x.BACK),x.enable(x.CULL_FACE),x.enable(x.BLEND),x.blendEquation(x.FUNC_ADD),x.blendFunc(x.SRC_ALPHA,x.ONE_MINUS_SRC_ALPHA),x.viewport(L,D,R,I),j(d.r,d.g,d.b,f)},Y=function(){E=null,C=null,S="",T=-1,U=!0,H.reset()};X(),this.context=x,this.state=H;var K,Z=x.getParameter(x.MAX_TEXTURE_IMAGE_UNITS),Q=x.getParameter(x.MAX_VERTEX_TEXTURE_IMAGE_UNITS),J=x.getParameter(x.MAX_TEXTURE_SIZE),$=x.getParameter(x.MAX_CUBE_MAP_TEXTURE_SIZE),ee=Q>0,te=ee&&W.get("OES_texture_float"),ne=x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.HIGH_FLOAT),ie=x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.MEDIUM_FLOAT),re=x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,x.HIGH_FLOAT),oe=x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,x.MEDIUM_FLOAT),ae=function(){if(void 0!==K)return K;if(K=[],W.get("WEBGL_compressed_texture_pvrtc")||W.get("WEBGL_compressed_texture_s3tc"))for(var e=x.getParameter(x.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)K.push(e[t]);return K},se=ne.precision>0&&re.precision>0,le=ie.precision>0&&oe.precision>0;"highp"!==r||se||(le?(r="mediump",q.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(r="lowp",q.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==r||le||(r="lowp",q.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));var ce,ue=new q.ShadowMapPlugin(this,p,m,g),he=new q.SpritePlugin(this,_),de=new q.LensFlarePlugin(this,b);function fe(e){e.__webglVertexBuffer=x.createBuffer(),e.__webglNormalBuffer=x.createBuffer(),e.__webglTangentBuffer=x.createBuffer(),e.__webglColorBuffer=x.createBuffer(),e.__webglUVBuffer=x.createBuffer(),e.__webglUV2Buffer=x.createBuffer(),e.__webglSkinIndicesBuffer=x.createBuffer(),e.__webglSkinWeightsBuffer=x.createBuffer(),e.__webglFaceBuffer=x.createBuffer(),e.__webglLineBuffer=x.createBuffer();var t=e.numMorphTargets;if(t){e.__webglMorphTargetsBuffers=[];for(var n=0,i=t;n<i;n++)e.__webglMorphTargetsBuffers.push(x.createBuffer())}var r=e.numMorphNormals;if(r){e.__webglMorphNormalsBuffers=[];for(n=0,i=r;n<i;n++)e.__webglMorphNormalsBuffers.push(x.createBuffer())}w.info.memory.geometries++}this.getContext=function(){return x},this.forceContextLoss=function(){W.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return ee},this.supportsFloatTextures=function(){return W.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return W.get("OES_texture_half_float")},this.supportsStandardDerivatives=function(){return W.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return W.get("WEBGL_compressed_texture_s3tc")},this.supportsCompressedTexturePVRTC=function(){return W.get("WEBGL_compressed_texture_pvrtc")},this.supportsBlendMinMax=function(){return W.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){if(void 0!==ce)return ce;var e=W.get("EXT_texture_filter_anisotropic");return ce=null!==e?x.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},this.getPrecision=function(){return r},this.getPixelRatio=function(){return i},this.setPixelRatio=function(e){i=e},this.setSize=function(e,n,r){t.width=e*i,t.height=n*i,!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n)},this.setViewport=function(e,t,n,r){L=e*i,D=t*i,R=n*i,I=r*i,x.viewport(L,D,R,I)},this.setScissor=function(e,t,n,r){x.scissor(e*i,t*i,n*i,r*i)},this.enableScissorTest=function(e){e?x.enable(x.SCISSOR_TEST):x.disable(x.SCISSOR_TEST)},this.getClearColor=function(){return d},this.setClearColor=function(e,t){d.set(e),f=void 0!==t?t:1,j(d.r,d.g,d.b,f)},this.getClearAlpha=function(){return f},this.setClearAlpha=function(e){f=e,j(d.r,d.g,d.b,f)},this.clear=function(e,t,n){var i=0;(void 0===e||e)&&(i|=x.COLOR_BUFFER_BIT),(void 0===t||t)&&(i|=x.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=x.STENCIL_BUFFER_BIT),x.clear(i)},this.clearColor=function(){x.clear(x.COLOR_BUFFER_BIT)},this.clearDepth=function(){x.clear(x.DEPTH_BUFFER_BIT)},this.clearStencil=function(){x.clear(x.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,n,i){this.setRenderTarget(e),this.clear(t,n,i)},this.resetGLState=Y;var pe=function e(t){t.target.traverse((function(t){t.removeEventListener("remove",e),function(e){e instanceof q.Mesh||e instanceof q.PointCloud||e instanceof q.Line?delete m[e.id]:(e instanceof q.ImmediateRenderObject||e.immediateRenderCallback)&&function(e,t){for(var n=e.length-1;n>=0;n--)e[n].object===t&&e.splice(n,1)}(g,e);delete e.__webglInit,delete e._modelViewMatrix,delete e._normalMatrix,delete e.__webglActive}(t)}))},me=function e(t){var n=t.target;n.removeEventListener("dispose",e),be(n)},ge=function e(t){var n=t.target;n.removeEventListener("dispose",e),xe(n),w.info.memory.textures--},ve=function e(t){var n=t.target;n.removeEventListener("dispose",e),we(n),w.info.memory.textures--},ye=function e(t){var n=t.target;n.removeEventListener("dispose",e),Ae(n)},_e=function(e){for(var t=["__webglVertexBuffer","__webglNormalBuffer","__webglTangentBuffer","__webglColorBuffer","__webglUVBuffer","__webglUV2Buffer","__webglSkinIndicesBuffer","__webglSkinWeightsBuffer","__webglFaceBuffer","__webglLineBuffer","__webglLineDistanceBuffer"],n=0,i=t.length;n<i;n++){void 0!==e[r=t[n]]&&(x.deleteBuffer(e[r]),delete e[r])}if(void 0!==e.__webglCustomAttributesList){for(var r in e.__webglCustomAttributesList)x.deleteBuffer(e.__webglCustomAttributesList[r].buffer);delete e.__webglCustomAttributesList}w.info.memory.geometries--},be=function(e){if(delete e.__webglInit,e instanceof q.BufferGeometry){for(var t in e.attributes){var n=e.attributes[t];void 0!==n.buffer&&(x.deleteBuffer(n.buffer),delete n.buffer)}w.info.memory.geometries--}else{var i=ke[e.id];if(void 0!==i){for(var r=0,o=i.length;r<o;r++){var a=i[r];if(void 0!==a.numMorphTargets){for(var s=0,l=a.numMorphTargets;s<l;s++)x.deleteBuffer(a.__webglMorphTargetsBuffers[s]);delete a.__webglMorphTargetsBuffers}if(void 0!==a.numMorphNormals){for(s=0,l=a.numMorphNormals;s<l;s++)x.deleteBuffer(a.__webglMorphNormalsBuffers[s]);delete a.__webglMorphNormalsBuffers}_e(a)}delete ke[e.id]}else _e(e)}S=""},xe=function(e){if(e.image&&e.image.__webglTextureCube)x.deleteTexture(e.image.__webglTextureCube),delete e.image.__webglTextureCube;else{if(void 0===e.__webglInit)return;x.deleteTexture(e.__webglTexture),delete e.__webglTexture,delete e.__webglInit}},we=function(e){if(e&&void 0!==e.__webglTexture){if(x.deleteTexture(e.__webglTexture),delete e.__webglTexture,e instanceof q.WebGLRenderTargetCube)for(var t=0;t<6;t++)x.deleteFramebuffer(e.__webglFramebuffer[t]),x.deleteRenderbuffer(e.__webglRenderbuffer[t]);else x.deleteFramebuffer(e.__webglFramebuffer),x.deleteRenderbuffer(e.__webglRenderbuffer);delete e.__webglFramebuffer,delete e.__webglRenderbuffer}},Ae=function(e){var t=e.program.program;if(void 0!==t){var n,i,r;e.program=void 0;var o=!1;for(n=0,i=A.length;n<i;n++)if((r=A[n]).program===t){r.usedTimes--,0===r.usedTimes&&(o=!0);break}if(!0===o){var a=[];for(n=0,i=A.length;n<i;n++)(r=A[n]).program!==t&&a.push(r);A=a,x.deleteProgram(t),w.info.memory.programs--}}};function Ee(e){var t=e.geometry,n=e.material,i=t.vertices.length;if(n.attributes)for(var r in void 0===t.__webglCustomAttributesList&&(t.__webglCustomAttributesList=[]),n.attributes){var o=n.attributes[r];if(!o.__webglInitialized||o.createUniqueBuffers){o.__webglInitialized=!0;var a=1;"v2"===o.type?a=2:"v3"===o.type?a=3:"v4"===o.type?a=4:"c"===o.type&&(a=3),o.size=a,o.array=new Float32Array(i*a),o.buffer=x.createBuffer(),o.buffer.belongsToAttribute=r,o.needsUpdate=!0}t.__webglCustomAttributesList.push(o)}}function Me(e,t){var n=t.geometry,i=e.faces3,r=3*i.length,o=1*i.length,a=3*i.length,s=Te(t,e);e.__vertexArray=new Float32Array(3*r),e.__normalArray=new Float32Array(3*r),e.__colorArray=new Float32Array(3*r),e.__uvArray=new Float32Array(2*r),n.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*r)),n.hasTangents&&(e.__tangentArray=new Float32Array(4*r)),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*r),e.__skinWeightArray=new Float32Array(4*r));var l=null!==W.get("OES_element_index_uint")&&o>21845?Uint32Array:Uint16Array;e.__typeArray=l,e.__faceArray=new l(3*o),e.__lineArray=new l(2*a);var c=e.numMorphTargets;if(c){e.__morphTargetsArrays=[];for(var u=0,h=c;u<h;u++)e.__morphTargetsArrays.push(new Float32Array(3*r))}var d=e.numMorphNormals;if(d){e.__morphNormalsArrays=[];for(u=0,h=d;u<h;u++)e.__morphNormalsArrays.push(new Float32Array(3*r))}if(e.__webglFaceCount=3*o,e.__webglLineCount=2*a,s.attributes)for(var f in void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]),s.attributes){var p=s.attributes[f],m={};for(var g in p)m[g]=p[g];if(!m.__webglInitialized||m.createUniqueBuffers){m.__webglInitialized=!0;var v=1;"v2"===m.type?v=2:"v3"===m.type?v=3:"v4"===m.type?v=4:"c"===m.type&&(v=3),m.size=v,m.array=new Float32Array(r*v),m.buffer=x.createBuffer(),m.buffer.belongsToAttribute=f,p.needsUpdate=!0,m.__original=p}e.__webglCustomAttributesList.push(m)}e.__inittedArrays=!0}function Te(e,t){return e.material instanceof q.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function Se(e,t,n,i,r){if(e.__inittedArrays){var o,a,s,l,c,u,h,d,f,p,m,g,v,y,_,b,w,A,E,M,T,S,C,P,L,D,R,I,O,N,k,F,V,B,U,z,G,H,W,j,X,Y=function(e){return e instanceof q.MeshPhongMaterial==!1&&e.shading===q.FlatShading}(r),K=0,Z=0,Q=0,J=0,$=0,ee=0,te=0,ne=0,ie=0,re=0,oe=0,ae=0,se=e.__vertexArray,le=e.__uvArray,ce=e.__uv2Array,ue=e.__normalArray,he=e.__tangentArray,de=e.__colorArray,fe=e.__skinIndexArray,pe=e.__skinWeightArray,me=e.__morphTargetsArrays,ge=e.__morphNormalsArrays,ve=e.__webglCustomAttributesList,ye=e.__faceArray,_e=e.__lineArray,be=t.geometry,xe=be.verticesNeedUpdate,we=be.elementsNeedUpdate,Ae=be.uvsNeedUpdate,Ee=be.normalsNeedUpdate,Me=be.tangentsNeedUpdate,Te=be.colorsNeedUpdate,Se=be.morphTargetsNeedUpdate,Ce=be.vertices,Pe=e.faces3,Le=be.faces,De=be.faceVertexUvs[0],Re=be.faceVertexUvs[1],Ie=be.skinIndices,Oe=be.skinWeights,Ne=be.morphTargets,ke=be.morphNormals;if(xe){for(o=0,a=Pe.length;o<a;o++)m=Ce[(s=Le[Pe[o]]).a],g=Ce[s.b],v=Ce[s.c],se[Z]=m.x,se[Z+1]=m.y,se[Z+2]=m.z,se[Z+3]=g.x,se[Z+4]=g.y,se[Z+5]=g.z,se[Z+6]=v.x,se[Z+7]=v.y,se[Z+8]=v.z,Z+=9;x.bindBuffer(x.ARRAY_BUFFER,e.__webglVertexBuffer),x.bufferData(x.ARRAY_BUFFER,se,n)}if(Se)for(B=0,U=Ne.length;B<U;B++){for(oe=0,o=0,a=Pe.length;o<a;o++)s=Le[H=Pe[o]],m=Ne[B].vertices[s.a],g=Ne[B].vertices[s.b],v=Ne[B].vertices[s.c],(z=me[B])[oe]=m.x,z[oe+1]=m.y,z[oe+2]=m.z,z[oe+3]=g.x,z[oe+4]=g.y,z[oe+5]=g.z,z[oe+6]=v.x,z[oe+7]=v.y,z[oe+8]=v.z,r.morphNormals&&(Y?(A=w=ke[B].faceNormals[H],E=w):(w=(W=ke[B].vertexNormals[H]).a,A=W.b,E=W.c),(G=ge[B])[oe]=w.x,G[oe+1]=w.y,G[oe+2]=w.z,G[oe+3]=A.x,G[oe+4]=A.y,G[oe+5]=A.z,G[oe+6]=E.x,G[oe+7]=E.y,G[oe+8]=E.z),oe+=9;x.bindBuffer(x.ARRAY_BUFFER,e.__webglMorphTargetsBuffers[B]),x.bufferData(x.ARRAY_BUFFER,me[B],n),r.morphNormals&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglMorphNormalsBuffers[B]),x.bufferData(x.ARRAY_BUFFER,ge[B],n))}if(Oe.length){for(o=0,a=Pe.length;o<a;o++)C=Oe[(s=Le[Pe[o]]).a],P=Oe[s.b],L=Oe[s.c],pe[re]=C.x,pe[re+1]=C.y,pe[re+2]=C.z,pe[re+3]=C.w,pe[re+4]=P.x,pe[re+5]=P.y,pe[re+6]=P.z,pe[re+7]=P.w,pe[re+8]=L.x,pe[re+9]=L.y,pe[re+10]=L.z,pe[re+11]=L.w,D=Ie[s.a],R=Ie[s.b],I=Ie[s.c],fe[re]=D.x,fe[re+1]=D.y,fe[re+2]=D.z,fe[re+3]=D.w,fe[re+4]=R.x,fe[re+5]=R.y,fe[re+6]=R.z,fe[re+7]=R.w,fe[re+8]=I.x,fe[re+9]=I.y,fe[re+10]=I.z,fe[re+11]=I.w,re+=12;re>0&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglSkinIndicesBuffer),x.bufferData(x.ARRAY_BUFFER,fe,n),x.bindBuffer(x.ARRAY_BUFFER,e.__webglSkinWeightsBuffer),x.bufferData(x.ARRAY_BUFFER,pe,n))}if(Te){for(o=0,a=Pe.length;o<a;o++)u=(s=Le[Pe[o]]).vertexColors,h=s.color,3===u.length&&r.vertexColors===q.VertexColors?(M=u[0],T=u[1],S=u[2]):(M=h,T=h,S=h),de[ie]=M.r,de[ie+1]=M.g,de[ie+2]=M.b,de[ie+3]=T.r,de[ie+4]=T.g,de[ie+5]=T.b,de[ie+6]=S.r,de[ie+7]=S.g,de[ie+8]=S.b,ie+=9;ie>0&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglColorBuffer),x.bufferData(x.ARRAY_BUFFER,de,n))}if(Me&&be.hasTangents){for(o=0,a=Pe.length;o<a;o++)y=(d=(s=Le[Pe[o]]).vertexTangents)[0],_=d[1],b=d[2],he[te]=y.x,he[te+1]=y.y,he[te+2]=y.z,he[te+3]=y.w,he[te+4]=_.x,he[te+5]=_.y,he[te+6]=_.z,he[te+7]=_.w,he[te+8]=b.x,he[te+9]=b.y,he[te+10]=b.z,he[te+11]=b.w,te+=12;x.bindBuffer(x.ARRAY_BUFFER,e.__webglTangentBuffer),x.bufferData(x.ARRAY_BUFFER,he,n)}if(Ee){for(o=0,a=Pe.length;o<a;o++)if(l=(s=Le[Pe[o]]).vertexNormals,c=s.normal,3===l.length&&!1===Y)for(O=0;O<3;O++)k=l[O],ue[ee]=k.x,ue[ee+1]=k.y,ue[ee+2]=k.z,ee+=3;else for(O=0;O<3;O++)ue[ee]=c.x,ue[ee+1]=c.y,ue[ee+2]=c.z,ee+=3;x.bindBuffer(x.ARRAY_BUFFER,e.__webglNormalBuffer),x.bufferData(x.ARRAY_BUFFER,ue,n)}if(Ae&&De){for(o=0,a=Pe.length;o<a;o++)if(void 0!==(f=De[Pe[o]]))for(O=0;O<3;O++)F=f[O],le[Q]=F.x,le[Q+1]=F.y,Q+=2;Q>0&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglUVBuffer),x.bufferData(x.ARRAY_BUFFER,le,n))}if(Ae&&Re){for(o=0,a=Pe.length;o<a;o++)if(void 0!==(p=Re[Pe[o]]))for(O=0;O<3;O++)V=p[O],ce[J]=V.x,ce[J+1]=V.y,J+=2;J>0&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglUV2Buffer),x.bufferData(x.ARRAY_BUFFER,ce,n))}if(we){for(o=0,a=Pe.length;o<a;o++)ye[$]=K,ye[$+1]=K+1,ye[$+2]=K+2,$+=3,_e[ne]=K,_e[ne+1]=K+1,_e[ne+2]=K,_e[ne+3]=K+2,_e[ne+4]=K+1,_e[ne+5]=K+2,ne+=6,K+=3;x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,ye,n),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,_e,n)}if(ve)for(O=0,N=ve.length;O<N;O++)if((X=ve[O]).__original.needsUpdate){if(ae=0,1===X.size){if(void 0===X.boundTo||"vertices"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)s=Le[Pe[o]],X.array[ae]=X.value[s.a],X.array[ae+1]=X.value[s.b],X.array[ae+2]=X.value[s.c],ae+=3;else if("faces"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)j=X.value[Pe[o]],X.array[ae]=j,X.array[ae+1]=j,X.array[ae+2]=j,ae+=3}else if(2===X.size){if(void 0===X.boundTo||"vertices"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)s=Le[Pe[o]],m=X.value[s.a],g=X.value[s.b],v=X.value[s.c],X.array[ae]=m.x,X.array[ae+1]=m.y,X.array[ae+2]=g.x,X.array[ae+3]=g.y,X.array[ae+4]=v.x,X.array[ae+5]=v.y,ae+=6;else if("faces"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)m=j=X.value[Pe[o]],g=j,v=j,X.array[ae]=m.x,X.array[ae+1]=m.y,X.array[ae+2]=g.x,X.array[ae+3]=g.y,X.array[ae+4]=v.x,X.array[ae+5]=v.y,ae+=6}else if(3===X.size){var Fe;if(Fe="c"===X.type?["r","g","b"]:["x","y","z"],void 0===X.boundTo||"vertices"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)s=Le[Pe[o]],m=X.value[s.a],g=X.value[s.b],v=X.value[s.c],X.array[ae]=m[Fe[0]],X.array[ae+1]=m[Fe[1]],X.array[ae+2]=m[Fe[2]],X.array[ae+3]=g[Fe[0]],X.array[ae+4]=g[Fe[1]],X.array[ae+5]=g[Fe[2]],X.array[ae+6]=v[Fe[0]],X.array[ae+7]=v[Fe[1]],X.array[ae+8]=v[Fe[2]],ae+=9;else if("faces"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)m=j=X.value[Pe[o]],g=j,v=j,X.array[ae]=m[Fe[0]],X.array[ae+1]=m[Fe[1]],X.array[ae+2]=m[Fe[2]],X.array[ae+3]=g[Fe[0]],X.array[ae+4]=g[Fe[1]],X.array[ae+5]=g[Fe[2]],X.array[ae+6]=v[Fe[0]],X.array[ae+7]=v[Fe[1]],X.array[ae+8]=v[Fe[2]],ae+=9;else if("faceVertices"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)m=(j=X.value[Pe[o]])[0],g=j[1],v=j[2],X.array[ae]=m[Fe[0]],X.array[ae+1]=m[Fe[1]],X.array[ae+2]=m[Fe[2]],X.array[ae+3]=g[Fe[0]],X.array[ae+4]=g[Fe[1]],X.array[ae+5]=g[Fe[2]],X.array[ae+6]=v[Fe[0]],X.array[ae+7]=v[Fe[1]],X.array[ae+8]=v[Fe[2]],ae+=9}else if(4===X.size)if(void 0===X.boundTo||"vertices"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)s=Le[Pe[o]],m=X.value[s.a],g=X.value[s.b],v=X.value[s.c],X.array[ae]=m.x,X.array[ae+1]=m.y,X.array[ae+2]=m.z,X.array[ae+3]=m.w,X.array[ae+4]=g.x,X.array[ae+5]=g.y,X.array[ae+6]=g.z,X.array[ae+7]=g.w,X.array[ae+8]=v.x,X.array[ae+9]=v.y,X.array[ae+10]=v.z,X.array[ae+11]=v.w,ae+=12;else if("faces"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)m=j=X.value[Pe[o]],g=j,v=j,X.array[ae]=m.x,X.array[ae+1]=m.y,X.array[ae+2]=m.z,X.array[ae+3]=m.w,X.array[ae+4]=g.x,X.array[ae+5]=g.y,X.array[ae+6]=g.z,X.array[ae+7]=g.w,X.array[ae+8]=v.x,X.array[ae+9]=v.y,X.array[ae+10]=v.z,X.array[ae+11]=v.w,ae+=12;else if("faceVertices"===X.boundTo)for(o=0,a=Pe.length;o<a;o++)m=(j=X.value[Pe[o]])[0],g=j[1],v=j[2],X.array[ae]=m.x,X.array[ae+1]=m.y,X.array[ae+2]=m.z,X.array[ae+3]=m.w,X.array[ae+4]=g.x,X.array[ae+5]=g.y,X.array[ae+6]=g.z,X.array[ae+7]=g.w,X.array[ae+8]=v.x,X.array[ae+9]=v.y,X.array[ae+10]=v.z,X.array[ae+11]=v.w,ae+=12;x.bindBuffer(x.ARRAY_BUFFER,X.buffer),x.bufferData(x.ARRAY_BUFFER,X.array,n)}i&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function Ce(e,t,n,i){for(var r=n.attributes,o=t.attributes,a=t.attributesKeys,s=0,l=a.length;s<l;s++){var c=a[s],u=o[c];if(u>=0){var h=r[c];if(void 0!==h){var d=h.itemSize;x.bindBuffer(x.ARRAY_BUFFER,h.buffer),H.enableAttribute(u),x.vertexAttribPointer(u,d,x.FLOAT,!1,0,i*d*4)}else void 0!==e.defaultAttributeValues&&(2===e.defaultAttributeValues[c].length?x.vertexAttrib2fv(u,e.defaultAttributeValues[c]):3===e.defaultAttributeValues[c].length&&x.vertexAttrib3fv(u,e.defaultAttributeValues[c]))}}H.disableUnusedAttributes()}function Pe(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Le(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function De(e,t){return t[0]-e[0]}function Re(e,t,n,i,r){for(var o,a=0,s=e.length;a<s;a++){var l=e[a],c=l.object,u=l.buffer;if(Ze(c,t),r)o=r;else{if(!(o=l.material))continue;je(o)}w.setMaterialFaces(o),u instanceof q.BufferGeometry?w.renderBufferDirect(t,n,i,o,u,c):w.renderBuffer(t,n,i,o,u,c)}}function Ie(e,t,n,i,r,o){for(var a,s=0,l=e.length;s<l;s++){var c=e[s],u=c.object;if(u.visible){if(o)a=o;else{if(!(a=c[t]))continue;je(a)}w.renderImmediateObject(n,i,r,a,u)}}}function Oe(e){var t=e.object.material;t.transparent?(e.transparent=t,e.opaque=null):(e.opaque=t,e.transparent=null)}function Ne(e){var t=e.object,n=e.buffer,i=t.geometry,r=t.material;if(r instanceof q.MeshFaceMaterial){var o=i instanceof q.BufferGeometry?0:n.materialIndex;r=r.materials[o],e.material=r,r.transparent?y.push(e):v.push(e)}else r&&(e.material=r,r.transparent?y.push(e):v.push(e))}this.renderBufferImmediate=function(e,t,n){if(H.initAttributes(),e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=x.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=x.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=x.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=x.createBuffer()),e.hasPositions&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglVertexBuffer),x.bufferData(x.ARRAY_BUFFER,e.positionArray,x.DYNAMIC_DRAW),H.enableAttribute(t.attributes.position),x.vertexAttribPointer(t.attributes.position,3,x.FLOAT,!1,0,0)),e.hasNormals){if(x.bindBuffer(x.ARRAY_BUFFER,e.__webglNormalBuffer),n instanceof q.MeshPhongMaterial==!1&&n.shading===q.FlatShading){var i,r,o,a,s,l,c,u,h,d,f,p=3*e.count;for(f=0;f<p;f+=9)a=(d=e.normalArray)[f],l=d[f+1],u=d[f+2],s=d[f+3],c=d[f+4],h=d[f+5],i=(a+s+d[f+6])/3,r=(l+c+d[f+7])/3,o=(u+h+d[f+8])/3,d[f]=i,d[f+1]=r,d[f+2]=o,d[f+3]=i,d[f+4]=r,d[f+5]=o,d[f+6]=i,d[f+7]=r,d[f+8]=o}x.bufferData(x.ARRAY_BUFFER,e.normalArray,x.DYNAMIC_DRAW),H.enableAttribute(t.attributes.normal),x.vertexAttribPointer(t.attributes.normal,3,x.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglUvBuffer),x.bufferData(x.ARRAY_BUFFER,e.uvArray,x.DYNAMIC_DRAW),H.enableAttribute(t.attributes.uv),x.vertexAttribPointer(t.attributes.uv,2,x.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==q.NoColors&&(x.bindBuffer(x.ARRAY_BUFFER,e.__webglColorBuffer),x.bufferData(x.ARRAY_BUFFER,e.colorArray,x.DYNAMIC_DRAW),H.enableAttribute(t.attributes.color),x.vertexAttribPointer(t.attributes.color,3,x.FLOAT,!1,0,0)),H.disableUnusedAttributes(),x.drawArrays(x.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,o,a){if(!1!==r.visible){Ue(a);var s=Xe(e,t,n,r,a),l=!1,c=r.wireframe?1:0,u="direct_"+o.id+"_"+s.id+"_"+c;if(u!==S&&(S=u,l=!0),l&&H.initAttributes(),a instanceof q.Mesh){var h=!0===r.wireframe?x.LINES:x.TRIANGLES;if(g=o.attributes.index){if(g.array instanceof Uint32Array&&W.get("OES_element_index_uint")?(v=x.UNSIGNED_INT,y=4):(v=x.UNSIGNED_SHORT,y=2),0===(_=o.offsets).length)l&&(Ce(r,s,o,0),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,g.buffer)),x.drawElements(h,g.array.length,v,0),w.info.render.calls++,w.info.render.vertices+=g.array.length,w.info.render.faces+=g.array.length/3;else{l=!0;for(var d=0,f=_.length;d<f;d++){var p=_[d].index;l&&(Ce(r,s,o,p),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,g.buffer)),x.drawElements(h,_[d].count,v,_[d].start*y),w.info.render.calls++,w.info.render.vertices+=_[d].count,w.info.render.faces+=_[d].count/3}}}else{l&&Ce(r,s,o,0);var m=o.attributes.position;x.drawArrays(h,0,m.array.length/m.itemSize),w.info.render.calls++,w.info.render.vertices+=m.array.length/m.itemSize,w.info.render.faces+=m.array.length/(3*m.itemSize)}}else if(a instanceof q.PointCloud){h=x.POINTS;if(g=o.attributes.index){if(g.array instanceof Uint32Array&&W.get("OES_element_index_uint")?(v=x.UNSIGNED_INT,y=4):(v=x.UNSIGNED_SHORT,y=2),0===(_=o.offsets).length)l&&(Ce(r,s,o,0),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,g.buffer)),x.drawElements(h,g.array.length,v,0),w.info.render.calls++,w.info.render.points+=g.array.length;else{_.length>1&&(l=!0);for(d=0,f=_.length;d<f;d++){p=_[d].index;l&&(Ce(r,s,o,p),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,g.buffer)),x.drawElements(h,_[d].count,v,_[d].start*y),w.info.render.calls++,w.info.render.points+=_[d].count}}}else{l&&Ce(r,s,o,0);m=o.attributes.position;if(0===(_=o.offsets).length)x.drawArrays(h,0,m.array.length/3),w.info.render.calls++,w.info.render.points+=m.array.length/3;else for(d=0,f=_.length;d<f;d++)x.drawArrays(h,_[d].index,_[d].count),w.info.render.calls++,w.info.render.points+=_[d].count}}else if(a instanceof q.Line){var g;h=a.mode===q.LineStrip?x.LINE_STRIP:x.LINES;if(H.setLineWidth(r.linewidth*i),g=o.attributes.index){var v,y;if(g.array instanceof Uint32Array?(v=x.UNSIGNED_INT,y=4):(v=x.UNSIGNED_SHORT,y=2),0===(_=o.offsets).length)l&&(Ce(r,s,o,0),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,g.buffer)),x.drawElements(h,g.array.length,v,0),w.info.render.calls++,w.info.render.vertices+=g.array.length;else{_.length>1&&(l=!0);for(d=0,f=_.length;d<f;d++){p=_[d].index;l&&(Ce(r,s,o,p),x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,g.buffer)),x.drawElements(h,_[d].count,v,_[d].start*y),w.info.render.calls++,w.info.render.vertices+=_[d].count}}}else{l&&Ce(r,s,o,0);var _;m=o.attributes.position;if(0===(_=o.offsets).length)x.drawArrays(h,0,m.array.length/3),w.info.render.calls++,w.info.render.vertices+=m.array.length/3;else for(d=0,f=_.length;d<f;d++)x.drawArrays(h,_[d].index,_[d].count),w.info.render.calls++,w.info.render.vertices+=_[d].count}}}},this.renderBuffer=function(e,t,n,r,o,a){if(!1!==r.visible){Ue(a);var s=Xe(e,t,n,r,a),l=s.attributes,c=!1,u=r.wireframe?1:0,h=o.id+"_"+s.id+"_"+u;if(h!==S&&(S=h,c=!0),c&&H.initAttributes(),!r.morphTargets&&l.position>=0?c&&(x.bindBuffer(x.ARRAY_BUFFER,o.__webglVertexBuffer),H.enableAttribute(l.position),x.vertexAttribPointer(l.position,3,x.FLOAT,!1,0,0)):a.morphTargetBase&&function(e,t,n){var i=e.program.attributes;-1!==n.morphTargetBase&&i.position>=0?(x.bindBuffer(x.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[n.morphTargetBase]),H.enableAttribute(i.position),x.vertexAttribPointer(i.position,3,x.FLOAT,!1,0,0)):i.position>=0&&(x.bindBuffer(x.ARRAY_BUFFER,t.__webglVertexBuffer),H.enableAttribute(i.position),x.vertexAttribPointer(i.position,3,x.FLOAT,!1,0,0));if(n.morphTargetForcedOrder.length)for(var r=0,o=n.morphTargetForcedOrder,a=n.morphTargetInfluences;r<e.numSupportedMorphTargets&&r<o.length;)(s=i["morphTarget"+r])>=0&&(x.bindBuffer(x.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[o[r]]),H.enableAttribute(s),x.vertexAttribPointer(s,3,x.FLOAT,!1,0,0)),(s=i["morphNormal"+r])>=0&&e.morphNormals&&(x.bindBuffer(x.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[o[r]]),H.enableAttribute(s),x.vertexAttribPointer(s,3,x.FLOAT,!1,0,0)),n.__webglMorphTargetInfluences[r]=a[o[r]],r++;else{var s,l=[],c=(a=n.morphTargetInfluences,n.geometry.morphTargets);a.length>c.length&&(console.warn("THREE.WebGLRenderer: Influences array is bigger than morphTargets array."),a.length=c.length);for(var u=0,h=a.length;u<h;u++){var d=a[u];l.push([d,u])}l.length>e.numSupportedMorphTargets?(l.sort(De),l.length=e.numSupportedMorphTargets):l.length>e.numSupportedMorphNormals?l.sort(De):0===l.length&&l.push([0,0]);r=0;for(var f=e.numSupportedMorphTargets;r<f;r++)if(l[r]){var p=l[r][1];(s=i["morphTarget"+r])>=0&&(x.bindBuffer(x.ARRAY_BUFFER,t.__webglMorphTargetsBuffers[p]),H.enableAttribute(s),x.vertexAttribPointer(s,3,x.FLOAT,!1,0,0)),(s=i["morphNormal"+r])>=0&&e.morphNormals&&(x.bindBuffer(x.ARRAY_BUFFER,t.__webglMorphNormalsBuffers[p]),H.enableAttribute(s),x.vertexAttribPointer(s,3,x.FLOAT,!1,0,0)),n.__webglMorphTargetInfluences[r]=a[p]}else n.__webglMorphTargetInfluences[r]=0}null!==e.program.uniforms.morphTargetInfluences&&x.uniform1fv(e.program.uniforms.morphTargetInfluences,n.__webglMorphTargetInfluences)}(r,o,a),c){if(o.__webglCustomAttributesList)for(var d=0,f=o.__webglCustomAttributesList.length;d<f;d++){var p=o.__webglCustomAttributesList[d];l[p.buffer.belongsToAttribute]>=0&&(x.bindBuffer(x.ARRAY_BUFFER,p.buffer),H.enableAttribute(l[p.buffer.belongsToAttribute]),x.vertexAttribPointer(l[p.buffer.belongsToAttribute],p.size,x.FLOAT,!1,0,0))}l.color>=0&&(a.geometry.colors.length>0||a.geometry.faces.length>0?(x.bindBuffer(x.ARRAY_BUFFER,o.__webglColorBuffer),H.enableAttribute(l.color),x.vertexAttribPointer(l.color,3,x.FLOAT,!1,0,0)):void 0!==r.defaultAttributeValues&&x.vertexAttrib3fv(l.color,r.defaultAttributeValues.color)),l.normal>=0&&(x.bindBuffer(x.ARRAY_BUFFER,o.__webglNormalBuffer),H.enableAttribute(l.normal),x.vertexAttribPointer(l.normal,3,x.FLOAT,!1,0,0)),l.tangent>=0&&(x.bindBuffer(x.ARRAY_BUFFER,o.__webglTangentBuffer),H.enableAttribute(l.tangent),x.vertexAttribPointer(l.tangent,4,x.FLOAT,!1,0,0)),l.uv>=0&&(a.geometry.faceVertexUvs[0]?(x.bindBuffer(x.ARRAY_BUFFER,o.__webglUVBuffer),H.enableAttribute(l.uv),x.vertexAttribPointer(l.uv,2,x.FLOAT,!1,0,0)):void 0!==r.defaultAttributeValues&&x.vertexAttrib2fv(l.uv,r.defaultAttributeValues.uv)),l.uv2>=0&&(a.geometry.faceVertexUvs[1]?(x.bindBuffer(x.ARRAY_BUFFER,o.__webglUV2Buffer),H.enableAttribute(l.uv2),x.vertexAttribPointer(l.uv2,2,x.FLOAT,!1,0,0)):void 0!==r.defaultAttributeValues&&x.vertexAttrib2fv(l.uv2,r.defaultAttributeValues.uv2)),r.skinning&&l.skinIndex>=0&&l.skinWeight>=0&&(x.bindBuffer(x.ARRAY_BUFFER,o.__webglSkinIndicesBuffer),H.enableAttribute(l.skinIndex),x.vertexAttribPointer(l.skinIndex,4,x.FLOAT,!1,0,0),x.bindBuffer(x.ARRAY_BUFFER,o.__webglSkinWeightsBuffer),H.enableAttribute(l.skinWeight),x.vertexAttribPointer(l.skinWeight,4,x.FLOAT,!1,0,0)),l.lineDistance>=0&&(x.bindBuffer(x.ARRAY_BUFFER,o.__webglLineDistanceBuffer),H.enableAttribute(l.lineDistance),x.vertexAttribPointer(l.lineDistance,1,x.FLOAT,!1,0,0))}if(H.disableUnusedAttributes(),a instanceof q.Mesh){var m=o.__typeArray===Uint32Array?x.UNSIGNED_INT:x.UNSIGNED_SHORT;r.wireframe?(H.setLineWidth(r.wireframeLinewidth*i),c&&x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,o.__webglLineBuffer),x.drawElements(x.LINES,o.__webglLineCount,m,0)):(c&&x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,o.__webglFaceBuffer),x.drawElements(x.TRIANGLES,o.__webglFaceCount,m,0)),w.info.render.calls++,w.info.render.vertices+=o.__webglFaceCount,w.info.render.faces+=o.__webglFaceCount/3}else if(a instanceof q.Line){var g=a.mode===q.LineStrip?x.LINE_STRIP:x.LINES;H.setLineWidth(r.linewidth*i),x.drawArrays(g,0,o.__webglLineCount),w.info.render.calls++}else a instanceof q.PointCloud&&(x.drawArrays(x.POINTS,0,o.__webglParticleCount),w.info.render.calls++,w.info.render.points+=o.__webglParticleCount)}},this.render=function(e,t,n,i){if(t instanceof q.Camera!=!1){var r=e.fog;S="",T=-1,C=null,U=!0,!0===e.autoUpdate&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),e.traverse((function(e){e instanceof q.SkinnedMesh&&e.skeleton.update()})),t.matrixWorldInverse.getInverse(t.matrixWorld),F.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),k.setFromMatrix(F),p.length=0,v.length=0,y.length=0,_.length=0,b.length=0,function e(t){if(!1===t.visible)return;if(t instanceof q.Scene||t instanceof q.Group);else if(function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e._modelViewMatrix=new q.Matrix4,e._normalMatrix=new q.Matrix3,e.addEventListener("removed",pe));var t=e.geometry;void 0===t||void 0===t.__webglInit&&(t.__webglInit=!0,t.addEventListener("dispose",me),t instanceof q.BufferGeometry?w.info.memory.geometries++:e instanceof q.Mesh?Ve(e,t):e instanceof q.Line?void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=x.createBuffer(),e.__webglColorBuffer=x.createBuffer(),e.__webglLineDistanceBuffer=x.createBuffer(),w.info.memory.geometries++}(t),function(e,t){var n=e.vertices.length;e.__vertexArray=new Float32Array(3*n),e.__colorArray=new Float32Array(3*n),e.__lineDistanceArray=new Float32Array(1*n),e.__webglLineCount=n,Ee(t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0,t.lineDistancesNeedUpdate=!0):e instanceof q.PointCloud&&void 0===t.__webglVertexBuffer&&(!function(e){e.__webglVertexBuffer=x.createBuffer(),e.__webglColorBuffer=x.createBuffer(),w.info.memory.geometries++}(t),function(e,t){var n=e.vertices.length;e.__vertexArray=new Float32Array(3*n),e.__colorArray=new Float32Array(3*n),e.__webglParticleCount=n,Ee(t)}(t,e),t.verticesNeedUpdate=!0,t.colorsNeedUpdate=!0));if(void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof q.Mesh){if(t instanceof q.BufferGeometry)Be(m,t,e);else if(t instanceof q.Geometry)for(var n=ke[t.id],i=0,r=n.length;i<r;i++)Be(m,n[i],e)}else e instanceof q.Line||e instanceof q.PointCloud?Be(m,t,e):(e instanceof q.ImmediateRenderObject||e.immediateRenderCallback)&&function(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}(g,e)}(t),t instanceof q.Light)p.push(t);else if(t instanceof q.Sprite)_.push(t);else if(t instanceof q.LensFlare)b.push(t);else{var n=m[t.id];if(n&&(!1===t.frustumCulled||!0===k.intersectsObject(t)))for(var i=0,r=n.length;i<r;i++){var o=n[i];Ne(o),o.render=!0,!0===w.sortObjects&&(V.setFromMatrixPosition(t.matrixWorld),V.applyProjection(F),o.z=V.z)}}for(i=0,r=t.children.length;i<r;i++)e(t.children[i])}(e),!0===w.sortObjects&&(v.sort(Pe),y.sort(Le)),ue.render(e,t),w.info.render.calls=0,w.info.render.vertices=0,w.info.render.faces=0,w.info.render.points=0,this.setRenderTarget(n),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);for(var o=0,a=g.length;o<a;o++){var s=g[o],l=s.object;l.visible&&(Ze(l,t),Oe(s))}if(e.overrideMaterial){var c=e.overrideMaterial;je(c),Re(v,t,p,r,c),Re(y,t,p,r,c),Ie(g,"",t,p,r,c)}else H.setBlending(q.NoBlending),Re(v,t,p,r,null),Ie(g,"opaque",t,p,r,null),Re(y,t,p,r,null),Ie(g,"transparent",t,p,r,null);he.render(e,t),de.render(e,t,O,N),n&&n.generateMipmaps&&n.minFilter!==q.NearestFilter&&n.minFilter!==q.LinearFilter&&function(e){e instanceof q.WebGLRenderTargetCube?(x.bindTexture(x.TEXTURE_CUBE_MAP,e.__webglTexture),x.generateMipmap(x.TEXTURE_CUBE_MAP),x.bindTexture(x.TEXTURE_CUBE_MAP,null)):(x.bindTexture(x.TEXTURE_2D,e.__webglTexture),x.generateMipmap(x.TEXTURE_2D),x.bindTexture(x.TEXTURE_2D,null))}(n),H.setDepthTest(!0),H.setDepthWrite(!0),H.setColorWrite(!0)}else q.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.renderImmediateObject=function(e,t,n,i,r){var o=Xe(e,t,n,i,r);S="",w.setMaterialFaces(i),r.immediateRenderCallback?r.immediateRenderCallback(o,x,k):r.render((function(e){w.renderBufferImmediate(e,o,i)}))};var ke={},Fe=0;function Ve(e,t){var n=e.material,i=!1;void 0!==ke[t.id]&&!0!==t.groupsNeedUpdate||(delete m[e.id],ke[t.id]=function(e,t){for(var n,i,r=W.get("OES_element_index_uint")?4294967296:65535,o={},a=e.morphTargets.length,s=e.morphNormals.length,l={},c=[],u=0,h=e.faces.length;u<h;u++){var d=e.faces[u],f=t?d.materialIndex:0;f in o||(o[f]={hash:f,counter:0}),(n=o[f].hash+"_"+o[f].counter)in l||(i={id:Fe++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[n]=i,c.push(i)),l[n].vertices+3>r&&(o[f].counter+=1,(n=o[f].hash+"_"+o[f].counter)in l||(i={id:Fe++,faces3:[],materialIndex:f,vertices:0,numMorphTargets:a,numMorphNormals:s},l[n]=i,c.push(i))),l[n].faces3.push(u),l[n].vertices+=3}return c}(t,n instanceof q.MeshFaceMaterial),t.groupsNeedUpdate=!1);for(var r=ke[t.id],o=0,a=r.length;o<a;o++){var s=r[o];void 0===s.__webglVertexBuffer?(fe(s),Me(s,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,i=!0):i=!1,(i||void 0===e.__webglActive)&&Be(m,s,e)}e.__webglActive=!0}function Be(e,t,n){var i=n.id;e[i]=e[i]||[],e[i].push({id:i,buffer:t,object:n,material:null,z:0})}function Ue(e){var t=e.geometry;if(t instanceof q.BufferGeometry)for(var n=t.attributes,i=t.attributesKeys,r=0,o=i.length;r<o;r++){var a=i[r],s=n[a],l="index"===a?x.ELEMENT_ARRAY_BUFFER:x.ARRAY_BUFFER;void 0===s.buffer?(s.buffer=x.createBuffer(),x.bindBuffer(l,s.buffer),x.bufferData(l,s.array,s instanceof q.DynamicBufferAttribute?x.DYNAMIC_DRAW:x.STATIC_DRAW),s.needsUpdate=!1):!0===s.needsUpdate&&(x.bindBuffer(l,s.buffer),void 0===s.updateRange||-1===s.updateRange.count?x.bufferSubData(l,0,s.array):0===s.updateRange.count?console.error("THREE.WebGLRenderer.updateObject: using updateRange for THREE.DynamicBufferAttribute and marked as needsUpdate but count is 0, ensure you are using set methods or updating manually."):(x.bufferSubData(l,s.updateRange.offset*s.array.BYTES_PER_ELEMENT,s.array.subarray(s.updateRange.offset,s.updateRange.offset+s.updateRange.count)),s.updateRange.count=0),s.needsUpdate=!1)}else if(e instanceof q.Mesh){!0===t.groupsNeedUpdate&&Ve(e,t);for(var c=ke[t.id],u=(r=0,c.length);r<u;r++){var h=c[r],d=(f=Te(e,h)).attributes&&ze(f);(t.verticesNeedUpdate||t.morphTargetsNeedUpdate||t.elementsNeedUpdate||t.uvsNeedUpdate||t.normalsNeedUpdate||t.colorsNeedUpdate||t.tangentsNeedUpdate||d)&&Se(h,e,x.DYNAMIC_DRAW,!t.dynamic,f)}t.verticesNeedUpdate=!1,t.morphTargetsNeedUpdate=!1,t.elementsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.tangentsNeedUpdate=!1,f.attributes&&Ge(f)}else if(e instanceof q.Line){d=(f=Te(e,t)).attributes&&ze(f);(t.verticesNeedUpdate||t.colorsNeedUpdate||t.lineDistancesNeedUpdate||d)&&function(e,t){var n,i,r,o,a,s,l,c,u,h,d,f,p=e.vertices,m=e.colors,g=e.lineDistances,v=p.length,y=m.length,_=g.length,b=e.__vertexArray,w=e.__colorArray,A=e.__lineDistanceArray,E=e.verticesNeedUpdate,M=e.colorsNeedUpdate,T=e.lineDistancesNeedUpdate,S=e.__webglCustomAttributesList;if(E){for(n=0;n<v;n++)o=p[n],b[a=3*n]=o.x,b[a+1]=o.y,b[a+2]=o.z;x.bindBuffer(x.ARRAY_BUFFER,e.__webglVertexBuffer),x.bufferData(x.ARRAY_BUFFER,b,t)}if(M){for(i=0;i<y;i++)s=m[i],w[a=3*i]=s.r,w[a+1]=s.g,w[a+2]=s.b;x.bindBuffer(x.ARRAY_BUFFER,e.__webglColorBuffer),x.bufferData(x.ARRAY_BUFFER,w,t)}if(T){for(r=0;r<_;r++)A[r]=g[r];x.bindBuffer(x.ARRAY_BUFFER,e.__webglLineDistanceBuffer),x.bufferData(x.ARRAY_BUFFER,A,t)}if(S)for(l=0,c=S.length;l<c;l++)if((f=S[l]).needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo)){if(a=0,h=f.value.length,1===f.size)for(u=0;u<h;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;x.bindBuffer(x.ARRAY_BUFFER,f.buffer),x.bufferData(x.ARRAY_BUFFER,f.array,t),f.needsUpdate=!1}}(t,x.DYNAMIC_DRAW),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,t.lineDistancesNeedUpdate=!1,f.attributes&&Ge(f)}else if(e instanceof q.PointCloud){var f;d=(f=Te(e,t)).attributes&&ze(f);(t.verticesNeedUpdate||t.colorsNeedUpdate||d)&&function(e,t,n){var i,r,o,a,s,l,c,u,h,d,f,p=e.vertices,m=p.length,g=e.colors,v=g.length,y=e.__vertexArray,_=e.__colorArray,b=e.verticesNeedUpdate,w=e.colorsNeedUpdate,A=e.__webglCustomAttributesList;if(b){for(i=0;i<m;i++)o=p[i],y[a=3*i]=o.x,y[a+1]=o.y,y[a+2]=o.z;x.bindBuffer(x.ARRAY_BUFFER,e.__webglVertexBuffer),x.bufferData(x.ARRAY_BUFFER,y,t)}if(w){for(r=0;r<v;r++)s=g[r],_[a=3*r]=s.r,_[a+1]=s.g,_[a+2]=s.b;x.bindBuffer(x.ARRAY_BUFFER,e.__webglColorBuffer),x.bufferData(x.ARRAY_BUFFER,_,t)}if(A)for(l=0,c=A.length;l<c;l++){if((f=A[l]).needsUpdate&&(void 0===f.boundTo||"vertices"===f.boundTo))if(h=f.value.length,a=0,1===f.size)for(u=0;u<h;u++)f.array[u]=f.value[u];else if(2===f.size)for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,a+=2;else if(3===f.size)if("c"===f.type)for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.r,f.array[a+1]=d.g,f.array[a+2]=d.b,a+=3;else for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,a+=3;else if(4===f.size)for(u=0;u<h;u++)d=f.value[u],f.array[a]=d.x,f.array[a+1]=d.y,f.array[a+2]=d.z,f.array[a+3]=d.w,a+=4;x.bindBuffer(x.ARRAY_BUFFER,f.buffer),x.bufferData(x.ARRAY_BUFFER,f.array,t),f.needsUpdate=!1}}(t,x.DYNAMIC_DRAW),t.verticesNeedUpdate=!1,t.colorsNeedUpdate=!1,f.attributes&&Ge(f)}}function ze(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function Ge(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}var He={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};function We(e,t,n,i){e.addEventListener("dispose",ye);var o=He[e.type];if(o){var a=q.ShaderLib[o];e.__webglShader={uniforms:q.UniformsUtils.clone(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}}else e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};var s=function(e){for(var t=0,n=0,i=0,r=0,o=0,a=e.length;o<a;o++){var s=e[o];s.onlyShadow||!1===s.visible||(s instanceof q.DirectionalLight&&t++,s instanceof q.PointLight&&n++,s instanceof q.SpotLight&&i++,s instanceof q.HemisphereLight&&r++)}return{directional:t,point:n,spot:i,hemi:r}}(t),l=function(e){for(var t=0,n=0,i=e.length;n<i;n++){var r=e[n];r.castShadow&&(r instanceof q.SpotLight&&t++,r instanceof q.DirectionalLight&&!r.shadowCascade&&t++)}return t}(t),c=function(e){if(te&&e&&e.skeleton&&e.skeleton.useVertexTexture)return 1024;var t=x.getParameter(x.MAX_VERTEX_UNIFORM_VECTORS),n=Math.floor((t-20)/4);return void 0!==e&&e instanceof q.SkinnedMesh&&(n=Math.min(e.skeleton.bones.length,n))<e.skeleton.bones.length&&q.warn("WebGLRenderer: too many bones - "+e.skeleton.bones.length+", this GPU supports just "+n+" (try OpenGL instead of ANGLE)"),n}(i),u={precision:r,supportsVertexTextures:ee,map:!!e.map,envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,combine:e.combine,vertexColors:e.vertexColors,fog:n,useFog:e.fog,fogExp:n instanceof q.FogExp2,flatShading:e.shading===q.FlatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:h,skinning:e.skinning,maxBones:c,useVertexTexture:te&&i&&i.skeleton&&i.skeleton.useVertexTexture,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:w.maxMorphTargets,maxMorphNormals:w.maxMorphNormals,maxDirLights:s.directional,maxPointLights:s.point,maxSpotLights:s.spot,maxHemiLights:s.hemi,maxShadows:l,shadowMapEnabled:w.shadowMapEnabled&&i.receiveShadow&&l>0,shadowMapType:w.shadowMapType,shadowMapDebug:w.shadowMapDebug,shadowMapCascade:w.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,wrapAround:e.wrapAround,doubleSided:e.side===q.DoubleSide,flipSided:e.side===q.BackSide},d=[];if(o?d.push(o):(d.push(e.fragmentShader),d.push(e.vertexShader)),void 0!==e.defines)for(var f in e.defines)d.push(f),d.push(e.defines[f]);for(var f in u)d.push(f),d.push(u[f]);for(var p,m=d.join(),g=0,v=A.length;g<v;g++){var y=A[g];if(y.code===m){(p=y).usedTimes++;break}}void 0===p&&(p=new q.WebGLProgram(w,m,e,u),A.push(p),w.info.memory.programs=A.length),e.program=p;var _=p.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0;for(var b="morphTarget",E=0;E<w.maxMorphTargets;E++)_[b+E]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;b="morphNormal";for(E=0;E<w.maxMorphNormals;E++)_[b+E]>=0&&e.numSupportedMorphNormals++}for(var M in e.uniformsList=[],e.__webglShader.uniforms){var T=e.program.uniforms[M];T&&e.uniformsList.push([e.__webglShader.uniforms[M],T])}}function je(e){!0===e.transparent?H.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha):H.setBlending(q.NoBlending),H.setDepthTest(e.depthTest),H.setDepthWrite(e.depthWrite),H.setColorWrite(e.colorWrite),H.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function Xe(e,n,i,r,o){P=0,r.needsUpdate&&(r.program&&Ae(r),We(r,n,i,o),r.needsUpdate=!1),r.morphTargets&&(o.__webglMorphTargetInfluences||(o.__webglMorphTargetInfluences=new Float32Array(w.maxMorphTargets)));var a=!1,s=!1,l=!1,c=r.program,u=c.uniforms,d=r.__webglShader.uniforms;if(c.id!==E&&(x.useProgram(c.program),E=c.id,a=!0,s=!0,l=!0),r.id!==T&&(-1===T&&(l=!0),T=r.id,s=!0),(a||e!==C)&&(x.uniformMatrix4fv(u.projectionMatrix,!1,e.projectionMatrix.elements),h&&x.uniform1f(u.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==C&&(C=e),(r instanceof q.ShaderMaterial||r instanceof q.MeshPhongMaterial||r.envMap)&&null!==u.cameraPosition&&(V.setFromMatrixPosition(e.matrixWorld),x.uniform3f(u.cameraPosition,V.x,V.y,V.z)),(r instanceof q.MeshPhongMaterial||r instanceof q.MeshLambertMaterial||r instanceof q.MeshBasicMaterial||r instanceof q.ShaderMaterial||r.skinning)&&null!==u.viewMatrix&&x.uniformMatrix4fv(u.viewMatrix,!1,e.matrixWorldInverse.elements)),r.skinning)if(o.bindMatrix&&null!==u.bindMatrix&&x.uniformMatrix4fv(u.bindMatrix,!1,o.bindMatrix.elements),o.bindMatrixInverse&&null!==u.bindMatrixInverse&&x.uniformMatrix4fv(u.bindMatrixInverse,!1,o.bindMatrixInverse.elements),te&&o.skeleton&&o.skeleton.useVertexTexture){if(null!==u.boneTexture){var f=Ke();x.uniform1i(u.boneTexture,f),w.setTexture(o.skeleton.boneTexture,f)}null!==u.boneTextureWidth&&x.uniform1i(u.boneTextureWidth,o.skeleton.boneTextureWidth),null!==u.boneTextureHeight&&x.uniform1i(u.boneTextureHeight,o.skeleton.boneTextureHeight)}else o.skeleton&&o.skeleton.boneMatrices&&null!==u.boneGlobalMatrices&&x.uniformMatrix4fv(u.boneGlobalMatrices,!1,o.skeleton.boneMatrices);return s&&(i&&r.fog&&function(e,t){e.fogColor.value=t.color,t instanceof q.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof q.FogExp2&&(e.fogDensity.value=t.density)}(d,i),(r instanceof q.MeshPhongMaterial||r instanceof q.MeshLambertMaterial||r.lights)&&(U&&(l=!0,function(e){var t,n,i,r,o,a,s,l,c=0,u=0,h=0,d=z,f=d.directional.colors,p=d.directional.positions,m=d.point.colors,g=d.point.positions,v=d.point.distances,y=d.point.decays,_=d.spot.colors,b=d.spot.positions,x=d.spot.distances,w=d.spot.directions,A=d.spot.anglesCos,E=d.spot.exponents,M=d.spot.decays,T=d.hemi.skyColors,S=d.hemi.groundColors,C=d.hemi.positions,P=0,L=0,D=0,R=0,I=0,O=0,N=0,k=0,F=0,U=0,G=0,H=0;for(t=0,n=e.length;t<n;t++)if(!(i=e[t]).onlyShadow)if(r=i.color,s=i.intensity,l=i.distance,i instanceof q.AmbientLight){if(!i.visible)continue;c+=r.r,u+=r.g,h+=r.b}else if(i instanceof q.DirectionalLight){if(I+=1,!i.visible)continue;B.setFromMatrixPosition(i.matrixWorld),V.setFromMatrixPosition(i.target.matrixWorld),B.sub(V),B.normalize(),p[F=3*P]=B.x,p[F+1]=B.y,p[F+2]=B.z,Qe(f,F,r,s),P+=1}else if(i instanceof q.PointLight){if(O+=1,!i.visible)continue;Qe(m,U=3*L,r,s),V.setFromMatrixPosition(i.matrixWorld),g[U]=V.x,g[U+1]=V.y,g[U+2]=V.z,v[L]=l,y[L]=0===i.distance?0:i.decay,L+=1}else if(i instanceof q.SpotLight){if(N+=1,!i.visible)continue;Qe(_,G=3*D,r,s),B.setFromMatrixPosition(i.matrixWorld),b[G]=B.x,b[G+1]=B.y,b[G+2]=B.z,x[D]=l,V.setFromMatrixPosition(i.target.matrixWorld),B.sub(V),B.normalize(),w[G]=B.x,w[G+1]=B.y,w[G+2]=B.z,A[D]=Math.cos(i.angle),E[D]=i.exponent,M[D]=0===i.distance?0:i.decay,D+=1}else if(i instanceof q.HemisphereLight){if(k+=1,!i.visible)continue;B.setFromMatrixPosition(i.matrixWorld),B.normalize(),C[H=3*R]=B.x,C[H+1]=B.y,C[H+2]=B.z,o=i.color,a=i.groundColor,Qe(T,H,o,s),Qe(S,H,a,s),R+=1}for(t=3*P,n=Math.max(f.length,3*I);t<n;t++)f[t]=0;for(t=3*L,n=Math.max(m.length,3*O);t<n;t++)m[t]=0;for(t=3*D,n=Math.max(_.length,3*N);t<n;t++)_[t]=0;for(t=3*R,n=Math.max(T.length,3*k);t<n;t++)T[t]=0;for(t=3*R,n=Math.max(S.length,3*k);t<n;t++)S[t]=0;d.directional.length=P,d.point.length=L,d.spot.length=D,d.hemi.length=R,d.ambient[0]=c,d.ambient[1]=u,d.ambient[2]=h}(n),U=!1),l?(!function(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.pointLightDecay.value=t.point.decays,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.spotLightDecay.value=t.spot.decays,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}(d,z),Ye(d,!0)):Ye(d,!1)),(r instanceof q.MeshBasicMaterial||r instanceof q.MeshLambertMaterial||r instanceof q.MeshPhongMaterial)&&function(e,t){e.opacity.value=t.opacity,e.diffuse.value=t.color,e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));var n;t.map?n=t.map:t.specularMap?n=t.specularMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.alphaMap&&(n=t.alphaMap);if(void 0!==n){var i=n.offset,r=n.repeat;e.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap instanceof q.WebGLRenderTargetCube?1:-1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}(d,r),r instanceof q.LineBasicMaterial?qe(d,r):r instanceof q.LineDashedMaterial?(qe(d,r),function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(d,r)):r instanceof q.PointCloudMaterial?function(e,n){if(e.psColor.value=n.color,e.opacity.value=n.opacity,e.size.value=n.size,e.scale.value=t.height/2,e.map.value=n.map,null!==n.map){var i=n.map.offset,r=n.map.repeat;e.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}}(d,r):r instanceof q.MeshPhongMaterial?function(e,t){e.shininess.value=t.shininess,e.emissive.value=t.emissive,e.specular.value=t.specular,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}(d,r):r instanceof q.MeshLambertMaterial?function(e,t){e.emissive.value=t.emissive,t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}(d,r):r instanceof q.MeshDepthMaterial?(d.mNear.value=e.near,d.mFar.value=e.far,d.opacity.value=r.opacity):r instanceof q.MeshNormalMaterial&&(d.opacity.value=r.opacity),o.receiveShadow&&!r._shadowPass&&function(e,t){if(e.shadowMatrix)for(var n=0,i=0,r=t.length;i<r;i++){var o=t[i];o.castShadow&&((o instanceof q.SpotLight||o instanceof q.DirectionalLight&&!o.shadowCascade)&&(e.shadowMap.value[n]=o.shadowMap,e.shadowMapSize.value[n]=o.shadowMapSize,e.shadowMatrix.value[n]=o.shadowMatrix,e.shadowDarkness.value[n]=o.shadowDarkness,e.shadowBias.value[n]=o.shadowBias,n++))}}(d,n),function(e){for(var t,n,i,r=0,o=e.length;r<o;r++){var a=e[r][0];if(!1!==a.needsUpdate){var s=a.type,l=a.value,c=e[r][1];switch(s){case"1i":x.uniform1i(c,l);break;case"1f":x.uniform1f(c,l);break;case"2f":x.uniform2f(c,l[0],l[1]);break;case"3f":x.uniform3f(c,l[0],l[1],l[2]);break;case"4f":x.uniform4f(c,l[0],l[1],l[2],l[3]);break;case"1iv":x.uniform1iv(c,l);break;case"3iv":x.uniform3iv(c,l);break;case"1fv":x.uniform1fv(c,l);break;case"2fv":x.uniform2fv(c,l);break;case"3fv":x.uniform3fv(c,l);break;case"4fv":x.uniform4fv(c,l);break;case"Matrix3fv":x.uniformMatrix3fv(c,!1,l);break;case"Matrix4fv":x.uniformMatrix4fv(c,!1,l);break;case"i":x.uniform1i(c,l);break;case"f":x.uniform1f(c,l);break;case"v2":x.uniform2f(c,l.x,l.y);break;case"v3":x.uniform3f(c,l.x,l.y,l.z);break;case"v4":x.uniform4f(c,l.x,l.y,l.z,l.w);break;case"c":x.uniform3f(c,l.r,l.g,l.b);break;case"iv1":x.uniform1iv(c,l);break;case"iv":x.uniform3iv(c,l);break;case"fv1":x.uniform1fv(c,l);break;case"fv":x.uniform3fv(c,l);break;case"v2v":void 0===a._array&&(a._array=new Float32Array(2*l.length));for(var u=0,h=l.length;u<h;u++)i=2*u,a._array[i]=l[u].x,a._array[i+1]=l[u].y;x.uniform2fv(c,a._array);break;case"v3v":void 0===a._array&&(a._array=new Float32Array(3*l.length));for(u=0,h=l.length;u<h;u++)i=3*u,a._array[i]=l[u].x,a._array[i+1]=l[u].y,a._array[i+2]=l[u].z;x.uniform3fv(c,a._array);break;case"v4v":void 0===a._array&&(a._array=new Float32Array(4*l.length));for(u=0,h=l.length;u<h;u++)i=4*u,a._array[i]=l[u].x,a._array[i+1]=l[u].y,a._array[i+2]=l[u].z,a._array[i+3]=l[u].w;x.uniform4fv(c,a._array);break;case"m3":x.uniformMatrix3fv(c,!1,l.elements);break;case"m3v":void 0===a._array&&(a._array=new Float32Array(9*l.length));for(u=0,h=l.length;u<h;u++)l[u].flattenToArrayOffset(a._array,9*u);x.uniformMatrix3fv(c,!1,a._array);break;case"m4":x.uniformMatrix4fv(c,!1,l.elements);break;case"m4v":void 0===a._array&&(a._array=new Float32Array(16*l.length));for(u=0,h=l.length;u<h;u++)l[u].flattenToArrayOffset(a._array,16*u);x.uniformMatrix4fv(c,!1,a._array);break;case"t":if(t=l,n=Ke(),x.uniform1i(c,n),!t)continue;t instanceof q.CubeTexture||t.image instanceof Array&&6===t.image.length?et(t,n):t instanceof q.WebGLRenderTargetCube?tt(t,n):w.setTexture(t,n);break;case"tv":void 0===a._array&&(a._array=[]);for(u=0,h=a.value.length;u<h;u++)a._array[u]=Ke();x.uniform1iv(c,a._array);for(u=0,h=a.value.length;u<h;u++)t=a.value[u],n=a._array[u],t&&w.setTexture(t,n);break;default:q.warn("THREE.WebGLRenderer: Unknown uniform type: "+s)}}}}(r.uniformsList)),function(e,t){x.uniformMatrix4fv(e.modelViewMatrix,!1,t._modelViewMatrix.elements),e.normalMatrix&&x.uniformMatrix3fv(e.normalMatrix,!1,t._normalMatrix.elements)}(u,o),null!==u.modelMatrix&&x.uniformMatrix4fv(u.modelMatrix,!1,o.matrixWorld.elements),c}function qe(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function Ye(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.pointLightDecay.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.spotLightDecay.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function Ke(){var e=P;return e>=Z&&q.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Z),P+=1,e}function Ze(e,t){e._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e._normalMatrix.getNormalMatrix(e._modelViewMatrix)}function Qe(e,t,n,i){e[t]=n.r*i,e[t+1]=n.g*i,e[t+2]=n.b*i}function Je(e,t,n){var i;n?(x.texParameteri(e,x.TEXTURE_WRAP_S,ot(t.wrapS)),x.texParameteri(e,x.TEXTURE_WRAP_T,ot(t.wrapT)),x.texParameteri(e,x.TEXTURE_MAG_FILTER,ot(t.magFilter)),x.texParameteri(e,x.TEXTURE_MIN_FILTER,ot(t.minFilter))):(x.texParameteri(e,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(e,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),t.wrapS===q.ClampToEdgeWrapping&&t.wrapT===q.ClampToEdgeWrapping||q.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),x.texParameteri(e,x.TEXTURE_MAG_FILTER,rt(t.magFilter)),x.texParameteri(e,x.TEXTURE_MIN_FILTER,rt(t.minFilter)),t.minFilter!==q.NearestFilter&&t.minFilter!==q.LinearFilter&&q.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),(i=W.get("EXT_texture_filter_anisotropic"))&&t.type!==q.FloatType&&t.type!==q.HalfFloatType&&(t.anisotropy>1||t.__currentAnisotropy)&&(x.texParameterf(e,i.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,w.getMaxAnisotropy())),t.__currentAnisotropy=t.anisotropy)}function $e(e,t){if(e.width>t||e.height>t){var n=t/Math.max(e.width,e.height),i=document.createElement("canvas");return i.width=Math.floor(e.width*n),i.height=Math.floor(e.height*n),i.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),q.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+i.width+"x"+i.height,e),i}return e}function et(e,t){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.addEventListener("dispose",ge),e.image.__webglTextureCube=x.createTexture(),w.info.memory.textures++),x.activeTexture(x.TEXTURE0+t),x.bindTexture(x.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var n=e instanceof q.CompressedTexture,i=e.image[0]instanceof q.DataTexture,r=[],o=0;o<6;o++)!w.autoScaleCubemaps||n||i?r[o]=i?e.image[o].image:e.image[o]:r[o]=$e(e.image[o],$);var a=r[0],s=q.Math.isPowerOfTwo(a.width)&&q.Math.isPowerOfTwo(a.height),l=ot(e.format),c=ot(e.type);Je(x.TEXTURE_CUBE_MAP,e,s);for(o=0;o<6;o++)if(n)for(var u,h=r[o].mipmaps,d=0,f=h.length;d<f;d++)u=h[d],e.format!==q.RGBAFormat&&e.format!==q.RGBFormat?ae().indexOf(l)>-1?x.compressedTexImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+o,d,l,u.width,u.height,0,u.data):q.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+o,d,l,u.width,u.height,0,l,c,u.data);else i?x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,l,r[o].width,r[o].height,0,l,c,r[o].data):x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,l,l,c,r[o]);e.generateMipmaps&&s&&x.generateMipmap(x.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else x.activeTexture(x.TEXTURE0+t),x.bindTexture(x.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function tt(e,t){x.activeTexture(x.TEXTURE0+t),x.bindTexture(x.TEXTURE_CUBE_MAP,e.__webglTexture)}function nt(e,t,n){x.bindFramebuffer(x.FRAMEBUFFER,e),x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,n,t.__webglTexture,0)}function it(e,t){x.bindRenderbuffer(x.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(x.renderbufferStorage(x.RENDERBUFFER,x.DEPTH_COMPONENT16,t.width,t.height),x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(x.renderbufferStorage(x.RENDERBUFFER,x.DEPTH_STENCIL,t.width,t.height),x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_STENCIL_ATTACHMENT,x.RENDERBUFFER,e)):x.renderbufferStorage(x.RENDERBUFFER,x.RGBA4,t.width,t.height)}function rt(e){return e===q.NearestFilter||e===q.NearestMipMapNearestFilter||e===q.NearestMipMapLinearFilter?x.NEAREST:x.LINEAR}function ot(e){var t;if(e===q.RepeatWrapping)return x.REPEAT;if(e===q.ClampToEdgeWrapping)return x.CLAMP_TO_EDGE;if(e===q.MirroredRepeatWrapping)return x.MIRRORED_REPEAT;if(e===q.NearestFilter)return x.NEAREST;if(e===q.NearestMipMapNearestFilter)return x.NEAREST_MIPMAP_NEAREST;if(e===q.NearestMipMapLinearFilter)return x.NEAREST_MIPMAP_LINEAR;if(e===q.LinearFilter)return x.LINEAR;if(e===q.LinearMipMapNearestFilter)return x.LINEAR_MIPMAP_NEAREST;if(e===q.LinearMipMapLinearFilter)return x.LINEAR_MIPMAP_LINEAR;if(e===q.UnsignedByteType)return x.UNSIGNED_BYTE;if(e===q.UnsignedShort4444Type)return x.UNSIGNED_SHORT_4_4_4_4;if(e===q.UnsignedShort5551Type)return x.UNSIGNED_SHORT_5_5_5_1;if(e===q.UnsignedShort565Type)return x.UNSIGNED_SHORT_5_6_5;if(e===q.ByteType)return x.BYTE;if(e===q.ShortType)return x.SHORT;if(e===q.UnsignedShortType)return x.UNSIGNED_SHORT;if(e===q.IntType)return x.INT;if(e===q.UnsignedIntType)return x.UNSIGNED_INT;if(e===q.FloatType)return x.FLOAT;if(null!==(t=W.get("OES_texture_half_float"))&&e===q.HalfFloatType)return t.HALF_FLOAT_OES;if(e===q.AlphaFormat)return x.ALPHA;if(e===q.RGBFormat)return x.RGB;if(e===q.RGBAFormat)return x.RGBA;if(e===q.LuminanceFormat)return x.LUMINANCE;if(e===q.LuminanceAlphaFormat)return x.LUMINANCE_ALPHA;if(e===q.AddEquation)return x.FUNC_ADD;if(e===q.SubtractEquation)return x.FUNC_SUBTRACT;if(e===q.ReverseSubtractEquation)return x.FUNC_REVERSE_SUBTRACT;if(e===q.ZeroFactor)return x.ZERO;if(e===q.OneFactor)return x.ONE;if(e===q.SrcColorFactor)return x.SRC_COLOR;if(e===q.OneMinusSrcColorFactor)return x.ONE_MINUS_SRC_COLOR;if(e===q.SrcAlphaFactor)return x.SRC_ALPHA;if(e===q.OneMinusSrcAlphaFactor)return x.ONE_MINUS_SRC_ALPHA;if(e===q.DstAlphaFactor)return x.DST_ALPHA;if(e===q.OneMinusDstAlphaFactor)return x.ONE_MINUS_DST_ALPHA;if(e===q.DstColorFactor)return x.DST_COLOR;if(e===q.OneMinusDstColorFactor)return x.ONE_MINUS_DST_COLOR;if(e===q.SrcAlphaSaturateFactor)return x.SRC_ALPHA_SATURATE;if(null!==(t=W.get("WEBGL_compressed_texture_s3tc"))){if(e===q.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===q.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===q.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===q.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(t=W.get("WEBGL_compressed_texture_pvrtc"))){if(e===q.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===q.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===q.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===q.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(t=W.get("EXT_blend_minmax"))){if(e===q.MinEquation)return t.MIN_EXT;if(e===q.MaxEquation)return t.MAX_EXT}return 0}this.setFaceCulling=function(e,t){e===q.CullFaceNone?x.disable(x.CULL_FACE):(t===q.FrontFaceDirectionCW?x.frontFace(x.CW):x.frontFace(x.CCW),e===q.CullFaceBack?x.cullFace(x.BACK):e===q.CullFaceFront?x.cullFace(x.FRONT):x.cullFace(x.FRONT_AND_BACK),x.enable(x.CULL_FACE))},this.setMaterialFaces=function(e){H.setDoubleSided(e.side===q.DoubleSide),H.setFlipSided(e.side===q.BackSide)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",ge),e.__webglTexture=x.createTexture(),w.info.memory.textures++),x.bindTexture(x.TEXTURE_2D,e.__webglTexture),x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,e.flipY),x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),x.pixelStorei(x.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=$e(e.image,J);var t=e.image,n=q.Math.isPowerOfTwo(t.width)&&q.Math.isPowerOfTwo(t.height),i=ot(e.format),r=ot(e.type);Je(x.TEXTURE_2D,e,n);var o,a=e.mipmaps;if(e instanceof q.DataTexture)if(a.length>0&&n){for(var s=0,l=a.length;s<l;s++)o=a[s],x.texImage2D(x.TEXTURE_2D,s,i,o.width,o.height,0,i,r,o.data);e.generateMipmaps=!1}else x.texImage2D(x.TEXTURE_2D,0,i,t.width,t.height,0,i,r,t.data);else if(e instanceof q.CompressedTexture)for(s=0,l=a.length;s<l;s++)o=a[s],e.format!==q.RGBAFormat&&e.format!==q.RGBFormat?ae().indexOf(i)>-1?x.compressedTexImage2D(x.TEXTURE_2D,s,i,o.width,o.height,0,o.data):q.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):x.texImage2D(x.TEXTURE_2D,s,i,o.width,o.height,0,i,r,o.data);else if(a.length>0&&n){for(s=0,l=a.length;s<l;s++)o=a[s],x.texImage2D(x.TEXTURE_2D,s,i,i,r,o);e.generateMipmaps=!1}else x.texImage2D(x.TEXTURE_2D,0,i,i,r,e.image);e.generateMipmaps&&n&&x.generateMipmap(x.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){x.activeTexture(x.TEXTURE0+t),e.needsUpdate?w.uploadTexture(e):x.bindTexture(x.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var t,n,i,r,o,a=e instanceof q.WebGLRenderTargetCube;if(e&&void 0===e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",ve),e.__webglTexture=x.createTexture(),w.info.memory.textures++;var s=q.Math.isPowerOfTwo(e.width)&&q.Math.isPowerOfTwo(e.height),l=ot(e.format),c=ot(e.type);if(a){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],x.bindTexture(x.TEXTURE_CUBE_MAP,e.__webglTexture),Je(x.TEXTURE_CUBE_MAP,e,s);for(var u=0;u<6;u++)e.__webglFramebuffer[u]=x.createFramebuffer(),e.__webglRenderbuffer[u]=x.createRenderbuffer(),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+u,0,l,e.width,e.height,0,l,c,null),nt(e.__webglFramebuffer[u],e,x.TEXTURE_CUBE_MAP_POSITIVE_X+u),it(e.__webglRenderbuffer[u],e);s&&x.generateMipmap(x.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=x.createFramebuffer(),e.shareDepthFrom?e.__webglRenderbuffer=e.shareDepthFrom.__webglRenderbuffer:e.__webglRenderbuffer=x.createRenderbuffer(),x.bindTexture(x.TEXTURE_2D,e.__webglTexture),Je(x.TEXTURE_2D,e,s),x.texImage2D(x.TEXTURE_2D,0,l,e.width,e.height,0,l,c,null),nt(e.__webglFramebuffer,e,x.TEXTURE_2D),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_STENCIL_ATTACHMENT,x.RENDERBUFFER,e.__webglRenderbuffer):it(e.__webglRenderbuffer,e),s&&x.generateMipmap(x.TEXTURE_2D);a?x.bindTexture(x.TEXTURE_CUBE_MAP,null):x.bindTexture(x.TEXTURE_2D,null),x.bindRenderbuffer(x.RENDERBUFFER,null),x.bindFramebuffer(x.FRAMEBUFFER,null)}e?(t=a?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,n=e.width,i=e.height,r=0,o=0):(t=null,n=R,i=I,r=L,o=D),t!==M&&(x.bindFramebuffer(x.FRAMEBUFFER,t),x.viewport(r,o,n,i),M=t),O=n,N=i},this.readRenderTargetPixels=function(e,t,n,i,r,o){if(e instanceof q.WebGLRenderTarget){if(e.__webglFramebuffer){if(e.format!==q.RGBAFormat)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");var a=!1;e.__webglFramebuffer!==M&&(x.bindFramebuffer(x.FRAMEBUFFER,e.__webglFramebuffer),a=!0),x.checkFramebufferStatus(x.FRAMEBUFFER)===x.FRAMEBUFFER_COMPLETE?x.readPixels(t,n,i,r,x.RGBA,x.UNSIGNED_BYTE,o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),a&&x.bindFramebuffer(x.FRAMEBUFFER,M)}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.initMaterial=function(){q.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},this.addPrePlugin=function(){q.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},this.addPostPlugin=function(){q.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},this.updateShadowMap=function(){q.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}},q.WebGLRenderTarget=function(e,t,n){this.width=e,this.height=t,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:q.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:q.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:q.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:q.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new q.Vector2(0,0),this.repeat=new q.Vector2(1,1),this.format=void 0!==n.format?n.format:q.RGBAFormat,this.type=void 0!==n.type?n.type:q.UnsignedByteType,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.generateMipmaps=!0,this.shareDepthFrom=void 0!==n.shareDepthFrom?n.shareDepthFrom:null},q.WebGLRenderTarget.prototype={constructor:q.WebGLRenderTarget,setSize:function(e,t){this.width=e,this.height=t},clone:function(){var e=new q.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},q.EventDispatcher.prototype.apply(q.WebGLRenderTarget.prototype),q.WebGLRenderTargetCube=function(e,t,n){q.WebGLRenderTarget.call(this,e,t,n),this.activeCubeFace=0},q.WebGLRenderTargetCube.prototype=Object.create(q.WebGLRenderTarget.prototype),q.WebGLRenderTargetCube.prototype.constructor=q.WebGLRenderTargetCube,q.WebGLExtensions=function(e){var t={};this.get=function(n){if(void 0!==t[n])return t[n];var i;switch(n){case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return null===i&&q.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=i,i}},q.WebGLProgram=(N=0,function(e,t,n,i){var r=e,o=r.context,a=n.defines,s=n.__webglShader.uniforms,l=n.attributes,c=n.__webglShader.vertexShader,u=n.__webglShader.fragmentShader,h=n.index0AttributeName;void 0===h&&!0===i.morphTargets&&(h="position");var d="SHADOWMAP_TYPE_BASIC";i.shadowMapType===q.PCFShadowMap?d="SHADOWMAP_TYPE_PCF":i.shadowMapType===q.PCFSoftShadowMap&&(d="SHADOWMAP_TYPE_PCF_SOFT");var f="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(i.envMap){switch(n.envMap.mapping){case q.CubeReflectionMapping:case q.CubeRefractionMapping:f="ENVMAP_TYPE_CUBE";break;case q.EquirectangularReflectionMapping:case q.EquirectangularRefractionMapping:f="ENVMAP_TYPE_EQUIREC";break;case q.SphericalReflectionMapping:f="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case q.CubeRefractionMapping:case q.EquirectangularRefractionMapping:p="ENVMAP_MODE_REFRACTION"}switch(n.combine){case q.MultiplyOperation:m="ENVMAP_BLENDING_MULTIPLY";break;case q.MixOperation:m="ENVMAP_BLENDING_MIX";break;case q.AddOperation:m="ENVMAP_BLENDING_ADD"}}var g,v,y=e.gammaFactor>0?e.gammaFactor:1,_=function(e){var t,n,i=[];for(var r in e)!1!==(t=e[r])&&(n="#define "+r+" "+t,i.push(n));return i.join("\n")}(a),b=o.createProgram();n instanceof q.RawShaderMaterial?(g="",v=""):(g=["precision "+i.precision+" float;","precision "+i.precision+" int;",_,i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.gammaInput?"#define GAMMA_INPUT":"",r.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+y,"#define MAX_DIR_LIGHTS "+i.maxDirLights,"#define MAX_POINT_LIGHTS "+i.maxPointLights,"#define MAX_SPOT_LIGHTS "+i.maxSpotLights,"#define MAX_HEMI_LIGHTS "+i.maxHemiLights,"#define MAX_SHADOWS "+i.maxShadows,"#define MAX_BONES "+i.maxBones,i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+p:"",i.lightMap?"#define USE_LIGHTMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals?"#define USE_MORPHNORMALS":"",i.wrapAround?"#define WRAP_AROUND":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",i.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif",""].join("\n"),v=["precision "+i.precision+" float;","precision "+i.precision+" int;",i.bumpMap||i.normalMap||i.flatShading?"#extension GL_OES_standard_derivatives : enable":"",_,"#define MAX_DIR_LIGHTS "+i.maxDirLights,"#define MAX_POINT_LIGHTS "+i.maxPointLights,"#define MAX_SPOT_LIGHTS "+i.maxSpotLights,"#define MAX_HEMI_LIGHTS "+i.maxHemiLights,"#define MAX_SHADOWS "+i.maxShadows,i.alphaTest?"#define ALPHATEST "+i.alphaTest:"",r.gammaInput?"#define GAMMA_INPUT":"",r.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+y,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+f:"",i.envMap?"#define "+p:"",i.envMap?"#define "+m:"",i.lightMap?"#define USE_LIGHTMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.metal?"#define METAL":"",i.wrapAround?"#define WRAP_AROUND":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+d:"",i.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",i.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"));var x=new q.WebGLShader(o,o.VERTEX_SHADER,g+c),w=new q.WebGLShader(o,o.FRAGMENT_SHADER,v+u);o.attachShader(b,x),o.attachShader(b,w),void 0!==h&&o.bindAttribLocation(b,0,h),o.linkProgram(b);var A=o.getProgramInfoLog(b);!1===o.getProgramParameter(b,o.LINK_STATUS)&&q.error("THREE.WebGLProgram: shader error: "+o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(b,o.VALIDATE_STATUS),"gl.getPRogramInfoLog",A),""!==A&&q.warn("THREE.WebGLProgram: gl.getProgramInfoLog()"+A),o.deleteShader(x),o.deleteShader(w);var E=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"];for(var M in i.useVertexTexture?(E.push("boneTexture"),E.push("boneTextureWidth"),E.push("boneTextureHeight")):E.push("boneGlobalMatrices"),i.logarithmicDepthBuffer&&E.push("logDepthBufFC"),s)E.push(M);this.uniforms=function(e,t,n){for(var i={},r=0,o=n.length;r<o;r++){var a=n[r];i[a]=e.getUniformLocation(t,a)}return i}(o,b,E),E=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(var T=0;T<i.maxMorphTargets;T++)E.push("morphTarget"+T);for(T=0;T<i.maxMorphNormals;T++)E.push("morphNormal"+T);for(var S in l)E.push(S);return this.attributes=function(e,t,n){for(var i={},r=0,o=n.length;r<o;r++){var a=n[r];i[a]=e.getAttribLocation(t,a)}return i}(o,b,E),this.attributesKeys=Object.keys(this.attributes),this.id=N++,this.code=t,this.usedTimes=1,this.program=b,this.vertexShader=x,this.fragmentShader=w,this}),q.WebGLShader=function(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),!1===e.getShaderParameter(i,e.COMPILE_STATUS)&&q.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(i)&&q.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e.getShaderInfoLog(i),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n)),i},q.WebGLState=function(e,t){var n=new Uint8Array(16),i=new Uint8Array(16),r=null,o=null,a=null,s=null,l=null,c=null,u=null,h=null,d=null,f=null,p=null,m=null,g=null,v=null,y=null,_=null;this.initAttributes=function(){for(var e=0,t=n.length;e<t;e++)n[e]=0},this.enableAttribute=function(t){n[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1)},this.disableUnusedAttributes=function(){for(var t=0,r=i.length;t<r;t++)i[t]!==n[t]&&(e.disableVertexAttribArray(t),i[t]=0)},this.setBlending=function(n,i,h,d,f,p,m){n!==r&&(n===q.NoBlending?e.disable(e.BLEND):n===q.AdditiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)):n===q.SubtractiveBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR)):n===q.MultiplyBlending?(e.enable(e.BLEND),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR)):n===q.CustomBlending?e.enable(e.BLEND):(e.enable(e.BLEND),e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)),r=n),n===q.CustomBlending?(f=f||i,p=p||h,m=m||d,i===o&&f===l||(e.blendEquationSeparate(t(i),t(f)),o=i,l=f),h===a&&d===s&&p===c&&m===u||(e.blendFuncSeparate(t(h),t(d),t(p),t(m)),a=h,s=d,c=p,u=m)):(o=null,a=null,s=null,l=null,c=null,u=null)},this.setDepthTest=function(t){h!==t&&(t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),h=t)},this.setDepthWrite=function(t){d!==t&&(e.depthMask(t),d=t)},this.setColorWrite=function(t){f!==t&&(e.colorMask(t,t,t,t),f=t)},this.setDoubleSided=function(t){p!==t&&(t?e.disable(e.CULL_FACE):e.enable(e.CULL_FACE),p=t)},this.setFlipSided=function(t){m!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),m=t)},this.setLineWidth=function(t){t!==g&&(e.lineWidth(t),g=t)},this.setPolygonOffset=function(t,n,i){v!==t&&(t?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),v=t),!t||y===n&&_===i||(e.polygonOffset(n,i),y=n,_=i)},this.reset=function(){for(var e=0;e<i.length;e++)i[e]=0;r=null,h=null,d=null,f=null,p=null,m=null}},q.LensFlarePlugin=function(e,t){var n,i,r,o,a,s,l,c,u=e.context,h=function(){var t,h=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),d=new Uint16Array([0,1,2,0,2,3]);n=u.createBuffer(),i=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,n),u.bufferData(u.ARRAY_BUFFER,h,u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),u.bufferData(u.ELEMENT_ARRAY_BUFFER,d,u.STATIC_DRAW),l=u.createTexture(),c=u.createTexture(),u.bindTexture(u.TEXTURE_2D,l),u.texImage2D(u.TEXTURE_2D,0,u.RGB,16,16,0,u.RGB,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),u.bindTexture(u.TEXTURE_2D,c),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,16,16,0,u.RGBA,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),t=(s=u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0)?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},r=function(t){var n=u.createProgram(),i=u.createShader(u.FRAGMENT_SHADER),r=u.createShader(u.VERTEX_SHADER),o="precision "+e.getPrecision()+" float;\n";return u.shaderSource(i,o+t.fragmentShader),u.shaderSource(r,o+t.vertexShader),u.compileShader(i),u.compileShader(r),u.attachShader(n,i),u.attachShader(n,r),u.linkProgram(n),n}(t),o={vertex:u.getAttribLocation(r,"position"),uv:u.getAttribLocation(r,"uv")},a={renderType:u.getUniformLocation(r,"renderType"),map:u.getUniformLocation(r,"map"),occlusionMap:u.getUniformLocation(r,"occlusionMap"),opacity:u.getUniformLocation(r,"opacity"),color:u.getUniformLocation(r,"color"),scale:u.getUniformLocation(r,"scale"),rotation:u.getUniformLocation(r,"rotation"),screenPosition:u.getUniformLocation(r,"screenPosition")}};this.render=function(d,f,p,m){if(0!==t.length){var g=new q.Vector3,v=m/p,y=.5*p,_=.5*m,b=16/m,x=new q.Vector2(b*v,b),w=new q.Vector3(1,1,0),A=new q.Vector2(1,1);void 0===r&&h(),u.useProgram(r),u.enableVertexAttribArray(o.vertex),u.enableVertexAttribArray(o.uv),u.uniform1i(a.occlusionMap,0),u.uniform1i(a.map,1),u.bindBuffer(u.ARRAY_BUFFER,n),u.vertexAttribPointer(o.vertex,2,u.FLOAT,!1,16,0),u.vertexAttribPointer(o.uv,2,u.FLOAT,!1,16,8),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),u.disable(u.CULL_FACE),u.depthMask(!1);for(var E=0,M=t.length;E<M;E++){b=16/m,x.set(b*v,b);var T=t[E];if(g.set(T.matrixWorld.elements[12],T.matrixWorld.elements[13],T.matrixWorld.elements[14]),g.applyMatrix4(f.matrixWorldInverse),g.applyProjection(f.projectionMatrix),w.copy(g),A.x=w.x*y+y,A.y=w.y*_+_,s||A.x>0&&A.x<p&&A.y>0&&A.y<m){u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,l),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGB,A.x-8,A.y-8,16,16,0),u.uniform1i(a.renderType,0),u.uniform2f(a.scale,x.x,x.y),u.uniform3f(a.screenPosition,w.x,w.y,w.z),u.disable(u.BLEND),u.enable(u.DEPTH_TEST),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),u.activeTexture(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,A.x-8,A.y-8,16,16,0),u.uniform1i(a.renderType,1),u.disable(u.DEPTH_TEST),u.activeTexture(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,l),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),T.positionScreen.copy(w),T.customUpdateCallback?T.customUpdateCallback(T):T.updateLensFlares(),u.uniform1i(a.renderType,2),u.enable(u.BLEND);for(var S=0,C=T.lensFlares.length;S<C;S++){var P=T.lensFlares[S];P.opacity>.001&&P.scale>.001&&(w.x=P.x,w.y=P.y,w.z=P.z,b=P.size*P.scale/m,x.x=b*v,x.y=b,u.uniform3f(a.screenPosition,w.x,w.y,w.z),u.uniform2f(a.scale,x.x,x.y),u.uniform1f(a.rotation,P.rotation),u.uniform1f(a.opacity,P.opacity),u.uniform3f(a.color,P.color.r,P.color.g,P.color.b),e.state.setBlending(P.blending,P.blendEquation,P.blendSrc,P.blendDst),e.setTexture(P.texture,1),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0))}}}u.enable(u.CULL_FACE),u.enable(u.DEPTH_TEST),u.depthMask(!0),e.resetGLState()}}},q.ShadowMapPlugin=function(e,t,n,i){var r,o,a,s,l=e.context,c=new q.Frustum,u=new q.Matrix4,h=new q.Vector3,d=new q.Vector3,f=new q.Vector3,p=[],m=q.ShaderLib.depthRGBA,g=q.UniformsUtils.clone(m.uniforms);function v(e,t,i){if(t.visible){var r=n[t.id];if(r&&t.castShadow&&(!1===t.frustumCulled||!0===c.intersectsObject(t)))for(var o=0,a=r.length;o<a;o++){var s=r[o];t._modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),p.push(s)}for(o=0,a=t.children.length;o<a;o++)v(e,t.children[o],i)}}function y(e,t){var n=new q.DirectionalLight;n.isVirtual=!0,n.onlyShadow=!0,n.castShadow=!0,n.shadowCameraNear=e.shadowCameraNear,n.shadowCameraFar=e.shadowCameraFar,n.shadowCameraLeft=e.shadowCameraLeft,n.shadowCameraRight=e.shadowCameraRight,n.shadowCameraBottom=e.shadowCameraBottom,n.shadowCameraTop=e.shadowCameraTop,n.shadowCameraVisible=e.shadowCameraVisible,n.shadowDarkness=e.shadowDarkness,n.shadowBias=e.shadowCascadeBias[t],n.shadowMapWidth=e.shadowCascadeWidth[t],n.shadowMapHeight=e.shadowCascadeHeight[t],n.pointsWorld=[],n.pointsFrustum=[];for(var i=n.pointsWorld,r=n.pointsFrustum,o=0;o<8;o++)i[o]=new q.Vector3,r[o]=new q.Vector3;var a=e.shadowCascadeNearZ[t],s=e.shadowCascadeFarZ[t];return r[0].set(-1,-1,a),r[1].set(1,-1,a),r[2].set(-1,1,a),r[3].set(1,1,a),r[4].set(-1,-1,s),r[5].set(1,-1,s),r[6].set(-1,1,s),r[7].set(1,1,s),n}function _(e,t){var n=e.shadowCascadeArray[t];n.position.copy(e.position),n.target.position.copy(e.target.position),n.lookAt(n.target),n.shadowCameraVisible=e.shadowCameraVisible,n.shadowDarkness=e.shadowDarkness,n.shadowBias=e.shadowCascadeBias[t];var i=e.shadowCascadeNearZ[t],r=e.shadowCascadeFarZ[t],o=n.pointsFrustum;o[0].z=i,o[1].z=i,o[2].z=i,o[3].z=i,o[4].z=r,o[5].z=r,o[6].z=r,o[7].z=r}function b(e,t){var n=t.shadowCamera,i=t.pointsFrustum,r=t.pointsWorld;h.set(1/0,1/0,1/0),d.set(-1/0,-1/0,-1/0);for(var o=0;o<8;o++){var a=r[o];a.copy(i[o]),a.unproject(e),a.applyMatrix4(n.matrixWorldInverse),a.x<h.x&&(h.x=a.x),a.x>d.x&&(d.x=a.x),a.y<h.y&&(h.y=a.y),a.y>d.y&&(d.y=a.y),a.z<h.z&&(h.z=a.z),a.z>d.z&&(d.z=a.z)}n.left=h.x,n.right=d.x,n.top=d.y,n.bottom=h.y,n.updateProjectionMatrix()}function x(e){return e.material instanceof q.MeshFaceMaterial?e.material.materials[0]:e.material}r=new q.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}),o=new q.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,morphTargets:!0}),a=new q.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,skinning:!0}),s=new q.ShaderMaterial({uniforms:g,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,morphTargets:!0,skinning:!0}),r._shadowPass=!0,o._shadowPass=!0,a._shadowPass=!0,s._shadowPass=!0,this.render=function(n,h){if(!1!==e.shadowMapEnabled){var d,m,g,w,A,E,M,T,S,C,P,L,D,R=[],I=0;for(l.clearColor(1,1,1,1),l.disable(l.BLEND),l.enable(l.CULL_FACE),l.frontFace(l.CCW),e.shadowMapCullFace===q.CullFaceFront?l.cullFace(l.FRONT):l.cullFace(l.BACK),e.state.setDepthTest(!0),d=0,m=t.length;d<m;d++)if((D=t[d]).castShadow)if(D instanceof q.DirectionalLight&&D.shadowCascade)for(A=0;A<D.shadowCascadeCount;A++){var O;if(D.shadowCascadeArray[A])O=D.shadowCascadeArray[A];else{(O=y(D,A)).originalCamera=h;var N=new q.Gyroscope;N.position.copy(D.shadowCascadeOffset),N.add(O),N.add(O.target),h.add(N),D.shadowCascadeArray[A]=O}_(D,A),R[I]=O,I++}else R[I]=D,I++;for(d=0,m=R.length;d<m;d++){if(!(D=R[d]).shadowMap){var k=q.LinearFilter;e.shadowMapType===q.PCFSoftShadowMap&&(k=q.NearestFilter);var F={minFilter:k,magFilter:k,format:q.RGBAFormat};D.shadowMap=new q.WebGLRenderTarget(D.shadowMapWidth,D.shadowMapHeight,F),D.shadowMapSize=new q.Vector2(D.shadowMapWidth,D.shadowMapHeight),D.shadowMatrix=new q.Matrix4}if(!D.shadowCamera){if(D instanceof q.SpotLight)D.shadowCamera=new q.PerspectiveCamera(D.shadowCameraFov,D.shadowMapWidth/D.shadowMapHeight,D.shadowCameraNear,D.shadowCameraFar);else{if(!(D instanceof q.DirectionalLight)){q.error("THREE.ShadowMapPlugin: Unsupported light type for shadow",D);continue}D.shadowCamera=new q.OrthographicCamera(D.shadowCameraLeft,D.shadowCameraRight,D.shadowCameraTop,D.shadowCameraBottom,D.shadowCameraNear,D.shadowCameraFar)}n.add(D.shadowCamera),!0===n.autoUpdate&&n.updateMatrixWorld()}var V,B,U;for(D.shadowCameraVisible&&!D.cameraHelper&&(D.cameraHelper=new q.CameraHelper(D.shadowCamera),n.add(D.cameraHelper)),D.isVirtual&&O.originalCamera==h&&b(h,D),E=D.shadowMap,M=D.shadowMatrix,(T=D.shadowCamera).position.setFromMatrixPosition(D.matrixWorld),f.setFromMatrixPosition(D.target.matrixWorld),T.lookAt(f),T.updateMatrixWorld(),T.matrixWorldInverse.getInverse(T.matrixWorld),D.cameraHelper&&(D.cameraHelper.visible=D.shadowCameraVisible),D.shadowCameraVisible&&D.cameraHelper.update(),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(T.projectionMatrix),M.multiply(T.matrixWorldInverse),u.multiplyMatrices(T.projectionMatrix,T.matrixWorldInverse),c.setFromMatrix(u),e.setRenderTarget(E),e.clear(),p.length=0,v(n,n,T),g=0,w=p.length;g<w;g++)L=(P=p[g]).object,S=P.buffer,V=x(L),B=void 0!==L.geometry.morphTargets&&L.geometry.morphTargets.length>0&&V.morphTargets,U=L instanceof q.SkinnedMesh&&V.skinning,C=L.customDepthMaterial?L.customDepthMaterial:U?B?s:a:B?o:r,e.setMaterialFaces(V),S instanceof q.BufferGeometry?e.renderBufferDirect(T,t,null,C,S,L):e.renderBuffer(T,t,null,C,S,L);for(g=0,w=i.length;g<w;g++)(L=(P=i[g]).object).visible&&L.castShadow&&(L._modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,L.matrixWorld),e.renderImmediateObject(T,t,null,r,L))}var z=e.getClearColor(),G=e.getClearAlpha();l.clearColor(z.r,z.g,z.b,G),l.enable(l.BLEND),e.shadowMapCullFace===q.CullFaceFront&&l.cullFace(l.BACK),e.resetGLState()}}},q.SpritePlugin=function(e,t){var n,i,r,o,a,s,l=e.context,c=new q.Vector3,u=new q.Quaternion,h=new q.Vector3,d=function(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),c=new Uint16Array([0,1,2,0,2,3]);n=l.createBuffer(),i=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,n),l.bufferData(l.ARRAY_BUFFER,t,l.STATIC_DRAW),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,i),l.bufferData(l.ELEMENT_ARRAY_BUFFER,c,l.STATIC_DRAW),r=function(){var t=l.createProgram(),n=l.createShader(l.VERTEX_SHADER),i=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(n,["precision "+e.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),l.shaderSource(i,["precision "+e.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),l.compileShader(n),l.compileShader(i),l.attachShader(t,n),l.attachShader(t,i),l.linkProgram(t),t}(),o={position:l.getAttribLocation(r,"position"),uv:l.getAttribLocation(r,"uv")},a={uvOffset:l.getUniformLocation(r,"uvOffset"),uvScale:l.getUniformLocation(r,"uvScale"),rotation:l.getUniformLocation(r,"rotation"),scale:l.getUniformLocation(r,"scale"),color:l.getUniformLocation(r,"color"),map:l.getUniformLocation(r,"map"),opacity:l.getUniformLocation(r,"opacity"),modelViewMatrix:l.getUniformLocation(r,"modelViewMatrix"),projectionMatrix:l.getUniformLocation(r,"projectionMatrix"),fogType:l.getUniformLocation(r,"fogType"),fogDensity:l.getUniformLocation(r,"fogDensity"),fogNear:l.getUniformLocation(r,"fogNear"),fogFar:l.getUniformLocation(r,"fogFar"),fogColor:l.getUniformLocation(r,"fogColor"),alphaTest:l.getUniformLocation(r,"alphaTest")};var u=document.createElement("canvas");u.width=8,u.height=8;var h=u.getContext("2d");h.fillStyle="white",h.fillRect(0,0,8,8),(s=new q.Texture(u)).needsUpdate=!0};function f(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(p,m){if(0!==t.length){void 0===r&&d(),l.useProgram(r),l.enableVertexAttribArray(o.position),l.enableVertexAttribArray(o.uv),l.disable(l.CULL_FACE),l.enable(l.BLEND),l.bindBuffer(l.ARRAY_BUFFER,n),l.vertexAttribPointer(o.position,2,l.FLOAT,!1,16,0),l.vertexAttribPointer(o.uv,2,l.FLOAT,!1,16,8),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,i),l.uniformMatrix4fv(a.projectionMatrix,!1,m.projectionMatrix.elements),l.activeTexture(l.TEXTURE0),l.uniform1i(a.map,0);var g=0,v=0,y=p.fog;y?(l.uniform3f(a.fogColor,y.color.r,y.color.g,y.color.b),y instanceof q.Fog?(l.uniform1f(a.fogNear,y.near),l.uniform1f(a.fogFar,y.far),l.uniform1i(a.fogType,1),g=1,v=1):y instanceof q.FogExp2&&(l.uniform1f(a.fogDensity,y.density),l.uniform1i(a.fogType,2),g=2,v=2)):(l.uniform1i(a.fogType,0),g=0,v=0);for(var _=0,b=t.length;_<b;_++){(w=t[_])._modelViewMatrix.multiplyMatrices(m.matrixWorldInverse,w.matrixWorld),w.z=-w._modelViewMatrix.elements[14]}t.sort(f);var x=[];for(_=0,b=t.length;_<b;_++){var w,A=(w=t[_]).material;l.uniform1f(a.alphaTest,A.alphaTest),l.uniformMatrix4fv(a.modelViewMatrix,!1,w._modelViewMatrix.elements),w.matrixWorld.decompose(c,u,h),x[0]=h.x,x[1]=h.y;var E=0;p.fog&&A.fog&&(E=v),g!==E&&(l.uniform1i(a.fogType,E),g=E),null!==A.map?(l.uniform2f(a.uvOffset,A.map.offset.x,A.map.offset.y),l.uniform2f(a.uvScale,A.map.repeat.x,A.map.repeat.y)):(l.uniform2f(a.uvOffset,0,0),l.uniform2f(a.uvScale,1,1)),l.uniform1f(a.opacity,A.opacity),l.uniform3f(a.color,A.color.r,A.color.g,A.color.b),l.uniform1f(a.rotation,A.rotation),l.uniform2fv(a.scale,x),e.state.setBlending(A.blending,A.blendEquation,A.blendSrc,A.blendDst),e.state.setDepthTest(A.depthTest),e.state.setDepthWrite(A.depthWrite),A.map&&A.map.image&&A.map.image.width?e.setTexture(A.map,0):e.setTexture(s,0),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0)}l.enable(l.CULL_FACE),e.resetGLState()}}},q.GeometryUtils={merge:function(e,t,n){var i;q.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t instanceof q.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),i=t.matrix,t=t.geometry),e.merge(t,i,n)},center:function(e){return q.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},q.ImageUtils={crossOrigin:void 0,loadTexture:function(e,t,n,i){var r=new q.ImageLoader;r.crossOrigin=this.crossOrigin;var o=new q.Texture(void 0,t);return r.load(e,(function(e){o.image=e,o.needsUpdate=!0,n&&n(o)}),void 0,(function(e){i&&i(e)})),o.sourceFile=e,o},loadTextureCube:function(e,t,n,i){var r=new q.ImageLoader;r.crossOrigin=this.crossOrigin;var o=new q.CubeTexture([],t);o.flipY=!1;for(var a=0,s=function(t){r.load(e[t],(function(e){o.images[t]=e,6===(a+=1)&&(o.needsUpdate=!0,n&&n(o))}),void 0,i)},l=0,c=e.length;l<c;++l)s(l);return o},loadCompressedTexture:function(){q.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){q.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(e,t){var n=function(e,t){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},i=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]};t|=1;var r=e.width,o=e.height,a=document.createElement("canvas");a.width=r,a.height=o;var s=a.getContext("2d");s.drawImage(e,0,0);for(var l,c,u=s.getImageData(0,0,r,o).data,h=s.createImageData(r,o),d=h.data,f=0;f<r;f++)for(var p=0;p<o;p++){var m=p-1<0?0:p-1,g=p+1>o-1?o-1:p+1,v=f-1<0?0:f-1,y=f+1>r-1?r-1:f+1,_=[],b=[0,0,u[4*(p*r+f)]/255*t];_.push([-1,0,u[4*(p*r+v)]/255*t]),_.push([-1,-1,u[4*(m*r+v)]/255*t]),_.push([0,-1,u[4*(m*r+f)]/255*t]),_.push([1,-1,u[4*(m*r+y)]/255*t]),_.push([1,0,u[4*(p*r+y)]/255*t]),_.push([1,1,u[4*(g*r+y)]/255*t]),_.push([0,1,u[4*(g*r+f)]/255*t]),_.push([-1,1,u[4*(g*r+v)]/255*t]);for(var x=[],w=_.length,A=0;A<w;A++){var E=_[A],M=_[(A+1)%w];E=n(E,b),M=n(M,b),x.push(i((c=M,[(l=E)[1]*c[2]-l[2]*c[1],l[2]*c[0]-l[0]*c[2],l[0]*c[1]-l[1]*c[0]])))}var T=[0,0,0];for(A=0;A<x.length;A++)T[0]+=x[A][0],T[1]+=x[A][1],T[2]+=x[A][2];T[0]/=x.length,T[1]/=x.length,T[2]/=x.length;var S=4*(p*r+f);d[S]=(T[0]+1)/2*255|0,d[S+1]=(T[1]+1)/2*255|0,d[S+2]=255*T[2]|0,d[S+3]=255}return s.putImageData(h,0,0),a},generateDataTexture:function(e,t,n){for(var i=e*t,r=new Uint8Array(3*i),o=Math.floor(255*n.r),a=Math.floor(255*n.g),s=Math.floor(255*n.b),l=0;l<i;l++)r[3*l]=o,r[3*l+1]=a,r[3*l+2]=s;var c=new q.DataTexture(r,e,t,q.RGBFormat);return c.needsUpdate=!0,c}},q.SceneUtils={createMultiMaterialObject:function(e,t){for(var n=new q.Object3D,i=0,r=t.length;i<r;i++)n.add(new q.Mesh(e,t[i]));return n},detach:function(e,t,n){e.applyMatrix(t.matrixWorld),t.remove(e),n.add(e)},attach:function(e,t,n){var i=new q.Matrix4;i.getInverse(n.matrixWorld),e.applyMatrix(i),t.remove(e),n.add(e)}},q.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(e){var t=e.familyName.toLowerCase();return this.faces[t]=this.faces[t]||{},this.faces[t][e.cssFontWeight]=this.faces[t][e.cssFontWeight]||{},this.faces[t][e.cssFontWeight][e.cssFontStyle]=e,this.faces[t][e.cssFontWeight][e.cssFontStyle]=e,e},drawText:function(e){var t,n=this.getFace(),i=this.size/n.resolution,r=0,o=String(e).split(""),a=o.length,s=[];for(t=0;t<a;t++){var l=new q.Path,c=this.extractGlyphPoints(o[t],n,i,r,l);r+=c.offset,s.push(c.path)}return{paths:s,offset:r/2}},extractGlyphPoints:function(e,t,n,i,r){var o,a,s,l,c,u,h,d,f,p,m,g,v,y,_,b,x,w,A=[],E=t.glyphs[e]||t.glyphs["?"];if(E){if(E.o)for(c=(l=E._cachedOutline||(E._cachedOutline=E.o.split(" "))).length,u=n,h=n,o=0;o<c;)switch(l[o++]){case"m":d=l[o++]*u+i,f=l[o++]*h,r.moveTo(d,f);break;case"l":d=l[o++]*u+i,f=l[o++]*h,r.lineTo(d,f);break;case"q":if(p=l[o++]*u+i,m=l[o++]*h,y=l[o++]*u+i,_=l[o++]*h,r.quadraticCurveTo(y,_,p,m),w=A[A.length-1])for(g=w.x,v=w.y,a=1,s=this.divisions;a<=s;a++){var M=a/s;q.Shape.Utils.b2(M,g,y,p),q.Shape.Utils.b2(M,v,_,m)}break;case"b":if(p=l[o++]*u+i,m=l[o++]*h,y=l[o++]*u+i,_=l[o++]*h,b=l[o++]*u+i,x=l[o++]*h,r.bezierCurveTo(y,_,b,x,p,m),w=A[A.length-1])for(g=w.x,v=w.y,a=1,s=this.divisions;a<=s;a++){M=a/s;q.Shape.Utils.b3(M,g,y,b,p),q.Shape.Utils.b3(M,v,_,x,m)}}return{offset:E.ha*n,path:r}}}},q.FontUtils.generateShapes=function(e,t){var n=void 0!==(t=t||{}).size?t.size:100,i=void 0!==t.curveSegments?t.curveSegments:4,r=void 0!==t.font?t.font:"helvetiker",o=void 0!==t.weight?t.weight:"normal",a=void 0!==t.style?t.style:"normal";q.FontUtils.size=n,q.FontUtils.divisions=i,q.FontUtils.face=r,q.FontUtils.weight=o,q.FontUtils.style=a;for(var s=q.FontUtils.drawText(e).paths,l=[],c=0,u=s.length;c<u;c++)Array.prototype.push.apply(l,s[c].toShapes());return l},k=q.FontUtils,F=function(e){for(var t=e.length,n=0,i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n},V=function(e,t,n,i,r,o){var a,s,l,c,u,h,d,f,p,m,g,v,y,_,b;if(s=e[o[t]].x,l=e[o[t]].y,c=e[o[n]].x,u=e[o[n]].y,h=e[o[i]].x,1e-10>(c-s)*((d=e[o[i]].y)-l)-(u-l)*(h-s))return!1;for(m=h-c,g=d-u,v=s-h,y=l-d,_=c-s,b=u-l,a=0;a<r;a++)if(f=e[o[a]].x,p=e[o[a]].y,!(f===s&&p===l||f===c&&p===u||f===h&&p===d)&&m*(p-u)-g*(f-c)>=-1e-10&&v*(p-d)-y*(f-h)>=-1e-10&&_*(p-l)-b*(f-s)>=-1e-10)return!1;return!0},k.Triangulate=function(e,t){var n=e.length;if(n<3)return null;var i,r,o,a=[],s=[],l=[];if(F(e)>0)for(r=0;r<n;r++)s[r]=r;else for(r=0;r<n;r++)s[r]=n-1-r;var c=n,u=2*c;for(r=c-1;c>2;){if(u--<=0)return q.warn("THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()"),t?l:a;if(c<=(i=r)&&(i=0),c<=(r=i+1)&&(r=0),c<=(o=r+1)&&(o=0),V(e,i,r,o,c,s)){var h,d,f,p,m;for(h=s[i],d=s[r],f=s[o],a.push([e[h],e[d],e[f]]),l.push([s[i],s[r],s[o]]),p=r,m=r+1;m<c;p++,m++)s[p]=s[m];u=2*--c}}return t?l:a},k.Triangulate.area=F,q.Audio=function(e){q.Object3D.call(this),this.type="Audio",this.context=e.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.autoplay=!1,this.startTime=0,this.isPlaying=!1},q.Audio.prototype=Object.create(q.Object3D.prototype),q.Audio.prototype.constructor=q.Audio,q.Audio.prototype.load=function(e){var t=this,n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(e){t.context.decodeAudioData(this.response,(function(e){t.source.buffer=e,t.autoplay&&t.play()}))},n.send(),this},q.Audio.prototype.play=function(){if(!0!==this.isPlaying){var e=this.context.createBufferSource();e.buffer=this.source.buffer,e.loop=this.source.loop,e.onended=this.source.onended,e.connect(this.panner),e.start(0,this.startTime),this.isPlaying=!0,this.source=e}else q.warn("THREE.Audio: Audio is already playing.")},q.Audio.prototype.pause=function(){this.source.stop(),this.startTime=this.context.currentTime},q.Audio.prototype.stop=function(){this.source.stop(),this.startTime=0},q.Audio.prototype.onEnded=function(){this.isPlaying=!1},q.Audio.prototype.setLoop=function(e){this.source.loop=e},q.Audio.prototype.setRefDistance=function(e){this.panner.refDistance=e},q.Audio.prototype.setRolloffFactor=function(e){this.panner.rolloffFactor=e},q.Audio.prototype.setVolume=function(e){this.gain.gain.value=e},q.Audio.prototype.updateMatrixWorld=function(){var e=new q.Vector3;return function(t){q.Object3D.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}(),q.AudioListener=function(){q.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext)},q.AudioListener.prototype=Object.create(q.Object3D.prototype),q.AudioListener.prototype.constructor=q.AudioListener,q.AudioListener.prototype.updateMatrixWorld=function(){var e=new q.Vector3,t=new q.Quaternion,n=new q.Vector3,i=new q.Vector3,r=new q.Vector3,o=new q.Vector3;return function(a){q.Object3D.prototype.updateMatrixWorld.call(this,a);var s=this.context.listener,l=this.up;this.matrixWorld.decompose(e,t,n),i.set(0,0,-1).applyQuaternion(t),r.subVectors(e,o),s.setPosition(e.x,e.y,e.z),s.setOrientation(i.x,i.y,i.z,l.x,l.y,l.z),s.setVelocity(r.x,r.y,r.z),o.copy(e)}}(),q.Curve=function(){},q.Curve.prototype.getPoint=function(e){return q.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},q.Curve.prototype.getPointAt=function(e){var t=this.getUtoTmapping(e);return this.getPoint(t)},q.Curve.prototype.getPoints=function(e){e||(e=5);var t,n=[];for(t=0;t<=e;t++)n.push(this.getPoint(t/e));return n},q.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,n=[];for(t=0;t<=e;t++)n.push(this.getPointAt(t/e));return n},q.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},q.Curve.prototype.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=e;n++)o+=(t=this.getPoint(n/e)).distanceTo(r),i.push(o),r=t;return this.cacheArcLengths=i,i},q.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},q.Curve.prototype.getUtoTmapping=function(e,t){var n,i=this.getLengths(),r=0,o=i.length;n=t||e*i[o-1];for(var a,s=0,l=o-1;s<=l;)if((a=i[r=Math.floor(s+(l-s)/2)]-n)<0)s=r+1;else{if(!(a>0)){l=r;break}l=r-1}if(i[r=l]==n)return r/(o-1);var c=i[r];return(r+(n-c)/(i[r+1]-c))/(o-1)},q.Curve.prototype.getTangent=function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),n>1&&(n=1);var i=this.getPoint(t);return this.getPoint(n).clone().sub(i).normalize()},q.Curve.prototype.getTangentAt=function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},q.Curve.Utils={tangentQuadraticBezier:function(e,t,n,i){return 2*(1-e)*(n-t)+2*e*(i-n)},tangentCubicBezier:function(e,t,n,i,r){return-3*t*(1-e)*(1-e)+3*n*(1-e)*(1-e)-6*e*n*(1-e)+6*e*i*(1-e)-3*e*e*i+3*e*e*r},tangentSpline:function(e,t,n,i,r){return 6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e)},interpolate:function(e,t,n,i,r){var o=.5*(n-e),a=.5*(i-t),s=r*r;return(2*t-2*n+o+a)*(r*s)+(-3*t+3*n-2*o-a)*s+o*r+t}},q.Curve.create=function(e,t){return e.prototype=Object.create(q.Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},q.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},q.CurvePath.prototype=Object.create(q.Curve.prototype),q.CurvePath.prototype.constructor=q.CurvePath,q.CurvePath.prototype.add=function(e){this.curves.push(e)},q.CurvePath.prototype.checkConnection=function(){},q.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new q.LineCurve(t,e))},q.CurvePath.prototype.getPoint=function(e){for(var t,n=e*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var o=1-(i[r]-n)/(t=this.curves[r]).getLength();return t.getPointAt(o)}r++}return null},q.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},q.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e,t=[],n=0,i=this.curves.length;for(e=0;e<i;e++)n+=this.curves[e].getLength(),t.push(n);return this.cacheLengths=t,t},q.CurvePath.prototype.getBoundingBox=function(){var e,t,n,i,r,o,a,s,l,c,u=this.getPoints();e=t=Number.NEGATIVE_INFINITY,i=r=Number.POSITIVE_INFINITY;var h=u[0]instanceof q.Vector3;for(c=h?new q.Vector3:new q.Vector2,s=0,l=u.length;s<l;s++)(a=u[s]).x>e?e=a.x:a.x<i&&(i=a.x),a.y>t?t=a.y:a.y<r&&(r=a.y),h&&(a.z>n?n=a.z:a.z<o&&(o=a.z)),c.add(a);var d={minX:i,minY:r,maxX:e,maxY:t};return h&&(d.maxZ=n,d.minZ=o),d},q.CurvePath.prototype.createPointsGeometry=function(e){var t=this.getPoints(e,!0);return this.createGeometry(t)},q.CurvePath.prototype.createSpacedPointsGeometry=function(e){var t=this.getSpacedPoints(e,!0);return this.createGeometry(t)},q.CurvePath.prototype.createGeometry=function(e){for(var t=new q.Geometry,n=0;n<e.length;n++)t.vertices.push(new q.Vector3(e[n].x,e[n].y,e[n].z||0));return t},q.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},q.CurvePath.prototype.getTransformedPoints=function(e,t){var n,i,r=this.getPoints(e);for(t||(t=this.bends),n=0,i=t.length;n<i;n++)r=this.getWrapPoints(r,t[n]);return r},q.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var n,i,r=this.getSpacedPoints(e);for(t||(t=this.bends),n=0,i=t.length;n<i;n++)r=this.getWrapPoints(r,t[n]);return r},q.CurvePath.prototype.getWrapPoints=function(e,t){var n,i,r,o,a,s,l=this.getBoundingBox();for(n=0,i=e.length;n<i;n++){o=(r=e[n]).x,a=r.y,s=o/l.maxX,s=t.getUtoTmapping(s,o);var c=t.getPoint(s),u=t.getTangent(s);u.set(-u.y,u.x).multiplyScalar(a),r.x=c.x+u.x,r.y=c.y+u.y}return e},q.Gyroscope=function(){q.Object3D.call(this)},q.Gyroscope.prototype=Object.create(q.Object3D.prototype),q.Gyroscope.prototype.constructor=q.Gyroscope,q.Gyroscope.prototype.updateMatrixWorld=(B=new q.Vector3,U=new q.Quaternion,z=new q.Vector3,G=new q.Vector3,H=new q.Quaternion,W=new q.Vector3,function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(G,H,W),this.matrix.decompose(B,U,z),this.matrixWorld.compose(G,U,W)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)}),q.Path=function(e){q.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},q.Path.prototype=Object.create(q.CurvePath.prototype),q.Path.prototype.constructor=q.Path,q.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},q.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},q.Path.prototype.moveTo=function(e,t){var n=Array.prototype.slice.call(arguments);this.actions.push({action:q.PathActions.MOVE_TO,args:n})},q.Path.prototype.lineTo=function(e,t){var n=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,r=i[i.length-2],o=i[i.length-1],a=new q.LineCurve(new q.Vector2(r,o),new q.Vector2(e,t));this.curves.push(a),this.actions.push({action:q.PathActions.LINE_TO,args:n})},q.Path.prototype.quadraticCurveTo=function(e,t,n,i){var r=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,a=o[o.length-2],s=o[o.length-1],l=new q.QuadraticBezierCurve(new q.Vector2(a,s),new q.Vector2(e,t),new q.Vector2(n,i));this.curves.push(l),this.actions.push({action:q.PathActions.QUADRATIC_CURVE_TO,args:r})},q.Path.prototype.bezierCurveTo=function(e,t,n,i,r,o){var a=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,l=s[s.length-2],c=s[s.length-1],u=new q.CubicBezierCurve(new q.Vector2(l,c),new q.Vector2(e,t),new q.Vector2(n,i),new q.Vector2(r,o));this.curves.push(u),this.actions.push({action:q.PathActions.BEZIER_CURVE_TO,args:a})},q.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,i=n[n.length-2],r=n[n.length-1],o=[new q.Vector2(i,r)];Array.prototype.push.apply(o,e);var a=new q.SplineCurve(o);this.curves.push(a),this.actions.push({action:q.PathActions.CSPLINE_THRU,args:t})},q.Path.prototype.arc=function(e,t,n,i,r,o){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(e+s,t+l,n,i,r,o)},q.Path.prototype.absarc=function(e,t,n,i,r,o){this.absellipse(e,t,n,n,i,r,o)},q.Path.prototype.ellipse=function(e,t,n,i,r,o,a){var s=this.actions[this.actions.length-1].args,l=s[s.length-2],c=s[s.length-1];this.absellipse(e+l,t+c,n,i,r,o,a)},q.Path.prototype.absellipse=function(e,t,n,i,r,o,a){var s=Array.prototype.slice.call(arguments),l=new q.EllipseCurve(e,t,n,i,r,o,a);this.curves.push(l);var c=l.getPoint(1);s.push(c.x),s.push(c.y),this.actions.push({action:q.PathActions.ELLIPSE,args:s})},q.Path.prototype.getSpacedPoints=function(e,t){e||(e=40);for(var n=[],i=0;i<e;i++)n.push(this.getPoint(i/e));return n},q.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,t);e=e||12;var n,i,r,o,a,s,l,c,u,h,d,f,p,m,g,v,y,_,b=[];for(n=0,i=this.actions.length;n<i;n++)switch(o=(r=this.actions[n]).action,a=r.args,o){case q.PathActions.MOVE_TO:case q.PathActions.LINE_TO:b.push(new q.Vector2(a[0],a[1]));break;case q.PathActions.QUADRATIC_CURVE_TO:for(s=a[2],l=a[3],h=a[0],d=a[1],b.length>0?(f=(m=b[b.length-1]).x,p=m.y):(f=(m=this.actions[n-1].args)[m.length-2],p=m[m.length-1]),g=1;g<=e;g++)v=g/e,y=q.Shape.Utils.b2(v,f,h,s),_=q.Shape.Utils.b2(v,p,d,l),b.push(new q.Vector2(y,_));break;case q.PathActions.BEZIER_CURVE_TO:for(s=a[4],l=a[5],h=a[0],d=a[1],c=a[2],u=a[3],b.length>0?(f=(m=b[b.length-1]).x,p=m.y):(f=(m=this.actions[n-1].args)[m.length-2],p=m[m.length-1]),g=1;g<=e;g++)v=g/e,y=q.Shape.Utils.b3(v,f,h,c,s),_=q.Shape.Utils.b3(v,p,d,u,l),b.push(new q.Vector2(y,_));break;case q.PathActions.CSPLINE_THRU:m=this.actions[n-1].args;var x=[new q.Vector2(m[m.length-2],m[m.length-1])],w=e*a[0].length;x=x.concat(a[0]);var A=new q.SplineCurve(x);for(g=1;g<=w;g++)b.push(A.getPointAt(g/w));break;case q.PathActions.ARC:var E=a[0],M=a[1],T=a[2],S=a[3],C=a[4],P=!!a[5],L=C-S,D=2*e;for(g=1;g<=D;g++)v=g/D,P||(v=1-v),R=S+v*L,y=E+T*Math.cos(R),_=M+T*Math.sin(R),b.push(new q.Vector2(y,_));break;case q.PathActions.ELLIPSE:E=a[0],M=a[1];var R,I=a[2],O=a[3];S=a[4],C=a[5],P=!!a[6],L=C-S,D=2*e;for(g=1;g<=D;g++)v=g/D,P||(v=1-v),R=S+v*L,y=E+I*Math.cos(R),_=M+O*Math.sin(R),b.push(new q.Vector2(y,_))}var N=b[b.length-1];return Math.abs(N.x-b[0].x)<1e-10&&Math.abs(N.y-b[0].y)<1e-10&&b.splice(b.length-1,1),t&&b.push(b[0]),b},q.Path.prototype.toShapes=function(e,t){function n(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n],o=new q.Shape;o.actions=r.actions,o.curves=r.curves,t.push(o)}return t}function i(e,t){for(var n=t.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=t[r],s=t[o],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>1e-10){if(c<0&&(a=t[o],l=-l,s=t[r],c=-c),e.y<a.y||e.y>s.y)continue;if(e.y==a.y){if(e.x==a.x)return!0}else{var u=c*(e.x-a.x)-l*(e.y-a.y);if(0==u)return!0;if(u<0)continue;i=!i}}else{if(e.y!=a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return i}var r=function(e){var t,n,i,r,o,a=[],s=new q.Path;for(t=0,n=e.length;t<n;t++)o=(i=e[t]).args,(r=i.action)==q.PathActions.MOVE_TO&&0!=s.actions.length&&(a.push(s),s=new q.Path),s[r].apply(s,o);return 0!=s.actions.length&&a.push(s),a}(this.actions);if(0==r.length)return[];if(!0===t)return n(r);var o,a,s,l=[];if(1==r.length)return a=r[0],(s=new q.Shape).actions=a.actions,s.curves=a.curves,l.push(s),l;var c=!q.Shape.Utils.isClockWise(r[0].getPoints());c=e?!c:c;var u,h,d,f,p,m,g=[],v=[],y=[],_=0;for(v[_]=void 0,y[_]=[],h=0,d=r.length;h<d;h++)u=(a=r[h]).getPoints(),o=q.Shape.Utils.isClockWise(u),(o=e?!o:o)?(!c&&v[_]&&_++,v[_]={s:new q.Shape,p:u},v[_].s.actions=a.actions,v[_].s.curves=a.curves,c&&_++,y[_]=[]):y[_].push({h:a,p:u[0]});if(!v[0])return n(r);if(v.length>1){for(var b=!1,x=[],w=0,A=v.length;w<A;w++)g[w]=[];for(w=0,A=v.length;w<A;w++)for(var E=y[w],M=0;M<E.length;M++){for(var T=E[M],S=!0,C=0;C<v.length;C++)i(T.p,v[C].p)&&(w!=C&&x.push({froms:w,tos:C,hole:M}),S?(S=!1,g[C].push(T)):b=!0);S&&g[w].push(T)}x.length>0&&(b||(y=g))}for(h=0,d=v.length;h<d;h++)for(s=v[h].s,l.push(s),p=0,m=(f=y[h]).length;p<m;p++)s.holes.push(f[p].h);return l},q.Shape=function(){q.Path.apply(this,arguments),this.holes=[]},q.Shape.prototype=Object.create(q.Path.prototype),q.Shape.prototype.constructor=q.Shape,q.Shape.prototype.extrude=function(e){return new q.ExtrudeGeometry(this,e)},q.Shape.prototype.makeGeometry=function(e){return new q.ShapeGeometry(this,e)},q.Shape.prototype.getPointsHoles=function(e){var t,n=this.holes.length,i=[];for(t=0;t<n;t++)i[t]=this.holes[t].getTransformedPoints(e,this.bends);return i},q.Shape.prototype.getSpacedPointsHoles=function(e){var t,n=this.holes.length,i=[];for(t=0;t<n;t++)i[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return i},q.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},q.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},q.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},q.Shape.Utils={triangulateShape:function(e,t){function n(e,t,n){return e.x!=t.x?e.x<t.x?e.x<=n.x&&n.x<=t.x:t.x<=n.x&&n.x<=e.x:e.y<t.y?e.y<=n.y&&n.y<=t.y:t.y<=n.y&&n.y<=e.y}function i(e,t,i,r,o){var a=t.x-e.x,s=t.y-e.y,l=r.x-i.x,c=r.y-i.y,u=e.x-i.x,h=e.y-i.y,d=s*l-a*c,f=s*u-a*h;if(Math.abs(d)>1e-10){var p;if(d>0){if(f<0||f>d)return[];if((p=c*u-l*h)<0||p>d)return[]}else{if(f>0||f<d)return[];if((p=c*u-l*h)>0||p<d)return[]}if(0==p)return!o||0!=f&&f!=d?[e]:[];if(p==d)return!o||0!=f&&f!=d?[t]:[];if(0==f)return[i];if(f==d)return[r];var m=p/d;return[{x:e.x+m*a,y:e.y+m*s}]}if(0!=f||c*u!=l*h)return[];var g,v,y,_,b,x,w,A,E=0==a&&0==s,M=0==l&&0==c;return E&&M?e.x!=i.x||e.y!=i.y?[]:[e]:E?n(i,r,e)?[e]:[]:M?n(e,t,i)?[i]:[]:(0!=a?(e.x<t.x?(g=e,y=e.x,v=t,_=t.x):(g=t,y=t.x,v=e,_=e.x),i.x<r.x?(b=i,w=i.x,x=r,A=r.x):(b=r,w=r.x,x=i,A=i.x)):(e.y<t.y?(g=e,y=e.y,v=t,_=t.y):(g=t,y=t.y,v=e,_=e.y),i.y<r.y?(b=i,w=i.y,x=r,A=r.y):(b=r,w=r.y,x=i,A=i.y)),y<=w?_<w?[]:_==w?o?[]:[b]:_<=A?[b,v]:[b,x]:y>A?[]:y==A?o?[]:[g]:_<=A?[g,v]:[g,x])}function r(e,t,n,i){var r=t.x-e.x,o=t.y-e.y,a=n.x-e.x,s=n.y-e.y,l=i.x-e.x,c=i.y-e.y,u=r*s-o*a,h=r*c-o*l;if(Math.abs(u)>1e-10){var d=l*s-c*a;return u>0?h>=0&&d>=0:h>=0||d>=0}return h>0}for(var o,a,s,l,c,u,h={},d=e.concat(),f=0,p=t.length;f<p;f++)Array.prototype.push.apply(d,t[f]);for(o=0,a=d.length;o<a;o++)void 0!==h[c=d[o].x+":"+d[o].y]&&q.warn("THREE.Shape: Duplicate point",c),h[c]=o;var m=function(e,t){var n,o=e.concat();function a(e,t){var i=o.length-1,a=e-1;a<0&&(a=i);var s=e+1;s>i&&(s=0);var l=r(o[e],o[a],o[s],n[t]);if(!l)return!1;var c=n.length-1,u=t-1;u<0&&(u=c);var h=t+1;return h>c&&(h=0),!!(l=r(n[t],n[u],n[h],o[e]))}function s(e,t){var n,r;for(n=0;n<o.length;n++)if(r=n+1,r%=o.length,i(e,t,o[n],o[r],!0).length>0)return!0;return!1}var l=[];function c(e,n){var r,o,a,s;for(r=0;r<l.length;r++)for(o=t[l[r]],a=0;a<o.length;a++)if(s=a+1,s%=o.length,i(e,n,o[a],o[s],!0).length>0)return!0;return!1}for(var u,h,d,f,p,m,g,v,y,_,b=[],x=0,w=t.length;x<w;x++)l.push(x);for(var A=0,E=2*l.length;l.length>0;){if(--E<0){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(h=A;h<o.length;h++){d=o[h],u=-1;for(x=0;x<l.length;x++)if(p=l[x],void 0===b[m=d.x+":"+d.y+":"+p]){n=t[p];for(var M=0;M<n.length;M++)if(f=n[M],a(h,M)&&!s(d,f)&&!c(d,f)){u=M,l.splice(x,1),g=o.slice(0,h+1),v=o.slice(h),y=n.slice(u),_=n.slice(0,u+1),o=g.concat(y).concat(_).concat(v),A=h;break}if(u>=0)break;b[m]=!0}if(u>=0)break}}return o}(e,t),g=q.FontUtils.Triangulate(m,!1);for(o=0,a=g.length;o<a;o++)for(l=g[o],s=0;s<3;s++)void 0!==(u=h[c=l[s].x+":"+l[s].y])&&(l[s]=u);return g.concat()},isClockWise:function(e){return q.FontUtils.Triangulate.area(e)<0},b2p0:function(e,t){var n=1-e;return n*n*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,n,i){return this.b2p0(e,t)+this.b2p1(e,n)+this.b2p2(e,i)},b3p0:function(e,t){var n=1-e;return n*n*n*t},b3p1:function(e,t){var n=1-e;return 3*n*n*e*t},b3p2:function(e,t){return 3*(1-e)*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,n,i,r){return this.b3p0(e,t)+this.b3p1(e,n)+this.b3p2(e,i)+this.b3p3(e,r)}},q.LineCurve=function(e,t){this.v1=e,this.v2=t},q.LineCurve.prototype=Object.create(q.Curve.prototype),q.LineCurve.prototype.constructor=q.LineCurve,q.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},q.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},q.LineCurve.prototype.getTangent=function(e){return this.v2.clone().sub(this.v1).normalize()},q.QuadraticBezierCurve=function(e,t,n){this.v0=e,this.v1=t,this.v2=n},q.QuadraticBezierCurve.prototype=Object.create(q.Curve.prototype),q.QuadraticBezierCurve.prototype.constructor=q.QuadraticBezierCurve,q.QuadraticBezierCurve.prototype.getPoint=function(e){var t=new q.Vector2;return t.x=q.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=q.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t},q.QuadraticBezierCurve.prototype.getTangent=function(e){var t=new q.Vector2;return t.x=q.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),t.y=q.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),t.normalize()},q.CubicBezierCurve=function(e,t,n,i){this.v0=e,this.v1=t,this.v2=n,this.v3=i},q.CubicBezierCurve.prototype=Object.create(q.Curve.prototype),q.CubicBezierCurve.prototype.constructor=q.CubicBezierCurve,q.CubicBezierCurve.prototype.getPoint=function(e){var t,n;return t=q.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=q.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new q.Vector2(t,n)},q.CubicBezierCurve.prototype.getTangent=function(e){var t,n;t=q.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=q.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var i=new q.Vector2(t,n);return i.normalize(),i},q.SplineCurve=function(e){this.points=null==e?[]:e},q.SplineCurve.prototype=Object.create(q.Curve.prototype),q.SplineCurve.prototype.constructor=q.SplineCurve,q.SplineCurve.prototype.getPoint=function(e){var t=this.points,n=(t.length-1)*e,i=Math.floor(n),r=n-i,o=t[0==i?i:i-1],a=t[i],s=t[i>t.length-2?t.length-1:i+1],l=t[i>t.length-3?t.length-1:i+2],c=new q.Vector2;return c.x=q.Curve.Utils.interpolate(o.x,a.x,s.x,l.x,r),c.y=q.Curve.Utils.interpolate(o.y,a.y,s.y,l.y,r),c},q.EllipseCurve=function(e,t,n,i,r,o,a){this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a},q.EllipseCurve.prototype=Object.create(q.Curve.prototype),q.EllipseCurve.prototype.constructor=q.EllipseCurve,q.EllipseCurve.prototype.getPoint=function(e){var t,n=this.aEndAngle-this.aStartAngle;n<0&&(n+=2*Math.PI),n>2*Math.PI&&(n-=2*Math.PI),t=!0===this.aClockwise?this.aEndAngle+(1-e)*(2*Math.PI-n):this.aStartAngle+e*n;var i=new q.Vector2;return i.x=this.aX+this.xRadius*Math.cos(t),i.y=this.aY+this.yRadius*Math.sin(t),i},q.ArcCurve=function(e,t,n,i,r,o){q.EllipseCurve.call(this,e,t,n,n,i,r,o)},q.ArcCurve.prototype=Object.create(q.EllipseCurve.prototype),q.ArcCurve.prototype.constructor=q.ArcCurve,q.LineCurve3=q.Curve.create((function(e,t){this.v1=e,this.v2=t}),(function(e){var t=new q.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t})),q.QuadraticBezierCurve3=q.Curve.create((function(e,t,n){this.v0=e,this.v1=t,this.v2=n}),(function(e){var t=new q.Vector3;return t.x=q.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),t.y=q.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),t.z=q.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),t})),q.CubicBezierCurve3=q.Curve.create((function(e,t,n,i){this.v0=e,this.v1=t,this.v2=n,this.v3=i}),(function(e){var t=new q.Vector3;return t.x=q.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),t.y=q.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t.z=q.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),t})),q.SplineCurve3=q.Curve.create((function(e){this.points=null==e?[]:e}),(function(e){var t=this.points,n=(t.length-1)*e,i=Math.floor(n),r=n-i,o=t[0==i?i:i-1],a=t[i],s=t[i>t.length-2?t.length-1:i+1],l=t[i>t.length-3?t.length-1:i+2],c=new q.Vector3;return c.x=q.Curve.Utils.interpolate(o.x,a.x,s.x,l.x,r),c.y=q.Curve.Utils.interpolate(o.y,a.y,s.y,l.y,r),c.z=q.Curve.Utils.interpolate(o.z,a.z,s.z,l.z,r),c})),q.ClosedSplineCurve3=q.Curve.create((function(e){this.points=null==e?[]:e}),(function(e){var t=this.points,n=(t.length-0)*e,i=Math.floor(n),r=n-i,o=t[((i+=i>0?0:(Math.floor(Math.abs(i)/t.length)+1)*t.length)-1)%t.length],a=t[i%t.length],s=t[(i+1)%t.length],l=t[(i+2)%t.length],c=new q.Vector3;return c.x=q.Curve.Utils.interpolate(o.x,a.x,s.x,l.x,r),c.y=q.Curve.Utils.interpolate(o.y,a.y,s.y,l.y,r),c.z=q.Curve.Utils.interpolate(o.z,a.z,s.z,l.z,r),c})),q.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){q.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){q.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){q.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(e){if(!0===e.initialized)return e;for(var t=0;t<e.hierarchy.length;t++){for(var n=0;n<e.hierarchy[t].keys.length;n++)if(e.hierarchy[t].keys[n].time<0&&(e.hierarchy[t].keys[n].time=0),void 0!==e.hierarchy[t].keys[n].rot&&!(e.hierarchy[t].keys[n].rot instanceof q.Quaternion)){var i=e.hierarchy[t].keys[n].rot;e.hierarchy[t].keys[n].rot=(new q.Quaternion).fromArray(i)}if(e.hierarchy[t].keys.length&&void 0!==e.hierarchy[t].keys[0].morphTargets){var r={};for(n=0;n<e.hierarchy[t].keys.length;n++)for(var o=0;o<e.hierarchy[t].keys[n].morphTargets.length;o++){r[s=e.hierarchy[t].keys[n].morphTargets[o]]=-1}e.hierarchy[t].usedMorphTargets=r;for(n=0;n<e.hierarchy[t].keys.length;n++){var a={};for(var s in r){for(o=0;o<e.hierarchy[t].keys[n].morphTargets.length;o++)if(e.hierarchy[t].keys[n].morphTargets[o]===s){a[s]=e.hierarchy[t].keys[n].morphTargetsInfluences[o];break}o===e.hierarchy[t].keys[n].morphTargets.length&&(a[s]=0)}e.hierarchy[t].keys[n].morphTargetsInfluences=a}}for(n=1;n<e.hierarchy[t].keys.length;n++)e.hierarchy[t].keys[n].time===e.hierarchy[t].keys[n-1].time&&(e.hierarchy[t].keys.splice(n,1),n--);for(n=0;n<e.hierarchy[t].keys.length;n++)e.hierarchy[t].keys[n].index=n}return e.initialized=!0,e},parse:function(e){var t=[];if(e instanceof q.SkinnedMesh)for(var n=0;n<e.skeleton.bones.length;n++)t.push(e.skeleton.bones[n]);else!function e(t,n){n.push(t);for(var i=0;i<t.children.length;i++)e(t.children[i],n)}(e,t);return t},play:function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},stop:function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},update:function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].resetBlendWeights();for(t=0;t<this.animations.length;t++)this.animations[t].update(e)}},q.Animation=function(e,t){this.root=e,this.data=q.AnimationHandler.init(t),this.hierarchy=q.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=q.AnimationHandler.LINEAR},q.Animation.prototype={constructor:q.Animation,keyTypes:["pos","rot","scl"],play:function(e,t){this.currentTime=void 0!==e?e:0,this.weight=void 0!==t?t:1,this.isPlaying=!0,this.reset(),q.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,q.AnimationHandler.stop(this)},reset:function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var n=this.hierarchy[e];void 0===n.animationCache&&(n.animationCache={animations:{},blending:{positionWeight:0,quaternionWeight:0,scaleWeight:0}});var i=this.data.name,r=n.animationCache.animations,o=r[i];void 0===o&&(o={prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:n.matrix},r[i]=o);for(var a=0;a<3;a++){for(var s=this.keyTypes[a],l=this.data.hierarchy[e].keys[0],c=this.getNextKeyWith(s,e,1);c.time<this.currentTime&&c.index>l.index;)l=c,c=this.getNextKeyWith(s,e,c.index+1);o.prevKey[s]=l,o.nextKey[s]=c}}},resetBlendWeights:function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var n=this.hierarchy[e].animationCache;if(void 0!==n){var i=n.blending;i.positionWeight=0,i.quaternionWeight=0,i.scaleWeight=0}}},update:function(){var e=[],t=new q.Vector3,n=new q.Vector3,i=new q.Quaternion,r=function(e,t){var n,i,r,a,s,l,c,u,h,d=[],f=[];return r=(n=(e.length-1)*t)-(i=Math.floor(n)),d[0]=0===i?i:i-1,d[1]=i,d[2]=i>e.length-2?i:i+1,d[3]=i>e.length-3?i:i+2,l=e[d[0]],c=e[d[1]],u=e[d[2]],h=e[d[3]],s=r*(a=r*r),f[0]=o(l[0],c[0],u[0],h[0],r,a,s),f[1]=o(l[1],c[1],u[1],h[1],r,a,s),f[2]=o(l[2],c[2],u[2],h[2],r,a,s),f},o=function(e,t,n,i,r,o,a){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*r+t};return function(o){if(!1!==this.isPlaying&&(this.currentTime+=o*this.timeScale,0!==this.weight)){var a=this.data.length;(this.currentTime>a||this.currentTime<0)&&(this.loop?(this.currentTime%=a,this.currentTime<0&&(this.currentTime+=a),this.reset()):this.stop());for(var s=0,l=this.hierarchy.length;s<l;s++)for(var c=this.hierarchy[s],u=c.animationCache.animations[this.data.name],h=c.animationCache.blending,d=0;d<3;d++){var f=this.keyTypes[d],p=u.prevKey[f],m=u.nextKey[f];if(this.timeScale>0&&m.time<=this.currentTime||this.timeScale<0&&p.time>=this.currentTime){for(p=this.data.hierarchy[s].keys[0],m=this.getNextKeyWith(f,s,1);m.time<this.currentTime&&m.index>p.index;)p=m,m=this.getNextKeyWith(f,s,m.index+1);u.prevKey[f]=p,u.nextKey[f]=m}var g=(this.currentTime-p.time)/(m.time-p.time),v=p[f],y=m[f];if(g<0&&(g=0),g>1&&(g=1),"pos"===f){if(this.interpolationType===q.AnimationHandler.LINEAR){n.x=v[0]+(y[0]-v[0])*g,n.y=v[1]+(y[1]-v[1])*g,n.z=v[2]+(y[2]-v[2])*g;var _=this.weight/(this.weight+h.positionWeight);c.position.lerp(n,_),h.positionWeight+=this.weight}else if(this.interpolationType===q.AnimationHandler.CATMULLROM||this.interpolationType===q.AnimationHandler.CATMULLROM_FORWARD){e[0]=this.getPrevKeyWith("pos",s,p.index-1).pos,e[1]=v,e[2]=y,e[3]=this.getNextKeyWith("pos",s,m.index+1).pos;var b=r(e,g=.33*g+.33);_=this.weight/(this.weight+h.positionWeight);h.positionWeight+=this.weight;var x=c.position;if(x.x=x.x+(b[0]-x.x)*_,x.y=x.y+(b[1]-x.y)*_,x.z=x.z+(b[2]-x.z)*_,this.interpolationType===q.AnimationHandler.CATMULLROM_FORWARD){var w=r(e,1.01*g);t.set(w[0],w[1],w[2]),t.sub(x),t.y=0,t.normalize();var A=Math.atan2(t.x,t.z);c.rotation.set(0,A,0)}}}else if("rot"===f)if(q.Quaternion.slerp(v,y,i,g),0===h.quaternionWeight)c.quaternion.copy(i),h.quaternionWeight=this.weight;else{_=this.weight/(this.weight+h.quaternionWeight);q.Quaternion.slerp(c.quaternion,i,c.quaternion,_),h.quaternionWeight+=this.weight}else if("scl"===f){n.x=v[0]+(y[0]-v[0])*g,n.y=v[1]+(y[1]-v[1])*g,n.z=v[2]+(y[2]-v[2])*g;_=this.weight/(this.weight+h.scaleWeight);c.scale.lerp(n,_),h.scaleWeight+=this.weight}}return!0}}}(),getNextKeyWith:function(e,t,n){var i=this.data.hierarchy[t].keys;for(this.interpolationType===q.AnimationHandler.CATMULLROM||this.interpolationType===q.AnimationHandler.CATMULLROM_FORWARD?n=n<i.length-1?n:i.length-1:n%=i.length;n<i.length;n++)if(void 0!==i[n][e])return i[n];return this.data.hierarchy[t].keys[0]},getPrevKeyWith:function(e,t,n){var i=this.data.hierarchy[t].keys;for(n=this.interpolationType===q.AnimationHandler.CATMULLROM||this.interpolationType===q.AnimationHandler.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+i.length;n>=0;n--)if(void 0!==i[n][e])return i[n];return this.data.hierarchy[t].keys[i.length-1]}},q.KeyFrameAnimation=function(e){this.root=e.node,this.data=q.AnimationHandler.init(e),this.hierarchy=q.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var t=0,n=this.hierarchy.length;t<n;t++){var i=this.data.hierarchy[t].keys,r=this.data.hierarchy[t].sids,o=this.hierarchy[t];if(i.length&&r){for(var a=0;a<r.length;a++){var s=r[a],l=this.getNextKeyWith(s,t,0);l&&l.apply(s)}o.matrixAutoUpdate=!1,this.data.hierarchy[t].node.updateMatrix(),o.matrixWorldNeedsUpdate=!0}}},q.KeyFrameAnimation.prototype={constructor:q.KeyFrameAnimation,play:function(e){if(this.currentTime=void 0!==e?e:0,!1===this.isPlaying){this.isPlaying=!0;var t,n,i,r=this.hierarchy.length;for(t=0;t<r;t++){n=this.hierarchy[t],void 0===(i=this.data.hierarchy[t]).animationCache&&(i.animationCache={},i.animationCache.prevKey=null,i.animationCache.nextKey=null,i.animationCache.originalMatrix=n.matrix);var o=this.data.hierarchy[t].keys;o.length&&(i.animationCache.prevKey=o[0],i.animationCache.nextKey=o[1],this.startTime=Math.min(o[0].time,this.startTime),this.endTime=Math.max(o[o.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,q.AnimationHandler.play(this)},stop:function(){this.isPlaying=!1,this.isPaused=!1,q.AnimationHandler.stop(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],n=this.data.hierarchy[e];if(void 0!==n.animationCache){var i=n.animationCache.originalMatrix;i.copy(t.matrix),t.matrix=i,delete n.animationCache}}},update:function(e){if(!1!==this.isPlaying){this.currentTime+=e*this.timeScale;var t=this.data.length;!0===this.loop&&this.currentTime>t&&(this.currentTime%=t),this.currentTime=Math.min(this.currentTime,t);for(var n=0,i=this.hierarchy.length;n<i;n++){var r=this.hierarchy[n],o=this.data.hierarchy[n],a=o.keys,s=o.animationCache;if(a.length){var l=s.prevKey,c=s.nextKey;if(c.time<=this.currentTime){for(;c.time<this.currentTime&&c.index>l.index;)c=a[(l=c).index+1];s.prevKey=l,s.nextKey=c}c.time>=this.currentTime?l.interpolate(c,this.currentTime):l.interpolate(c,c.time),this.data.hierarchy[n].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}}},getNextKeyWith:function(e,t,n){var i=this.data.hierarchy[t].keys;for(n%=i.length;n<i.length;n++)if(i[n].hasTarget(e))return i[n];return i[0]},getPrevKeyWith:function(e,t,n){var i=this.data.hierarchy[t].keys;for(n=n>=0?n:n+i.length;n>=0;n--)if(i[n].hasTarget(e))return i[n];return i[i.length-1]}},q.MorphAnimation=function(e){this.mesh=e,this.frames=e.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.lastFrame=0,this.currentFrame=0,this.isPlaying=!1},q.MorphAnimation.prototype={constructor:q.MorphAnimation,play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(e){if(!1!==this.isPlaying){this.currentTime+=e,!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var t=this.duration/this.frames,n=Math.floor(this.currentTime/t),i=this.mesh.morphTargetInfluences;n!=this.currentFrame&&(i[this.lastFrame]=0,i[this.currentFrame]=1,i[n]=0,this.lastFrame=this.currentFrame,this.currentFrame=n),i[n]=this.currentTime%t/t,i[this.lastFrame]=1-i[n]}}},q.BoxGeometry=function(e,t,n,i,r,o){q.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.widthSegments=i||1,this.heightSegments=r||1,this.depthSegments=o||1;var a=this,s=e/2,l=t/2,c=n/2;function u(e,t,n,i,r,o,s,l){var c,u,h,d=a.widthSegments,f=a.heightSegments,p=r/2,m=o/2,g=a.vertices.length;"x"===e&&"y"===t||"y"===e&&"x"===t?c="z":"x"===e&&"z"===t||"z"===e&&"x"===t?(c="y",f=a.depthSegments):("z"===e&&"y"===t||"y"===e&&"z"===t)&&(c="x",d=a.depthSegments);var v=d+1,y=f+1,_=r/d,b=o/f,x=new q.Vector3;for(x[c]=s>0?1:-1,h=0;h<y;h++)for(u=0;u<v;u++){var w=new q.Vector3;w[e]=(u*_-p)*n,w[t]=(h*b-m)*i,w[c]=s,a.vertices.push(w)}for(h=0;h<f;h++)for(u=0;u<d;u++){var A=u+v*h,E=u+v*(h+1),M=u+1+v*(h+1),T=u+1+v*h,S=new q.Vector2(u/d,1-h/f),C=new q.Vector2(u/d,1-(h+1)/f),P=new q.Vector2((u+1)/d,1-(h+1)/f),L=new q.Vector2((u+1)/d,1-h/f),D=new q.Face3(A+g,E+g,T+g);D.normal.copy(x),D.vertexNormals.push(x.clone(),x.clone(),x.clone()),D.materialIndex=l,a.faces.push(D),a.faceVertexUvs[0].push([S,C,L]),(D=new q.Face3(E+g,M+g,T+g)).normal.copy(x),D.vertexNormals.push(x.clone(),x.clone(),x.clone()),D.materialIndex=l,a.faces.push(D),a.faceVertexUvs[0].push([C.clone(),P,L.clone()])}}u("z","y",-1,-1,n,t,s,0),u("z","y",1,-1,n,t,-s,1),u("x","z",1,1,e,n,l,2),u("x","z",1,-1,e,n,-l,3),u("x","y",1,-1,e,t,c,4),u("x","y",-1,-1,e,t,-c,5),this.mergeVertices()},q.BoxGeometry.prototype=Object.create(q.Geometry.prototype),q.BoxGeometry.prototype.constructor=q.BoxGeometry,q.CircleGeometry=function(e,t,n,i){q.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||50,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r,o=[],a=new q.Vector3,s=new q.Vector2(.5,.5);for(this.vertices.push(a),o.push(s),r=0;r<=t;r++){var l=new q.Vector3,c=n+r/t*i;l.x=e*Math.cos(c),l.y=e*Math.sin(c),this.vertices.push(l),o.push(new q.Vector2((l.x/e+1)/2,(l.y/e+1)/2))}var u=new q.Vector3(0,0,1);for(r=1;r<=t;r++)this.faces.push(new q.Face3(r,r+1,0,[u.clone(),u.clone(),u.clone()])),this.faceVertexUvs[0].push([o[r].clone(),o[r+1].clone(),s.clone()]);this.computeFaceNormals(),this.boundingSphere=new q.Sphere(new q.Vector3,e)},q.CircleGeometry.prototype=Object.create(q.Geometry.prototype),q.CircleGeometry.prototype.constructor=q.CircleGeometry,q.CubeGeometry=function(e,t,n,i,r,o){return q.warn("THREE.CubeGeometry has been renamed to THREE.BoxGeometry."),new q.BoxGeometry(e,t,n,i,r,o)},q.CylinderGeometry=function(e,t,n,i,r,o,a,s){q.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},e=void 0!==e?e:20,t=void 0!==t?t:20,n=void 0!==n?n:100,i=i||8,r=r||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l,c,u=n/2,h=[],d=[];for(c=0;c<=r;c++){var f=[],p=[],m=c/r,g=m*(t-e)+e;for(l=0;l<=i;l++){var v=l/i,y=new q.Vector3;y.x=g*Math.sin(v*s+a),y.y=-m*n+u,y.z=g*Math.cos(v*s+a),this.vertices.push(y),f.push(this.vertices.length-1),p.push(new q.Vector2(v,1-m))}h.push(f),d.push(p)}var _,b,x=(t-e)/n;for(l=0;l<i;l++)for(0!==e?(_=this.vertices[h[0][l]].clone(),b=this.vertices[h[0][l+1]].clone()):(_=this.vertices[h[1][l]].clone(),b=this.vertices[h[1][l+1]].clone()),_.setY(Math.sqrt(_.x*_.x+_.z*_.z)*x).normalize(),b.setY(Math.sqrt(b.x*b.x+b.z*b.z)*x).normalize(),c=0;c<r;c++){var w=h[c][l],A=h[c+1][l],E=h[c+1][l+1],M=h[c][l+1],T=_.clone(),S=_.clone(),C=b.clone(),P=b.clone(),L=d[c][l].clone(),D=d[c+1][l].clone(),R=d[c+1][l+1].clone(),I=d[c][l+1].clone();this.faces.push(new q.Face3(w,A,M,[T,S,P])),this.faceVertexUvs[0].push([L,D,I]),this.faces.push(new q.Face3(A,E,M,[S.clone(),C,P.clone()])),this.faceVertexUvs[0].push([D.clone(),R,I.clone()])}if(!1===o&&e>0)for(this.vertices.push(new q.Vector3(0,u,0)),l=0;l<i;l++){w=h[0][l],A=h[0][l+1],E=this.vertices.length-1,T=new q.Vector3(0,1,0),S=new q.Vector3(0,1,0),C=new q.Vector3(0,1,0),L=d[0][l].clone(),D=d[0][l+1].clone(),R=new q.Vector2(D.x,0);this.faces.push(new q.Face3(w,A,E,[T,S,C])),this.faceVertexUvs[0].push([L,D,R])}if(!1===o&&t>0)for(this.vertices.push(new q.Vector3(0,-u,0)),l=0;l<i;l++){w=h[r][l+1],A=h[r][l],E=this.vertices.length-1,T=new q.Vector3(0,-1,0),S=new q.Vector3(0,-1,0),C=new q.Vector3(0,-1,0),L=d[r][l+1].clone(),D=d[r][l].clone(),R=new q.Vector2(D.x,1);this.faces.push(new q.Face3(w,A,E,[T,S,C])),this.faceVertexUvs[0].push([L,D,R])}this.computeFaceNormals()},q.CylinderGeometry.prototype=Object.create(q.Geometry.prototype),q.CylinderGeometry.prototype.constructor=q.CylinderGeometry,q.ExtrudeGeometry=function(e,t){void 0!==e?(q.Geometry.call(this),this.type="ExtrudeGeometry",e=e instanceof Array?e:[e],this.addShapeList(e,t),this.computeFaceNormals()):e=[]},q.ExtrudeGeometry.prototype=Object.create(q.Geometry.prototype),q.ExtrudeGeometry.prototype.constructor=q.ExtrudeGeometry,q.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var n=e.length,i=0;i<n;i++){var r=e[i];this.addShape(r,t)}},q.ExtrudeGeometry.prototype.addShape=function(e,t){var n,i,r,o,a,s,l,c,u=void 0!==t.amount?t.amount:100,h=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:h-2,f=void 0!==t.bevelSegments?t.bevelSegments:3,p=void 0===t.bevelEnabled||t.bevelEnabled,m=void 0!==t.curveSegments?t.curveSegments:12,g=void 0!==t.steps?t.steps:1,v=t.extrudePath,y=!1,_=t.material,b=t.extrudeMaterial,x=void 0!==t.UVGenerator?t.UVGenerator:q.ExtrudeGeometry.WorldUVGenerator;v&&(n=v.getSpacedPoints(g),y=!0,p=!1,i=void 0!==t.frames?t.frames:new q.TubeGeometry.FrenetFrames(v,g,!1),r=new q.Vector3,o=new q.Vector3,a=new q.Vector3),p||(f=0,h=0,d=0);var w=this,A=this.vertices.length,E=e.extractPoints(m),M=E.shape,T=E.holes,S=!q.Shape.Utils.isClockWise(M);if(S){for(M=M.reverse(),l=0,c=T.length;l<c;l++)s=T[l],q.Shape.Utils.isClockWise(s)&&(T[l]=s.reverse());S=!1}var C=q.Shape.Utils.triangulateShape(M,T),P=M;for(l=0,c=T.length;l<c;l++)s=T[l],M=M.concat(s);function L(e,t,n){return t||q.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var D,R,I,O,N,k,F=M.length,V=C.length;function B(e,t,n){var i,r,o=1,a=e.x-t.x,s=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=a*a+s*s,h=a*c-s*l;if(Math.abs(h)>1e-10){var d=Math.sqrt(u),f=Math.sqrt(l*l+c*c),p=t.x-s/d,m=t.y+a/d,g=((n.x-c/f-p)*c-(n.y+l/f-m)*l)/(a*c-s*l),v=(i=p+a*g-e.x)*i+(r=m+s*g-e.y)*r;if(v<=2)return new q.Vector2(i,r);o=Math.sqrt(v/2)}else{var y=!1;a>1e-10?l>1e-10&&(y=!0):a<-1e-10?l<-1e-10&&(y=!0):Math.sign(s)==Math.sign(c)&&(y=!0),y?(i=-s,r=a,o=Math.sqrt(u)):(i=a,r=s,o=Math.sqrt(u/2))}return new q.Vector2(i/o,r/o)}for(var U=[],z=0,G=P.length,H=G-1,W=z+1;z<G;z++,H++,W++)H===G&&(H=0),W===G&&(W=0),U[z]=B(P[z],P[H],P[W]);var j,X,Y=[],K=U.concat();for(l=0,c=T.length;l<c;l++){for(s=T[l],j=[],z=0,H=(G=s.length)-1,W=z+1;z<G;z++,H++,W++)H===G&&(H=0),W===G&&(W=0),j[z]=B(s[z],s[H],s[W]);Y.push(j),K=K.concat(j)}for(D=0;D<f;D++){for(O=h*(1-(I=D/f)),R=d*Math.sin(I*Math.PI/2),z=0,G=P.length;z<G;z++)Q((N=L(P[z],U[z],R)).x,N.y,-O);for(l=0,c=T.length;l<c;l++)for(s=T[l],j=Y[l],z=0,G=s.length;z<G;z++)Q((N=L(s[z],j[z],R)).x,N.y,-O)}for(R=d,z=0;z<F;z++)N=p?L(M[z],K[z],R):M[z],y?(o.copy(i.normals[0]).multiplyScalar(N.x),r.copy(i.binormals[0]).multiplyScalar(N.y),a.copy(n[0]).add(o).add(r),Q(a.x,a.y,a.z)):Q(N.x,N.y,0);for(X=1;X<=g;X++)for(z=0;z<F;z++)N=p?L(M[z],K[z],R):M[z],y?(o.copy(i.normals[X]).multiplyScalar(N.x),r.copy(i.binormals[X]).multiplyScalar(N.y),a.copy(n[X]).add(o).add(r),Q(a.x,a.y,a.z)):Q(N.x,N.y,u/g*X);for(D=f-1;D>=0;D--){for(O=h*(1-(I=D/f)),R=d*Math.sin(I*Math.PI/2),z=0,G=P.length;z<G;z++)Q((N=L(P[z],U[z],R)).x,N.y,u+O);for(l=0,c=T.length;l<c;l++)for(s=T[l],j=Y[l],z=0,G=s.length;z<G;z++)N=L(s[z],j[z],R),y?Q(N.x,N.y+n[g-1].y,n[g-1].x+O):Q(N.x,N.y,u+O)}function Z(e,t){var n,i;for(z=e.length;--z>=0;){n=z,(i=z-1)<0&&(i=e.length-1);var r=0,o=g+2*f;for(r=0;r<o;r++){var a=F*r,s=F*(r+1);$(t+n+a,t+i+a,t+i+s,t+n+s,e,r,o,n,i)}}}function Q(e,t,n){w.vertices.push(new q.Vector3(e,t,n))}function J(e,t,n){e+=A,t+=A,n+=A,w.faces.push(new q.Face3(e,t,n,null,null,_));var i=x.generateTopUV(w,e,t,n);w.faceVertexUvs[0].push(i)}function $(e,t,n,i,r,o,a,s,l){e+=A,t+=A,n+=A,i+=A,w.faces.push(new q.Face3(e,t,i,null,null,b)),w.faces.push(new q.Face3(t,n,i,null,null,b));var c=x.generateSideWallUV(w,e,t,n,i);w.faceVertexUvs[0].push([c[0],c[1],c[3]]),w.faceVertexUvs[0].push([c[1],c[2],c[3]])}!function(){if(p){var e=0,t=F*e;for(z=0;z<V;z++)J((k=C[z])[2]+t,k[1]+t,k[0]+t);for(t=F*(e=g+2*f),z=0;z<V;z++)J((k=C[z])[0]+t,k[1]+t,k[2]+t)}else{for(z=0;z<V;z++)J((k=C[z])[2],k[1],k[0]);for(z=0;z<V;z++)J((k=C[z])[0]+F*g,k[1]+F*g,k[2]+F*g)}}(),function(){var e=0;for(Z(P,e),e+=P.length,l=0,c=T.length;l<c;l++)Z(s=T[l],e),e+=s.length}()},q.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,n,i){var r=e.vertices,o=r[t],a=r[n],s=r[i];return[new q.Vector2(o.x,o.y),new q.Vector2(a.x,a.y),new q.Vector2(s.x,s.y)]},generateSideWallUV:function(e,t,n,i,r){var o=e.vertices,a=o[t],s=o[n],l=o[i],c=o[r];return Math.abs(a.y-s.y)<.01?[new q.Vector2(a.x,1-a.z),new q.Vector2(s.x,1-s.z),new q.Vector2(l.x,1-l.z),new q.Vector2(c.x,1-c.z)]:[new q.Vector2(a.y,1-a.z),new q.Vector2(s.y,1-s.z),new q.Vector2(l.y,1-l.z),new q.Vector2(c.y,1-c.z)]}},q.ShapeGeometry=function(e,t){q.Geometry.call(this),this.type="ShapeGeometry",e instanceof Array==!1&&(e=[e]),this.addShapeList(e,t),this.computeFaceNormals()},q.ShapeGeometry.prototype=Object.create(q.Geometry.prototype),q.ShapeGeometry.prototype.constructor=q.ShapeGeometry,q.ShapeGeometry.prototype.addShapeList=function(e,t){for(var n=0,i=e.length;n<i;n++)this.addShape(e[n],t);return this},q.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var n,i,r,o=void 0!==t.curveSegments?t.curveSegments:12,a=t.material,s=void 0===t.UVGenerator?q.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,l=this.vertices.length,c=e.extractPoints(o),u=c.shape,h=c.holes,d=!q.Shape.Utils.isClockWise(u);if(d){for(u=u.reverse(),n=0,i=h.length;n<i;n++)r=h[n],q.Shape.Utils.isClockWise(r)&&(h[n]=r.reverse());d=!1}var f=q.Shape.Utils.triangulateShape(u,h);for(n=0,i=h.length;n<i;n++)r=h[n],u=u.concat(r);var p,m,g=u.length,v=f.length;for(n=0;n<g;n++)p=u[n],this.vertices.push(new q.Vector3(p.x,p.y,0));for(n=0;n<v;n++){var y=(m=f[n])[0]+l,_=m[1]+l,b=m[2]+l;this.faces.push(new q.Face3(y,_,b,null,null,a)),this.faceVertexUvs[0].push(s.generateTopUV(this,y,_,b))}},q.LatheGeometry=function(e,t,n,i){q.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=t||12,n=n||0,i=i||2*Math.PI;for(var r=1/(e.length-1),o=1/t,a=0,s=t;a<=s;a++)for(var l=n+a*o*i,c=Math.cos(l),u=Math.sin(l),h=0,d=e.length;h<d;h++){var f=e[h],p=new q.Vector3;p.x=c*f.x-u*f.y,p.y=u*f.x+c*f.y,p.z=f.z,this.vertices.push(p)}var m=e.length;for(a=0,s=t;a<s;a++)for(h=0,d=e.length-1;h<d;h++){var g=h+m*a,v=g,y=g+m,_=(c=g+1+m,g+1),b=a*o,x=h*r,w=b+o,A=x+r;this.faces.push(new q.Face3(v,y,_)),this.faceVertexUvs[0].push([new q.Vector2(b,x),new q.Vector2(w,x),new q.Vector2(b,A)]),this.faces.push(new q.Face3(y,c,_)),this.faceVertexUvs[0].push([new q.Vector2(w,x),new q.Vector2(w,A),new q.Vector2(b,A)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},q.LatheGeometry.prototype=Object.create(q.Geometry.prototype),q.LatheGeometry.prototype.constructor=q.LatheGeometry,q.PlaneGeometry=function(e,t,n,i){console.info("THREE.PlaneGeometry: Consider using THREE.PlaneBufferGeometry for lower memory footprint."),q.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new q.PlaneBufferGeometry(e,t,n,i))},q.PlaneGeometry.prototype=Object.create(q.Geometry.prototype),q.PlaneGeometry.prototype.constructor=q.PlaneGeometry,q.PlaneBufferGeometry=function(e,t,n,i){q.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};for(var r=e/2,o=t/2,a=n||1,s=i||1,l=a+1,c=s+1,u=e/a,h=t/s,d=new Float32Array(l*c*3),f=new Float32Array(l*c*3),p=new Float32Array(l*c*2),m=0,g=0,v=0;v<c;v++)for(var y=v*h-o,_=0;_<l;_++){var b=_*u-r;d[m]=b,d[m+1]=-y,f[m+2]=1,p[g]=_/a,p[g+1]=1-v/s,m+=3,g+=2}m=0;var x=new(d.length/3>65535?Uint32Array:Uint16Array)(a*s*6);for(v=0;v<s;v++)for(_=0;_<a;_++){var w=_+l*v,A=_+l*(v+1),E=_+1+l*(v+1),M=_+1+l*v;x[m]=w,x[m+1]=A,x[m+2]=M,x[m+3]=A,x[m+4]=E,x[m+5]=M,m+=6}this.addAttribute("index",new q.BufferAttribute(x,1)),this.addAttribute("position",new q.BufferAttribute(d,3)),this.addAttribute("normal",new q.BufferAttribute(f,3)),this.addAttribute("uv",new q.BufferAttribute(p,2))},q.PlaneBufferGeometry.prototype=Object.create(q.BufferGeometry.prototype),q.PlaneBufferGeometry.prototype.constructor=q.PlaneBufferGeometry,q.RingGeometry=function(e,t,n,i,r,o){q.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},e=e||0,t=t||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var a,s,l=[],c=e,u=(t-e)/(i=void 0!==i?Math.max(1,i):8);for(a=0;a<i+1;a++){for(s=0;s<n+1;s++){var h=new q.Vector3,d=r+s/n*o;h.x=c*Math.cos(d),h.y=c*Math.sin(d),this.vertices.push(h),l.push(new q.Vector2((h.x/t+1)/2,(h.y/t+1)/2))}c+=u}var f=new q.Vector3(0,0,1);for(a=0;a<i;a++){var p=a*(n+1);for(s=0;s<n;s++){var m=d=s+p,g=d+n+1,v=d+n+2;this.faces.push(new q.Face3(m,g,v,[f.clone(),f.clone(),f.clone()])),this.faceVertexUvs[0].push([l[m].clone(),l[g].clone(),l[v].clone()]),m=d,g=d+n+2,v=d+1,this.faces.push(new q.Face3(m,g,v,[f.clone(),f.clone(),f.clone()])),this.faceVertexUvs[0].push([l[m].clone(),l[g].clone(),l[v].clone()])}}this.computeFaceNormals(),this.boundingSphere=new q.Sphere(new q.Vector3,c)},q.RingGeometry.prototype=Object.create(q.Geometry.prototype),q.RingGeometry.prototype.constructor=q.RingGeometry,q.SphereGeometry=function(e,t,n,i,r,o,a){q.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},e=e||50,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,l,c=[],u=[];for(l=0;l<=n;l++){var h=[],d=[];for(s=0;s<=t;s++){var f=s/t,p=l/n,m=new q.Vector3;m.x=-e*Math.cos(i+f*r)*Math.sin(o+p*a),m.y=e*Math.cos(o+p*a),m.z=e*Math.sin(i+f*r)*Math.sin(o+p*a),this.vertices.push(m),h.push(this.vertices.length-1),d.push(new q.Vector2(f,1-p))}c.push(h),u.push(d)}for(l=0;l<n;l++)for(s=0;s<t;s++){var g=c[l][s+1],v=c[l][s],y=c[l+1][s],_=c[l+1][s+1],b=this.vertices[g].clone().normalize(),x=this.vertices[v].clone().normalize(),w=this.vertices[y].clone().normalize(),A=this.vertices[_].clone().normalize(),E=u[l][s+1].clone(),M=u[l][s].clone(),T=u[l+1][s].clone(),S=u[l+1][s+1].clone();Math.abs(this.vertices[g].y)===e?(E.x=(E.x+M.x)/2,this.faces.push(new q.Face3(g,y,_,[b,w,A])),this.faceVertexUvs[0].push([E,T,S])):Math.abs(this.vertices[y].y)===e?(T.x=(T.x+S.x)/2,this.faces.push(new q.Face3(g,v,y,[b,x,w])),this.faceVertexUvs[0].push([E,M,T])):(this.faces.push(new q.Face3(g,v,_,[b,x,A])),this.faceVertexUvs[0].push([E,M,S]),this.faces.push(new q.Face3(v,y,_,[x.clone(),w,A.clone()])),this.faceVertexUvs[0].push([M.clone(),T,S.clone()]))}this.computeFaceNormals(),this.boundingSphere=new q.Sphere(new q.Vector3,e)},q.SphereGeometry.prototype=Object.create(q.Geometry.prototype),q.SphereGeometry.prototype.constructor=q.SphereGeometry,q.TextGeometry=function(e,t){t=t||{};var n=q.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),q.ExtrudeGeometry.call(this,n,t),this.type="TextGeometry"},q.TextGeometry.prototype=Object.create(q.ExtrudeGeometry.prototype),q.TextGeometry.prototype.constructor=q.TextGeometry,q.TorusGeometry=function(e,t,n,i,r){q.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||100,t=t||40,n=n||8,i=i||6,r=r||2*Math.PI;for(var o=new q.Vector3,a=[],s=[],l=0;l<=n;l++)for(var c=0;c<=i;c++){var u=c/i*r,h=l/n*Math.PI*2;o.x=e*Math.cos(u),o.y=e*Math.sin(u);var d=new q.Vector3;d.x=(e+t*Math.cos(h))*Math.cos(u),d.y=(e+t*Math.cos(h))*Math.sin(u),d.z=t*Math.sin(h),this.vertices.push(d),a.push(new q.Vector2(c/i,l/n)),s.push(d.clone().sub(o).normalize())}for(l=1;l<=n;l++)for(c=1;c<=i;c++){var f=(i+1)*l+c-1,p=(i+1)*(l-1)+c-1,m=(i+1)*(l-1)+c,g=(i+1)*l+c,v=new q.Face3(f,p,g,[s[f].clone(),s[p].clone(),s[g].clone()]);this.faces.push(v),this.faceVertexUvs[0].push([a[f].clone(),a[p].clone(),a[g].clone()]),v=new q.Face3(p,m,g,[s[p].clone(),s[m].clone(),s[g].clone()]),this.faces.push(v),this.faceVertexUvs[0].push([a[p].clone(),a[m].clone(),a[g].clone()])}this.computeFaceNormals()},q.TorusGeometry.prototype=Object.create(q.Geometry.prototype),q.TorusGeometry.prototype.constructor=q.TorusGeometry,q.TorusKnotGeometry=function(e,t,n,i,r,o,a){q.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,p:r,q:o,heightScale:a},e=e||100,t=t||40,n=n||64,i=i||8,r=r||2,o=o||3,a=a||1;for(var s=new Array(n),l=new q.Vector3,c=new q.Vector3,u=new q.Vector3,h=0;h<n;++h){s[h]=new Array(i);var d=h/n*2*r*Math.PI,f=L(d,o,r,e,a),p=L(d+.01,o,r,e,a);l.subVectors(p,f),c.addVectors(p,f),u.crossVectors(l,c),c.crossVectors(u,l),u.normalize(),c.normalize();for(var m=0;m<i;++m){var g=m/i*2*Math.PI,v=-t*Math.cos(g),y=t*Math.sin(g),_=new q.Vector3;_.x=f.x+v*c.x+y*u.x,_.y=f.y+v*c.y+y*u.y,_.z=f.z+v*c.z+y*u.z,s[h][m]=this.vertices.push(_)-1}}for(h=0;h<n;++h)for(m=0;m<i;++m){var b=(h+1)%n,x=(m+1)%i,w=s[h][m],A=s[b][m],E=s[b][x],M=s[h][x],T=new q.Vector2(h/n,m/i),S=new q.Vector2((h+1)/n,m/i),C=new q.Vector2((h+1)/n,(m+1)/i),P=new q.Vector2(h/n,(m+1)/i);this.faces.push(new q.Face3(w,A,M)),this.faceVertexUvs[0].push([T,S,P]),this.faces.push(new q.Face3(A,E,M)),this.faceVertexUvs[0].push([S.clone(),C,P.clone()])}function L(e,t,n,i,r){var o=Math.cos(e),a=Math.sin(e),s=t/n*e,l=Math.cos(s),c=i*(2+l)*.5*o,u=i*(2+l)*a*.5,h=r*i*Math.sin(s)*.5;return new q.Vector3(c,u,h)}this.computeFaceNormals(),this.computeVertexNormals()},q.TorusKnotGeometry.prototype=Object.create(q.Geometry.prototype),q.TorusKnotGeometry.prototype.constructor=q.TorusKnotGeometry,q.TubeGeometry=function(e,t,n,i,r,o){q.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:e,segments:t,radius:n,radialSegments:i,closed:r},t=t||64,n=n||1,i=i||8,r=r||!1,o=o||q.TubeGeometry.NoTaper;var a,s,l,c,u,h,d,f,p,m,g,v,y,_,b,x,w,A,E,M,T=[],S=this,C=t+1,P=new q.Vector3,L=new q.TubeGeometry.FrenetFrames(e,t,r),D=L.tangents,R=L.normals,I=L.binormals;function O(e,t,n){return S.vertices.push(new q.Vector3(e,t,n))-1}for(this.tangents=D,this.normals=R,this.binormals=I,p=0;p<C;p++)for(T[p]=[],l=p/(C-1),f=e.getPointAt(l),D[p],a=R[p],s=I[p],u=n*o(l),m=0;m<i;m++)c=m/i*2*Math.PI,h=-u*Math.cos(c),d=u*Math.sin(c),P.copy(f),P.x+=h*a.x+d*s.x,P.y+=h*a.y+d*s.y,P.z+=h*a.z+d*s.z,T[p][m]=O(P.x,P.y,P.z);for(p=0;p<t;p++)for(m=0;m<i;m++)g=r?(p+1)%t:p+1,v=(m+1)%i,y=T[p][m],_=T[g][m],b=T[g][v],x=T[p][v],w=new q.Vector2(p/t,m/i),A=new q.Vector2((p+1)/t,m/i),E=new q.Vector2((p+1)/t,(m+1)/i),M=new q.Vector2(p/t,(m+1)/i),this.faces.push(new q.Face3(y,_,x)),this.faceVertexUvs[0].push([w,A,M]),this.faces.push(new q.Face3(_,b,x)),this.faceVertexUvs[0].push([A.clone(),E,M.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},q.TubeGeometry.prototype=Object.create(q.Geometry.prototype),q.TubeGeometry.prototype.constructor=q.TubeGeometry,q.TubeGeometry.NoTaper=function(e){return 1},q.TubeGeometry.SinusoidalTaper=function(e){return Math.sin(Math.PI*e)},q.TubeGeometry.FrenetFrames=function(e,t,n){var i,r,o,a,s,l,c,u=new q.Vector3,h=[],d=[],f=[],p=new q.Vector3,m=new q.Matrix4,g=t+1;for(this.tangents=h,this.normals=d,this.binormals=f,l=0;l<g;l++)c=l/(g-1),h[l]=e.getTangentAt(c),h[l].normalize();for(function(){d[0]=new q.Vector3,f[0]=new q.Vector3,r=Number.MAX_VALUE,o=Math.abs(h[0].x),a=Math.abs(h[0].y),s=Math.abs(h[0].z),o<=r&&(r=o,u.set(1,0,0));a<=r&&(r=a,u.set(0,1,0));s<=r&&u.set(0,0,1);p.crossVectors(h[0],u).normalize(),d[0].crossVectors(h[0],p),f[0].crossVectors(h[0],d[0])}(),l=1;l<g;l++)d[l]=d[l-1].clone(),f[l]=f[l-1].clone(),p.crossVectors(h[l-1],h[l]),p.length()>1e-4&&(p.normalize(),i=Math.acos(q.Math.clamp(h[l-1].dot(h[l]),-1,1)),d[l].applyMatrix4(m.makeRotationAxis(p,i))),f[l].crossVectors(h[l],d[l]);if(n)for(i=Math.acos(q.Math.clamp(d[0].dot(d[g-1]),-1,1)),i/=g-1,h[0].dot(p.crossVectors(d[0],d[g-1]))>0&&(i=-i),l=1;l<g;l++)d[l].applyMatrix4(m.makeRotationAxis(h[l],i*l)),f[l].crossVectors(h[l],d[l])},q.PolyhedronGeometry=function(e,t,n,i){q.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1,i=i||0;for(var r=this,o=0,a=e.length;o<a;o+=3)b(new q.Vector3(e[o],e[o+1],e[o+2]));var s=this.vertices,l=[],c=(o=0,0);for(a=t.length;o<a;o+=3,c++){var u=s[t[o]],h=s[t[o+1]],d=s[t[o+2]];l[c]=new q.Face3(u.index,h.index,d.index,[u.clone(),h.clone(),d.clone()])}var f=new q.Vector3;for(o=0,a=l.length;o<a;o++)w(l[o],i);for(o=0,a=this.faceVertexUvs[0].length;o<a;o++){var p=this.faceVertexUvs[0][o],m=p[0].x,g=p[1].x,v=p[2].x,y=Math.max(m,Math.max(g,v)),_=Math.min(m,Math.min(g,v));y>.9&&_<.1&&(m<.2&&(p[0].x+=1),g<.2&&(p[1].x+=1),v<.2&&(p[2].x+=1))}for(o=0,a=this.vertices.length;o<a;o++)this.vertices[o].multiplyScalar(n);function b(e){var t=e.normalize().clone();t.index=r.vertices.push(t)-1;var n=A(e)/2/Math.PI+.5,i=function(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(e)/Math.PI+.5;return t.uv=new q.Vector2(n,1-i),t}function x(e,t,n){var i=new q.Face3(e.index,t.index,n.index,[e.clone(),t.clone(),n.clone()]);r.faces.push(i),f.copy(e).add(t).add(n).divideScalar(3);var o=A(f);r.faceVertexUvs[0].push([E(e.uv,e,o),E(t.uv,t,o),E(n.uv,n,o)])}function w(e,t){for(var n=Math.pow(2,t),i=b(r.vertices[e.a]),o=b(r.vertices[e.b]),a=b(r.vertices[e.c]),s=[],l=0;l<=n;l++){s[l]=[];for(var c=b(i.clone().lerp(a,l/n)),u=b(o.clone().lerp(a,l/n)),h=n-l,d=0;d<=h;d++)s[l][d]=0==d&&l==n?c:b(c.clone().lerp(u,d/h))}for(l=0;l<n;l++)for(d=0;d<2*(n-l)-1;d++){var f=Math.floor(d/2);d%2==0?x(s[l][f+1],s[l+1][f],s[l][f]):x(s[l][f+1],s[l+1][f+1],s[l+1][f])}}function A(e){return Math.atan2(e.z,-e.x)}function E(e,t,n){return n<0&&1===e.x&&(e=new q.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new q.Vector2(n/2/Math.PI+.5,e.y)),e.clone()}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new q.Sphere(new q.Vector3,n)},q.PolyhedronGeometry.prototype=Object.create(q.Geometry.prototype),q.PolyhedronGeometry.prototype.constructor=q.PolyhedronGeometry,q.DodecahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i];q.PolyhedronGeometry.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t)},q.DodecahedronGeometry.prototype=Object.create(q.Geometry.prototype),q.DodecahedronGeometry.prototype.constructor=q.DodecahedronGeometry,q.IcosahedronGeometry=function(e,t){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];q.PolyhedronGeometry.call(this,i,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}},q.IcosahedronGeometry.prototype=Object.create(q.Geometry.prototype),q.IcosahedronGeometry.prototype.constructor=q.IcosahedronGeometry,q.OctahedronGeometry=function(e,t){this.parameters={radius:e,detail:t};q.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},q.OctahedronGeometry.prototype=Object.create(q.Geometry.prototype),q.OctahedronGeometry.prototype.constructor=q.OctahedronGeometry,q.TetrahedronGeometry=function(e,t){q.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}},q.TetrahedronGeometry.prototype=Object.create(q.Geometry.prototype),q.TetrahedronGeometry.prototype.constructor=q.TetrahedronGeometry,q.ParametricGeometry=function(e,t,n){q.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var i,r,o,a,s,l,c,u,h,d,f,p,m=this.vertices,g=this.faces,v=this.faceVertexUvs[0],y=t+1;for(i=0;i<=n;i++)for(a=i/n,r=0;r<=t;r++)o=e(r/t,a),m.push(o);for(i=0;i<n;i++)for(r=0;r<t;r++)s=i*y+r,l=i*y+r+1,c=(i+1)*y+r+1,u=(i+1)*y+r,h=new q.Vector2(r/t,i/n),d=new q.Vector2((r+1)/t,i/n),f=new q.Vector2((r+1)/t,(i+1)/n),p=new q.Vector2(r/t,(i+1)/n),g.push(new q.Face3(s,l,u)),v.push([h,d,p]),g.push(new q.Face3(l,c,u)),v.push([d.clone(),f,p.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},q.ParametricGeometry.prototype=Object.create(q.Geometry.prototype),q.ParametricGeometry.prototype.constructor=q.ParametricGeometry,q.AxisHelper=function(e){e=e||1;var t=new Float32Array([0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),i=new q.BufferGeometry;i.addAttribute("position",new q.BufferAttribute(t,3)),i.addAttribute("color",new q.BufferAttribute(n,3));var r=new q.LineBasicMaterial({vertexColors:q.VertexColors});q.Line.call(this,i,r,q.LinePieces)},q.AxisHelper.prototype=Object.create(q.Line.prototype),q.AxisHelper.prototype.constructor=q.AxisHelper,q.ArrowHelper=function(){var e=new q.Geometry;e.vertices.push(new q.Vector3(0,0,0),new q.Vector3(0,1,0));var t=new q.CylinderGeometry(0,.5,1,5,1);return t.applyMatrix((new q.Matrix4).makeTranslation(0,-.5,0)),function(n,i,r,o,a,s){q.Object3D.call(this),void 0===o&&(o=16776960),void 0===r&&(r=1),void 0===a&&(a=.2*r),void 0===s&&(s=.2*a),this.position.copy(i),this.line=new q.Line(e,new q.LineBasicMaterial({color:o})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new q.Mesh(t,new q.MeshBasicMaterial({color:o})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(n),this.setLength(r,a,s)}}(),q.ArrowHelper.prototype=Object.create(q.Object3D.prototype),q.ArrowHelper.prototype.constructor=q.ArrowHelper,q.ArrowHelper.prototype.setDirection=(X=new q.Vector3,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(X.set(e.z,0,-e.x).normalize(),j=Math.acos(e.y),this.quaternion.setFromAxisAngle(X,j))}),q.ArrowHelper.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,e-t,1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},q.ArrowHelper.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},q.BoxHelper=function(e){var t=new q.BufferGeometry;t.addAttribute("position",new q.BufferAttribute(new Float32Array(72),3)),q.Line.call(this,t,new q.LineBasicMaterial({color:16776960}),q.LinePieces),void 0!==e&&this.update(e)},q.BoxHelper.prototype=Object.create(q.Line.prototype),q.BoxHelper.prototype.constructor=q.BoxHelper,q.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var n=t.boundingBox.min,i=t.boundingBox.max,r=this.geometry.attributes.position.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=n.x,r[4]=i.y,r[5]=i.z,r[6]=n.x,r[7]=i.y,r[8]=i.z,r[9]=n.x,r[10]=n.y,r[11]=i.z,r[12]=n.x,r[13]=n.y,r[14]=i.z,r[15]=i.x,r[16]=n.y,r[17]=i.z,r[18]=i.x,r[19]=n.y,r[20]=i.z,r[21]=i.x,r[22]=i.y,r[23]=i.z,r[24]=i.x,r[25]=i.y,r[26]=n.z,r[27]=n.x,r[28]=i.y,r[29]=n.z,r[30]=n.x,r[31]=i.y,r[32]=n.z,r[33]=n.x,r[34]=n.y,r[35]=n.z,r[36]=n.x,r[37]=n.y,r[38]=n.z,r[39]=i.x,r[40]=n.y,r[41]=n.z,r[42]=i.x,r[43]=n.y,r[44]=n.z,r[45]=i.x,r[46]=i.y,r[47]=n.z,r[48]=i.x,r[49]=i.y,r[50]=i.z,r[51]=i.x,r[52]=i.y,r[53]=n.z,r[54]=n.x,r[55]=i.y,r[56]=i.z,r[57]=n.x,r[58]=i.y,r[59]=n.z,r[60]=n.x,r[61]=n.y,r[62]=i.z,r[63]=n.x,r[64]=n.y,r[65]=n.z,r[66]=i.x,r[67]=n.y,r[68]=i.z,r[69]=i.x,r[70]=n.y,r[71]=n.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},q.BoundingBoxHelper=function(e,t){var n=void 0!==t?t:8947848;this.object=e,this.box=new q.Box3,q.Mesh.call(this,new q.BoxGeometry(1,1,1),new q.MeshBasicMaterial({color:n,wireframe:!0}))},q.BoundingBoxHelper.prototype=Object.create(q.Mesh.prototype),q.BoundingBoxHelper.prototype.constructor=q.BoundingBoxHelper,q.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},q.CameraHelper=function(e){var t=new q.Geometry,n=new q.LineBasicMaterial({color:16777215,vertexColors:q.FaceColors}),i={};function r(e,t,n){o(e,n),o(t,n)}function o(e,n){t.vertices.push(new q.Vector3),t.colors.push(new q.Color(n)),void 0===i[e]&&(i[e]=[]),i[e].push(t.vertices.length-1)}r("n1","n2",16755200),r("n2","n4",16755200),r("n4","n3",16755200),r("n3","n1",16755200),r("f1","f2",16755200),r("f2","f4",16755200),r("f4","f3",16755200),r("f3","f1",16755200),r("n1","f1",16755200),r("n2","f2",16755200),r("n3","f3",16755200),r("n4","f4",16755200),r("p","n1",16711680),r("p","n2",16711680),r("p","n3",16711680),r("p","n4",16711680),r("u1","u2",43775),r("u2","u3",43775),r("u3","u1",43775),r("c","t",16777215),r("p","c",3355443),r("cn1","cn2",3355443),r("cn3","cn4",3355443),r("cf1","cf2",3355443),r("cf3","cf4",3355443),q.Line.call(this,t,n,q.LinePieces),this.camera=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=i,this.update()},q.CameraHelper.prototype=Object.create(q.Line.prototype),q.CameraHelper.prototype.constructor=q.CameraHelper,q.CameraHelper.prototype.update=function(){var e,t,n=new q.Vector3,i=new q.Camera,r=function(r,o,a,s){n.set(o,a,s).unproject(i);var l=t[r];if(void 0!==l)for(var c=0,u=l.length;c<u;c++)e.vertices[l[c]].copy(n)};return function(){e=this.geometry,t=this.pointMap;i.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),e.verticesNeedUpdate=!0}}(),q.DirectionalLightHelper=function(e,t){q.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,t=t||1;var n=new q.Geometry;n.vertices.push(new q.Vector3(-t,t,0),new q.Vector3(t,t,0),new q.Vector3(t,-t,0),new q.Vector3(-t,-t,0),new q.Vector3(-t,t,0));var i=new q.LineBasicMaterial({fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new q.Line(n,i),this.add(this.lightPlane),(n=new q.Geometry).vertices.push(new q.Vector3,new q.Vector3),(i=new q.LineBasicMaterial({fog:!1})).color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new q.Line(n,i),this.add(this.targetLine),this.update()},q.DirectionalLightHelper.prototype=Object.create(q.Object3D.prototype),q.DirectionalLightHelper.prototype.constructor=q.DirectionalLightHelper,q.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},q.DirectionalLightHelper.prototype.update=function(){var e=new q.Vector3,t=new q.Vector3,n=new q.Vector3;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(t,e),this.lightPlane.lookAt(n),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(n),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),q.EdgesHelper=function(e,t,n){var i=void 0!==t?t:16777215;n=void 0!==n?n:1;var r,o=Math.cos(q.Math.degToRad(n)),a=[0,0],s={},l=function(e,t){return e-t},c=["a","b","c"],u=new q.BufferGeometry;e.geometry instanceof q.BufferGeometry?(r=new q.Geometry).fromBufferGeometry(e.geometry):r=e.geometry.clone(),r.mergeVertices(),r.computeFaceNormals();for(var h=r.vertices,d=r.faces,f=0,p=0,m=d.length;p<m;p++)for(var g=d[p],v=0;v<3;v++){a[0]=g[c[v]],a[1]=g[c[(v+1)%3]],a.sort(l),void 0===s[b=a.toString()]?(s[b]={vert1:a[0],vert2:a[1],face1:p,face2:void 0},f++):s[b].face2=p}var y=new Float32Array(2*f*3),_=0;for(var b in s){var x=s[b];if(void 0===x.face2||d[x.face1].normal.dot(d[x.face2].normal)<=o){var w=h[x.vert1];y[_++]=w.x,y[_++]=w.y,y[_++]=w.z,w=h[x.vert2],y[_++]=w.x,y[_++]=w.y,y[_++]=w.z}}u.addAttribute("position",new q.BufferAttribute(y,3)),q.Line.call(this,u,new q.LineBasicMaterial({color:i}),q.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},q.EdgesHelper.prototype=Object.create(q.Line.prototype),q.EdgesHelper.prototype.constructor=q.EdgesHelper,q.FaceNormalsHelper=function(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;for(var r=void 0!==n?n:16776960,o=void 0!==i?i:1,a=new q.Geometry,s=0,l=this.object.geometry.faces.length;s<l;s++)a.vertices.push(new q.Vector3,new q.Vector3);q.Line.call(this,a,new q.LineBasicMaterial({color:r,linewidth:o}),q.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new q.Matrix3,this.update()},q.FaceNormalsHelper.prototype=Object.create(q.Line.prototype),q.FaceNormalsHelper.prototype.constructor=q.FaceNormalsHelper,q.FaceNormalsHelper.prototype.update=function(){var e=this.geometry.vertices,t=this.object,n=t.geometry.vertices,i=t.geometry.faces,r=t.matrixWorld;t.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(r);for(var o=0,a=0,s=i.length;o<s;o++,a+=2){var l=i[o];e[a].copy(n[l.a]).add(n[l.b]).add(n[l.c]).divideScalar(3).applyMatrix4(r),e[a+1].copy(l.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(e[a])}return this.geometry.verticesNeedUpdate=!0,this},q.GridHelper=function(e,t){var n=new q.Geometry,i=new q.LineBasicMaterial({vertexColors:q.VertexColors});this.color1=new q.Color(4473924),this.color2=new q.Color(8947848);for(var r=-e;r<=e;r+=t){n.vertices.push(new q.Vector3(-e,0,r),new q.Vector3(e,0,r),new q.Vector3(r,0,-e),new q.Vector3(r,0,e));var o=0===r?this.color1:this.color2;n.colors.push(o,o,o,o)}q.Line.call(this,n,i,q.LinePieces)},q.GridHelper.prototype=Object.create(q.Line.prototype),q.GridHelper.prototype.constructor=q.GridHelper,q.GridHelper.prototype.setColors=function(e,t){this.color1.set(e),this.color2.set(t),this.geometry.colorsNeedUpdate=!0},q.HemisphereLightHelper=function(e,t){q.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new q.Color,new q.Color];var n=new q.SphereGeometry(t,4,2);n.applyMatrix((new q.Matrix4).makeRotationX(-Math.PI/2));for(var i=0;i<8;i++)n.faces[i].color=this.colors[i<4?0:1];var r=new q.MeshBasicMaterial({vertexColors:q.FaceColors,wireframe:!0});this.lightSphere=new q.Mesh(n,r),this.add(this.lightSphere),this.update()},q.HemisphereLightHelper.prototype=Object.create(q.Object3D.prototype),q.HemisphereLightHelper.prototype.constructor=q.HemisphereLightHelper,q.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},q.HemisphereLightHelper.prototype.update=function(){var e=new q.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),q.PointLightHelper=function(e,t){this.light=e,this.light.updateMatrixWorld();var n=new q.SphereGeometry(t,4,2),i=new q.MeshBasicMaterial({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),q.Mesh.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},q.PointLightHelper.prototype=Object.create(q.Mesh.prototype),q.PointLightHelper.prototype.constructor=q.PointLightHelper,q.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},q.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},q.SkeletonHelper=function(e){this.bones=this.getBoneList(e);for(var t=new q.Geometry,n=0;n<this.bones.length;n++){this.bones[n].parent instanceof q.Bone&&(t.vertices.push(new q.Vector3),t.vertices.push(new q.Vector3),t.colors.push(new q.Color(0,0,1)),t.colors.push(new q.Color(0,1,0)))}var i=new q.LineBasicMaterial({vertexColors:q.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});q.Line.call(this,t,i,q.LinePieces),this.root=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.update()},q.SkeletonHelper.prototype=Object.create(q.Line.prototype),q.SkeletonHelper.prototype.constructor=q.SkeletonHelper,q.SkeletonHelper.prototype.getBoneList=function(e){var t=[];e instanceof q.Bone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,this.getBoneList(e.children[n]));return t},q.SkeletonHelper.prototype.update=function(){for(var e=this.geometry,t=(new q.Matrix4).getInverse(this.root.matrixWorld),n=new q.Matrix4,i=0,r=0;r<this.bones.length;r++){var o=this.bones[r];o.parent instanceof q.Bone&&(n.multiplyMatrices(t,o.matrixWorld),e.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(t,o.parent.matrixWorld),e.vertices[i+1].setFromMatrixPosition(n),i+=2)}e.verticesNeedUpdate=!0,e.computeBoundingSphere()},q.SpotLightHelper=function(e){q.Object3D.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;var t=new q.CylinderGeometry(0,1,1,8,1,!0);t.applyMatrix((new q.Matrix4).makeTranslation(0,-.5,0)),t.applyMatrix((new q.Matrix4).makeRotationX(-Math.PI/2));var n=new q.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new q.Mesh(t,n),this.add(this.cone),this.update()},q.SpotLightHelper.prototype=Object.create(q.Object3D.prototype),q.SpotLightHelper.prototype.constructor=q.SpotLightHelper,q.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},q.SpotLightHelper.prototype.update=function(){var e=new q.Vector3,t=new q.Vector3;return function(){var n=this.light.distance?this.light.distance:1e4,i=n*Math.tan(this.light.angle);this.cone.scale.set(i,i,n),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),q.VertexNormalsHelper=function(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;for(var r=void 0!==n?n:16711680,o=void 0!==i?i:1,a=new q.Geometry,s=e.geometry.faces,l=0,c=s.length;l<c;l++)for(var u=0,h=s[l].vertexNormals.length;u<h;u++)a.vertices.push(new q.Vector3,new q.Vector3);q.Line.call(this,a,new q.LineBasicMaterial({color:r,linewidth:o}),q.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new q.Matrix3,this.update()},q.VertexNormalsHelper.prototype=Object.create(q.Line.prototype),q.VertexNormalsHelper.prototype.constructor=q.VertexNormalsHelper,q.VertexNormalsHelper.prototype.update=function(e){var t=new q.Vector3;return function(e){var n=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var i=this.geometry.vertices,r=this.object.geometry.vertices,o=this.object.geometry.faces,a=this.object.matrixWorld,s=0,l=0,c=o.length;l<c;l++)for(var u=o[l],h=0,d=u.vertexNormals.length;h<d;h++){var f=r[u[n[h]]],p=u.vertexNormals[h];i[s].copy(f).applyMatrix4(a),t.copy(p).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),t.add(i[s]),i[s+=1].copy(t),s+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),q.VertexTangentsHelper=function(e,t,n,i){this.object=e,this.size=void 0!==t?t:1;for(var r=void 0!==n?n:255,o=void 0!==i?i:1,a=new q.Geometry,s=e.geometry.faces,l=0,c=s.length;l<c;l++)for(var u=0,h=s[l].vertexTangents.length;u<h;u++)a.vertices.push(new q.Vector3),a.vertices.push(new q.Vector3);q.Line.call(this,a,new q.LineBasicMaterial({color:r,linewidth:o}),q.LinePieces),this.matrixAutoUpdate=!1,this.update()},q.VertexTangentsHelper.prototype=Object.create(q.Line.prototype),q.VertexTangentsHelper.prototype.constructor=q.VertexTangentsHelper,q.VertexTangentsHelper.prototype.update=function(e){var t=new q.Vector3;return function(e){var n=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var i=this.geometry.vertices,r=this.object.geometry.vertices,o=this.object.geometry.faces,a=this.object.matrixWorld,s=0,l=0,c=o.length;l<c;l++)for(var u=o[l],h=0,d=u.vertexTangents.length;h<d;h++){var f=r[u[n[h]]],p=u.vertexTangents[h];i[s].copy(f).applyMatrix4(a),t.copy(p).transformDirection(a).multiplyScalar(this.size),t.add(i[s]),i[s+=1].copy(t),s+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),q.WireframeHelper=function(e,t){var n=void 0!==t?t:16777215,i=[0,0],r={},o=function(e,t){return e-t},a=["a","b","c"],s=new q.BufferGeometry;if(e.geometry instanceof q.Geometry){for(var l=e.geometry.vertices,c=e.geometry.faces,u=0,h=new Uint32Array(6*c.length),d=0,f=c.length;d<f;d++)for(var p=c[d],m=0;m<3;m++){i[0]=p[a[m]],i[1]=p[a[(m+1)%3]],i.sort(o),void 0===r[T=i.toString()]&&(h[2*u]=i[0],h[2*u+1]=i[1],r[T]=!0,u++)}var g=new Float32Array(2*u*3);for(d=0,f=u;d<f;d++)for(m=0;m<2;m++){var v=l[h[2*d+m]];g[(E=6*d+3*m)+0]=v.x,g[E+1]=v.y,g[E+2]=v.z}s.addAttribute("position",new q.BufferAttribute(g,3))}else if(e.geometry instanceof q.BufferGeometry)if(void 0!==e.geometry.attributes.index){l=e.geometry.attributes.position.array;var y=e.geometry.attributes.index.array,_=e.geometry.drawcalls;u=0;0===_.length&&(_=[{count:y.length,index:0,start:0}]);h=new Uint32Array(2*y.length);for(var b=0,x=_.length;b<x;++b)for(var w=_[b].start,A=_[b].count,E=_[b].index,M=(d=w,w+A);d<M;d+=3)for(m=0;m<3;m++){var T;i[0]=E+y[d+m],i[1]=E+y[d+(m+1)%3],i.sort(o),void 0===r[T=i.toString()]&&(h[2*u]=i[0],h[2*u+1]=i[1],r[T]=!0,u++)}for(g=new Float32Array(2*u*3),d=0,f=u;d<f;d++)for(m=0;m<2;m++){E=6*d+3*m;var S=3*h[2*d+m];g[E+0]=l[S],g[E+1]=l[S+1],g[E+2]=l[S+2]}s.addAttribute("position",new q.BufferAttribute(g,3))}else{var C=(u=(l=e.geometry.attributes.position.array).length/3)/3;for(g=new Float32Array(2*u*3),d=0,f=C;d<f;d++)for(m=0;m<3;m++){var P=9*d+3*m;g[(E=18*d+6*m)+0]=l[P],g[E+1]=l[P+1],g[E+2]=l[P+2];S=9*d+(m+1)%3*3;g[E+3]=l[S],g[E+4]=l[S+1],g[E+5]=l[S+2]}s.addAttribute("position",new q.BufferAttribute(g,3))}q.Line.call(this,s,new q.LineBasicMaterial({color:n}),q.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1},q.WireframeHelper.prototype=Object.create(q.Line.prototype),q.WireframeHelper.prototype.constructor=q.WireframeHelper,q.ImmediateRenderObject=function(){q.Object3D.call(this),this.render=function(e){}},q.ImmediateRenderObject.prototype=Object.create(q.Object3D.prototype),q.ImmediateRenderObject.prototype.constructor=q.ImmediateRenderObject,q.MorphBlendMesh=function(e,t){q.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i=n-1,r=n/1;this.createAnimation("__default",0,i,r),this.setAnimationWeight("__default",1)},q.MorphBlendMesh.prototype=Object.create(q.Mesh.prototype),q.MorphBlendMesh.prototype.constructor=q.MorphBlendMesh,q.MorphBlendMesh.prototype.createAnimation=function(e,t,n,i){var r={startFrame:t,endFrame:n,length:n-t+1,fps:i,duration:(n-t)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=r,this.animationsList.push(r)},q.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t,n=/([a-z]+)_?(\d+)/,i={},r=this.geometry,o=0,a=r.morphTargets.length;o<a;o++){var s=r.morphTargets[o].name.match(n);if(s&&s.length>1)i[l=s[1]]||(i[l]={start:1/0,end:-1/0}),o<(c=i[l]).start&&(c.start=o),o>c.end&&(c.end=o),t||(t=l)}for(var l in i){var c=i[l];this.createAnimation(l,c.start,c.end,e)}this.firstAnimation=t},q.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){var t=this.animationsMap[e];t&&(t.direction=1,t.directionBackwards=!1)},q.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){var t=this.animationsMap[e];t&&(t.direction=-1,t.directionBackwards=!0)},q.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var n=this.animationsMap[e];n&&(n.fps=t,n.duration=(n.end-n.start)/n.fps)},q.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var n=this.animationsMap[e];n&&(n.duration=t,n.fps=(n.end-n.start)/n.duration)},q.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var n=this.animationsMap[e];n&&(n.weight=t)},q.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var n=this.animationsMap[e];n&&(n.time=t)},q.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0,n=this.animationsMap[e];return n&&(t=n.time),t},q.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1,n=this.animationsMap[e];return n&&(t=n.duration),t},q.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):q.warn("THREE.MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},q.MorphBlendMesh.prototype.stopAnimation=function(e){var t=this.animationsMap[e];t&&(t.active=!1)},q.MorphBlendMesh.prototype.update=function(e){for(var t=0,n=this.animationsList.length;t<n;t++){var i=this.animationsList[t];if(i.active){var r=i.duration/i.length;i.time+=i.direction*e,i.mirroredLoop?(i.time>i.duration||i.time<0)&&(i.direction*=-1,i.time>i.duration&&(i.time=i.duration,i.directionBackwards=!0),i.time<0&&(i.time=0,i.directionBackwards=!1)):(i.time=i.time%i.duration,i.time<0&&(i.time+=i.duration));var o=i.startFrame+q.Math.clamp(Math.floor(i.time/r),0,i.length-1),a=i.weight;o!==i.currentFrame&&(this.morphTargetInfluences[i.lastFrame]=0,this.morphTargetInfluences[i.currentFrame]=1*a,this.morphTargetInfluences[o]=0,i.lastFrame=i.currentFrame,i.currentFrame=o);var s=i.time%r/r;i.directionBackwards&&(s=1-s),this.morphTargetInfluences[i.currentFrame]=s*a,this.morphTargetInfluences[i.lastFrame]=(1-s)*a}}}}).call(this,n(363)(e))},function(e,t,n){"use strict";n.r(t),n.d(t,"LogLevels",(function(){return s})),n.d(t,"Logger",(function(){return l})),n.d(t,"logger",(function(){return h})),n.d(t,"setLogger",(function(){return d}));var i=n(2),r=n(6),o=Object(i.getGlobal)(),a=o,s={DEBUG:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0};function l(){this.runtimeStats={},this.level=-1,this.setLevel(s.ERROR),this._reportError=this._reportError.bind(this)}function c(){return"undefined"!=typeof window?encodeURI(a.location.href):""}function u(){}l.prototype.initialize=function(e){if(e.eventCallback&&(this.callback=e.eventCallback),this.sessionId=e.sessionId,!this.sessionId){var t=Date.now()+"";this.sessionId=parseFloat((1e4*Math.random()|0)+""+t.substring(4))}"number"==typeof e.logLevel&&this.setLevel(e.logLevel),this.environmentInfo={touch:Object(i.isTouchDevice)(),env:Object(r.getEnv)(),referer:c(),version:o.LMV_VIEWER_VERSION,build_type:o.LMV_BUILD_TYPE};var n={category:"viewer_start",touch:this.environmentInfo.touch,env:this.environmentInfo.env,referer:this.environmentInfo.referer,version:this.environmentInfo.version,build_type:this.environmentInfo.build_type};this.track(n);var a=this;this.interval=setInterval((function(){a.reportRuntimeStats()}),6e4)},l.prototype.shutdown=function(){clearInterval(this.interval),this.interval=void 0},l.prototype.track=function(e){this.updateRuntimeStats(e),!Object(r.isOffline)()&&this.sessionId&&this.callback&&(e.timestamp=Date.now(),e.sessionId=this.sessionId,this.callback(e))},l.prototype.updateRuntimeStats=function(e){if(e.hasOwnProperty("aggregate"))switch(e.aggregate){case"count":this.runtimeStats[e.name]>0?this.runtimeStats[e.name]++:this.runtimeStats[e.name]=1,this.runtimeStats._nonempty=!0;break;case"last":this.runtimeStats[e.name]=e.value,this.runtimeStats._nonempty=!0;break;default:this.warn("unknown log aggregate type")}},l.prototype.reportRuntimeStats=function(){this.runtimeStats._nonempty&&(delete this.runtimeStats._nonempty,this.runtimeStats.category="misc_stats",this.track(this.runtimeStats),this.runtimeStats={})},l.prototype.setLevel=function(e){this.level!==e&&(this.level=e,this.debug=e>=s.DEBUG?console.log:u,this.log=e>=s.LOG?console.log:u,this.info=e>=s.INFO?console.info:u,this.warn=e>=s.WARNING?console.warn:u,this.error=e>=s.ERROR?this._reportError:u)},l.prototype._reportError=function(){if(this.callback){var e=Array.prototype.slice.call(arguments).join(" ");this.callback({category:"error",message:e})}console.error.apply(console,arguments)};var h=new l;function d(e){h=e}},function(e,t,n){"use strict";n.r(t),function(e){function i(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:e}n.d(t,"getGlobal",(function(){return i})),n.d(t,"isBrowser",(function(){return a})),n.d(t,"isNodeJS",(function(){return s})),n.d(t,"isIE11",(function(){return l})),n.d(t,"launchFullscreen",(function(){return c})),n.d(t,"exitFullscreen",(function(){return u})),n.d(t,"inFullscreen",(function(){return h})),n.d(t,"fullscreenElement",(function(){return d})),n.d(t,"isFullscreenAvailable",(function(){return f})),n.d(t,"getAndroidVersion",(function(){return p})),n.d(t,"isTouchDevice",(function(){return m})),n.d(t,"isIOSDevice",(function(){return v})),n.d(t,"isAndroidDevice",(function(){return _})),n.d(t,"isMobileDevice",(function(){return b})),n.d(t,"isSafari",(function(){return x})),n.d(t,"isFirefox",(function(){return w})),n.d(t,"isChrome",(function(){return A})),n.d(t,"isMac",(function(){return E})),n.d(t,"isWindows",(function(){return M})),n.d(t,"ObjectAssign",(function(){return T})),n.d(t,"disableDocumentTouchSafari",(function(){return C})),n.d(t,"enableDocumentTouchSafari",(function(){return P})),n.d(t,"touchStartToClick",(function(){return L}));var r=i(),o=r&&r.document,a="undefined"!=typeof navigator,s=function(){return!a},l=a&&!!navigator.userAgent.match(/Edge|Trident\/7\./);function c(e,t){e.requestFullscreen?e.requestFullscreen(t):e.mozRequestFullScreen?e.mozRequestFullScreen(t):e.webkitRequestFullscreen?e.webkitRequestFullscreen(t):e.msRequestFullscreen&&e.msRequestFullscreen(t)}function u(e){h(e)&&(e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen())}function h(e){return"webkitIsFullScreen"in e?!!e.webkitIsFullScreen:"fullscreenElement"in e?!!e.fullscreenElement:"mozFullScreenElement"in e?!!e.mozFullScreenElement:"msFullscreenElement"in e?!!e.msFullscreenElement:!!e.querySelector(".viewer-fill-browser")}function d(e){return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement}function f(e){return e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen}function p(e){var t=(e=e||navigator.userAgent).match(/Android\s([0-9\.]*)/);return!!t&&t[1]}function m(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)}"undefined"!=typeof window&&l&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=o.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=r.CustomEvent.prototype,r.CustomEvent=e}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){if(!t||t>this.byteLength?t=this.byteLength:t<0&&(t=this.byteLength+t)<0&&(t=0),e<0&&(e=this.byteLength+e)<0&&(e=0),t<=e)return new ArrayBuffer;for(var n=t-e,i=new Uint8Array(this,e,n),r=new Uint8Array(n),o=0;o<n;o++)r[o]=i[o];return r.buffer}),Math.log2=Math.log2||function(e){return Math.log(e)/Math.LN2},"undefined"!=typeof window&&(r.BlobBuilder=r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder);var g=a&&(/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1);function v(){return g}var y=a&&-1!==navigator.userAgent.toLowerCase().indexOf("android");function _(){return y}function b(){return!!a&&(v()||_())}function x(){if(!a)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("safari")&&-1===e.indexOf("chrome")}function w(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox")}function A(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("chrome")}function E(){return!!a&&-1!==navigator.userAgent.toLowerCase().indexOf("mac os")}function M(){if(!a)return!1;var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("win32")||-1!==e.indexOf("windows")}function T(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function S(e){var t=r.hasOwnProperty("pageXOffset")?r.pageXOffset:o.documentElement.scrollLeft,n=r.hasOwnProperty("pageYOffset")?r.pageYOffset:o.documentElement.scrollTop,i=void 0===e.pageX?e.changedTouches[0].pageX:e.pageX,a=void 0===e.pageY?e.changedTouches[0].pageY:e.pageY,s=o.elementFromPoint(i-t,a-n);return!s||"CANVAS"!==s.nodeName||(!!s.getAttribute(!0)||(e.preventDefault(),!1))}function C(){b()&&x()&&(o.documentElement.addEventListener("touchstart",S,!0),o.documentElement.addEventListener("touchmove",S,!0),o.documentElement.addEventListener("touchcanceled",S,!0),o.documentElement.addEventListener("touchend",S,!0))}function P(){b()&&x()&&(o.documentElement.removeEventListener("touchstart",S,!0),o.documentElement.removeEventListener("touchmove",S,!0),o.documentElement.removeEventListener("touchcanceled",S,!0),o.documentElement.removeEventListener("touchend",S,!0))}function L(e){e.target.className.indexOf("fullscreen")>-1||e.target.className.indexOf("webvr")>-1||(e.preventDefault(),e.stopPropagation(),e.target.click())}!function(){var e=i();e.performance||(e.performance=Date)}(),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},String.prototype.repeat=String.prototype.repeat||function(e){if(e<1)return"";for(var t="",n=this.valueOf();e>1;)1&e&&(t+=n),e>>=1,n+=n;return t+n},Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{enumerable:!1,value:function(e,t,n){t=void 0===t?0:t,n=void 0===n?this.length:n;for(var i=t;i<n;++i)this[i]=e}}),Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||function(e,t){return Array.prototype.lastIndexOf.call(this,e,t)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(e,t){for(var n=this.length,i=0;i<n;++i){var r=this[i];if(e.call(t,r,i,this))return r}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},writable:!0,configurable:!0}),"undefined"==typeof window||!l&&!v()||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){var i=this;setTimeout((function(){for(var r=atob(i.toDataURL(t,n).split(",")[1]),o=r.length,a=new Uint8Array(o),s=0;s<o;s++)a[s]=r.charCodeAt(s);e(new Blob([a],{type:t||"image/png"}))}))}}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){if(t=void 0!==t?t:this.length,"[object Array]"===Object.prototype.toString.call(this))return _slice.call(this,e,t);var n,i,r=[],o=this.length,a=e||0;a=a>=0?a:Math.max(0,o+a);var s="number"==typeof t?Math.min(t,o):o;if(t<0&&(s=o+t),(i=s-a)>0)if(r=new Array(i),this.charAt)for(n=0;n<i;n++)r[n]=this.charAt(a+n);else for(n=0;n<i;n++)r[n]=this[a+n];return r})}.call(this,n(156))},function(e,t,n){"use strict";var i=e.exports;i.ESCAPE_EVENT="escape",i.PROGRESS_UPDATE_EVENT="progress",i.FULLSCREEN_MODE_EVENT="fullScreenMode",i.NAVIGATION_MODE_CHANGED_EVENT="navmode",i.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored",i.VIEWER_RESIZE_EVENT="viewerResize",i.VIEWER_INITIALIZED="viewerInitialized",i.VIEWER_UNINITIALIZED="viewerUninitialized",i.LOADER_LOAD_FILE_EVENT="loaderLoadFile",i.MODEL_ROOT_LOADED_EVENT="svfLoaded",i.GEOMETRY_LOADED_EVENT="geometryLoaded",i.TEXTURES_LOADED_EVENT="texturesLoaded",i.OBJECT_TREE_CREATED_EVENT="propertyDbLoaded",i.OBJECT_TREE_UNAVAILABLE_EVENT="propertyDbUnavailable",i.OBJECT_TREE_LOAD_PROGRESS_EVENT="propertyDbLoadProgress",i.MODEL_UNLOADED_EVENT="modelUnloaded",i.MODEL_ADDED_EVENT="modelAdded",i.MODEL_REMOVED_EVENT="modelRemoved",i.MODEL_LAYERS_LOADED_EVENT="modelLayersLoaded",i.EXTENSION_LOADED_EVENT="extensionLoaded",i.EXTENSION_UNLOADED_EVENT="extensionUnloaded",i.SELECTION_CHANGED_EVENT="selection",i.AGGREGATE_SELECTION_CHANGED_EVENT="aggregateSelection",i.ISOLATE_EVENT="isolate",i.AGGREGATE_ISOLATION_CHANGED_EVENT="aggregateIsolation",i.HIDE_EVENT="hide",i.AGGREGATE_HIDDEN_CHANGED_EVENT="aggregateHidden",i.SHOW_EVENT="show",i.SHOW_PROPERTIES_EVENT="showProperties",i.SHOW_ALL_EVENT="showAll",i.CAMERA_CHANGE_EVENT="cameraChanged",i.EXPLODE_CHANGE_EVENT="explodeChanged",i.FIT_TO_VIEW_EVENT="fitToView",i.AGGREGATE_FIT_TO_VIEW_EVENT="aggregateFitToView",i.CUTPLANES_CHANGE_EVENT="cutplanesChanged",i.TOOL_CHANGE_EVENT="toolChanged",i.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged",i.FINAL_FRAME_RENDERED_CHANGED_EVENT="finalFrameRenderedChanged",i.RENDER_PRESENTED_EVENT="renderPresented",i.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility",i.PREF_CHANGED_EVENT="PrefChanged",i.PREF_RESET_EVENT="PrefReset",i.RESTORE_DEFAULT_SETTINGS_EVENT="restoreDefaultSettings",i.ANIMATION_READY_EVENT="animationReady",i.CAMERA_TRANSITION_COMPLETED="cameraTransitionCompleted",i.HYPERLINK_EVENT="hyperlink",i.HYPERLINK_NAVIGATE="hyperlink_navigate",i.LOAD_GEOMETRY_EVENT="load_geometry",i.LOAD_MISSING_GEOMETRY="loadMissingGeometry",i.WEBGL_CONTEXT_LOST_EVENT="webglcontextlost",i.CANCEL_LEAFLET_SCREENSHOT="cancelLeafletScreenshot",i.SET_VIEW_EVENT="setView",i.RENDER_FIRST_PIXEL="renderFirstPixel",i.PROFILE_CHANGE_EVENT="profileChanged"},function(e,t,n){"use strict";n.r(t),n.d(t,"Prefs3D",(function(){return i})),n.d(t,"Prefs2D",(function(){return r})),n.d(t,"Prefs",(function(){return o}));var i={VIEW_CUBE:"viewCube",VIEW_CUBE_COMPASS:"viewCubeCompass",ALWAYS_USE_PIVOT:"alwaysUsePivot",ZOOM_TOWARDS_PIVOT:"zoomTowardsPivot",REVERSE_HORIZONTAL_LOOK_DIRECTION:"reverseHorizontalLookDirection",REVERSE_VERTICAL_LOOK_DIRECTION:"reverseVerticalLookDirection",ORBIT_PAST_WORLD_POLES:"orbitPastWorldPoles",CLICK_TO_SET_COI:"clickToSetCOI",GHOSTING:"ghosting",OPTIMIZE_NAVIGATION:"optimizeNavigation",AMBIENT_SHADOWS:"ambientShadows",ANTIALIASING:"antialiasing",GROUND_SHADOW:"groundShadow",GROUND_REFLECTION:"groundReflection",LINE_RENDERING:"lineRendering",EDGE_RENDERING:"edgeRendering",LIGHT_PRESET:"lightPreset",ENV_MAP_BACKGROUND:"envMapBackground",FIRST_PERSON_TOOL_POPUP:"firstPersonToolPopup",BIM_WALK_TOOL_POPUP:"bimWalkToolPopup",BIM_WALK_NAVIGATOR_TYPE:"bimWalkNavigatorType",DEFAULT_NAVIGATION_TOOL_3D:"defaultNavigationTool3D",SELECTION_MODE:"selectionMode",ENABLE_CUSTOM_ORBIT_TOOL_CURSOR:"enableCustomOrbitToolCursor"},r={GRAYSCALE:"grayscale",SWAP_BLACK_AND_WHITE:"swapBlackAndWhite"},o={PROGRESSIVE_RENDERING:"progressiveRendering",OPEN_PROPERTIES_ON_SELECT:"openPropertiesOnSelect",POINT_RENDERING:"pointRendering",BACKGROUND_COLOR_PRESET:"backgroundColorPreset",REVERSE_MOUSE_ZOOM_DIR:"reverseMouseZoomDir",LEFT_HANDED_MOUSE_SETUP:"leftHandedMouseSetup",FUSION_ORBIT:"fusionOrbit",FUSION_ORBIT_CONSTRAINED:"fusionOrbitConstrained",WHEEL_SETS_PIVOT:"wheelSetsPivot"}},function(e,t,n){var i=n(20),r=n(34),o=n(62),a=n(59),s=n(72),l=function(e,t,n){var c,u,h,d,f=e&l.F,p=e&l.G,m=e&l.S,g=e&l.P,v=e&l.B,y=p?i:m?i[t]||(i[t]={}):(i[t]||{}).prototype,_=p?r:r[t]||(r[t]={}),b=_.prototype||(_.prototype={});for(c in p&&(n=t),n)h=((u=!f&&y&&void 0!==y[c])?y:n)[c],d=v&&u?s(h,i):g&&"function"==typeof h?s(Function.call,h):h,y&&a(y,c,h,e&l.U),_[c]!=h&&o(_,c,d),g&&b[c]!=h&&(b[c]=h)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){"use strict";n.r(t),n.d(t,"getEnv",(function(){return p})),n.d(t,"setEnv",(function(){return m})),n.d(t,"isOffline",(function(){return v})),n.d(t,"setOffline",(function(){return y})),n.d(t,"setOfflineResourcePrefix",(function(){return b})),n.d(t,"getOfflineResourcePrefix",(function(){return x})),n.d(t,"endpoint",(function(){return w})),n.d(t,"initLoadContext",(function(){return A}));var i=n(2),r=Object(i.getGlobal)(),o={},a=null;o.ENDPOINT_API_DERIVATIVE_SERVICE_V2="derivativeV2",o.ENDPOINT_API_MODEL_DERIVATIVE_V2="modelDerivativeV2",o.ENDPOINT_API_FLUENT="fluent";var s,l={derivativeV2:{baseURL:"/derivativeservice/v2",itemURL:"/derivativeservice/v2/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn"},derivativeV2_EU:{baseURL:"/derivativeservice/v2/regions/eu",itemURL:"/derivativeservice/v2/regions/eu/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/regions/eu/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn"},modelDerivativeV2:{baseURL:"/modelderivative/v2/",itemURL:"/modelderivative/v2/designdata/:urn/manifest/:derivativeurn",manifestURL:"/modelderivative/v2/designdata/:urn/manifest",thumbnailsURL:"/modelderivative/v2/designdata/:urn/thumbnail"},fluent:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws"}},c="",u=o.ENDPOINT_API_DERIVATIVE_SERVICE_V2,h=!1,d=!1,f="";function p(){return s}function m(e){s=e}o.HTTP_REQUEST_HEADERS={},o.setEndpointAndApi=function(e,t){c=e,t&&(u=t)},o.getEndpointAndApi=function(){return c+l[u].baseURL},o.getApiEndpoint=function(){return c},o.getApiFlavor=function(){return u},o.getCdnUrl=function(){return a||(c?c+l[u].cdnURL:void 0)},o.getCdnWebSocketEndpoint=function(){return c+(l[u].cdnWS||"")},o.setCdnUrl=function(e){a=e},o.getCdnRedirectUrl=function(){var e=l[u].cdnRedirectURL;return e?c+e:null},o.setAcmSession=function(e){f=e},o.getAcmSession=function(){return f},o.getManifestApi=function(e,t,n){var i=e||c;return t=t||"",i=(i+=l[n=n||u].manifestURL).replace(":urn",t)},o.getItemApi=function(e,t,n){var i=n||u,r=(e||c)+l[i].itemURL;t=t||"";var a=decodeURIComponent(t);if(-1!==r.indexOf(":urn")){var s=a.split("/")[0]||"";s=(s=s.split(":"))[s.length-1]||"",r=r.replace(":urn",s)}return i===o.ENDPOINT_API_MODEL_DERIVATIVE_V2&&(t=encodeURIComponent(a)),r=r.replace(":derivativeurn",t)},o.getThumbnailApi=function(e,t,n){return((e||c)+l[n||u].thumbnailsURL).replace(":urn",t||"")},o.getUseCredentials=function(){return h},o.getDomainParam=function(){return this.getUseCredentials()&&!Object(i.isNodeJS)()?"domain="+encodeURIComponent(r.location.origin):""},o.setUseCredentials=function(e){h=e},o.setUseCookie=function(e){d=e},o.getUseCookie=function(){return d},o.initLoadContext=function(e){for(var t in(e=e||{}).auth=this.getUseCredentials(),e.endpoint||(e.endpoint=this.getApiEndpoint()),e.api||(e.api=this.getApiFlavor()),e.headers||(e.headers={}),this.HTTP_REQUEST_HEADERS)e.headers[t]=this.HTTP_REQUEST_HEADERS[t];e.api===this.ENDPOINT_API_FLUENT&&(e.supportsRangeRequests=!0);var n=this.getDomainParam();return n&&(e.queryParams?e.queryParams+="&"+n:e.queryParams=n),e.otg_cdn=a||this.getCdnUrl(),e.otg_ws=this.getCdnWebSocketEndpoint(),e};var g=!1;function v(){return g}function y(e){g=e}var _="";function b(e){_=e}function x(){return _}var w=o,A=o.initLoadContext.bind(o)},function(e,t,n){"use strict";n.r(t),n.d(t,"ErrorCodes",(function(){return i})),n.d(t,"errorCodeString",(function(){return r})),n.d(t,"getErrorCode",(function(){return o}));var i={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,BAD_DATA_MODEL_IS_EMPTY:11,RTC_ERROR:12,UNSUPORTED_FILE_EXTENSION:13,VIEWER_INTERNAL_ERROR:14,WEBGL_LOST_CONTEXT:15};function r(e){return"ErrorCode:"+e+"."}function o(e){return 403===e||401===e?i.NETWORK_ACCESS_DENIED:404===e?i.NETWORK_FILE_NOT_FOUND:e>=500?i.NETWORK_SERVER_ERROR:i.NETWORK_UNHANDLED_RESPONSE_CODE}},function(e,t,n){"use strict";n.r(t),n.d(t,"MeshFlags",(function(){return i}));var i={MESH_VISIBLE:1,MESH_HIGHLIGHTED:2,MESH_HIDE:4,MESH_ISLINE:8,MESH_MOVED:16,MESH_RENDERFLAG:32,MESH_NOTLOADED:64,MESH_ISPOINT:128,MESH_ISWIDELINE:256,MESH_TRAVERSED:512,MESH_DRAWN:1024}},function(e,t,n){"use strict";n.r(t),n.d(t,"i18n",(function(){return V}));var i=n(13),r=n(2);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=Object(r.getGlobal)(),s=a,l=s&&s.document,c=null;Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var i=0;if(arguments.length>0&&((i=Number(arguments[1]))!=i?i=0:0!=i&&i!=1/0&&i!=-1/0&&(i=(i>0||-1)*Math.floor(Math.abs(i)))),i>=n)return-1;for(var r=i>=0?i:Math.max(n-Math.abs(i),0);r<n;r++)if(r in t&&t[r]===e)return r;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var i=n;arguments.length>1&&((i=Number(arguments[1]))!=i?i=0:0!=i&&i!=1/0&&i!=-1/0&&(i=(i>0||-1)*Math.floor(Math.abs(i))));for(var r=i>=0?Math.min(i,n-1):n-Math.abs(i);r>=0;r--)if(r in t&&t[r]===e)return r;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var u,h=a,d=h.jQuery||h.Zepto,f={},p=0,m=[],g=!1,v={lng:void 0,load:"current",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"res/locales/__lng__/__ns__.json",resPostPath:"res/locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"};var y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};var _={create:function(e,t,n,i){var r;if(n){var o=new Date;o.setTime(o.getTime()+60*n*1e3),r="; expires="+o.toGMTString()}else r="";i=i?"domain="+i+";":"",l.cookie=e+"="+t+r+";"+i+"path=/"},read:function(e){for(var t=e+"=",n=l.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},remove:function(e){this.create(e,"",-1)}},b={extend:d?d.extend:function(e,t){if(!t||"function"==typeof t)return e;for(var n in t)e[n]=t[n];return e},each:d?d.each:function(e,t,n){var i,r=0,o=e.length,a=void 0===o||"[object Array]"!==Object.prototype.toString.apply(e)||"function"==typeof e;if(n)if(a){for(i in e)if(!1===t.apply(e[i],n))break}else for(;r<o&&!1!==t.apply(e[r++],n););else if(a){for(i in e)if(!1===t.call(e[i],i,e[i]))break}else for(;r<o&&!1!==t.call(e[r],r,e[r++]););return e},ajax:d?d.ajax:void 0!==l?function(e){var t=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t}(e);var n,i,r,o,a,s,l,c="",u=0;do{o=(n=e.charCodeAt(u++))>>2,a=(3&n)<<4|(i=e.charCodeAt(u++))>>4,s=(15&i)<<2|(r=e.charCodeAt(u++))>>6,l=63&r,isNaN(i)?s=l=64:isNaN(r)&&(l=64),c+=t.charAt(o)+t.charAt(a)+t.charAt(s)+t.charAt(l),n=i=r="",o=a=s=l=""}while(u<e.length);return c},n=function e(t,n,i,r){"function"==typeof i&&(r=i,i={}),i.doNotCache=i.doNotCache||!1,i.data=i.data||{},i.headers=i.headers||{},i.jsonp=i.jsonp||!1,i.async=void 0===i.async||i.async;var o,a=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e}({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},e.headers,i.headers);if(o="application/json"===a["content-type"]?JSON.stringify(i.data):function(e){if("string"==typeof e)return e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}(i.data),"GET"===t){var c=[];if(o&&(c.push(o),o=null),i.doNotCache&&c.push("_="+(new Date).getTime()),i.jsonp&&(c.push("callback="+i.jsonp),c.push("jsonp="+i.jsonp)),(c=c.join("&")).length>1&&(n.indexOf("?")>-1?n+="&"+c:n+="?"+c),i.jsonp){var u=l.getElementsByTagName("head")[0],h=l.createElement("script");return h.type="text/javascript",h.src=n,void u.appendChild(h)}}!function(e){if(s.XMLHttpRequest)return e(null,new XMLHttpRequest);if(s.ActiveXObject)try{return e(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(t){return e(null,new ActiveXObject("Microsoft.XMLHTTP"))}e(new Error)}((function(e,s){if(e)return r(e);for(var l in s.open(t,n,i.async),a)a.hasOwnProperty(l)&&s.setRequestHeader(l,a[l]);s.onreadystatechange=function(){if(4===s.readyState){var e=s.responseText||"";if(!r)return;r(s.status,e)}},s.send(o)}))};({authBasic:function(e,i){n.headers.Authorization="Basic "+t(e+":"+i)},connect:function(e,t,i){return n("CONNECT",e,t,i)},del:function(e,t,i){return n("DELETE",e,t,i)},get:function(e,t,i){return n("GET",e,t,i)},head:function(e,t,i){return n("HEAD",e,t,i)},headers:function(e){n.headers=e||{}},isAllowed:function(e,t,n){this.options(e,(function(e,i){n(-1!==i.text().indexOf(t))}))},options:function(e,t,i){return n("OPTIONS",e,t,i)},patch:function(e,t,i){return n("PATCH",e,t,i)},post:function(e,t,i){return n("POST",e,t,i)},put:function(e,t,i){return n("PUT",e,t,i)},trace:function(e,t,i){return n("TRACE",e,t,i)}})[e.type?e.type.toLowerCase():"get"](e.url,e,(function(t,n){200===t?e.success(n,t,null):e.error(n,t,null)}))}:function(){},cookie:void 0!==l?_:{create:function(e,t,n,i){},read:function(e){return null},remove:function(e){}},detectLanguage:function(){var e,t=[];"undefined"!=typeof window&&(!function(){for(var e=s.location.search.substring(1).split("&"),n=0;n<e.length;n++){var i=e[n].indexOf("=");if(i>0){var r=e[n].substring(0,i),o=e[n].substring(i+1);t[r]=o}}}(),t[v.detectLngQS]&&(e=t[v.detectLngQS]));if(!e&&void 0!==l&&v.useCookie){var n=b.cookie.read(v.cookieName);n&&(e=n)}e||"undefined"==typeof navigator||(e=navigator.language?navigator.language:navigator.userLanguage);return e},escape:function(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return y[e]})):e},log:function(e){v.debug&&"undefined"!=typeof console&&console.log(e)},toLanguages:function(e){var t=[];if("string"==typeof e&&e.indexOf("-")>-1){var n=e.split("-");e=v.lowerCaseLng?n[0].toLowerCase()+"-"+n[1].toLowerCase():n[0].toLowerCase()+"-"+n[1].toUpperCase(),"unspecific"!==v.load&&t.push(e),"current"!==v.load&&t.push(n[0])}else t.push(e);for(var i=0;i<v.fallbackLng.length;i++)-1===t.indexOf(v.fallbackLng[i])&&v.fallbackLng[i]&&t.push(v.fallbackLng[i]);return t},regexEscape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}};function x(e,t){"function"==typeof e&&(t=e,e={}),e=e||{},b.extend(v,e),delete v.fixLng,"string"==typeof v.ns&&(v.ns={namespaces:[v.ns],defaultNs:v.ns}),"string"==typeof v.fallbackNS&&(v.fallbackNS=[v.fallbackNS]),"string"!=typeof v.fallbackLng&&"boolean"!=typeof v.fallbackLng||(v.fallbackLng=[v.fallbackLng]),v.interpolationPrefixEscaped=b.regexEscape(v.interpolationPrefix),v.interpolationSuffixEscaped=b.regexEscape(v.interpolationSuffix),v.lng||(v.lng=b.detectLanguage()),v.lng?v.useCookie&&b.cookie.create(v.cookieName,v.lng,v.cookieExpirationTime,v.cookieDomain):(v.lng=v.fallbackLng[0],v.useCookie&&b.cookie.remove(v.cookieName)),m=b.toLanguages(v.lng),u=m[0],b.log("currentLng set to: "+u);var n=S;if(e.fixLng&&((n=function(e,t){return(t=t||{}).lng=t.lng||n.lng,S(e,t)}).lng=u),I.setCurrentLng(u),v.resStore)return b.each(v.resStore,(function(e,t){b.each(t,(function(t,n){w(e,t,n)}))})),g=!0,void(t&&t(n));var i=b.toLanguages(v.lng);"string"==typeof v.preload&&(v.preload=[v.preload]);for(var r=0,o=v.preload.length;r<o;r++)for(var a=b.toLanguages(v.preload[r]),s=0,l=a.length;s<l;s++)i.indexOf(a[s])<0&&i.push(a[s]);Autodesk.Viewing.i18n.sync.load(i,v,(function(e,i){b.each(i,(function(e,t){b.each(t,(function(t,n){w(e,t,n)}))})),g=!0,t&&t(n)}))}function w(e,t,n){"string"!=typeof t?(n=t,t=v.ns.defaultNs):v.ns.namespaces.indexOf(t)<0&&v.ns.namespaces.push(t),f[e]=f[e]||{},f[e][t]=f[e][t]||{},b.extend(f[e][t],n)}function A(e,t){var n={dynamicLoad:v.dynamicLoad,resGetPath:v.resGetPath,getAsync:v.getAsync,customLoad:v.customLoad,ns:{namespaces:e,defaultNs:""}},i=b.toLanguages(v.lng);"string"==typeof v.preload&&(v.preload=[v.preload]);for(var r=0,o=v.preload.length;r<o;r++)for(var a=b.toLanguages(v.preload[r]),s=0,l=a.length;s<l;s++)i.indexOf(a[s])<0&&i.push(a[s]);for(var c=[],u=0,h=i.length;u<h;u++){var d=!1,p=f[i[u]];if(p)for(var m=0,g=e.length;m<g;m++)p[e[m]]||(d=!0);else d=!0;d&&c.push(i[u])}c.length?R._fetch(c,n,(function(n,i){var r=e.length*c.length;b.each(e,(function(e,n){v.ns.namespaces.indexOf(n)<0&&v.ns.namespaces.push(n),b.each(c,(function(e,o){f[o]=f[o]||{},f[o][n]=i[o][n],0===--r&&t&&(v.useLocalStorage&&R._storeLocal(f),t())}))}))})):t&&t()}function E(e,t,n,i){if(!e)return e;if(i=i||t,e.indexOf(i.interpolationPrefix||v.interpolationPrefix)<0)return e;var r=i.interpolationPrefix?b.regexEscape(i.interpolationPrefix):v.interpolationPrefixEscaped,a=i.interpolationSuffix?b.regexEscape(i.interpolationSuffix):v.interpolationSuffixEscaped,s="HTML"+a;return b.each(t,(function(t,l){var c=n?n+v.keyseparator+t:t;e="object"===o(l)&&null!==l?E(e,l,c,i):i.escapeInterpolation||v.escapeInterpolation?(e=e.replace(new RegExp([r,c,s].join(""),"g"),l)).replace(new RegExp([r,c,a].join(""),"g"),b.escape(l)):e.replace(new RegExp([r,c,a].join(""),"g"),l)})),e}function M(e,t){var n=b.extend({},t);for(delete n.postProcess;-1!=e.indexOf(v.reusePrefix)&&!(++p>v.maxRecursion);){var i=e.lastIndexOf(v.reusePrefix),r=e.indexOf(v.reuseSuffix,i)+v.reuseSuffix.length,o=e.substring(i,r),a=o.replace(v.reusePrefix,"").replace(v.reuseSuffix,"");if(-1!=a.indexOf(",")){var s=a.indexOf(",");if(-1!=a.indexOf("{",s)&&-1!=a.indexOf("}",s)){var l=a.indexOf("{",s),c=a.indexOf("}",l)+"}".length;try{n=b.extend(n,JSON.parse(a.substring(l,c))),a=a.substring(0,s)}catch(e){}}}var u=L(a,n);e=e.replace(o,u)}return e}function T(e,t){var n=C(e,t=t||{}),i=D(e,t);return void 0!==i||i===n}function S(e,t){if(t=t||{},!g){b.log("i18next not finished initialization. you might have called t function before loading resources finished.");var n=e.indexOf(":");n<0?n=0:n++;var i=t.defaultValue||e.substr(n);return i&&(i=E(i,t)),i}return p=0,L.apply(null,arguments)}function C(e,t){return void 0!==t.defaultValue?t.defaultValue:e}function P(){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t]);return{postProcess:"sprintf",sprintf:e}}function L(e,t){if(t&&"object"!==o(t)?"sprintf"===v.shortcutFunction?t=P.apply(null,arguments):"defaultValue"===v.shortcutFunction&&(t={defaultValue:t}):t=t||{},null==e)return"";"string"==typeof e&&(e=[e]);var n=e[0];if(e.length>1)for(var i=0;i<e.length&&!T(n=e[i],t);i++);var r,a=C(n,t),s=D(n,t),l=t.lng?b.toLanguages(t.lng):m,u=t.ns||v.ns.defaultNs;n.indexOf(v.nsseparator)>-1&&(u=(r=n.split(v.nsseparator))[0],n=r[1]),void 0===s&&v.sendMissing&&(t.lng?R.postMissing(l[0],u,n,a,l):R.postMissing(v.lng,u,n,a,l));var h=t.postProcess||v.postProcess;if(void 0!==s&&h&&O[h]&&(s=O[h](s,n,t)),c&&void 0!==s)return c;var d=a;if(a.indexOf(v.nsseparator)>-1&&(d=(r=a.split(v.nsseparator))[1]),d===n&&v.parseMissingKey&&(a=v.parseMissingKey(a)),void 0===s&&(a=M(a=E(a,t),t),h&&O[h])){var f=C(n,t);s=O[h](f,n,t)}return void 0!==s?s:a}function D(e,t){var n,i,r=C(e,t=t||{}),o=m;if(!f)return r;if("cimode"===o[0].toLowerCase())return r;if(t.lng&&(o=b.toLanguages(t.lng),!f[o[0]])){var a=v.getAsync;v.getAsync=!1,R.load(o,v,(function(e,t){b.extend(f,t),v.getAsync=a}))}var s,l=t.ns||v.ns.defaultNs;if(e.indexOf(v.nsseparator)>-1){var c=e.split(v.nsseparator);l=c[0],e=c[1]}if(function(e){return e.context&&("string"==typeof e.context||"number"==typeof e.context)}(t)&&(delete(n=b.extend({},t)).context,n.defaultValue=v.contextNotFound,(i=S(l+v.nsseparator+e+"_"+t.context,n))!=v.contextNotFound))return E(i,{context:t.context});if(function(e){return void 0!==e.count&&"string"!=typeof e.count&&1!==e.count}(t)){delete(n=b.extend({},t)).count,n.defaultValue=v.pluralNotFound;var u=l+v.nsseparator+e+v.pluralSuffix,h=I.get(o[0],t.count);if(h>=0?u=u+"_"+h:1===h&&(u=l+v.nsseparator+e),(i=S(u,n))!=v.pluralNotFound)return E(i,{count:t.count,interpolationPrefix:t.interpolationPrefix,interpolationSuffix:t.interpolationSuffix})}for(var d=e.split(v.keyseparator),p=0,g=o.length;p<g&&void 0===s;p++){for(var y=o[p],_=0,x=f[y]&&f[y][l];d[_];)x=x&&x[d[_]],_++;if(void 0!==x){var w=Object.prototype.toString.apply(x);if("string"==typeof x)x=M(x=E(x,t),t);else if("[object Array]"!==w||v.returnObjectTrees||t.returnObjectTrees){if(null===x&&!0===v.fallbackOnNull)x=void 0;else if(null!==x)if(v.returnObjectTrees||t.returnObjectTrees){if("[object Number]"!==w&&"[object Function]"!==w&&"[object RegExp]"!==w){var A="[object Array]"===w?[]:{};b.each(x,(function(n){A[n]=L(l+v.nsseparator+e+v.keyseparator+n,t)})),x=A}}else v.objectTreeKeyHandler&&"function"==typeof v.objectTreeKeyHandler?x=v.objectTreeKeyHandler(e,x,y,l,t):(x="key '"+l+":"+e+" ("+y+")' returned an object instead of string.",b.log(x))}else x=M(x=E(x=x.join("\n"),t),t);"string"==typeof x&&""===x.trim()&&!0===v.fallbackOnEmpty&&(x=void 0),s=x}}if(void 0===s&&!t.isFallbackLookup&&(!0===v.fallbackToDefaultNS||v.fallbackNS&&v.fallbackNS.length>0))if(t.isFallbackLookup=!0,v.fallbackNS.length)for(var T=0,P=v.fallbackNS.length;T<P;T++){if(s=D(v.fallbackNS[T]+v.nsseparator+e,t))if((s.indexOf(v.nsseparator)>-1?s.split(v.nsseparator)[1]:s)!==(r.indexOf(v.nsseparator)>-1?r.split(v.nsseparator)[1]:r))break}else s=D(e,t);return s}b.applyReplacement=E;var R={load:function(e,t,n){t.useLocalStorage?R._loadLocal(e,t,(function(i,r){for(var o=[],a=0,s=e.length;a<s;a++)r[e[a]]||o.push(e[a]);o.length>0?R._fetch(o,t,(function(e,t){b.extend(r,t),R._storeLocal(t),n(null,r)})):n(null,r)})):R._fetch(e,t,(function(e,t){n(null,t)}))},_loadLocal:function(e,t,n){var i={},r=(new Date).getTime();if(s.localStorage){var o=e.length;b.each(e,(function(e,a){var l=s.localStorage.getItem("res_"+a);l&&(l=JSON.parse(l)).i18nStamp&&l.i18nStamp+t.localStorageExpirationTime>r&&(i[a]=l),0===--o&&n(null,i)}))}},_storeLocal:function(e){if(s.localStorage)for(var t in e)e[t].i18nStamp=(new Date).getTime(),s.localStorage.setItem("res_"+t,JSON.stringify(e[t]))},_fetch:function(e,t,n){var r=t.ns,o={};if(t.dynamicLoad){var a=function(e,t){n(null,t)};if("function"==typeof t.customLoad)t.customLoad(e,r.namespaces,t,a);else{var s=E(t.resGetPath,{lng:e.join("+"),ns:r.namespaces.join("+")});s=Object(i.getResourceUrl)(s),b.ajax({url:s,success:function(e,t,n){b.log("loaded: "+s),a(0,e.json())},error:function(e,t,n){b.log("failed loading: "+s),a()},dataType:"text",async:t.getAsync})}}else{var l,c=r.namespaces.length*e.length;b.each(r.namespaces,(function(i,r){b.each(e,(function(e,i){var a=function(e,t){e&&(l=l||[]).push(e),o[i]=o[i]||{},o[i][r]=t,0===--c&&n(l,o)};"function"==typeof t.customLoad?t.customLoad(i,r,t,a):R._fetchOne(i,r,t,a)}))}))}},_fetchOne:function(e,t,n,r){var o=E(n.resGetPath,{lng:e,ns:t});o=Object(i.getResourceUrl)(o),b.ajax({url:o,success:function(e,t,n){b.log("loaded: "+o);var i=e;r(null,JSON.parse(i))},error:function(e,t,n){if(t&&200==t||e&&e.status&&200==e.status)b.log("There is a typo in: "+o);else if(t&&404==t||e&&e.status&&404==e.status)b.log("Does not exist: "+o);else{var i=t||(e&&e.status?e.status:null);b.log(i+" when loading "+o)}r(n,{})},dataType:"text",async:n.getAsync})},postMissing:function(e,t,n,i,r){var o={};o[n]=i;var a=[];if("fallback"===v.sendMissingTo&&!1!==v.fallbackLng[0])for(var s=0;s<v.fallbackLng.length;s++)a.push({lng:v.fallbackLng[s],url:E(v.resPostPath,{lng:v.fallbackLng[s],ns:t})});else if("current"===v.sendMissingTo||"fallback"===v.sendMissingTo&&!1===v.fallbackLng[0])a.push({lng:e,url:E(v.resPostPath,{lng:e,ns:t})});else if("all"===v.sendMissingTo){s=0;for(var l=r.length;s<l;s++)a.push({lng:r[s],url:E(v.resPostPath,{lng:r[s],ns:t})})}for(var c=0,u=a.length;c<u;c++){var h=a[c];b.ajax({url:h.url,type:v.sendType,data:o,success:function(e,r,o){b.log("posted missing key '"+n+"' to: "+h.url);for(var a=n.split("."),s=0,l=f[h.lng][t];a[s];)l=s===a.length-1?l[a[s]]=i:l[a[s]]=l[a[s]]||{},s++},error:function(e,t,i){b.log("failed posting missing key '"+n+"' to: "+h.url)},dataType:"json",async:v.postAsync})}}},I={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(e){return Number(e>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ak:{name:"Akan",numbers:[1,2],plurals:function(e){return Number(e>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(e){return Number(e>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ay:{name:"Aymará",numbers:[1],plurals:function(e){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(e){return Number(1!=e)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bo:{name:"Tibetan",numbers:[1],plurals:function(e){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(e){return Number(e>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},cgg:{name:"Chiga",numbers:[1],plurals:function(e){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},de:{name:"German",numbers:[1,2],plurals:function(e){return Number(1!=e)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(e){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(e){return Number(1!=e)}},en:{name:"English",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es:{name:"Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},et:{name:"Estonian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eu:{name:"Basque",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fa:{name:"Persian",numbers:[1],plurals:function(e){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(e){return Number(e>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fr:{name:"French",numbers:[1,2],plurals:function(e){return Number(e>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gun:{name:"Gun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(e){return Number(1!=e)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(e){return Number(1!=e)}},id:{name:"Indonesian",numbers:[1],plurals:function(e){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(e){return Number(e%10!=1||e%100==11)}},it:{name:"Italian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ja:{name:"Japanese",numbers:[1],plurals:function(e){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(e){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(e){return Number(0!==e)}},ka:{name:"Georgian",numbers:[1],plurals:function(e){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(e){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(e){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ko:{name:"Korean",numbers:[1],plurals:function(e){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(e){return Number(1==e?0:2==e?1:3==e?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(e){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(e){return Number(e>1)}},lo:{name:"Lao",numbers:[1],plurals:function(e){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(e){return Number(e>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(e){return Number(e>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(e){return Number(e>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(e){return Number(1==e||e%10==1?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(e){return Number(1==e?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ms:{name:"Malay",numbers:[1],plurals:function(e){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(e){return Number(1==e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(e){return Number(1!=e)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(e){return Number(1!=e)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(e){return Number(e>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(e){return Number(1!=e)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(e){return Number(1==e?0:0===e||e%100>0&&e%100<20?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(e){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(e){return Number(1!=e)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(e){return Number(1!=e)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},son:{name:"Songhay",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(e){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(e){return Number(1!=e)}},te:{name:"Telugu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(e){return Number(e>1)}},th:{name:"Thai",numbers:[1],plurals:function(e){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(e){return Number(e>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(e){return Number(e>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(e){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(e){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(e){return Number(e>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(e){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(e){return Number(e>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(e){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(e){return Number(1!=e)}},zh:{name:"Chinese",numbers:[1],plurals:function(e){return 0}}},addRule:function(e,t){I.rules[e]=t},setCurrentLng:function(e){if(!I.currentRule||I.currentRule.lng!==e){var t=e.split("-");I.currentRule={lng:e,rule:I.rules[t[0]]}}},get:function(e,t){return function(t,n){var i;if(i=I.currentRule&&I.currentRule.lng===e?I.currentRule.rule:I.rules[t]){var r=i.plurals(n),o=i.numbers[r];return 2===i.numbers.length&&1===i.numbers[0]&&(2===o?o=-1:1===o&&(o=1)),o}return 1===n?"1":"-1"}(e.split("-")[0],t)}},O={},N=function(e,t){O[e]=t},k=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function e(){return e.cache.hasOwnProperty(arguments[0])||(e.cache[arguments[0]]=e.parse(arguments[0])),e.format.call(null,e.cache[arguments[0]],arguments)};return n.format=function(n,i){var r,o,a,s,l,c,u,h=1,d=n.length,f="",p=[];for(o=0;o<d;o++)if("string"===(f=e(n[o])))p.push(n[o]);else if("array"===f){if((s=n[o])[2])for(r=i[h],a=0;a<s[2].length;a++){if(!r.hasOwnProperty(s[2][a]))throw k('[sprintf] property "%s" does not exist',s[2][a]);r=r[s[2][a]]}else r=s[1]?i[s[1]]:i[h++];if(/[^s]/.test(s[8])&&"number"!=e(r))throw k("[sprintf] expecting number but found %s",e(r));switch(s[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r,10);break;case"e":r=s[7]?r.toExponential(s[7]):r.toExponential();break;case"f":r=s[7]?parseFloat(r).toFixed(s[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&s[7]?r.substring(0,s[7]):r;break;case"u":r=Math.abs(r);break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}r=/[def]/.test(s[8])&&s[3]&&r>=0?"+"+r:r,c=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",u=s[6]-String(r).length,l=s[6]?t(c,u):"",p.push(s[5]?r+l:l+r)}return p.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],i=[],r=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))i.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))i.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(n[2]){r|=1;var o=[],a=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(a)))throw"[sprintf] huh?";for(o.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(a)))o.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(a)))throw"[sprintf] huh?";o.push(s[1])}n[2]=o}else r|=2;if(3===r)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";i.push(n)}t=t.substring(n[0].length)}return i},n}();N("sprintf",(function(e,t,n){return n.sprintf?"[object Array]"===Object.prototype.toString.apply(n.sprintf)?(i=e,(r=n.sprintf).unshift(i),k.apply(null,r)):"object"===o(n.sprintf)?k(e,n.sprintf):e:e;var i,r}));var F=function(e){var t=e||l;Array.prototype.forEach.call(t.querySelectorAll("[data-i18n]"),(function(e){var t=e.getAttribute("data-i18n"),n=[null,t],i=n[0],r=n[1],o=S(r);o?i?e.setAttribute(i,o):e.placeholder?e.placeholder=o:e.textContent=o:i?e.setAttribute(i,r):e.textContent=r}))},V={init:x,setLng:function(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),t.lng=e,x(t,n)},preload:function(e,t){"string"==typeof e&&(e=[e]);for(var n=0,i=e.length;n<i;n++)v.preload.indexOf(e[n])<0&&v.preload.push(e[n]);return x(t)},addResourceBundle:w,removeResourceBundle:function(e,t){"string"!=typeof t&&(t=v.ns.defaultNs),f[e]=f[e]||{},f[e][t]={}},loadNamespace:function(e,t){A([e],t)},loadNamespaces:A,localize:F,setDefaultNamespace:function(e){v.ns.defaultNs=e},t:S,translate:S,exists:T,detectLanguage:b.detectLanguage,pluralExtensions:I,sync:R,functions:b,lng:function(){return u},addPostProcessor:N,options:v,setDebugLocString:function(){c="aaaa",F()},clearDebugLocString:function(){c=null,F()}}},function(e,t,n){"use strict";n.r(t),n.d(t,"Button",(function(){return s}));var i,r,o=n(28),a=n(2);function s(e,t){o.Control.call(this,e,t);var n=this;this._state=s.State.INACTIVE;var i=this.getDocument();this.icon=i.createElement("div"),this.icon.classList.add("adsk-button-icon"),this.container.appendChild(this.icon),this.container.addEventListener("click",(function(e){n.getState()!==s.State.DISABLED&&(n.dispatchEvent(s.Event.CLICK),n.onClick&&n.onClick(e)),e.stopPropagation()})),Object(a.isTouchDevice)()?this.container.addEventListener("touchstart",a.touchStartToClick):(this.container.addEventListener("mouseover",(function(e){n.onMouseOver(e)})),this.container.addEventListener("mouseout",(function(e){n.onMouseOut(e)}))),this.addClass("adsk-button"),this.addClass(s.StateToClassMap[this._state])}s.Event={VISIBILITY_CHANGED:o.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:o.Control.Event.COLLAPSED_CHANGED,STATE_CHANGED:"Button.StateChanged",CLICK:"click"},s.State={ACTIVE:0,INACTIVE:1,DISABLED:2},s.StateToClassMap=(i=s.State,(r={})[i.ACTIVE]="active",r[i.INACTIVE]="inactive",r[i.DISABLED]="disabled",r),s.prototype=Object.create(o.Control.prototype),s.prototype.constructor=s,s.prototype.setState=function(e){if(e===this._state)return!1;this.removeClass(s.StateToClassMap[this._state]),this.addClass(s.StateToClassMap[e]),this._state=e;var t={type:s.Event.STATE_CHANGED,state:e};return this.dispatchEvent(t),!0},s.prototype.setIcon=function(e){this.iconClass&&this.icon.classList.remove(this.iconClass),this.iconClass=e,this.icon.classList.add(e)},s.prototype.getState=function(){return this._state},s.prototype.onClick=function(e){},s.prototype.onMouseOver=function(e){},s.prototype.onMouseOut=function(e){}},function(e,t,n){"use strict";n.r(t),n.d(t,"GlobalManagerMixin",(function(){return o}));var i=n(135),r=new i.GlobalManager;function o(){this.globalManager=r,this.setGlobalManager=function(e){this.globalManager=e,this.onSetGlobalManager(this.globalManager)},this.onSetGlobalManager=function(e){},this.getWindow=function(){return this.globalManager.getWindow()},this.getDocument=function(){return this.globalManager.getDocument()},this.setWindow=function(e){return this.globalManager.setWindow(e)},this.addWindowEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).addWindowEventListener.apply(n,[e,t].concat(r))},this.removeWindowEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).removeWindowEventListener.apply(n,[e,t].concat(r))},this.addDocumentEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).addDocumentEventListener.apply(n,[e,t].concat(r))},this.removeDocumentEventListener=function(e,t){for(var n,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];(n=this.globalManager).removeDocumentEventListener.apply(n,[e,t].concat(r))}}Autodesk.Viewing.GlobalManager=i.GlobalManager,Autodesk.Viewing.GlobalManagerMixin=o},function(e,t,n){"use strict";n.r(t),n.d(t,"LmvVector3",(function(){return s}));var i,r,o,a,s=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};s.prototype={constructor:s,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i+r[12],this.y=r[1]*t+r[5]*n+r[9]*i+r[13],this.z=r[2]*t+r[6]*n+r[10]*i+r[14],this},applyProjection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,s=e.w,l=s*t+o*i-a*n,c=s*n+a*t-r*i,u=s*i+r*n-o*t,h=-r*t-o*n-a*i;return this.x=l*s+h*-r+c*-a-u*-o,this.y=c*s+h*-o+u*-r-l*-a,this.z=u*s+h*-a+l*-o-c*-r,this},transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){if(0!==e){var t=1/e;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},clampScalar:function(e,t){return void 0===o&&(o=new s,a=new s),o.set(e,e,e),a.set(t,t,t),this.clamp(o,a)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e),this},cross:function(e,t){if(void 0!==t)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,i=this.y,r=this.z;return this.x=i*e.z-r*e.y,this.y=r*e.x-n*e.z,this.z=n*e.y-i*e.x,this},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(e){return void 0===i&&(i=new s),i.copy(e).normalize(),r=this.dot(i),this.copy(i).multiplyScalar(r)},projectOnPlane:function(){var e;return function(t){return void 0===e&&(e=new s),e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e;return function(t){return void 0===e&&(e=new s),this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},setEulerFromRotationMatrix:function(e,t){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(e,t){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},setFromMatrixPosition:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},setFromMatrixScale:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),i=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){var n=4*e,i=t.elements;return this.x=i[n],this.y=i[n+1],this.z=i[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromAttribute:function(e,t,n){return void 0===n&&(n=0),t=t*e.itemSize+n,this.x=e.array[t],this.y=e.array[t+1],this.z=e.array[t+2],this}}},function(e,t,n){"use strict";n.r(t),n.d(t,"getScript",(function(){return s})),n.d(t,"injectCSS",(function(){return l})),n.d(t,"getHtmlTemplate",(function(){return c})),n.d(t,"isExperimentalFlagEnabled",(function(){return u})),n.d(t,"getResourceUrl",(function(){return h})),n.d(t,"getParameterByName",(function(){return d})),n.d(t,"getParameterByNameFromPath",(function(){return f})),n.d(t,"stringToDOM",(function(){return p}));var i=n(2),r=Object(i.getGlobal)(),o=r,a=o&&o.document;function s(e){e=e.toLowerCase();var t=a.getElementsByTagName("SCRIPT");if(t&&t.length>0)for(var n=0;n<t.length;++n)if(t[n].src&&-1!==t[n].src.toLowerCase().indexOf(e))return t[n];return null}function l(e,t,n){for(var i=e.indexOf("://")>0?e:h(e),r=a.getElementsByTagName("link"),o=0,s=r.length;o<s;o++)if(r[o].href===i)return void(t&&t());var l=a.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",i),t&&(l.onload=t),n&&(l.onerror=n),a.head.appendChild(l)}function c(e,t){var n=e.indexOf("://")>0?e:h(e),i=new XMLHttpRequest;function r(e){t(e,null)}i.onload=function(e){var n=e.currentTarget.responseText;t(null,n)},i.onerror=r,i.ontimeout=r,i.open("GET",n,!0),i.send()}function u(e,t){return!(!t||!Array.isArray(t.experimental))&&-1!==t.experimental.indexOf(e)}function h(e){return r.LMV_RESOURCE_ROOT+e}function d(e){return"undefined"==typeof window?"":f(e,o.location.href)}function f(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function p(e){var t=a.createElement("div");return t.innerHTML=e,t.firstChild}r.LOCALIZATION_REL_PATH="",r.LMV_VIEWER_VERSION="7.9.0",r.LMV_BUILD_TYPE="Production",r.LMV_RESOURCE_ROOT="",r.LMV_THIRD_PARTY_COOKIE=!Object(i.isNodeJS)()&&void 0,"v"===r.LMV_VIEWER_VERSION.charAt(0)&&(r.LMV_VIEWER_VERSION=r.LMV_VIEWER_VERSION.substr(1)),r.LMV_VECTOR_PDF=!1,r.LMV_RASTER_PDF=!0},function(e,t,n){"use strict";n.r(t),n.d(t,"ViewingService",(function(){return v})),n.d(t,"pathToURL",(function(){return b})),n.d(t,"textToArrayBuffer",(function(){return x}));var i,r,o,a,s,l,c,u,h=n(1),d=n(7),f=n(80),p=n(6),m=n(2),g=n(365),v={},y=!1;function _(e){var t=e.split("/");if(0==t.length)return e;for(var n=[],i=0;i<t.length;++i){var r=t[i];"."!==r&&(".."===r&&n.length?n.pop():n.push(r))}return 0==n.length?"":n.join("/")}function b(e,t){if(-1!==e.indexOf("://")||0===e.indexOf("urn:"))return e;if(t)return t+e;if("undefined"==typeof window)return e;var n=Object(m.getGlobal)(),i=n.location.pathname,r=i.lastIndexOf("/");return i=i.substr(0,r+1),n.location.protocol+"//"+n.location.host+i+e}function x(e,t){for(var n=e.length-t,i=new ArrayBuffer(n),r=new Uint8Array(i,0),o=0,a=t;o<n;o++,a++)r[o]=255&e.charCodeAt(a);return r}function w(e,t){return-1===t.indexOf("file://")&&(-1!==t.indexOf("://")||(!!e||void 0))}if(v.simplifyPath=_,v.OSS_PREFIX="urn:adsk.objects:os.object:",v.generateUrl=function(e,t,n){if(n=n||"",Object(m.isNodeJS)()&&!w(e,n))return n;var i=(n=_(n)).indexOf("urn:"),r=n.indexOf("?");if(n=-1!=i?-1!==r?n.slice(0,i)+encodeURIComponent(n.slice(i,r))+n.slice(r):n.slice(0,i)+encodeURIComponent(n.slice(i)):encodeURI(n),!t||0!==decodeURIComponent(n).indexOf("urn:"))return w(null,n)?n:e+n;switch("items"!==t&&(n=n.substr(6)),t){case"items":return p.endpoint.getItemApi(e,n);case"bubbles":return p.endpoint.getManifestApi(e,n);case"thumbnails":return p.endpoint.getThumbnailApi(e,n)}},Object(m.isNodeJS)())i=n(141),r=n(141),o=n(141),a=n(141),s=n(141),l=new o.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),c=new a.Agent({keepAlive:!0,keepAliveMsecs:100,maxSockets:10}),u=new o.Agent({maxSockets:10}),v.rawGet=function(e,t,n,f,p,m){if(m=m||{},w(e,n=v.generateUrl(e,t,n))){if(m.queryParams){var g=-1===n.indexOf("?")?"?":"&";n=n+g+m.queryParams}var y=s.parse(n),_={host:y.hostname,port:y.port,method:m.method||"GET",path:y.path,headers:{},retryCount:0,agent:"https:"===y.protocol?l:c};if(_.host.endsWith(".api.autodesk.com")&&(_.path.startsWith("/derivativeservice")||_.path.startsWith("/modelderivative"))&&(_.agent=u),m.headers)for(var b in m.headers)_.headers[b]=m.headers[b];_.headers["accept-encoding"]||(_.headers["accept-encoding"]="gzip, deflate"),m.range&&(_.headers.Range="bytes="+m.range.min+"-"+m.range.max),(m.ondata||m.onprogress)&&(m.responseType="arraybuffer");var x=("https:"===y.protocol?o:a).request(_,(function(e){var t=!(e.statusCode>=200&&e.statusCode<400),i=e;t||!function(e,t){return!!("gzip"===e.headers["content-encoding"]||t.endsWith(".json.gz")||t.endsWith("FragmentList.pack")||t.endsWith("LightList.bin")||t.endsWith("CameraList.bin")||t.endsWith("CameraDefinitions.bin")||t.endsWith("LightDefinitions.bin"))}(e,y.pathname)||m.skipDecompress||(i=e.pipe(r.createGunzip())),"json"!==m.responseType&&"text"!==m.responseType&&m.responseType||i.setEncoding("utf8");var o=[],a=Buffer.allocUnsafe(65536),s=0;i.on("data",(function(e){if(m.onprogress){if(e.length+s>a.length){var t=Buffer.allocUnsafe(0|Math.ceil(1.5*a.length));a.copy(t,0,0,s),a=t}return e.copy(a,s,0,e.length),s+=e.length,void(m.onprogress(a,s)&&x.abort())}o.push(e),m.ondata&&m.ondata(e)})),i.on("end",(function(){if(e.statusCode>=200&&e.statusCode<400){if("json"===m.responseType){var t=JSON.parse(o.join(""));return void f(t)}if("text"===m.responseType||""===m.responseType){var i=o.join("");return void f(i)}var l=m.onprogress?a:Buffer.concat(o);if(!m.skipDecompress&&31===l[0]&&139===l[1]){h.logger.warn("An LMV resource ("+n+") was double compressed, or Content-Encoding header missing");try{l=r.gunzipSync(l),s=l.length}catch(e){p(d.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:n,exception:e.toString(),stack:e.stack})}}200===x.status&&m.range&&(l=new Uint8Array(l,m.range.min,m.range.max-m.range.min)),f(l,s)}else p&&p(e.statusCode,e.statusMessage,{url:n})}))}));x.on("error",(function(e){p&&p(e.code,e.message,{url:n})})),m.postData&&x.write(m.postData),x.end()}else!function(e,t,n,o){function a(e){if("json"===o.responseType)try{return JSON.parse(e.toString("utf8"))}catch(e){n(e)}return e}0===e.indexOf("file://")&&(e=e.substr(7)),i.readFile(e,(function(i,s){i?n(0,0,{httpStatusText:i,url:e}):31===s[0]&&139===s[1]?r.gunzip(s,null,(function(i,r){i?n(0,0,{httpStatusText:i,url:e}):(r=a(r),o.ondata&&o.ondata(r),t(r))})):(s=a(s),o.ondata&&o.ondata(s),t(s))}))}(n,f,p,m)};else{var A=new(n(256));A.max=25,v.rawGet=function(e,t,n,i,r,o){A.go((function(a){v._rawGet(e,t,n,(function(){a();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i&&i.apply(i,t)}),(function(){a();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r&&r.apply(r,t)}),o)}))},v._rawGet=function(e,t,n,i,r,o){if(o=o||{},n=v.generateUrl(e,t,n),o.queryParams){var a=-1===n.indexOf("?")?"?":"&";n=n+a+o.queryParams}var s=new XMLHttpRequest;function l(e){r&&r(s.status,s.statusText,{url:n})}function c(e){if("json"===o.responseType)try{if(e instanceof Uint8Array)return Object(f.a)(e);if("string"==typeof e)return JSON.parse(e)}catch(e){}return e}function u(e){if(200===s.status||206===s.status)if(s.response&&s.response instanceof ArrayBuffer){var t;if(t=200===s.status&&o.range?new Uint8Array(s.response,o.range.min,o.range.max-o.range.min):new Uint8Array(s.response),!o.skipDecompress&&31===t[0]&&139===t[1]){y||(y=!0,h.logger.warn("An LMV resource ("+n+") was not uncompressed by the browser. This hurts performance. Check the Content-Encoding header returned by the server and check whether you're getting double-compressed streams. The warning prints only once but it's likely the problem affects multiple resources."));try{t=g.ungzip(t)}catch(e){r(d.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:n,exception:e.toString(),stack:e.stack})}}i&&i(c(t))}else{var a=s.response;a||o.responseType&&"text"!==o.responseType||(a=s.responseText),i&&i(c(a))}else l()}try{var p=!o.hasOwnProperty("asynchronous")||o.asynchronous;if(s.open(o.method||(o.noBody?"HEAD":"GET"),n,p),o.hasOwnProperty("responseType")&&(s.responseType=o.responseType),s.withCredentials=!0,o.hasOwnProperty("withCredentials")&&(s.withCredentials=o.withCredentials),o.range&&s.setRequestHeader("Range","bytes="+o.range.min+"-"+o.range.max),o.headers)for(var m in o.headers)s.setRequestHeader(m,o.headers[m]),"authorization"===m.toLocaleLowerCase()&&(s.withCredentials=!1);p&&(s.onload=u,s.onerror=l,s.ontimeout=l,(o.ondata||o.onprogress)&&(s.overrideMimeType("text/plain; charset=x-user-defined"),o._dlProgress={streamOffset:0},s.onreadystatechange=function(){if(s.readyState>2&&200===s.status)if(o.ondata){var e=s.responseText;if(o._dlProgress.streamOffset>=e.length)return;var t=x(e,o._dlProgress.streamOffset);o._dlProgress.streamOffset=e.length,o.ondata(t)}else if(o.onprogress){o.onprogress(s.responseText)&&s.abort()}})),s.send(o.postData),p||u()}catch(e){r(s.status,s.statusText,{url:n,exception:e})}}}function E(e,t){t.hasOwnProperty("responseType")||(t.responseType="arraybuffer"),t.hasOwnProperty("withCredentials")||(t.withCredentials=!!e.auth),t.headers=e.headers,t.queryParams=e.queryParams,t.endpoint=e.endpoint}v.defaultFailureCallback=function(e,t,n){403==e?this.raiseError(d.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:n.url,httpStatus:e,httpStatusText:t}):404==e?this.raiseError(d.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:n.url,httpStatus:e,httpStatusText:t}):e>=500&&e<600?this.raiseError(d.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:n.url,httpStatus:e,httpStatusText:t}):n.exception?this.raiseError(d.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:n.url,exception:n.exception.toString(),stack:n.exception.stack}):this.raiseError(d.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:n.url,httpStatus:e,httpStatusText:t,data:n})},v.getItem=function(e,t,n,i,r){if(E(e,r=r||{}),r.range&&!e.supportsRangeRequests){var o="start="+r.range.min+"&end="+r.range.max;r.queryParams?r.queryParams+="&"+o:r.queryParams=o,r.range=void 0}v.rawGet(e.endpoint,"items",t,n,i,r)},v.getManifest=function(e,t,n,i,r){(r=r||{}).hasOwnProperty("responseType")||(r.responseType="json"),E(e,r),v.rawGet(e.endpoint,"bubbles",t,n,i,r)},v.getThumbnail=function(e,t,n,i,r){E(e,r=r||{});var o=r.queryParams||"",a=[];if(-1===o.indexOf("guid=")&&a.push("guid="+encodeURIComponent(r.guid)),-1===o.indexOf("role=")){var s=r.role||"rendered";a.push("role="+s)}if(-1===o.indexOf("width=")){var l=r.size||400;a.push("width="+l)}if(-1===o.indexOf("height=")){l=r.size||400;a.push("height="+l)}-1===o.indexOf("acmsession=")&&r.acmsession&&a.push("acmsession="+r.acmsession);var c=a.join("&");r.queryParams?r.queryParams=r.queryParams+"&"+c:r.queryParams=c,v.rawGet(e.endpoint,"thumbnails",t,n,i,r)},v.getACMSession=function(e,t,n,i){var r,o={};for(var a in t)"oauth2AccessToken"===a?r=t[a]:-1!==a.indexOf("x-ads-acm")&&(o[a]=t[a]);o.application="autodesk";var s=new XMLHttpRequest;s.open("POST",e+"/oss-ext/v2/acmsessions",!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+r),s.responseType="json",s.onload=function(){if(200===s.status&&s.response){var e="string"==typeof s.response?JSON.parse(s.response):s.response;e&&e.acmsession?n(e.acmsession):i(s.status,"Can't get acm session from response.")}else i(s.status)},s.onerror=i,s.ontimeout=i,s.send(JSON.stringify(o)),delete o.application}},function(e,t,n){"use strict";n.r(t),n.d(t,"SnapType",(function(){return i}));var i={SNAP_VERTEX:0,SNAP_MIDPOINT:1,SNAP_CIRCLE_CENTER:2,SNAP_EDGE:3,SNAP_FACE:4,SNAP_CIRCULARARC:5,SNAP_CURVEDEDGE:6,SNAP_CURVEDFACE:7,RASTER_PIXEL:8,SNAP_INTERSECTION:9}},function(e,t,n){"use strict";n.r(t),n.d(t,"CutPlanesUniforms",(function(){return de})),n.d(t,"IdUniforms",(function(){return fe})),n.d(t,"ThemingUniform",(function(){return pe})),n.d(t,"ShadowMapCommonUniforms",(function(){return me})),n.d(t,"ShadowMapUniforms",(function(){return ge})),n.d(t,"PointSizeUniforms",(function(){return ve})),n.d(t,"WideLinesUniforms",(function(){return ye})),n.d(t,"DepthTextureUniforms",(function(){return _e})),n.d(t,"GetPrismMapSampleChunk",(function(){return Ae})),n.d(t,"GetPrismMapUniformChunk",(function(){return Ee})),n.d(t,"resolve",(function(){return Te})),n.d(t,"PackDepthShaderChunk",(function(){return Se})),n.d(t,"TonemapShaderChunk",(function(){return Ce})),n.d(t,"OrderedDitheringShaderChunk",(function(){return Pe})),n.d(t,"CutPlanesShaderChunk",(function(){return Le})),n.d(t,"PackNormalsShaderChunk",(function(){return De})),n.d(t,"HatchPatternShaderChunk",(function(){return Re})),n.d(t,"EnvSamplingShaderChunk",(function(){return Ie})),n.d(t,"IdVertexDeclaration",(function(){return Oe})),n.d(t,"IdVertexShaderChunk",(function(){return Ne})),n.d(t,"IdFragmentDeclaration",(function(){return ke})),n.d(t,"IdOutputShaderChunk",(function(){return Fe})),n.d(t,"FinalOutputShaderChunk",(function(){return Ve})),n.d(t,"ThemingFragmentDeclaration",(function(){return Be})),n.d(t,"ThemingFragmentShaderChunk",(function(){return Ue})),n.d(t,"InstancingVertexDeclaration",(function(){return ze})),n.d(t,"ShadowMapDeclareCommonUniforms",(function(){return Ge})),n.d(t,"ShadowMapVertexDeclaration",(function(){return He})),n.d(t,"ShadowMapVertexShaderChunk",(function(){return We})),n.d(t,"ShadowMapFragmentDeclaration",(function(){return je})),n.d(t,"PointSizeDeclaration",(function(){return Xe})),n.d(t,"PointSizeShaderChunk",(function(){return qe})),n.d(t,"ShaderChunks",(function(){return Ye}));var i=n(0),r=n(301),o=n.n(r),a=n(302),s=n.n(a),l=n(303),c=n.n(l),u=n(304),h=n.n(u),d=n(305),f=n.n(d),p=n(306),m=n.n(p),g=n(307),v=n.n(g),y=n(308),_=n.n(y),b=n(309),x=n.n(b),w=n(310),A=n.n(w),E=n(311),M=n.n(E),T=n(312),S=n.n(T),C=n(313),P=n.n(C),L=n(314),D=n.n(L),R=n(315),I=n.n(R),O=n(316),N=n.n(O),k=n(317),F=n.n(k),V=n(318),B=n.n(V),U=n(319),z=n.n(U),G=n(320),H=n.n(G),W=n(321),j=n.n(W),X=n(322),q=n.n(X),Y=n(323),K=n.n(Y),Z=n(324),Q=n.n(Z),J=n(325),$=n.n(J),ee=n(326),te=n.n(ee),ne=n(327),ie=n.n(ne),re=n(328),oe=n.n(re),ae=n(329),se=n.n(ae),le=n(330),ce=n.n(le),ue=n(331),he=n.n(ue),de={cutplanes:{type:"v4v",value:[]},hatchParams:{type:"v2",value:new i.Vector2(1,10)},hatchTintColor:{type:"c",value:new i.Color(16777215)},hatchTintIntensity:{type:"f",value:1}},fe={dbId:{type:"v3",value:new i.Vector3(0,0,0)},modelId:{type:"v3",value:new i.Vector3(0,0,0)}},pe={themingColor:{type:"v4",value:new i.Vector4(0,0,0,0)}},me={shadowESMConstant:{type:"f",value:0}},ge=i.UniformsUtils.merge([{shadowMap:{type:"t",value:null},shadowMapSize:{type:"v2",value:new i.Vector2(0,0)},shadowBias:{type:"f",value:0},shadowDarkness:{type:"f",value:0},shadowMatrix:{type:"m4",value:new i.Matrix4},shadowLightDir:{type:"v3",value:new i.Vector3}},me]),ve={point_size:{type:"f",value:1}},ye={view_size:{type:"v2",value:new i.Vector2(640,480)}},_e={tDepth:{type:"t",value:null},projInfo:{type:"v4",value:new i.Vector4},isOrtho:{type:"f",value:0},worldMatrix_mainPass:{type:"m4",value:new i.Matrix4}},be={};for(var xe in i.ShaderChunk)be[xe]=i.ShaderChunk[xe];be.pack_depth=o.a,be.depth_texture=s.a,be.tonemap=c.a,be.ordered_dither=h.a,be.cutplanes=f.a,be.pack_normals=m.a,be.hatch_pattern=v.a,be.env_sample=_.a,be.id_decl_vert=x.a,be.id_vert=A.a,be.id_decl_frag=M.a,be.id_frag=S.a,be.final_frag=P.a,be.theming_decl_frag=D.a,be.theming_frag=I.a,be.instancing_decl_vert=N.a,be.shadowmap_decl_common=F.a,be.shadowmap_decl_vert=B.a,be.shadowmap_vert=z.a,be.shadowmap_decl_frag=H.a,be.float3_average=j.a,be.line_decl_common=q.a,be.prism_wood=K.a,be.prism_glazing=Q.a,be.prism_transparency=$.a,be.normal_map=te.a,be.decl_point_size=ie.a,be.point_size=oe.a,be.wide_lines_decl=se.a,be.wide_lines_vert=ce.a,be.hsv=he.a;var we={};function Ae(e,t,n,i){var r=n?"_v3":"",o=n?"vec3 ":"",a=n?t+" = average("+t+r+");":"",s=i?t+r+" = SRGBToLinear("+t+r+");":"";return["#if defined( USE_"+e.toUpperCase()+"_MAP )","vec2 uv_"+e+"_map = ("+e+"_map_texMatrix * vec3(uv, 1.0)).xy;",e.toUpperCase()+"_CLAMP_TEST;",o+t+r+" = texture2D("+e+"_map, uv_"+e+"_map).xyz;",s,"if("+e+"_map_invert) "+t+r+" = vec3(1.0) - "+t+r+";",a,"#else",t+" = "+e+";","#endif"].join("\n")}function Ee(e){var t=e+"_texMatrix",n=e+"_invert";return["#if defined( "+("USE_"+e).toUpperCase()+" )","uniform sampler2D "+e+";","uniform mat3 "+t+";","uniform bool "+n+";","#endif"].join("\n")}we.prism_check=function(e){return["#if defined( USE_SURFACE_ALBEDO_MAP ) || defined( USE_SURFACE_ROUGHNESS_MAP ) || defined( USE_SURFACE_CUTOUT_MAP ) || defined( USE_SURFACE_ANISOTROPY_MAP ) || defined( USE_SURFACE_ROTATION_MAP ) || defined( USE_OPAQUE_ALBEDO_MAP ) || defined( USE_OPAQUE_F0_MAP ) || defined( USE_OPAQUE_LUMINANCE_MODIFIER_MAP ) || defined( USE_LAYERED_BOTTOM_F0_MAP ) || defined( USE_LAYERED_F0_MAP ) || defined( USE_LAYERED_DIFFUSE_MAP ) || defined( USE_LAYERED_FRACTION_MAP ) || defined( USE_LAYERED_ROUGHNESS_MAP ) || defined( USE_LAYERED_ANISOTROPY_MAP ) || defined( USE_LAYERED_ROTATION_MAP ) || defined( USE_METAL_F0_MAP ) || defined( USE_SURFACE_NORMAL_MAP ) || defined( USE_LAYERED_NORMAL_MAP )","#define "+e,"#endif"].join("\n")},we.prism_sample_texture=function(e,t,n,i){return Ae(e,t,"true"===n,"true"===i)},we.prism_uniforms=Ee,we.prism_bump_uniforms=function(e){var t=e+"_texMatrix",n=e+"_bumpScale",i=e+"_bumpmapType";return["#if defined( "+("USE_"+e).toUpperCase()+" )","uniform sampler2D "+e+";","uniform mat3 "+t+";","uniform vec2 "+n+";","uniform int "+i+";","#endif"].join("\n")};var Me={};for(xe in we)Me[xe]=new RegExp("#"+xe+" *<([\\w\\d., ]*)>","g");var Te=function e(t){for(var n in we){var i=Me[n];t=t.replace(i,(function(e,t){var i=t.split(",").map((function(e){return e.trim()}));return we[n].apply(null,i)}))}return t.replace(/#include *<([\w\d.]+)>/g,(function(t,n){if(!be[n])throw new Error("Cannot resolve #include<"+n+">");return e(be[n])}))},Se=be.pack_depth,Ce=be.tonemap,Pe=be.ordered_dither,Le=be.cutplanes,De=be.pack_normals,Re=be.hatch_pattern,Ie=be.env_sample,Oe=be.id_decl_vert,Ne=be.id_vert,ke=be.id_decl_frag,Fe=be.id_frag,Ve=be.final_frag,Be=be.theming_decl_frag,Ue=be.theming_frag,ze=be.instancing_decl_vert,Ge=be.shadowmap_decl_common,He=be.shadowmap_decl_vert,We=be.shadowmap_vert,je=be.shadowmap_decl_frag,Xe=be.decl_point_size,qe=be.point_size,Ye={IdUniforms:fe,ThemingUniform:pe,CutPlanesUniforms:de,ShadowMapCommonUniforms:me,ShadowMapUniforms:ge,PointSizeUniforms:ve,WideLinesUniforms:ye,DepthTextureUniforms:_e,PackDepthShaderChunk:Se,TonemapShaderChunk:Ce,OrderedDitheringShaderChunk:Pe,CutPlanesShaderChunk:Le,PackNormalsShaderChunk:De,HatchPatternShaderChunk:Re,EnvSamplingShaderChunk:Ie,IdVertexDeclaration:Oe,IdVertexShaderChunk:Ne,IdFragmentDeclaration:ke,IdOutputShaderChunk:Fe,FinalOutputShaderChunk:Ve,ThemingFragmentDeclaration:Be,ThemingFragmentShaderChunk:Ue,InstancingVertexDeclaration:ze,ShadowMapDeclareCommonUniforms:Ge,ShadowMapVertexDeclaration:He,ShadowMapVertexShaderChunk:We,ShadowMapFragmentDeclaration:je,PointSizeDeclaration:Xe,PointSizeShaderChunk:qe,GetPrismMapSampleChunk:Ae,GetPrismMapUniformChunk:Ee,resolve:Te}},function(e,t,n){"use strict";n.r(t),n.d(t,"LmvMatrix4",(function(){return i}));var i=function(e){this.elements=e?new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};i.prototype={constructor:i,set:function(e,t,n,i,r,o,a,s,l,c,u,h,d,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},makeRotationFromQuaternion:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z,o=e.w,a=n+n,s=i+i,l=r+r,c=n*a,u=n*s,h=n*l,d=i*s,f=i*l,p=r*l,m=o*a,g=o*s,v=o*l;return t[0]=1-(d+p),t[4]=u-v,t[8]=h+g,t[1]=u+v,t[5]=1-(c+p),t[9]=f-m,t[2]=h-g,t[6]=f+m,t[10]=1-(c+d),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},multiply:function(e){return this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],x=i[0],w=i[4],A=i[8],E=i[12],M=i[1],T=i[5],S=i[9],C=i[13],P=i[2],L=i[6],D=i[10],R=i[14],I=i[3],O=i[7],N=i[11],k=i[15];return r[0]=o*x+a*M+s*P+l*I,r[4]=o*w+a*T+s*L+l*O,r[8]=o*A+a*S+s*D+l*N,r[12]=o*E+a*C+s*R+l*k,r[1]=c*x+u*M+h*P+d*I,r[5]=c*w+u*T+h*L+d*O,r[9]=c*A+u*S+h*D+d*N,r[13]=c*E+u*C+h*R+d*k,r[2]=f*x+p*M+m*P+g*I,r[6]=f*w+p*T+m*L+g*O,r[10]=f*A+p*S+m*D+g*N,r[14]=f*E+p*C+m*R+g*k,r[3]=v*x+y*M+_*P+b*I,r[7]=v*w+y*T+_*L+b*O,r[11]=v*A+y*S+_*D+b*N,r[15]=v*E+y*C+_*R+b*k,this},multiplyToArray:function(e,t,n){var i=this.elements;return this.multiplyMatrices(e,t),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*s*u-i*l*u-r*a*h+n*l*h+i*a*d-n*s*d)+e[7]*(+t*s*d-t*l*h+r*o*h-i*o*d+i*l*c-r*s*c)+e[11]*(+t*l*u-t*a*d-r*o*u+n*o*d+r*a*c-n*l*c)+e[15]*(-i*a*c-t*s*u+t*a*h+i*o*u-n*o*h+n*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,i=e.elements,r=i[0],o=i[4],a=i[8],s=i[12],l=i[1],c=i[5],u=i[9],h=i[13],d=i[2],f=i[6],p=i[10],m=i[14],g=i[3],v=i[7],y=i[11],_=i[15];n[0]=u*m*v-h*p*v+h*f*y-c*m*y-u*f*_+c*p*_,n[4]=s*p*v-a*m*v-s*f*y+o*m*y+a*f*_-o*p*_,n[8]=a*h*v-s*u*v+s*c*y-o*h*y-a*c*_+o*u*_,n[12]=s*u*f-a*h*f-s*c*p+o*h*p+a*c*m-o*u*m,n[1]=h*p*g-u*m*g-h*d*y+l*m*y+u*d*_-l*p*_,n[5]=a*m*g-s*p*g+s*d*y-r*m*y-a*d*_+r*p*_,n[9]=s*u*g-a*h*g-s*l*y+r*h*y+a*l*_-r*u*_,n[13]=a*h*d-s*u*d+s*l*p-r*h*p-a*l*m+r*u*m,n[2]=c*m*g-h*f*g+h*d*v-l*m*v-c*d*_+l*f*_,n[6]=s*f*g-o*m*g-s*d*v+r*m*v+o*d*_-r*f*_,n[10]=o*h*g-s*c*g+s*l*v-r*h*v-o*l*_+r*c*_,n[14]=s*c*d-o*h*d-s*l*f+r*h*f+o*l*m-r*c*m,n[3]=u*f*g-c*p*g-u*d*v+l*p*v+c*d*y-l*f*y,n[7]=o*p*g-a*f*g+a*d*v-r*p*v-o*d*y+r*f*y,n[11]=a*c*g-o*u*g-a*l*v+r*u*v+o*l*y-r*c*y,n[15]=o*u*d-a*c*d+a*l*f-r*u*f-o*l*p+r*c*p;var b=r*n[0]+l*n[4]+d*n[8]+g*n[12];if(0==b){var x="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(t)throw new Error(x);return console.warn(x),this.identity(),this}return this.multiplyScalar(1/b),this},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,s=e.z,l=r*o,c=r*a;return this.set(l*o+n,l*a-i*s,l*s+i*a,0,l*a+i*s,c*a+n,c*s-i*o,0,l*s-i*a,c*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},compose:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},transformPoint:function(e){var t=e.x,n=e.y,i=e.z,r=this.elements;return e.x=r[0]*t+r[4]*n+r[8]*i+r[12],e.y=r[1]*t+r[5]*n+r[9]*i+r[13],e.z=r[2]*t+r[6]*n+r[10]*i+r[14],e},transformDirection:function(e){var t=e.x,n=e.y,i=e.z,r=this.elements;e.x=r[0]*t+r[4]*n+r[8]*i,e.y=r[1]*t+r[5]*n+r[9]*i,e.z=r[2]*t+r[6]*n+r[10]*i;var o=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z);if(o>0){var a=1/o;e.x*=a,e.y*=a,e.z*=a}return e},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements;return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return new i(this.elements instanceof Float64Array).fromArray(this.elements)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultLightPreset",(function(){return r})),n.d(t,"DefaultLightPreset2d",(function(){return o})),n.d(t,"BackgroundPresets",(function(){return a})),n.d(t,"LightPresets",(function(){return l})),n.d(t,"copyLightPreset",(function(){return u}));var i=n(2),r=1,o=0,a={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Snow:[181,186,199,181,186,199],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Dark Sky":[51,51,51,51,51,51],"Infinity Pool":[255,255,255,255,255,255],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Field:[202,226,252,202,201,190],Boardwalk:[216,230,248,230,228,220],Custom:[230,230,230,150,150,150]},s=a,l=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.2,.225,.25],lightMultiplier:1,bgColorGradient:s["Fusion Grey"],darkerFade:!1,rotation:0},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.5,-.2,-.06],bgColorGradient:s["Photo Booth"],darkerFade:!0,rotation:0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:1,lightDirection:[.1,-.55,-1],bgColorGradient:s["Dark Sky"],darkerFade:!1,rotation:0},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:s["Grey Room"],darkerFade:!0,rotation:0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:s["Photo Booth"],darkerFade:!0,rotation:0},{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:s.Tranquility,darkerFade:!1,rotation:0},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:s["Infinity Pool"],darkerFade:!1,rotation:0},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25,.25,.25],lightMultiplier:1,bgColorGradient:s.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0,rotation:0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:1,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s["Sky Blue"],darkerFade:!1,rotation:0},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s.Midnight,darkerFade:!1,rotation:0},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[.35,-.35,-.5],bgColorGradient:s["Photo Booth"],darkerFade:!0,rotation:0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:s["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-0,-.15,-.5],bgColorGradient:s["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.5,0],bgColorGradient:s["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:1,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.5,-.6,0],bgColorGradient:s["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Plaza",path:"Plaza",type:"logluv",tonemap:1,E_bias:-14,directLightColor:[.9,.9,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[-.2,-.18,.72],bgColorGradient:s.Plaza,darkerFade:!1,rotation:0},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:1,E_bias:-10.461343,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,lightDirection:[0,-1,0],bgColorGradient:s.Snow,darkerFade:!1,rotation:0},{name:"Field",path:"field",type:"logluv",tonemap:1,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s.Field,useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:1,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s.Boardwalk,useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Flat Shading",path:null,tonemap:0,E_bias:0,directLightColor:[0,0,0],ambientColor:[0,0,0],lightMultiplier:0,bgColorGradient:s["Fusion Grey"],darkerFade:!1,rotation:0}],c=[{name:"Harbor",path:"Harbor",type:"logluv",tonemap:1,E_bias:1.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s["Sky Blue"],useIrradianceAsBackground:!0,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"Night",path:"Night",type:"logluv",tonemap:1,E_bias:4,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0},{name:"Parking",path:"Parking",type:"logluv",tonemap:1,E_bias:2.8,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s["Sky Blue"],useIrradianceAsBackground:!1,saoIntensity:.5,darkerFade:!1,rotation:0},{name:"River Road",path:"RiverRoad",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s["Fusion Grey"],useIrradianceAsBackground:!1,saoIntensity:.7,darkerFade:!1,rotation:0},{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:1,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!0,rotation:0},{name:"Seaport",path:"seaport",type:"logluv",tonemap:1,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s["Sky Blue"],useIrradianceAsBackground:!0,darkerFade:!1,rotation:0},{name:"Glacier",path:"glacier",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s.Midnight,darkerFade:!1,rotation:0},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:s["RaaS SBS"],darkerFade:!1,rotation:0},{name:"City Night",path:"CityNight",type:"logluv",tonemap:1,E_bias:1.6,directLightColor:[1,1,1],lightMultiplier:.2,bgColorGradient:s.Midnight,useIrradianceAsBackground:!1,darkerFade:!1,rotation:0}];function u(e,t){Object(i.ObjectAssign)(t,e),t.name=e.name+" (copy)"}Object(i.getGlobal)().ENABLE_DEBUG&&Array.prototype.push.apply(l,c)},function(e,t,n){"use strict";n.r(t),n.d(t,"RenderFlags",(function(){return i}));var i={RENDER_NORMAL:0,RENDER_HIGHLIGHTED:1,RENDER_HIDDEN:2,RENDER_SHADOWMAP:3,RENDER_FINISHED:4}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var i=n(23);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";n.r(t),n.d(t,"GroundFlags",(function(){return i}));var i={GROUND_UNFINISHED:0,GROUND_FINISHED:1,GROUND_RENDERED:2}},function(e,t,n){"use strict";n.r(t),n.d(t,"createShaderMaterial",(function(){return r})),n.d(t,"setMacro",(function(){return o})),n.d(t,"removeMacro",(function(){return a}));var i=n(0),r=function(e){var t={vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return e.uniforms&&(t.uniforms=i.UniformsUtils.clone(e.uniforms)),e.defines&&(t.defines=Object.assign({},e.defines)),e.extensions&&(t.extensions=Object.assign({},e.extensions)),e.attributes&&(t.attributes=e.attributes),new i.ShaderMaterial(t)},o=function(e,t,n){n=n||"",e.defines||(e.defines={}),e.defines[t]!=n&&(e.defines[t]=n,e.needsUpdate=!0)},a=function(e,t){(e.defines||e.defines[t])&&(delete e.defines[t],e.needsUpdate=!0)}},function(e,t,n){"use strict";n.r(t),n.d(t,"OptionSlider",(function(){return c})),n.d(t,"OptionCheckbox",(function(){return u})),n.d(t,"OptionLabel",(function(){return h})),n.d(t,"OptionButton",(function(){return d})),n.d(t,"OptionDropDown",(function(){return f})),n.d(t,"ResizeFooter",(function(){return p})),n.d(t,"OptionRow",(function(){return m})),n.d(t,"SimpleList",(function(){return g}));var i=n(32),r=n(9),o=n(2),a=n(11);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=n(140);function c(e,t,n,i,o){var a=this;this.tbody=i;var s=o&&o.insertAtIndex?o.insertAtIndex:-1;this.hideStepper=o&&o.hideStepper;var l=o&&o.hideCaption;this.sliderRow=this.tbody.insertRow(s),this.sliderRow.classList.add("switch-slider-row");var c=this.getDocument(),u=this.sliderRow.insertCell(0);function h(e){e.target!=a.stepperElement&&(a.stepperElement.value=a.sliderElement.value),a.fireChangeEvent()}this.caption=c.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.i18n.translate(e),l&&(this.caption.style.display="none"),u.appendChild(this.caption),u=this.sliderRow.insertCell(1),this.sliderElement=c.createElement("input"),this.sliderElement.type="range",this.sliderElement.id=e+"_slider",this.sliderElement.min=t,this.sliderElement.max=n,this.sliderElement.style.width="85%",u.appendChild(this.sliderElement),u=this.sliderRow.insertCell(2),this.stepperElement=c.createElement("input"),this.stepperElement.type="number",this.stepperElement.id=e+"_stepper",this.stepperElement.min=t,this.stepperElement.max=n,this.stepperElement.step=1,this.stepperElement.style.width="64px",this.hideStepper&&(this.stepperElement.style.display="none"),u.appendChild(this.stepperElement),this.blockEvent=!1,this.stepperElement.addEventListener("change",(function(e){e.target!=a.sliderElement&&(a.sliderElement.value=a.stepperElement.value),a.fireChangeEvent()}),!1),this.sliderElement.addEventListener("change",h,!1),this.sliderElement.addEventListener("input",h,!1)}function u(e,t,n,i,a,s){var c=this;this.tbody=t;var u=s&&s.insertAtIndex?s.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(u),this.sliderRow.classList.add("switch-slider-row");var h=this.getDocument(),d=this.sliderRow.insertCell(0);this.caption=h.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.i18n.translate(e),d.appendChild(this.caption),d=this.sliderRow.insertCell(1),i&&(this.description=h.createElement("div"),this.description.setAttribute("data-i18n",i),this.description.textContent=r.i18n.translate(i),d.appendChild(this.description),d=this.sliderRow.insertCell(2));var f=h.createElement("label");f.classList.add("switch"),this.checkElement=h.createElement("input"),this.checkElement.type="checkbox",this.checkElement.id=e+"_check",this.checkElement.checked=n,f.appendChild(this.checkElement);var p=h.createElement("div");p.classList.add("slider"),f.appendChild(p),d.appendChild(f),this.blockEvent=!1,this.checked=n,this.checkElement.addEventListener("change",(function(e){c.fireChangeEvent()}),!1),Object(o.isTouchDevice)()&&(this.sliderRowHammer=new l.Manager(this.sliderRow,{recognizers:[[l.Tap]],handlePointerEventMouse:!1,inputClass:o.isIE11?l.PointerEventInput:l.TouchInput}),this.sliderRowHammer.on("tap",(function(e){e.preventDefault(),e.target.click()}))),this.checkElement.addEventListener("click",(function(e){e.stopPropagation()}),!1),this.sliderRow.addEventListener("click",(function(e){c.checkElement.disabled||(c.checkElement.checked=!c.checkElement.checked,c.fireChangeEvent())}),!1)}function h(e,t,n,i){this.tbody=t;var o=i&&i.insertAtIndex?i.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(o);var a=this.getDocument(),s=this.sliderRow.insertCell(0);this.caption=a.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.i18n.translate(e),s.appendChild(this.caption),s.colSpan="3",this.blockEvent=!1,this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this.tbody=null,this.sliderRow=null,this.caption=null}}function d(e,t,n,i){this.tbody=t;var o=i&&i.insertAtIndex?i.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(o),this.sliderRow.insertCell();var a=this.sliderRow.insertCell();this.sliderRow.insertCell();var s=this.getDocument();this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.i18n.translate(e),this.caption.classList.add("adsk-button"),this.caption.classList.add("table-button"),a.appendChild(this.caption),this.removeFromParent=function(){this.tbody.removeChild(this.sliderRow),this._onClick&&(this.caption.removeEventListener("click",this._onClick),this._onClick=null),this.tbody=null,this.sliderRow=null,this.caption=null},this.setOnClick=function(e){this._onClick=e,this.caption.addEventListener("click",e,!1)}}function f(e,t,n,i,o,a,s){var l=this;this.tbody=t;var c=s&&s.insertAtIndex?s.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(c);var u=this.getDocument();this.dropdownElement=u.createElement("select"),this.dropdownElement.id=e+"_dropdown",this.dropdownElement.classList.add("option-drop-down");for(var h=0;h<n.length;h++){var d=u.createElement("option");d.value=h,d.setAttribute("data-i18n",n[h]),d.textContent=r.i18n.translate(n[h]),this.dropdownElement.add(d)}this.selectedIndex=this.dropdownElement.selectedIndex=i;var f=this.sliderRow.insertCell(0);(this.caption=u.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.i18n.translate(e),f.appendChild(this.caption),o)?(f.colSpan="2",this.sliderRow=this.tbody.insertRow(c),(f=this.sliderRow.insertCell(0)).appendChild(this.dropdownElement),f.colSpan="2",this.dropdownElement.classList.add("tabcell")):(f=this.sliderRow.insertCell(1)).appendChild(this.dropdownElement);f.style.paddingLeft=(s&&void 0!==s.paddingLeft?s.paddingLeft:5)+"px",f.style.paddingRight=(s&&void 0!==s.paddingRight?s.paddingRight:5)+"px",this.blockEvent=!1,this.dropdownElement.addEventListener("change",(function(e){l.fireChangeEvent()}),!1)}function p(e,t,n){this.resizeCallback=t;var i=this.getDocument(),r=i.createElement("div");r.classList.add("docking-panel-footer");var o=i.createElement("div");o.classList.add("docking-panel-footer-resizer"),r.appendChild(o);var a=!1,s=e.getBoundingClientRect(),l={x:0,y:0},c=i.createElement("div");c.classList.add("adsk-viewing-viewer"),c.classList.add("docking-panel-resize-overlay");var u=function(t){a=!0,s=e.getBoundingClientRect(),this.getDocument().body.appendChild(c),this.addDocumentEventListener("touchmove",d),this.addDocumentEventListener("touchcancel",h),this.addDocumentEventListener("touchend",h),this.addDocumentEventListener("mousemove",d),this.addDocumentEventListener("mouseup",h),t.preventDefault(),t.stopPropagation()};u=u.bind(this);var h=function(e){var t=this.getDocument();t.body.contains(c)&&(t.body.removeChild(c),this.removeDocumentEventListener("touchmove",d),this.removeDocumentEventListener("touchcancel",h),this.removeDocumentEventListener("touchend",h),this.removeDocumentEventListener("mousemove",d),this.removeDocumentEventListener("mouseup",h),e.preventDefault(),e.stopPropagation())};h=h.bind(this);var d=function(t){"touchmove"===t.type&&(t.canvasX=t.touches[0].screenX,t.canvasY=t.touches[0].screenY),a&&(a=!1,l.x=t.canvasX||t.clientX,l.y=t.canvasY||t.clientY);var n=(t.canvasX||t.clientX)-l.x,i=(t.canvasY||t.clientY)-l.y,r=parseInt(s.width+n),o=parseInt(s.height+i);e.style.width=r+"px",e.style.height=o+"px",this.resizeCallback&&this.resizeCallback(r,o),t.preventDefault(),t.stopPropagation()};d=d.bind(this),o.addEventListener("touchstart",u),o.addEventListener("mousedown",u),e.style.resize="none",e.appendChild(r),this.footer=r,this.resizer=o}function m(e,t,n,i,o){this.tbody=t;var a=o&&o.insertAtIndex?o.insertAtIndex:-1;this.sliderRow=this.tbody.insertRow(a),this.sliderRow.classList.add("switch-slider-row");var s=this.getDocument(),l=this.sliderRow.insertCell(0);this.caption=s.createElement("div"),this.caption.setAttribute("data-i18n",e),this.caption.textContent=r.i18n.translate(e),l.appendChild(this.caption),l=this.sliderRow.insertCell(1),n&&(this.description=s.createElement("div"),this.description.setAttribute("data-i18n",n),this.description.textContent=r.i18n.translate(n),l.appendChild(this.description),l=this.sliderRow.insertCell(2))}c.prototype.constructor=c,i.EventDispatcher.prototype.apply(c.prototype),c.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var e=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(e)}},c.prototype.setValue=function(e){this.blockEvent=!0,this.value=e,this.sliderElement.value=e,this.stepperElement.value=e,this.blockEvent=!1},c.prototype.setDisabled=function(e){this.sliderElement.disabled=e,this.stepperElement.disabled=e,this.caption.disabled=e},a.GlobalManagerMixin.call(c.prototype),u.prototype.constructor=u,i.EventDispatcher.prototype.apply(u.prototype),a.GlobalManagerMixin.call(u.prototype),u.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var e=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(e)}},u.prototype.setChecked=function(e){this.checkElement.checked!=e&&(this.checkElement.checked=e,this.fireChangeEvent())},u.prototype.setValue=function(e){this.blockEvent=!0,this.checked=e,this.checkElement.checked=e,this.blockEvent=!1},u.prototype.getValue=function(){return this.checkElement.checked},u.prototype.setDisabled=function(e){this.checkElement.disabled=e,this.caption.disabled=e},u.prototype.setVisibility=function(e){this.sliderRow.style.display=e?"table-row":"none"},a.GlobalManagerMixin.call(h.prototype),a.GlobalManagerMixin.call(d.prototype),f.prototype.constructor=f,i.EventDispatcher.prototype.apply(f.prototype),f.prototype.setSelectedIndex=function(e){this.blockEvent=!0,this.selectedIndex=this.dropdownElement.selectedIndex=e,this.blockEvent=!1},f.prototype.setSelectedValue=function(e){this.blockEvent=!0,this.dropdownElement.selectedValue=e,this.selectedIndex=this.dropdownElement.selectedIndex,this.blockEvent=!1},f.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex;var e=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(e)}},f.prototype.setDisabled=function(e){this.dropdownElement.disabled=e,this.caption.disabled=e},a.GlobalManagerMixin.call(f.prototype),a.GlobalManagerMixin.call(p.prototype),a.GlobalManagerMixin.call(m.prototype);var g=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._parentDiv=t,this._renderRowFn=n,this._onClickFn=i,this._onRowClick=this._onRowClick.bind(this);var r=this.getDocument(),o=r.createElement("div");o.classList.add("settings-container"),this._parentDiv.appendChild(o),this._myContainer=o,this._myContainer.addEventListener("click",this._onRowClick,{capture:!0});var a=r.createElement("div");a.classList.add("settings-table"),this._rowsContainer=a,o.appendChild(a)}var t,n,i;return t=e,(n=[{key:"setData",value:function(e,t){this._removeAllRows(),this._items=e;for(var n=0;n<e.length;++n)this._addRow(n);this._updateSelection(t)}},{key:"removeFromParent",value:function(){this._myContainer.removeEventListener("click",this._onRowClick,{capture:!0}),this._removeAllRows(),this._parentDiv.removeChild(this._myContainer),this._parentDiv=null,this._myContainer=null,this._rowsContainer=null,this._onClickFn=null,this._items=null}},{key:"_addRow",value:function(e){var t=this._items[e],n=this.getDocument(),i=n.createElement("div");this._renderRowFn(i,t,{domDocument:n}),i.setAttribute("data-index",e),this._rowsContainer.appendChild(i)}},{key:"_removeAllRows",value:function(){for(var e=this._rowsContainer.children;e.length;)this._rowsContainer.removeChild(e[0])}},{key:"_updateSelection",value:function(e){this._myContainer;for(var t=this._rowsContainer.children,n=0;n<t.length;n++){var i=t[n];n===e?i.classList.add("border-select"):i.classList.remove("border-select")}}},{key:"_onRowClick",value:function(e){for(var t,n=e.target;n!==this._myContainer&&!(t=n.getAttribute("data-index"));)n=n.parentNode;if(t){var i=parseInt(t);this._onClickFn(i)}}}])&&s(t.prototype,n),i&&s(t,i),e}();a.GlobalManagerMixin.call(g.prototype)},function(e,t,n){"use strict";n.r(t),n.d(t,"Extension",(function(){return o}));var i=n(110),r=n(11),o=function(e,t){this.viewer=e,r.GlobalManagerMixin.call(this),this.setGlobalManager(e.globalManager),this.options=t||{},this.id="",this.modes=[],this.mode="",this.name="",this.activeStatus=!1};o.prototype.load=function(){return!0},o.prototype.unload=function(){return!0},o.prototype.activate=function(e){return!0},o.prototype.deactivate=function(){return!0},o.prototype.getName=function(){return this.name},o.prototype.getModes=function(){return this.modes},o.prototype.isActive=function(e){return e?this.activeStatus&&this.mode===e:this.activeStatus},o.prototype.getState=function(e){},o.prototype.restoreState=function(e,t){return!0},o.prototype.extendLocalization=function(e){return Object(i.extendLocalization)(e)},o.prototype.getCache=function(){this.viewer.extensionCache||(this.viewer.extensionCache={});var e=this.viewer.extensionCache[this.id];return e||(e=this.viewer.extensionCache[this.id]={}),e},o.prototype.onToolbarCreated=function(e){},"undefined"!=typeof Autodesk&&(Autodesk.Viewing.Extension=o)},function(e,t,n){"use strict";n.r(t),n.d(t,"Control",(function(){return r}));var i=n(32);function r(e,t){this._id=e,this._isCollapsible=!t||t.collapsible,this._toolTipElement=null,this._listeners={},this.container=this.getDocument().createElement("div"),this.container.id=e,this.addClass("adsk-control")}n(11).GlobalManagerMixin.call(r.prototype),r.Event={VISIBILITY_CHANGED:"Control.VisibilityChanged",COLLAPSED_CHANGED:"Control.CollapsedChanged"},i.EventDispatcher.prototype.apply(r.prototype),r.prototype.constructor=r,r.prototype.container=null,r.prototype.getId=function(){return this._id},r.prototype.setVisible=function(e){if(!this.container.classList.contains("adsk-hidden")===e)return!1;e?this.container.classList.remove("adsk-hidden"):this.container.classList.add("adsk-hidden");var t={type:r.Event.VISIBILITY_CHANGED,target:this,controlId:this._id,isVisible:e};return this.dispatchEvent(t),!0},r.prototype.isVisible=function(){return!this.container.classList.contains("adsk-hidden")},r.prototype.setToolTip=function(e){return(!this._toolTipElement||this._toolTipElement.getAttribute("tooltipText")!==e)&&(this._toolTipElement||(this._toolTipElement=this.getDocument().createElement("div"),this._toolTipElement.id=this._id+"-tooltip",this._toolTipElement.classList.add("adsk-control-tooltip"),this.container.appendChild(this._toolTipElement)),this._toolTipElement.setAttribute("data-i18n",e),this._toolTipElement.setAttribute("tooltipText",e),this._toolTipElement.textContent=Autodesk.Viewing.i18n.translate(e,{defaultValue:e}),!0)},r.prototype.getToolTip=function(){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")},r.prototype.setCollapsed=function(e){if(!this._isCollapsible||this.isCollapsed()===e)return!1;e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed");var t={type:r.Event.COLLAPSED_CHANGED,isCollapsed:e};return this.dispatchEvent(t),!0},r.prototype.isCollapsed=function(){return!!this.container.classList.contains("collapsed")},r.prototype.isCollapsible=function(){return this._isCollapsible},r.prototype.addClass=function(e){this.container.classList.add(e)},r.prototype.removeClass=function(e){this.container.classList.remove(e)},r.prototype.getPosition=function(){var e=this.container.getBoundingClientRect();return{top:e.top,left:e.left}},r.prototype.getDimensions=function(){var e=this.container.getBoundingClientRect();return{width:e.width,height:e.height}},r.prototype.setDisplay=function(e){this.container.style.display=e},r.prototype.removeFromParent=function(){return!!this.parent&&this.parent.removeControl(this)}},function(e,t,n){var i=n(157)("wks"),r=n(100),o=n(20).Symbol,a="function"==typeof o;(e.exports=function(e){return i[e]||(i[e]=a&&o[e]||(a?o:r)("Symbol."+e))}).store=i},function(e,t,n){"use strict";n.r(t),n.d(t,"Animation",(function(){return r})),n.d(t,"interpolateCatmullRom",(function(){return o}));var i=n(46);function r(e,t,n){this.root=e,this.handler=n.animationHandler,this.data=this.handler.init(t),this.hierarchy=this.handler.parse(e),this.viewer=n.viewer,this.animator=n,this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!1,this.delta=.5,this.interpolationType=i.a.LINEAR,this.setStartAndEndKeyTime()}function o(e,t){function n(e,t,n,i,r,o,a){var s=.5*(n-e),l=.5*(i-t);return(2*(t-n)+s+l)*a+(-3*(t-n)-2*s-l)*o+s*r+t}var i,r,o,a,s,l,c,u,h,d=[],f=[];return o=(i=(e.length-1)*t)-(r=Math.floor(i)),d[0]=0===r?r:r-1,d[1]=r,d[2]=r>e.length-2?r:r+1,d[3]=r>e.length-3?r:r+2,l=e[d[0]],c=e[d[1]],u=e[d[2]],h=e[d[3]],s=o*(a=o*o),f[0]=n(l[0],c[0],u[0],h[0],o,a,s),f[1]=n(l[1],c[1],u[1],h[1],o,a,s),f[2]=n(l[2],c[2],u[2],h[2],o,a,s),f}n(11).GlobalManagerMixin.call(r.prototype),r.prototype.setStartAndEndKeyTime=function(){if(this.data.hierarchy.length>0){var e=this.data.hierarchy[0].keys;this.startKeyTime=e[0].time,this.endKeyTime=e[e.length-1].time}else this.startKeyTime=this.endKeyTime=0},r.prototype.keyTypes=[],r.prototype.defaultKey={},r.prototype.play=function(e){this.currentTime=void 0!==e?e:0,this.isPlaying=!0,this.isPaused=!1,this.reset(),this.handler.play(this)},r.prototype.pause=function(){!0===this.isPaused?this.handler.play(this):this.handler.stop(this),this.isPaused=!this.isPaused},r.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.handler.stop(this)},r.prototype.goto=function(e){this.isPlaying||this.play(),this.isPaused||this.pause();var t=e-this.currentTime;this.update(t)},r.prototype.reset=function(){for(var e=0,t=this.hierarchy.length;e<t;e++){var n=this.hierarchy[e];void 0===n.animationCache&&(n.animationCache={}),void 0===n.animationCache[this.data.name]&&(n.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:n.matrix});for(var i=n.animationCache[this.data.name],r=0;r<this.keyTypes.length;r++){for(var o=this.keyTypes[r],a=this.data.hierarchy[e].keys[0],s=this.getNextKeyWith(o,e,1);s.time<this.currentTime&&s.index>a.index;)a=s,s=this.getNextKeyWith(o,e,s.index+1);i.prevKey[o]=a,i.nextKey[o]=s}}this.setStartAndEndKeyTime()},r.prototype.getNextKeyWith=function(e,t,n){var r=this.data.hierarchy[t].keys;for(this.interpolationType===i.a.CATMULLROM||this.interpolationType===i.a.CATMULLROM_FORWARD?n=n<r.length-1?n:r.length-1:n%=r.length;n<r.length;n++)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[0]},r.prototype.getPrevKeyWith=function(e,t,n){var r=this.data.hierarchy[t].keys;for(n=this.interpolationType===i.a.CATMULLROM||this.interpolationType===i.a.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+r.length;n>=0;n--)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[r.length-1]},r.prototype.isPlayingOutOfRange=function(){return!1===this.isPaused&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)},r.prototype.resetIfLooped=function(){!0===this.loop&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())}},function(e,t,n){var i=n(74),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){"use strict";n.r(t),n.d(t,"EventDispatcher",(function(){return i}));var i=function(){};i.prototype={constructor:i,apply:function(e){e.addEventListener=i.prototype.addEventListener,e.hasEventListener=i.prototype.hasEventListener,e.removeEventListener=i.prototype.removeEventListener,e.clearListeners=i.prototype.clearListeners,e.fireEvent=i.prototype.fireEvent,e.dispatchEvent=i.prototype.fireEvent,e.debugEvents=i.prototype.debugEvents},addEventListener:function(e,t,n){e&&(void 0===this.listeners&&(this.listeners={}),void 0===this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].push({callbackFn:t,once:!!n&&!!n.once}))},hasEventListener:function(e,t){if(!e)return!1;if(void 0===this.listeners)return!1;var n=this.listeners[e];if(!n||0===n.length)return!1;for(var i=0,r=n.length;i<r;++i)if(n[i].callbackFn===t)return!0;return!1},removeEventListener:function(e,t){if(e)if(void 0!==this.listeners){var n=this.listeners[e];if(n)for(var i=0,r=n.length;i<r;++i)if(n[i].callbackFn===t){n.splice(i,1);break}}else this.listeners={}},clearListeners:function(){this.listeners=null},dispatchEvent:function(e){if(void 0!==this.listeners){if("string"==typeof e&&(e={type:e}),!e.target)try{e.target=this}catch(e){}if(!e.type)throw new Error("event type unknown.");if(this._doDebug&&console.log("Event: "+e.type),Array.isArray(this.listeners[e.type])){for(var t=this.listeners[e.type].slice(),n=[],i=0,r=t.length;i<r;++i)t[i].callbackFn.call(this,e),t[i].once&&n.push(t[i].callbackFn);for(var o=0;o<n.length;++o)this.removeEventListener(e.type,n[o])}}else this.listeners={}},debugEvents:function(e){this._doDebug=e}},i.prototype.fireEvent=i.prototype.dispatchEvent,"undefined"!=typeof Autodesk&&(Autodesk.Viewing.EventDispatcher=i)},function(e,t,n){"use strict";n.r(t),n.d(t,"KeyCode",(function(){return i}));var i={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLONMOZ:59,EQUALSMOZ:61,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,LCOMMAND:91,RCOMMAND:93,PLUS:107,PLUSMOZ:171,DASHMOZ:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,DASHMOZNEW:173,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222,COMMANDMOZ:224}},function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},function(e,t,n){"use strict";n.r(t),n.d(t,"memoryOptimizedLoading",(function(){return r})),n.d(t,"GPU_MEMORY_LIMIT",(function(){return o})),n.d(t,"GPU_OBJECT_LIMIT",(function(){return a})),n.d(t,"USE_VAO",(function(){return s})),n.d(t,"GEOMETRY_OVERHEAD",(function(){return l})),n.d(t,"PIXEL_CULLING_THRESHOLD",(function(){return c}));var i=n(2),r=!0,o=1024*(Object(i.isMobileDevice)()?64:256)*1024,a=Object(i.isMobileDevice)()?2500:1e4,s=!Object(i.isMobileDevice)(),l=336,c=1},function(e,t,n){"use strict";n.r(t),n.d(t,"TextureLoader",(function(){return T}));var i=n(14),r=n(2),o=n(7),a=n(47),s=n(147),l=n(1),c=n(0),u=n(136),h=n(6),d=n(256),f=Object(r.getGlobal)(),p=f.document,m=new d;m.max=Object(r.isMobileDevice)()?4:6;var g=0,v=Object(r.isMobileDevice)()?32:1/0;v*=1048576;var y=0,_=1/0;function b(e){var t;!0===e.image.wasNPOT&&((t=e).format===c.AlphaFormat||t.format===c.RGBAFormat)&&function(e){return e.clampS||e.clampT}(e)&&function(e){return e.minFilter!==c.NearestFilter&&e.minFilter!==c.LinearFilter}(e)&&Object(r.isChrome)()&&Object(r.isWindows)()&&(e.minFilter=c.LinearFilter,e.generateMipmaps=!1,e.needsUpdate=!0)}function x(e,t,n,a,s,d,v){var y=h.endpoint.getUseCredentials(),x=h.endpoint.getUseCookie();y&&x?c.ImageUtils.crossOrigin="use-credentials":h.endpoint.getUseCredentials()?c.ImageUtils.crossOrigin="anonymous":c.ImageUtils.crossOrigin="";var w="";y&&s&&(w="acmsession="+s),v&&v.queryParams&&(w=w?w+"&":"",w+=v.queryParams);var A=h.endpoint.initLoadContext({queryParams:w});g++,m.go((function(s){var h=function(e,t){g--,t&&a?a(t):n(e),s()},m=d?h:function(e){function t(t){e&&(e.image=t),g--,n(e),s()}e&&e.image?function(e,t){var n,i,r=e.width,a=e.height;if(0==(r&r-1)&&0==(a&a-1)){if(r*a<=_)return void t(e);n=r,i=a}else{for(n=1;1.5*n<r;)n*=2;for(i=1;1.5*i<a;)i*=2}for(;n*i>_;)n=Math.max(n/2,1),i=Math.max(i/2,1);var s=p.createElement("canvas"),c=s.getContext("2d");s.width=n,s.height=i,c.drawImage(e,0,0,n,i);var u=new Image;u.wasNPOT=!0,u.src=s.toDataURL(),u.onload=function(){t(u)},u.onerror=function(e){l.logger.error(e,Object(o.errorCodeString)(o.ErrorCodes.UNKNOWN_FAILURE)),t(null)}}(e.image,t):t()},w=function(e){g--,l.logger.error("Texture load error",e),n(null),s()};if(Object(r.isNodeJS)())!function(e,t,n,r,a){var s=new c.DataTexture(void 0,n);i.ViewingService.getItem(t,e,(function(e){a&&a.extractImage&&(e=a.extractImage(e));s.image={data:e,width:void 0,height:void 0},s.needsUpdate=!0,r&&r(s)}),(function(e,t){var n="Error: "+e+" ("+t+")";l.logger.error(n,Object(o.errorCodeString)(o.ErrorCodes.NETWORK_SERVER_ERROR)),r&&r(null,{msg:t,args:e})}))}(e,A,t,h,v);else if(".dds"===e.slice(e.length-4).toLocaleLowerCase())if(Object(r.isIOSDevice)()){var E=e.slice(0,e.length-4)+".pvr";(new PVRLoader).load(E+"?"+A.queryParams,h,w)}else(new u.DDSLoader).load(e+"?"+A.queryParams,h,w);else y&&!x||v&&(v.rawData||v.extractImage)?function(e,t,n,r,a){var s=new c.Texture(void 0,n);function u(e){a&&a.extractImage&&(e=a.extractImage(e));var t,n,i=new Image;s.image=i,b(s),i.onload=function(){s.needsUpdate=!0,r&&r(s),f.URL.revokeObjectURL(i.src)},i.onerror=function(e){l.logger.error(e,Object(o.errorCodeString)(o.ErrorCodes.UNKNOWN_FAILURE)),r&&r(null)},i.src=(t=new Uint8Array(e),n=new Blob([t],{type:"image/jpeg"}),(f.URL||f.webkitURL).createObjectURL(n))}a&&a.rawData?u(a.rawData):i.ViewingService.getItem(t,e,u,(function(e,t){var n="Error: "+e+" ("+t+")";l.logger.error(n,Object(o.errorCodeString)(o.ErrorCodes.NETWORK_SERVER_ERROR)),r&&r(null,{msg:t,args:e})}),a)}(e,A,t,m,v):c.ImageUtils.loadTexture(A.queryParams?e+"?"+A.queryParams:e,t,m,w)}))}function w(e,t,n){var r=t.getData();return x(t.isOTG()?function(e){var t=h.endpoint.initLoadContext({});return r.makeSharedResourcePath(t.otg_cdn,"textures",e)}(e):function(e){for(var t=null,n=0;n<r.manifest.assets.length;++n){var o=r.manifest.assets[n];if(o.id.toLowerCase()==e.toLowerCase()){t=Object(i.pathToURL)(r.basePath+o.URI);break}}return t||(t=Object(i.pathToURL)(r.basePath+e)),t}(e),c.UVMapping,n,null,r.acmSessionId)}function A(e,t,n){if(t.textureMaps&&!t.texturesLoaded){t.texturesLoaded=!0;var i=e.getData(),r=t.textureMaps;for(var o in r){var s=r[o];if(!n.matman().loadTextureFromCache(e,t,s,o))w(s.uri,e,function(t){return function(r){if(r){var o=i.materials.scene.SceneUnit,s=n.renderer()?n.renderer().getMaxAnisotropy():0;a.MaterialConverter.convertTexture(t,r,o,s)}var l=n.matman();l&&(l.setTextureInCache(e,t,r),i.loadOptions.onTextureReceived&&i.loadOptions.onTextureReceived(l,t,r,!E()),!E()&&n&&i.loadDone&&!i.texLoadDone&&(i.texLoadDone=!0,n.onTextureLoadComplete(e)))}}(s))}}}function E(){return g}function M(e){e>=0&&(y=e,_=Math.max(16384,v/(4*y)))}var T={loadTextureWithSecurity:x,loadMaterialTextures:A,loadModelTextures:function(e,t){var n=t.matman(),i=n._getModelHash(e),r=0;if(e.isOTG())r=e.getData().metadata.stats.num_textures||0;else for(var o in n._materials){if(-1!==o.indexOf(i))(a=n._materials[o]).textureMaps&&(r+=Object.keys(a.textureMaps).length)}for(var o in M(r),n._materials){var a;if(-1!==o.indexOf(i))A(e,a=n._materials[o],t)}var s=e.getData();!E()&&t&&s.loadDone&&!s.texLoadDone&&(s.texLoadDone=!0,t.onTextureLoadComplete(e))},loadCubeMap:function(e,t,n){var i,r=function(i){i?(i.mapping=c.CubeReflectionMapping,i.LogLuv=-1!==e.indexOf("logluv"),i.RGBM=-1!==e.indexOf("rgbm"),Object(s.DecodeEnvMap)(i,t,!1,n)):n&&n(i)};return c.ImageUtils.crossOrigin="",Array.isArray(e)?(i=c.ImageUtils.loadTextureCube(e,c.CubeReflectionMapping,r)).format=c.RGBFormat:"string"==typeof e?-1!==e.toLowerCase().indexOf(".dds")?i=(new u.DDSLoader).load(e,r):(i=c.ImageUtils.loadTexture(e,c.SphericalReflectionMapping,n)).format=c.RGBFormat:e?n&&n(e):n&&n(null),i},requestsInProgress:E,calculateTextureSize:function(e){var t=4;switch(e.format){case c.AlphaFormat:t=1;break;case c.RGBFormat:t=3;break;case c.LuminanceFormat:t=1;break;case c.LuminanceAlphaFormat:t=2}switch(e.type){case c.ShortType:case c.UnsignedShortType:case c.HalfFloatType:t*=2;break;case c.IntType:case c.UnsignedIntType:case c.FloatType:t*=4;break;case c.UnsignedShort4444Type:case c.UnsignedShort5551Type:case c.UnsignedShort565Type:t=2}var n=t*e.image.width;return n+=e.unpackAlignment-1,n-=n%e.unpackAlignment,e.image.height*n},imageToCanvas:function(e){var t=e.width,n=e.height,i=p.createElement("canvas"),r=i.getContext("2d");return r.globalCompositeOperation="copy",i.width=t,i.height=n,r.drawImage(e,0,0,t,n),i}}},function(e,t,n){"use strict";n.r(t),n.d(t,"ShaderPass",(function(){return o}));var i=n(25),r=n(0),o=function(e,t){this.textureID=void 0!==t?t:"tDiffuse",this.material=Object(i.createShaderMaterial)(e),this.uniforms=this.material.uniforms,this.renderToScreen=!1,this.enabled=!0,this.clear=!1,this.camera=new r.OrthographicCamera(-1,1,1,-1,0,1);var n=new r.BufferGeometry,o=new Float32Array(9);o[0]=-1,o[1]=-1,o[2]=0,o[3]=3,o[4]=-1,o[5]=0,o[6]=-1,o[7]=3,o[8]=0;var a=new Float32Array(6);a[0]=0,a[1]=0,a[2]=2,a[3]=0,a[4]=0,a[5]=2;var s=new Float32Array(9);s[0]=0,s[1]=0,s[2]=1,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=1,n.addAttribute("position",new r.BufferAttribute(o,3)),n.addAttribute("normal",new r.BufferAttribute(s,3)),n.addAttribute("uv",new r.BufferAttribute(a,2)),this.quad=new r.Mesh(n,this.material),this.scene=new r.Scene,this.scene.add(this.quad)};o.prototype={render:function(e,t,n,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture||n),this.renderToScreen||!t?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}}},function(e,t,n){e.exports=!n(21)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var i=n(22),r=n(258),o=n(94),a=Object.defineProperty;t.f=n(38)?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var i=n(2),r=i.isNodeJS,o=i.getGlobal,a=n(13).getResourceUrl;r()?function(){var t=n(364).MainWorker;function i(){return new t}e.exports={createWorker:i,initWorkerScript:function(e,t){e&&e()},createWorkerWithIntercept:function(){return i()}}}():function(){var t=Autodesk.Viewing.Private,n=t.LMV_WORKER_URL||"src/file-loaders/workers/MainWorker-web.js",i=null,r=!1,s=[];function l(){var e;return(e=t.ENABLE_INLINE_WORKER?new Worker(i):new Worker(a(n))).doOperation=e.postMessage,e}e.exports={createWorker:l,initWorkerScript:function(e,l){if(t.ENABLE_INLINE_WORKER&&!i){if(s.push({successCB:e}),!r){var c=new XMLHttpRequest,u=n,h=a(n);h&&(u=h),c.open("GET",u,!0),c.withCredentials=!1,c.onload=function(){var e,t=o();r=!1,t.URL=t.URL||t.webkitURL;try{e=new Blob([c.responseText],{type:"application/javascript"})}catch(t){var n=new BlobBuilder;n.append(c.responseText),e=n.getBlob()}i=URL.createObjectURL(e);var a=s.concat();s=[];for(var l=0;l<a.length;++l)a[l].successCB&&a[l].successCB()},r=!0,c.send()}var d={cancel:function(){var t=-1;return!!s.some((function(n,i){return n.successCB==e&&(t=i,!0)}))&&(s.splice(t,1),!0)}};return d}return e&&e(),null},createWorkerWithIntercept:function(){var e=l();e.checkEvent=function(e){return!(!e.data||!e.data.assetRequest)};var t=[];return e.addEventListenerWithIntercept=function(n){var i=function(t){e.checkEvent(t)||n(t)};return t||(t=[]),t.push({arg:n,callback:i}),e.addEventListener("message",i,!1),i},e.removeEventListenerWithIntercept=function(n){var i=function(e){if(!t)return null;for(var n=0;n<t.length;++n)if(t[n].arg===e){var i=t[n].callback;return t.splice(n,1),0===t.length&&(t=null),i}return null}(n);i&&e.removeEventListener("message",i,!1)},e.clearAllEventListenerWithIntercept=function(){if(t)for(var n=t.concat(),i=0;i<n.length;++i)e.removeEventListenerWithIntercept(n[i].arg)},e},clearWorkerDataURL:function(){i=null}}}()},function(e,t,n){"use strict";n.r(t),n.d(t,"DockingPanel",(function(){return o}));var i=n(9),r=n(26);function o(e,t,n,i){this.kMinWdth=100,this.kMinHeight=100,this.visibilityCallbacks=[],this.movedSinceLastClick=!1,this.movedSinceCreate=!1,this.parentContainer=e;var r=this.getDocument();this.container=r.createElement("div"),this.container.id=t,this.container.lastWidth="",this.container.dockRight=!1,this.container.dockBottom=!1,this.titleLabel=n,(i=i||{}).hasOwnProperty("localizeTitle")||(i.localizeTitle=!0),i.hasOwnProperty("addFooter")||(i.addFooter=!0),this.options=i,this.container.classList.add("docking-panel"),e.appendChild(this.container),this.listeners=[],this.initialize(),this.setVisible(!1)}n(11).GlobalManagerMixin.call(o.prototype),o.prototype.onSetGlobalManager=function(e){this.footerInstance&&this.footerInstance.setGlobalManager(e)},o.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id),this.container.appendChild(this.title),this.initializeMoveHandlers(this.title),this.setTitle(this.titleLabel||this.container.id,this.options),this.closer=this.createCloseButton(),this.container.appendChild(this.closer),this.options.addFooter&&(this.footer=this.createFooter(),this.container.appendChild(this.footer))},o.prototype.uninitialize=function(){for(var e=0;e<this.listeners.length;++e){var t=this.listeners[e];t.target.removeEventListener(t.eventId,t.callback)}this.listeners=[],this.visibilityCallbacks=[],this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null,this.title=null,this.closer=null},o.prototype.addVisibilityListener=function(e){this.visibilityCallbacks.push(e)},o.prototype.setVisible=function(e){if(e){var t=this.getContainerBoundingRect();if(this.container.dockRight){var n=t.width,i=300,r=this.container.lastWidth||this.container.style.width;r||(r=this.container.getBoundingClientRect().width),r&&(i=parseInt(r)),this.container.style.left=n-i+"px"}if(this.container.dockBottom){var o=t.height,a=300,s=this.container.lastHeight||this.container.style.height;s||(s=this.container.getBoundingClientRect().height),s&&(a=parseInt(s));var l=o-a;this.container.style.top=l>0?l+"px":0}this.container.style.maxHeight=t.height+"px",this.container.style.maxWidth=t.width+"px",this.container.style.display="block",this.bringToFront()}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=this.container.style.height,this.container.style.display="none";for(var c=0;c<this.visibilityCallbacks.length;c++)this.visibilityCallbacks[c](e)},o.prototype.isVisible=function(){return"block"===this.container.style.display},o.prototype.visibilityChanged=function(){},o.prototype.initializeMoveHandlers=function(e){var t,n,i,r,o,a,s,l,c=this.container,u=this;function h(e){var h=c.style.minWidth?parseInt(c.style.minWidth):u.kMinWdth,d=c.style.minHeight?parseInt(c.style.minHeight):u.kMinHeight,f=u.getContainerBoundingRect();c.style.maxWidth&&parseInt(c.style.width)>parseInt(c.style.maxWidth)&&(c.style.width=c.style.maxWidth),c.style.maxHeight&&parseInt(c.style.height)>parseInt(c.style.maxHeight)&&(c.style.height=c.style.maxHeight),parseInt(c.style.width)<h&&(c.style.width=h+"px"),parseInt(c.style.height)<d&&(c.style.height=d+"px"),"touchmove"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),s+=e.screenX-i,l+=e.screenY-r,t=o+s,n=a+l;var p=parseInt(c.style.width),m=parseInt(c.style.height);isNaN(p)&&(p=u.container.getBoundingClientRect().width),isNaN(m)&&(m=u.container.getBoundingClientRect().height),t<5&&(t=0),n<5&&(n=0),c.dockRight=!1,c.dockBottom=!1,f.width-5<t+p&&(t=f.width-p,c.dockRight=!0),f.height-5<n+m&&(n=f.height-m,c.dockBottom=!0),c.style.left=t+"px",c.style.top=n+"px",c.style.maxWidth=f.width-t+"px",c.style.maxHeight=f.height-n+"px",i=e.screenX,r=e.screenY,u.onMove(e,t,n)}function d(e){u.removeWindowEventListener("mousemove",h),u.removeWindowEventListener("mouseup",d),u.removeWindowEventListener("touchmove",h),u.removeWindowEventListener("touchend",d),u.onEndMove(e,t,n)}function f(e){"touchstart"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),i=e.screenX,r=e.screenY,s=0,l=0,o=u.container.offsetLeft,a=u.container.offsetTop,u.addWindowEventListener("mousemove",h,!1),u.addWindowEventListener("mouseup",d,!1),u.addWindowEventListener("touchmove",h,!1),u.addWindowEventListener("touchend",d,!1),e.preventDefault(),u.onStartMove(e,o,a)}u.addEventListener(e,"mousedown",f),u.addEventListener(e,"touchstart",f)},o.prototype.initializeCloseHandler=function(e){var t=this;t.addEventListener(e,"click",(function(e){t.setVisible(!1)}),!1)},o.prototype.createScrollContainer=function(e){var t=this.getDocument().createElement("div"),n=t.classList;return n.add("docking-panel-scroll"),n.add("docking-panel-container-solid-color-a"),n.add(e&&e.left?"left":"right"),e&&e.heightAdjustment&&(t.style.height="calc(100% - "+e.heightAdjustment+"px)"),e&&e.marginTop&&(t.style.marginTop=e.marginTop+"px"),t.id=this.container.id+"-scroll-container",this.container.appendChild(t),this.scrollContainer=t,this.scrollEaseCurve=e&&e.scrollEaseCurve||[0,0,.29,1],this.scrollEaseSpeed=e&&e.scrollEaseSpeed||.003,t},o.prototype.createTitleBar=function(e){var t=this.getDocument().createElement("div");t.classList.add("docking-panel-title"),t.textContent=e;var n=this;return n.addEventListener(t,"click",(function(e){n.movedSinceLastClick||n.onTitleClick(e),n.movedSinceLastClick=!1})),n.addEventListener(t,"mousedown",(function(e){n.bringToFront()})),n.addEventListener(t,"dblclick",(function(e){n.onTitleDoubleClick(e)})),t},o.prototype.createFooter=function(){var e=new r.ResizeFooter(this.container);return e.setGlobalManager(this.globalManager),this.footerInstance=e,this.container.style.resize="none",e.footer},o.prototype.setTitle=function(e,t){t&&t.localizeTitle?(this.title.setAttribute("data-i18n",e),e=i.i18n.translate(e)):this.title.removeAttribute("data-i18n"),this.title.textContent=e},o.prototype.createCloseButton=function(){var e=this.getDocument().createElement("div");return e.className="docking-panel-close",this.initializeCloseHandler(e),e},o.prototype.onStartMove=function(e,t,n){},o.prototype.onEndMove=function(e,t,n){},o.prototype.onMove=function(e,t,n){this.movedSinceLastClick=!0,this.movedSinceCreate=!0},o.prototype.onTitleClick=function(e){},o.prototype.onTitleDoubleClick=function(e){},o.prototype.addEventListener=function(e,t,n){e.addEventListener(t,n),this.listeners.push({target:e,eventId:t,callback:n})},o.prototype.removeEventListener=function(e,t,n){for(var i=0;i<this.listeners.length;++i){var r=this.listeners[i];if(r.target===e&&r.eventId===t&&r.callback===n)return e.removeEventListener(t,n),this.listeners.splice(i,1),!0}return!1},o.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}},o.prototype.resizeToContent=function(e){if(this.isVisible()){var t=this.getContentSize().height,n=this.container.getBoundingClientRect(),i=this.getContainerBoundingRect(),r=this.container.querySelector(".docking-panel-footer");r&&(t+=r.getBoundingClientRect().height);var o=i.height;o-=n.top-i.top+75,e&&void 0!==e.maxHeight&&(o=Math.min(o,e.maxHeight)),t>o&&(t=o),this.container.style.maxHeight=o.toString()+"px",this.container.style.height=t.toString()+"px"}},o.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()},o.prototype.animateScroll=function(e,t,n){var i=this.scrollEaseCurve,r=this.scrollEaseSpeed,o=this.scrollContainer;var a=performance.now();requestAnimationFrame((function s(l){var c=(l-a)*r;c=Math.min(c,1);var u=function(e,t){var n=3*e[1],i=3*(e[3]-e[1])-n;return(((1-n-i)*t+i)*t+n)*t}(i,c),h=e+(t-e)*u;o.scrollTop=h,n&&n(h),c<1&&requestAnimationFrame(s)}))},o.prototype.onViewerResize=function(e,t,n,i,r,o){var a=this.container,s=a.getBoundingClientRect(),l=s.width,c=s.height;if(!l||!c)return!1;var u=s.top,h=s.bottom,d=s.left,f=s.right;return r<l&&(l=Math.round(r),a.style.width=l+"px"),o<c&&(c=Math.round(o),a.style.height=c+"px"),(i<f||a.dockRight)&&(d=Math.round(i-l-n),a.style.left=d+"px"),(t<h||a.dockBottom)&&((u=Math.round(t-c-e))<0&&(u=0),a.style.top=u+"px"),a.style.maxWidth=Math.round(r)+"px",a.style.maxHeight=Math.round(o)+"px",!0},o.prototype.bringToFront=function(){var e=this.scrollContainer?this.scrollContainer.scrollTop:0;this.parentContainer.appendChild(this.container),this.scrollContainer&&(this.scrollContainer.scrollTop=e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"ControlGroup",(function(){return r}));var i=n(28);function r(e,t){i.Control.call(this,e,t);var n=this;this._controls=[],this.addClass("adsk-control-group"),this.handleChildSizeChanged=function(e){var t={type:r.Event.SIZE_CHANGED,childEvent:e};n.dispatchEvent(t)}}r.Event={VISIBILITY_CHANGED:i.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:i.Control.Event.COLLAPSED_CHANGED,SIZE_CHANGED:"ControlGroup.SizeChanged",CONTROL_ADDED:"ControlGroup.ControlAdded",CONTROL_REMOVED:"ControlGroup.ControlRemoved"},r.prototype=Object.create(i.Control.prototype),r.prototype.constructor=r,r.prototype.addControl=function(e,t){e.setGlobalManager(this.globalManager);var n=t&&void 0!==t.index?t.index:this._controls.length;if(null!==this.getControl(e.getId()))return!1;var o={type:r.Event.CONTROL_ADDED,control:e,index:n};return n<this._controls.length?(this.container.insertBefore(e.container,this._controls[n].container),this._controls.splice(n,0,e)):(this.container.appendChild(e.container),this._controls.push(e)),e.addEventListener(i.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),e.addEventListener(i.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),e instanceof r&&e.addEventListener(r.Event.SIZE_CHANGED,this.handleChildSizeChanged),e.parent=this,this.dispatchEvent(o),this.dispatchEvent(r.Event.SIZE_CHANGED),!0},r.prototype.indexOf=function(e){for(var t=0;t<this._controls.length;t++){var n=this._controls[t];if(n===e||"string"==typeof e&&e===n.getId())return t}return-1},r.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;if(!t)return!1;var n=this._controls.indexOf(t);if(-1===n)return!1;this._controls.splice(n,1),this.container.removeChild(t.container);var o={type:r.Event.CONTROL_REMOVED,control:t,index:n};return t.removeEventListener(i.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),t.removeEventListener(i.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),t instanceof r&&t.removeEventListener(r.Event.SIZE_CHANGED,this.handleChildSizeChanged),t.parent=void 0,this.dispatchEvent(o),this.dispatchEvent(r.Event.SIZE_CHANGED),!0},r.prototype.getControl=function(e){for(var t=0;t<this._controls.length;t++)if(e===this._controls[t].getId())return this._controls[t];return null},r.prototype.getControlId=function(e){return e<0||e>=this._controls.length?null:this._controls[e].getId()},r.prototype.getNumberOfControls=function(){return this._controls.length},r.prototype.setCollapsed=function(e){if(!this._isCollapsible)return!1;var t=!1;return this._controls.forEach((function(n){n.isCollapsible()&&n.setCollapsed(e)&&(t=!0)})),t&&(e?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this.dispatchEvent({type:r.Event.COLLAPSED_CHANGED,isCollapsed:e})),t}},function(e,t,n){"use strict";n.r(t),n.d(t,"FrustumIntersector",(function(){return o})),n.d(t,"OUTSIDE",(function(){return l})),n.d(t,"INTERSECTS",(function(){return c})),n.d(t,"CONTAINS",(function(){return u})),n.d(t,"CONTAINMENT_UNKNOWN",(function(){return h}));var i=n(0),r=[[1,5,4,7,3,2,6],[0,3,2,1,5,4,6],[0,3,2,6,5,4,6],[0,4,7,3,2,1,6],[0,3,2,1,-1,-1,4],[0,3,2,6,5,1,6],[0,4,7,6,2,1,6],[0,3,7,6,2,1,6],[0,3,7,6,5,1,6],[0,1,5,4,7,3,6],[0,1,5,4,-1,-1,4],[0,1,2,6,5,4,6],[0,4,7,3,-1,-1,4],[-1,-1,-1,-1,-1,-1,0],[1,2,6,5,-1,-1,4],[0,4,7,6,2,3,6],[2,3,7,6,-1,-1,4],[1,2,3,7,6,5,6],[0,1,5,6,7,3,6],[0,1,5,6,7,4,6],[0,1,2,6,7,4,6],[0,4,5,6,7,3,6],[4,5,6,7,-1,-1,4],[1,2,6,7,4,5,6],[0,4,5,6,2,3,6],[2,3,7,4,5,6,6],[1,2,3,7,4,5,6]];function o(){this.frustum=new i.Frustum,this.viewProj=new i.Matrix4,this.viewDir=[0,0,1],this.ar=1,this.viewport=new i.Vector3(1,1,1),this.areaConv=1,this.areaCullThreshold=1,this.eye=new i.Vector3,this.perspective=!1}var a,s,l=0,c=1,u=2,h=-1;function d(e,t,n){return n.x=1&t?e.max.x:e.min.x,n.y=2&t?e.max.y:e.min.y,n.z=4&t?e.max.z:e.min.z,n}o.OUTSIDE=l,o.INTERSECTS=c,o.CONTAINS=u,o.CONTAINMENT_UNKNOWN=h,o.prototype.reset=function(e,t){this.viewProj.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this.perspective=e.isPerspective,this.frustum.setFromMatrix(this.viewProj);var n=e.matrixWorldInverse.elements;this.ar=e.aspect,this.viewDir[0]=-n[2],this.viewDir[1]=-n[6],this.viewDir[2]=-n[10],this.eye.x=e.position.x,this.eye.y=e.position.y,this.eye.z=e.position.z,this.areaConv=e.clientWidth*e.clientHeight/4,this.cutPlanes=t},o.prototype.projectedArea=function(){var e=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3],t=new i.Box2;function n(e,t){var n=e.x,i=e.y,r=e.z,o=t.elements,a=o[3]*n+o[7]*i+o[11]*r+o[15];a<0&&(a=-a);var s=1/a;e.x=(o[0]*n+o[4]*i+o[8]*r+o[12])*s,e.y=(o[1]*n+o[5]*i+o[9]*r+o[13])*s}return function(i){if(i.empty())return 0;var r=this.viewProj;e[0].set(i.min.x,i.min.y,i.min.z),e[1].set(i.min.x,i.min.y,i.max.z),e[2].set(i.min.x,i.max.y,i.min.z),e[3].set(i.min.x,i.max.y,i.max.z),e[4].set(i.max.x,i.min.y,i.min.z),e[5].set(i.max.x,i.min.y,i.max.z),e[6].set(i.max.x,i.max.y,i.min.z),e[7].set(i.max.x,i.max.y,i.max.z);for(var o=0;o<8;o++)n(e[o],r);return t.makeEmpty(),t.setFromPoints(e),t.min.x<-1&&(t.min.x=-1),t.min.x>1&&(t.min.x=1),t.min.y<-1&&(t.min.y=-1),t.min.y>1&&(t.min.y=1),t.max.x>1&&(t.max.x=1),t.max.x<-1&&(t.max.x=-1),t.max.y>1&&(t.max.y=1),t.max.y<-1&&(t.max.y=-1),(t.max.x-t.min.x)*(t.max.y-t.min.y)}}(),o.prototype.projectedBoxArea=function(){for(var e,t=[],n=[],o=0;o<10;o++)t.push(new i.Vector3),n.push(new i.Vector3);function a(e,t){var n=e.x,i=e.y,r=e.z,o=t.elements,a=o[3]*n+o[7]*i+o[11]*r+o[15];a<0&&(a=-a);var s=1/a;e.x=(o[0]*n+o[4]*i+o[8]*r+o[12])*s,e.y=(o[1]*n+o[5]*i+o[9]*r+o[13])*s}return function(i,o){if(i.empty())return 0;var s,l=this.viewProj;if(this.perspective?(s=this.eye.x>=i.min.x?this.eye.x>i.max.x?2:1:0,this.eye.y>=i.min.y&&(s+=this.eye.y>i.max.y?6:3),this.eye.z>=i.min.z&&(s+=this.eye.z>i.max.z?18:9)):(s=this.viewDir[0]<=0?this.viewDir[0]<0?2:1:0,this.viewDir[1]<=0&&(s+=this.viewDir[1]<0?6:3),this.viewDir[2]<=0&&(s+=this.viewDir[2]<0?18:9)),13===s)return 4;var c,u=r[s][6];for(c=0;c<u;c++){var h=r[s][c];t[c].set((h+1)%4<2?i.min.x:i.max.x,h%4<2?i.min.y:i.max.y,h<4?i.min.z:i.max.z),a(t[c],l)}var d=0;if(o)for(d=(t[u-1].x-t[0].x)*(t[u-1].y+t[0].y),c=0;c<u-1;c++)d+=(t[c].x-t[c+1].x)*(t[c].y+t[c+1].y);else{var f=function(t,i){var r,o,a,s,l,c,u,h,d=t,f=n,p=function(e){switch(u){case 0:return e.x>=-1;case 1:return e.x<=1;case 2:return e.y>=-1;case 3:return e.y<=1}},m=function(e){f[h].x=e.x,f[h++].y=e.y},g=function(){var e,t;switch(u){case 0:e=-1,t=o.y+(a.y-o.y)*(e-o.x)/(a.x-o.x);break;case 1:e=1,t=o.y+(a.y-o.y)*(e-o.x)/(a.x-o.x);break;case 2:t=-1,e=o.x+(a.x-o.x)*(t-o.y)/(a.y-o.y);break;case 3:t=1,e=o.x+(a.x-o.x)*(t-o.y)/(a.y-o.y)}f[h].x=e,f[h++].y=t};for(u=0;u<4&&i>2;u++){for(h=0,s=p(o=d[i-1]),c=0;c<i;c++)l=p(a=d[c]),s?l?m(a):g():l&&(g(),m(a)),o=a,s=l;i=h,r=d,d=f,f=r}return e=i,d}(t,u);if(e>=3)for(d=(f[e-1].x-f[0].x)*(f[e-1].y+f[0].y),c=0;c<e-1;c++)d+=(f[c].x-f[c+1].x)*(f[c].y+f[c+1].y)}return Math.abs(.5*d)}}(),o.prototype.estimateDepth=function(e){var t=this.viewProj.elements,n=(e.min.x+e.max.x)/2,i=(e.min.y+e.max.y)/2,r=(e.min.z+e.max.z)/2,o=1/(t[3]*n+t[7]*i+t[11]*r+t[15]);return(t[2]*n+t[6]*i+t[10]*r+t[14])*o},o.prototype.intersectsBox=(a=new i.Vector3,s=new i.Vector3,function(e){for(var t=this.frustum.planes,n=0,i=0;i<6;i++){var r=t[i];a.x=r.normal.x>0?e.min.x:e.max.x,s.x=r.normal.x>0?e.max.x:e.min.x,a.y=r.normal.y>0?e.min.y:e.max.y,s.y=r.normal.y>0?e.max.y:e.min.y,a.z=r.normal.z>0?e.min.z:e.max.z,s.z=r.normal.z>0?e.max.z:e.min.z;var l=r.distanceToPoint(a),c=r.distanceToPoint(s);if(l<0&&c<0)return o.OUTSIDE;l>0&&c>0&&n++}return 6==n?o.CONTAINS:o.INTERSECTS});var f,p=function(e,t){f||(f=new i.Vector3);for(var n=0;n<8;n++){var r=d(e,n,f);if(a=t,!((o=r).x*a.x+o.y*a.y+o.z*a.z+a.w>1e-6))return!1}var o,a;return!0};o.prototype.boxOutsideCutPlanes=function(e){if(!this.cutPlanes)return!1;for(var t=0;t<this.cutPlanes.length;t++){var n=this.cutPlanes[t];if(p(e,n))return!0}return!1}},function(e,t,n){"use strict";n.r(t),n.d(t,"ProgressState",(function(){return i}));var i={ROOT_LOADED:0,LOADING:1,RENDERING:2}},function(e,t,n){"use strict";n.r(t),n.d(t,"getVertexCount",(function(){return m})),n.d(t,"enumMeshVertices",(function(){return g})),n.d(t,"enumMeshIndices",(function(){return v})),n.d(t,"enumMeshTriangles",(function(){return y})),n.d(t,"enumMeshLines",(function(){return _})),n.d(t,"enumMeshEdges",(function(){return b})),n.d(t,"VertexEnumerator",(function(){return x}));var i,r,o,a,s,l,c,u,h,d,f,p=n(12);function m(e){return e.vb?e.vb.length/e.vbstride:e.attributes.positions?e.attributes.positions.count:0}function g(e,t,n){var a=e.attributes;i||(i=new p.LmvVector3,r=new p.LmvVector3,new p.LmvVector3),n&&(o||(o=new THREE.Matrix3),o.getNormalMatrix(n));var s,l=e.vb||a.position.array,c=e.vb||a.normal&&a.normal.array,u=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;s=e.vblayout.position.offset}else{if(!a.position)return;s=a.position.itemOffset||0}var h=0,d=e.vblayout?e.vblayout.normal:a.normal||null;d?h=d.offset||d.itemOffset||0:c=null,!d||3===d.itemSize&&4===d.bytesPerItem||(c=null);for(var f=e.vb?e.vb.length/e.vbstride:l.length,m=s,g=h,v=0;v<f;v++,m+=u,g+=u)i.set(l[m],l[m+1],l[m+2]),n&&i.applyMatrix4(n),c&&(r.set(c[g],c[g+1],c[g+2]),n&&r.applyMatrix3(o)),t(i,c?r:null,null,v)}function v(e,t){var n=e.ib||e.indices||(attributes.index?attributes.index.array:null);if(n){var i=e.offsets;i&&0!==i.length||(i=[{start:0,count:n.length,index:0}]);for(var r=0,o=i.length;r<o;++r)for(var a=i[r].start,s=i[r].count,l=i[r].index,c=a,u=a+s;c<u;c+=3){t(l+n[c],l+n[c+1],l+n[c+2])}}else for(var h=e.vb||attributes.position.array,d=e.vb?e.vb.length/e.vbstride:h.length/3,f=0;f<d;f++){t(3*f,3*f+1,3*f+2)}}function y(e,t){var n,i,r,o=e.attributes;a||(a=new p.LmvVector3,s=new p.LmvVector3,l=new p.LmvVector3,c=new p.LmvVector3,u=new p.LmvVector3,h=new p.LmvVector3);var d,f=e.vb||o.position.array,m=e.vb||o.normal&&o.normal.array,g=e.vb?e.vbstride:3;if(e.vblayout){if(!e.vblayout.position)return;d=e.vblayout.position.offset}else{if(!o.position)return;d=o.position.itemOffset||0}var v=0,y=e.vblayout?e.vblayout.normal:o.normal||null;y?v=y.offset||y.itemOffset||0:m=null,!y||3===y.itemSize&&4===y.bytesPerItem||(m=null);var _=e.ib||e.indices||(o.index?o.index.array:null);if(_){var b=e.offsets;b&&0!==b.length||(b=[{start:0,count:_.length,index:0}]);for(var x=0,w=b.length;x<w;++x)for(var A=b[x].start,E=b[x].count,M=b[x].index,T=A,S=A+E;T<S;T+=3){var C=(n=M+_[T])*g+d,P=(i=M+_[T+1])*g+d,L=(r=M+_[T+2])*g+d;if(a.x=f[C],a.y=f[C+1],a.z=f[C+2],s.x=f[P],s.y=f[P+1],s.z=f[P+2],l.x=f[L],l.y=f[L+1],l.z=f[L+2],m){var D=n*g+v,R=i*g+v,I=r*g+v;c.x=m[D],c.y=m[D+1],c.z=m[D+2],u.x=m[R],u.y=m[R+1],u.z=m[R+2],h.x=m[I],h.y=m[I+1],h.z=m[I+2],t(a,s,l,n,i,r,c,u,h,T/3)}else t(a,s,l,n,i,r,null,null,null,T/3)}}else{var O=e.vb?e.vb.length/e.vbstride:f.length/3;for(T=0;T<O;T++){C=(n=3*T)*g+d,P=(i=3*T+1)*g+d,L=(r=3*T+2)*g+d;if(a.x=f[C],a.y=f[C+1],a.z=f[C+2],s.x=f[P],s.y=f[P+1],s.z=f[P+2],l.x=f[L],l.y=f[L+1],l.z=f[L+2],m){D=n*g+v,R=i*g+v,I=r*g+v;c.x=m[D],c.y=m[D+1],c.z=m[D+2],u.x=m[R],u.y=m[R+1],u.z=m[R+2],h.x=m[I],h.y=m[I+1],h.z=m[I+2],t(a,s,l,n,i,r,c,u,h,T)}else t(a,s,l,n,i,r,null,null,null,T)}}}function _(e,t){var n,i,r=e.attributes;d||(d=new p.LmvVector3,f=new p.LmvVector3);var o=2;e.lineWidth&&(o=6);var a=e.ib||e.indices||(r.index?r.index.array:null);if(a){var s=e.vb?e.vb:r.position.array,l=e.vb?e.vbstride:3,c=e.offsets;c&&0!==c.length||(c=[{start:0,count:a.length,index:0}]);for(var u=0,h=c.length;u<h;++u)for(var m=c[u].start,g=c[u].count,v=c[u].index,y=m,_=m+g,b=m/o;y<_;y+=o,b++)n=v+a[y],i=v+a[y+1],d.x=s[n*l],d.y=s[n*l+1],d.z=s[n*l+2],f.x=s[i*l],f.y=s[i*l+1],f.z=s[i*l+2],t(d,f,n,i,b)}else for(s=e.vb?e.vb:r.position.array,l=e.vb?e.vbstride:3,y=0,_=s.length/l,b=0;y<_;y+=o,b++)n=y,i=y+1,d.x=s[n*l],d.y=s[n*l+1],d.z=s[n*l+2],f.x=s[i*l],f.y=s[i*l+1],f.z=s[i*l+2],t(d,f,n,i,b)}function b(e,t){var n,i,r=e.attributes;d||(d=new p.LmvVector3,f=new p.LmvVector3);var o=e.iblines;if(o){var a=e.vb?e.vb:r.position.array,s=e.vb?e.vbstride:3,l=e.offsets;l&&0!==l.length||(l=[{start:0,count:o.length,index:0}]);for(var c=0,u=l.length;c<u;++c)for(var h=l[c].start,m=l[c].count,g=l[c].index,v=h,y=h+m;v<y;v+=2)n=g+o[v],i=g+o[v+1],d.x=a[n*s],d.y=a[n*s+1],d.z=a[n*s+2],f.x=a[i*s],f.y=a[i*s+1],f.z=a[i*s+2],t(d,f,n,i)}}var x={getVertexCount:m,enumMeshVertices:g,enumMeshIndices:v,enumMeshTriangles:y,enumMeshLines:_,enumMeshEdges:b}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2}},function(e,t,n){"use strict";n.r(t);var i=n(111),r=n(0),o=-1e240;function a(){this.distance=o,this.dot=1}function s(e,t){return e.x*t.y-e.y*t.x}function l(e,t,n){t=t,n=n;var i=e.length();return 0===i?t?new r.Vector2(0,n?0:1):new r.Vector2(0,-(n?0:1)):t?new r.Vector2(-e.y/i,e.x/i):new r.Vector2(e.y/i,-e.x/i)}a.prototype={constructor:a,set:function(e,t){return this.distance=e,this.dot=t,this},copy:function(e){this.distance=e.distance,this.dot=e.dot},lessThan:function(e){return Math.abs(this.distance)<Math.abs(e.distance)||Math.abs(this.distance)===Math.abs(e.distance)&&this.dot<e.dot},greaterThan:function(e){return Math.abs(this.distance)>Math.abs(e.distance)||Math.abs(this.distance)===Math.abs(e.distance)&&this.dot>e.dot},lessThanOrEquals:function(e){return Math.abs(this.distance)<Math.abs(e.distance)||Math.abs(this.distance)==Math.abs(e.distance)&&this.dot<=e.dot},greaterThanOrEquals:function(e){return Math.abs(this.distance)>Math.abs(e.distance)||Math.abs(this.distance)==Math.abs(e.distance)&&this.dot>=e.dot}};var c=0,u=1,h=2,d=3,f=4,p=5,m=6,g=7;function v(e,t,n){this.p=[],this.p[0]=e.clone(),this.p[1]=t.clone(),this.color=n}function y(e,t){return(t.x-e.x)*(e.y+t.y)}function _(){this.edges=[]}function b(e,t,n){return e.dot(t)<=0||Math.abs(s(e,t))>n}function x(e,t){return w(e,t,c)}function w(e,t,n){var i=e&n;if(i==u||i==h||i==f)return[e=i^g,t];if(e==c||e==g)return[e=[m,p,d][t%3],t=Math.floor(t/3)];var r=e<<1+(1&t);return[e=(r|r>>3)&g,t>>=1]}function A(){this.minDistance=new a,this.nearEdge=null,this.nearParam=0}function E(e,t,n){return Math.max(Math.min(e,t),Math.min(Math.max(e,t),n))}function M(e,t){var n=t.point(0),i=t.point(1),r=e,o=e.clone().sub(n),a=i.clone().sub(n),s=o.dot(a)/a.dot(a);return s<0?o.length():s>1?r.clone().sub(i).length():Math.abs(l(a,!1,!1).dot(o))}function T(){this.contours=[],this.windings=[],this.inverseYAxis=!1}function S(e,t,n){if(!e||!e.colors)return new r.Color(1,0,0);var i=e.colors[t];if(!i)return new r.Color(0,0,0);var o=i.values;if(!o||!o.length)return new r.Color(1,0,0);var a=o[0];return new r.Color(a.r,a.g,a.b)}function C(e,t,n){if(!e||!e.scalars)return n;var i=e.scalars[t];return i?i.values[0]:n}function P(e,t,n){if(!e||!e.booleans)return n;var i=e.booleans[t];return void 0===i?n:i}function L(e,t,n,i){if(!e||!e[t])return i;var r=e[t][n];return r?r.values[0]:i}function D(e,t,n,i){if(!e||!e.scalars)return i;var o=e.scalars[t];return o?function(e,t,n){var i=F[n];i||(i=1,r.warn("Unsupported unit: "+n));var o=F[t];o||(o=1,r.warn("Unsupported unit: "+t));return e*i/o}(o.values[0],o.units,n):i}function R(e,t,n,i){if(!e||!e[t])return i;var r=e[t][n];return r&&r.connections?r.connections[0]:i}function I(e){var t=e;return t<=.04045?t/=12.92:t=Math.pow((t+.055)/1.055,2.4),t}function O(e){var t,n,i;return t=I(e.r),n=I(e.g),i=I(e.b),new r.Color(t,n,i)}v.prototype={constructor:v,set:function(e){return this.color=e,this},clone:function(){return new this.constructor(this.p[0],this.p[1],this.color)},point:function(e){return this.p[0].clone().lerp(this.p[1],e)},direction:function(){return this.p[1].clone().sub(this.p[0])},signedDistance:function(e){var t=e.clone().sub(this.p[0]),n=this.direction(),i=t.dot(n)/n.dot(n),r=this.p[i>.5?1:0].clone().sub(e),o=r.length();if(i>0&&i<1){var c=l(n,!1,!1).dot(t);if(Math.abs(c)<o){var u=new a;return u.set(c,0),[u,i]}}var h=2*(s(t,n)>0?1:0)-1,d=new a;return d.set(h*o,Math.abs(n.normalize().dot(r.normalize(r)))),[d,i]},distanceToPseudoDistance:function(e,t,n){var i,r;if(n<0){r=this.direction().normalize();var o=t.clone().sub(this.p[0]);o.dot(r)<0&&(i=s(o,r),Math.abs(i)<=Math.abs(e.distance)&&(e.distance=i,e.dot=0))}else if(n>1){r=this.direction().normalize();var a=t.clone().sub(this.p[1]);a.dot(r)>0&&(i=s(a,r),Math.abs(i)<=Math.abs(e.distance)&&(e.distance=i,e.dot=0))}},moveStartPoint:function(e){this.p[0].copy(e)},moveEndPoint:function(e){this.p[1].copy(e)},splitInThirds:function(e,t,n){var i=this.point(1/3),r=this.point(2/3);new v(this.p[0],i,this.color),new v(i,r,this.color),new v(r,this.p[1],this.color)}},_.prototype={constructor:_,addEdge:function(e){this.edges.push(e)},winding:function(){if(0===this.edges.length)return 0;var e,t,n,i,o,a=0;if(1==this.edges.length)e=new r.Vector2,t=new r.Vector2,n=new r.Vector2,e.copy(this.edges[0].point(0)),t.copy(this.edges[0].point(1/3)),n.copy(this.edges[0].point(2/3)),a+=y(e,t),a+=y(t,n),a+=y(n,e);else if(2==this.edges.length)e=new r.Vector2,t=new r.Vector2,n=new r.Vector2,i=new r.Vector2,e.copy(this.edges[0].point(0)),t.copy(this.edges[0].point(.5)),n.copy(this.edges[1].point(0)),i.copy(this.edges[1].point(.5)),a+=y(e,t),a+=y(t,n),a+=y(n,i),a+=y(i,e);else{var s=new r.Vector2,l=new r.Vector2;s=this.edges[this.edges.length-1].point(0);for(var c=0;c<this.edges.length;c++)a+=y(s,l=this.edges[c].point(0)),s=l}return(o=a)>0?1:o<0?-1:0}},A.prototype={constructor:A,clear:function(){this.nearEdge=null,this.nearParam=0},copy:function(e){this.minDistance.copy(e.minDistance),this.nearEdge=e.nearEdge,this.nearParam=e.nearParam}},T.prototype={constructor:T,addContour:function(e){this.contours.push(e)},addBlankContour:function(){var e=new _;return this.contours.push(e),e},initialize:function(){this.contours.length;for(var e=0;e<this.contours.length;++e){var t=this.contours[e];this.windings.push(t.winding())}},edgeColoringSimple:function(e,t){for(var n=Math.sin(e),i=0;i<this.contours.length;++i){var r=this.contours[i],o=[];if(r.edges.length>0)for(var a=r.edges[r.edges.length-1].direction(1),s=0;s<r.edges.length;++s){var l=r.edges[s];b(a.normalize(),l.direction(0).normalize(),n)&&o.push(s),a=l.direction(1)}if(0===o.length)for(var c=0;c<r.edges.length;++c)r.edges[c].color=g;else if(1==o.length){var u=[g,g],h=x(u[0],t);u[0]=h[0],t=h[1],u[2]=u[0],h=x(u[0],t),u[0]=h[0],t=h[1];var d=o[0];if(r.edges.length>=3)for(var f=r.edges.length,p=0;p<f;++p)r.edges[(d+p)%f].color=u[Math.floor(2.875*p/(f-1)+.0625)];else if(r.edges.length>=1){var m=[];r.edges[0].splitInThirds(m[0+3*d],m[1+3*d],m[2+3*d]),r.edges.length>=2?(r.edges[1].splitInThirds(m[3-3*d],m[4-3*d],m[5-3*d]),m[0].color=m[1].color=u[0],m[2].color=m[3].color=u[1],m[4].color=m[5].color=u[2]):(m[0].color=u[0],m[1].color=u[1],m[2].color=u[2]),r.edges.clear();for(var v=0;v<m.length;++v)r.edges.push(m[v])}}else{var y=o.length,_=0,A=o[0],E=r.edges.length,M=g,T=x(M,t);M=T[0],t=T[1];for(var S=M,C=0;C<E;++C){var P=(A+C)%E;_+1<y&&o[_+1]==P&&(M=(T=w(M,t,(++_===y-1?1:0)*S))[0],t=T[1]),r.edges[P].color=M}}}},calculateMSDFValue:function(e){for(var t=this.contours.length,n=[],i=new A,a=new A,s=new A,l=Math.abs(o),c=-o,d=o,p=0,m=new A,g=new A,v=new A,y=0;y<this.contours.length;++y){n[y]={r:o,g:o,b:o,med:o};var _=this.contours[y];m.clear(),g.clear(),v.clear();for(var b=0;b<_.edges.length;++b){var x=_.edges[b],w=x.signedDistance(e),M=w[0],T=w[1];(x.color&u)>0&&M.lessThan(m.minDistance)&&(m.minDistance.copy(M),m.nearEdge=x,m.nearParam=T),(x.color&h)>0&&M.lessThan(g.minDistance)&&(g.minDistance.copy(M),g.nearEdge=x,g.nearParam=T),(x.color&f)>0&&M.lessThan(v.minDistance)&&(v.minDistance.copy(M),v.nearEdge=x,v.nearParam=T)}m.minDistance.lessThan(i.minDistance)&&i.copy(m),g.minDistance.lessThan(a.minDistance)&&a.copy(g),v.minDistance.lessThan(s.minDistance)&&s.copy(v);var S=Math.abs(E(m.minDistance.distance,g.minDistance.distance,v.minDistance.distance));S<l&&(l=S,p=-this.windings[y]),m.nearEdge&&m.nearEdge.distanceToPseudoDistance(m.minDistance,e,m.nearParam),g.nearEdge&&g.nearEdge.distanceToPseudoDistance(g.minDistance,e,g.nearParam),v.nearEdge&&v.nearEdge.distanceToPseudoDistance(v.minDistance,e,v.nearParam),S=E(m.minDistance.distance,g.minDistance.distance,v.minDistance.distance),n[y].r=m.minDistance.distance,n[y].g=g.minDistance.distance,n[y].b=v.minDistance.distance,n[y].med=S,this.windings[y]>0&&S>=0&&Math.abs(S)<Math.abs(d)&&(d=S),this.windings[y]<0&&S<=0&&Math.abs(S)<Math.abs(c)&&(c=S)}i.nearEdge&&i.nearEdge.distanceToPseudoDistance(i.minDistance,e,i.nearParam),a.nearEdge&&a.nearEdge.distanceToPseudoDistance(a.minDistance,e,a.nearParam),s.nearEdge&&s.nearEdge.distanceToPseudoDistance(s.minDistance,e,s.nearParam);var C={r:o,g:o,b:o,med:o};if(d>=0&&Math.abs(d)<=Math.abs(c)){C.med=o,p=1;for(var P=0;P<t;++P)this.windings[P]>0&&n[P].med>C.med&&Math.abs(n[P].med)<Math.abs(c)&&(C=n[P])}else if(c<=0&&Math.abs(c)<=Math.abs(d)){C.med=-o,p=-1;for(var L=0;L<t;++L)this.windings[L]<0&&n[L].med<C.med&&Math.abs(n[L].med)<Math.abs(d)&&(C=n[L])}for(var D=0;D<t;++D)this.windings[D]!=p&&Math.abs(n[D].med)<Math.abs(C.med)&&(C=n[D]);return E(i.minDistance.distance,a.minDistance.distance,s.minDistance.distance)==C.med&&(C.r=i.minDistance.distance,C.g=a.minDistance.distance,C.b=s.minDistance.distance),new r.Vector3(C.r,C.g,C.b)},minSameColoredEdgeDistance:function(){for(var e=[1e10,1e10,1e10],t=0;t<this.contours.length;++t)for(var n=this.contours[t],i=0;i<n.edges.length;++i)for(var r=n.edges[i],o=0;o+1<i;++o){var a=n.edges[o];if(r.color==a.color){var s=Math.min(Math.min(M(r.point(0),a),M(r.point(1),a)),Math.min(M(a.point(0),r),M(a.point(1),r))),l=r.color-p;e[l]=Math.min(e[l],s)}}return Math.min(Math.min(e[0],e[1]),e[2])}},n.d(t,"MaterialConverter",(function(){return ie}));var N,k,F={MilliMeter:1e3,mm:1e3,8206:1e3,DeciMeter:10,dm:10,8204:10,CentiMeter:100,cm:100,8205:100,Meter:1,m:1,8193:1,KiloMeter:.001,km:.001,8201:.001,Inch:39.37008,in:39.37008,8214:39.37008,Foot:3.28084,ft:3.28084,8215:3.28084,Mile:62137e-8,mi:62137e-8,8225:62137e-8,Yard:1.09361,yard:1.09361,8221:1.09361};function V(e,t){var n=D(e,"texture_RealWorldOffsetX",t,0),i=D(e,"texture_RealWorldOffsetY",t,0),r=L(e,"scalars","texture_UOffset",0),o=L(e,"scalars","texture_VOffset",0),a=1,s=1;null!=L(e,"scalars","texture_RealWorldScale")?a=s=D(e,"texture_RealWorldScale",t,1):(a=D(e,"texture_RealWorldScaleX",t,1),s=D(e,"texture_RealWorldScaleY",t,1)),a=0===a?1:a,s=0===s?1:s;var l=L(e,"scalars","texture_UScale",1),c=L(e,"scalars","texture_VScale",1),u=L(e,"scalars","texture_WAngle",1);u*=Math.PI/180;var h=Math.cos(u),d=Math.sin(u),f=l/a,p=c/s;return{elements:[h*f,d*f,0,-d*p,h*p,0,-h*f*n+d*p*i+r,-d*f*n-h*p*i+o,1]}}function B(e,t,n){e[n+"_enable"]=L(t,"booleans",n+"_enable",0);var i=function(e,t,n){var i={bands:0,weights:new r.Vector4(1,1,1,1),frequencies:new r.Vector4(1,1,1,1)};if(!e||!e[t])return i;var o=e[t][n];if(!(o&&o.values&&o.values instanceof Array))return i;var a=o.values;i.bands=a.length/2;for(var s=0;s<i.bands;++s)i.frequencies.setComponent(s,1/a[2*s]),i.weights.setComponent(s,a[2*s+1]);return i}(t,"scalars",n+"_prof");e[n+"_bands"]=i.bands,e[n+"_weights"]=i.weights,e[n+"_frequencies"]=i.frequencies}function U(e,t){if(0!==t.randomOffsetMode){e.tilingRandomAxisS=new r.Vector2,e.tilingRandomAxisT=new r.Vector2,e.tilingRandomAlignmentOffset=new r.Vector2;var n=e.tilingRandomAxisS;n.set(1,0);var i=e.tilingRandomAxisT;i.set(0,1);var o=e.tilingRandomAlignmentOffset;o.set(0,0);var a=new r.Matrix4,s=new r.Matrix4,l=function(e){var t=["opaque_albedo_map","opaque_f0_map","layered_diffuse_map","layered_bottom_f0_map","surface_roughness_map","surface_normal_map","surface_albedo_map","surface_anisotropy_map","surface_cutout_map"];if(void 0!==e.textureMaps)for(var n=0;n<t.length;++n)if(void 0!==e.textureMaps[t[n]]&&void 0!==e.textureMaps[t[n]].textureObj&&void 0!==e.textureMaps[t[n]].textureObj.matrix){var i=e.textureMaps[t[n]].textureObj.matrix.elements,o=new r.Matrix4;return o.set(i[0],i[1],0,i[2],i[3],i[4],0,i[5],0,0,1,0,i[6],i[7],0,i[8]),o}return new r.Matrix4}(e),c=function(e,t){var n=new r.Matrix4;n.makeScale(t.x,t.y,1);var i=new r.Matrix4;return i.makeTranslation(-e.x,-e.y,0),n.multiply(i),n}(new r.Vector2(0,1),new r.Vector2(1,-1));c.multiply(l),l.copy(c),a.multiplyMatrices(l,e.tilingUVTransform),s.getInverse(a);var u=new r.Vector4(1,0,0,0).applyMatrix4(s);n.set(u.x,u.y),u=new r.Vector4(0,1,0,0).applyMatrix4(s),i.set(u.x,u.y);for(var h=new r.Vector2,d=new r.Box2,f=t.alignedVertices,p=0;p<f.length;p++)u.set(f[p].x,f[p].y,0,1),u.applyMatrix4(a),h.set(u.x,u.y),d.expandByPoint(h);u.set(-d.min.x,-d.min.y,0,0),u.applyMatrix4(s),o.set(u.x,u.y);var m=d.size(),g=1===t.randomOffsetMode?new r.Vector2(m.x,m.y):new r.Vector2(0,0);n.multiplyScalar(1-g.x),i.multiplyScalar(1-g.y)}}function z(e,t,n){var i=new r.Vector2(n.x,n.y).sub(t),o=new r.Vector2(e.x,e.y).sub(t),a=i.dot(o);if(a<=0)return o.length();var s=i.dot(i);return a>=s?new r.Vector2(e).sub(n).length():Math.sqrt(Math.max(o.dot(o)-a*a/s,0))}function G(e,t){for(var n=1e11,i=n,r=-1,o=0;o<e.vertices.length;o++){var a=o==e.vertices.length-1?0:o+1;(i=z(t,e.vertices[o],e.vertices[a]))<n&&(n=i,r=o)}return[n,r]}function H(e,t,n){for(var i=e.length,r=i-1,o=!1,a=0;a<i;++a)(e[a].y<n&&e[r].y>=n||e[r].y<n&&e[a].y>=n)&&e[a].x+(n-e[a].y)/(e[r].y-e[a].y)*(e[r].x-e[a].x)<t&&(o=!o),r=a;return o}function W(e,t){var n=t.bbox.size(),i=2*e.cornerRoundingSize*.7071/3,o=Z(Math.ceil(n.x/i)+2,128,1024),a=Z(Math.ceil(n.y/i)+2,128,1024);o-=2,a-=2,n.x<n.y?a=Math.floor(o*n.y/n.x):o=Math.floor(a*n.x/n.y),o+=2,a+=2,function(e,t){e.normalToEdges=[];for(var n=e.vertices.length,i=Math.cos(t),o=Math.sin(t),a=0;a<n;++a){var s=a,l=a==n-1?0:a+1,c=new r.Vector2(e.vertices[l].x,e.vertices[l].y);c.sub(e.vertices[s]),c.normalize();var u=new r.Vector3(c.y*o,-c.x*o,i);e.normalToEdges.push(u)}e.cornerRoundingAngle=t}(t,e.cornerRoundingAngle);for(var s=new Uint8Array(o*a*4),l=new r.Vector2(n.x/(o-2),n.y/(a-2)),c=new r.Vector2,u=new r.Vector3,h=new r.Vector3(0,0,1),d=0,f=0;f<a;f++){c.y=(a-f-1.5)*l.y+t.bbox.min.y;for(var p=0;p<o;p++){c.x=(p-.5)*l.x+t.bbox.min.x;var m=G(t,c),g=m[0],v=m[1];g<e.cornerRoundingSize+e.insetSize?(H(t.vertices,c.x,c.y)||(g=-g),u.copy(t.normalToEdges[v]),u.lerp(h,(g-e.insetSize)/e.cornerRoundingSize),u.normalize(),s[d++]=255*Z(.5*(u.x+1),0,1),s[d++]=255*Z(.5*(u.y+1),0,1),s[d++]=255*Z(.5*(u.z+1),0,1),s[d++]=255):(s[d++]=127,s[d++]=127,s[d++]=255,s[d++]=255)}}t.material.TilingNormalMap=new r.DataTexture(s,o,a,r.RGBAFormat,r.UnsignedByteType,r.UVMapping,r.ClampToEdgeWrapping,r.ClampToEdgeWrapping,r.LinearFilter,r.LinearFilter),t.material.TilingNormalMap.needsUpdate=!0;var y=new r.Vector2(-t.bbox.min.x,-t.bbox.min.y);t.material.TilingNormalMap_texMatrix=new r.Matrix3,t.material.TilingNormalMap_texMatrix.set(1/n.x*(o-2)/o,0,0,0,1/n.y*(a-2)/a,0,y.x/n.x*(o-2)/o+1/o,y.y/n.y*(a-2)/a+1/a,1),t.material.TilingNormalMap_texMatrix.transpose()}function j(e,t){return e<<t|e>>>32-t}function X(e,t){var n,i,r;return n=i=r=3735928567+t,i+=e.y,function(e,t,n){var i=4294967296;return n=((n^=t)-j(t,14)+i)%i,n=((n^=t=((t^=e=((e^=n)-j(n,11)+i)%i)-j(e,25)+i)%i)-j(t,16)+i)%i,n=((n^=t=((t^=e=((e^=n)-j(n,4)+i)%i)-j(e,14)+i)%i)-j(t,24)+i)%i}(n+=e.x,i,r)}function q(e,t){for(var n,i,o=new Uint8Array(1048576),a=new r.Vector2,s=new r.Vector2(107021*t,t),l=new r.Vector2,c=new r.Vector2,u=0,h=0;h<512;h++){a.y=Math.floor(-(h+1-256));for(var d=0;d<512;d++)a.x=Math.floor(d-256),l.copy(a),l.add(s),n=c,i=void 0,i=X(l,33),n.x=(65535&i)>>>8,n.y=i>>>16>>>8,o[u++]=0,o[u++]=0,o[u++]=c.x,o[u++]=c.y}e.material.TilingRandomMap=new r.DataTexture(o,512,512,r.RGBAFormat,r.UnsignedByteType,r.UVMapping,r.RepeatWrapping,r.RepeatWrapping,r.NearestFilter,r.NearestFilter),e.material.TilingRandomMap.needsUpdate=!0;new r.Vector2(-e.bbox.min.x,-e.bbox.min.y);e.material.TilingRandomMap_texMatrix=new r.Matrix3,e.material.TilingRandomMap_texMatrix.set(1/512,0,0,0,1/512,0,.5,.5,1),e.material.TilingRandomMap_texMatrix.transpose()}function Y(e,t,n){var i=[];i[0]=new r.Vector2(e.offsetVectorA.x,e.offsetVectorB.x),i[1]=new r.Vector2(e.offsetVectorA.y,e.offsetVectorB.y);for(var o=K(i),a=new r.Box2,s=new r.Vector2,l=0;l<t.vertices.length;++l)s.x=t.vertices[l].dot(o[0]),s.y=t.vertices[l].dot(o[1]),a.expandByPoint(s);n[0]=Math.floor(a.min.x-1),n[2]=Math.ceil(a.max.x),n[1]=Math.floor(a.min.y-1),n[3]=Math.ceil(a.max.y)}function K(e){var t=e[0].x*e[1].y-e[0].y*e[1].x,n=[];return n[0]=new r.Vector2(e[1].y/t,-e[0].y/t),n[1]=new r.Vector2(-e[1].x/t,e[0].x/t),n}function Z(e,t,n){return e>n?n:e<t?t:e}function Q(e,t){var n=new T;!function(e,t){for(var n=e.addBlankContour(),i=new r.Vector2,o=new r.Vector2,a=0;a<t.vertices.length;++a){var s=a,l=(a+1)%t.vertices.length;i=t.vertices[s],o=t.vertices[l],n.addEdge(new v(i,o,g))}e.initialize(),e.edgeColoringSimple(3,0)}(n,t);for(var i=t.bbox.size(),o=.7071*n.minSameColoredEdgeDistance()*.5,a=Z(Math.ceil(i.x/o)+2,16,512),s=Z(Math.ceil(i.y/o)+2,16,512),l=new Uint8Array(a*s*4),c=new r.Vector2(i.x/(a-2),i.y/(s-2)),u=(new r.Vector2(c.x*a,c.y*s),.5/(c.x+c.y)),h=new r.Vector2,d=new r.Vector3,f=0,p=0;p<s;p++){h.y=(s-p-1.5)*c.y+t.bbox.min.y;for(var m=0;m<a;m++)h.x=(m-.5)*c.x+t.bbox.min.x,d=(d=n.calculateMSDFValue(h)).add(new r.Vector3(e.insetSize,e.insetSize,e.insetSize)),l[f++]=255*Z(d.x*u+.5,0,1),l[f++]=255*Z(d.y*u+.5,0,1),l[f++]=255*Z(d.z*u+.5,0,1),l[f++]=0}t.material.TilingMap=new r.DataTexture(l,a,s,r.RGBAFormat,r.UnsignedByteType,r.UVMapping,r.ClampToEdgeWrapping,r.ClampToEdgeWrapping,r.LinearFilter,r.LinearFilter),t.material.TilingMap.needsUpdate=!0;var y=new r.Vector2(-t.bbox.min.x,-t.bbox.min.y);t.material.TilingMap_texMatrix=new r.Matrix3,t.material.TilingMap_texMatrix.set(1/i.x*(a-2)/a,0,0,0,1/i.y*(s-2)/s,0,y.x/i.x*(a-2)/a+1/a,y.y/i.y*(s-2)/s+1/s,1),t.material.TilingMap_texMatrix.transpose()}function J(e,t,n){var i=e.properties;t.clampS=!L(i,"booleans","texture_URepeat",!1),t.clampT=!L(i,"booleans","texture_VRepeat",!1),t.wrapS=t.clampS?r.ClampToEdgeWrapping:r.RepeatWrapping,t.wrapT=t.clampT?r.ClampToEdgeWrapping:r.RepeatWrapping,t.matrix=e.matrix||(e.matrix=V(i,n)),"UnifiedBitmap"==e.definition&&(t.invert=L(i,"booleans","unifiedbitmap_Invert",!1)),"BumpMap"==e.definition&&(t.bumpmapType=L(i,"choicelists","bumpmap_Type",0),t.bumpScale=function(e,t,n){if(0===t){var i=D(e,"bumpmap_Depth",n,0),o=1,a=1;return null!=L(e,"scalars","texture_RealWorldScale")?o=a=D(e,"texture_RealWorldScale",n,1):(o=D(e,"texture_RealWorldScaleX",n,1),a=D(e,"texture_RealWorldScaleY",n,1)),o=0===o?1:1/o,a=0===a?1:1/a,new r.Vector2(o*i,a*i)}var s=L(e,"scalars","bumpmap_NormalScale",1);return new r.Vector2(s,s)}(i,t.bumpmapType,n))}function $(e){var t=C(e,"texture_UScale",1),n=C(e,"texture_VScale",1),i=C(e,"texture_UOffset",0),r=C(e,"texture_VOffset",0),o=C(e,"texture_WAngle",0);return{elements:[Math.cos(o)*t,Math.sin(o)*n,0,-Math.sin(o)*t,Math.cos(o)*n,0,i,r,1]}}function ee(e,t,n){return e.matrix||(e.matrix=t?V(e.properties,n):$(e.properties)),e.matrix}function te(e){var t=e.materials,n=t[e.userassets[0]];if(n){var i=n.definition;if("TilingPattern"===i)(n=t[n.properties.references.grout_material.connections[0]])&&(i=n.definition);return"PrismLayered"==i||"PrismMetal"==i||"PrismOpaque"==i||"PrismTransparent"==i||"PrismGlazing"==i||"PrismWood"==i}return!1}function ne(e){return.299*e.r+.587*e.g+.114*e.b}var ie={convertMaterial:function(e,t,n,o){o=o||e.userassets;var a=e.materials,s=a[o];s&&"TilingPattern"===s.definition&&(s=a[s.properties.references.grout_material.connections[0]]);var l,c,u=s.properties,h=te(e);if(n){if(!(h?n.isPrismMaterial:n instanceof r.MeshPhongMaterial))return null;n.needsUpdate=!0}else n=h?Object(i.createPrismMaterial)():new r.MeshPhongMaterial;if(n.proteinMat=e,n.proteinCategories=s.categories,n.packedNormals=!0,s&&h){n.tag=s.tag,n.prismType=s.definition,void 0===n.prismType&&(n.prismType=""),void 0!==e.IsSingleSided&&!1===e.IsSingleSided&&(n.side=r.DoubleSide);var d=n.mapList;switch(n.transparent=!1,n.envExponentMin=1,n.envExponentMax=512,n.envExponentCount=10,n.surface_albedo=O(S(u,"surface_albedo",new r.Color(1,0,0))),d.surface_albedo_map=R(u,"colors","surface_albedo",null),n.surface_anisotropy=L(u,"scalars","surface_anisotropy",0),d.surface_anisotropy_map=R(u,"scalars","surface_anisotropy",null),n.surface_rotation=L(u,"scalars","surface_rotation",0),d.surface_rotation_map=R(u,"scalars","surface_rotation",null),n.surface_roughness=L(u,"scalars","surface_roughness",0),d.surface_roughness_map=R(u,"scalars","surface_roughness",null),d.surface_cutout_map=R(u,"textures","surface_cutout",null),d.surface_normal_map=R(u,"textures","surface_normal",null),null!=d.surface_cutout_map&&(n.side=r.DoubleSide,n.transparent=!0),n.prismType){case"PrismOpaque":n.opaque_albedo=O(S(u,"opaque_albedo",new r.Color(1,0,0))),d.opaque_albedo_map=R(u,"colors","opaque_albedo",null),n.opaque_luminance_modifier=O(S(u,"opaque_luminance_modifier",new r.Color(0,0,0))),d.opaque_luminance_modifier_map=R(u,"colors","opaque_luminance_modifier",null),n.opaque_f0=L(u,"scalars","opaque_f0",0),d.opaque_f0_map=R(u,"scalars","opaque_f0",null),n.opaque_luminance=L(u,"scalars","opaque_luminance",0);break;case"PrismMetal":n.metal_f0=O(S(u,"metal_f0",new r.Color(1,0,0))),d.metal_f0_map=R(u,"colors","metal_f0",null);break;case"PrismLayered":n.layered_bottom_f0=O(S(u,"layered_bottom_f0",new r.Color(1,1,1))),d.layered_bottom_f0_map=R(u,"colors","layered_bottom_f0",null),n.layered_diffuse=O(S(u,"layered_diffuse",new r.Color(1,0,0))),d.layered_diffuse_map=R(u,"colors","layered_diffuse",null),n.layered_anisotropy=L(u,"scalars","layered_anisotropy",0),d.layered_anisotropy_map=R(u,"scalars","layered_anisotropy",null),n.layered_f0=L(u,"scalars","layered_f0",0),d.layered_f0_map=R(u,"scalars","layered_f0",null),n.layered_fraction=L(u,"scalars","layered_fraction",0),d.layered_fraction_map=R(u,"scalars","layered_fraction",null),n.layered_rotation=L(u,"scalars","layered_rotation",0),d.layered_rotation_map=R(u,"scalars","layered_rotation",null),n.layered_roughness=L(u,"scalars","layered_roughness",0),d.layered_roughness_map=R(u,"scalars","layered_roughness",null),d.layered_normal_map=R(u,"textures","layered_normal",null);break;case"PrismTransparent":n.transparent_color=O(S(u,"transparent_color",new r.Color(1,0,0))),n.transparent_distance=L(u,"scalars","transparent_distance",0),n.transparent_ior=L(u,"scalars","transparent_ior",0),n.transparent=!0;break;case"PrismGlazing":n.glazing_f0=O(S(u,"glazing_f0",new r.Color(1,1,1))),d.glazing_f0_map=R(u,"colors","glazing_f0",null),n.glazing_transmission_color=O(S(u,"glazing_transmission_color",new r.Color(1,1,1))),d.glazing_transmission_color_map=R(u,"colors","glazing_transmission_color",null),n.glazing_transmission_roughness=C(u,"glazing_transmission_roughness",0),d.glazing_transmission_roughness_map=R(u,"scalars","glazing_transmission_roughness",null),n.side=L(u,"booleans","glazing_backface_culling",!1)?r.FrontSide:r.DoubleSide,n.transparent=!0;break;case"PrismWood":B(n,u,"wood_fiber_cosine"),B(n,u,"wood_fiber_perlin"),n.wood_fiber_perlin_scale_z=L(u,"scalars","wood_fiber_perlin_scale_z",0),B(n,u,"wood_growth_perlin"),n.wood_latewood_ratio=L(u,"scalars","wood_latewood_ratio",0),n.wood_earlywood_sharpness=L(u,"scalars","wood_earlywood_sharpness",0),n.wood_latewood_sharpness=L(u,"scalars","wood_latewood_sharpness",0),n.wood_ring_thickness=L(u,"scalars","wood_ring_thickness",0),B(n,u,"wood_earlycolor_perlin"),n.wood_early_color=O(S(u,"wood_early_color",new r.Color(1,0,0))),n.wood_use_manual_late_color=L(u,"booleans","wood_use_manual_late_color",0),n.wood_manual_late_color=O(S(u,"wood_manual_late_color",new r.Color(1,0,0))),B(n,u,"wood_latecolor_perlin"),n.wood_late_color_power=L(u,"scalars","wood_late_color_power",0),B(n,u,"wood_diffuse_perlin"),n.wood_diffuse_perlin_scale_z=L(u,"scalars","wood_diffuse_perlin_scale_z",0),n.wood_use_pores=L(u,"booleans","wood_use_pores",0),n.wood_pore_type=L(u,"choicelists","wood_pore_type",0),n.wood_pore_radius=L(u,"scalars","wood_pore_radius",0),n.wood_pore_cell_dim=L(u,"scalars","wood_pore_cell_dim",0),n.wood_pore_color_power=L(u,"scalars","wood_pore_color_power",0),n.wood_pore_depth=L(u,"scalars","wood_pore_depth",0),n.wood_use_rays=L(u,"booleans","wood_use_rays",0),n.wood_ray_color_power=L(u,"scalars","wood_ray_color_power",0),n.wood_ray_seg_length_z=L(u,"scalars","wood_ray_seg_length_z",0),n.wood_ray_num_slices=L(u,"integers","wood_ray_num_slices",0),n.wood_ray_ellipse_z2x=L(u,"scalars","wood_ray_ellipse_z2x",0),n.wood_ray_ellipse_radius_x=L(u,"scalars","wood_ray_ellipse_radius_x",0),n.wood_use_latewood_bump=L(u,"booleans","wood_use_latewood_bump",0),n.wood_latewood_bump_depth=L(u,"scalars","wood_latewood_bump_depth",0),n.wood_use_groove_roughness=L(u,"booleans","wood_use_groove_roughness",0),n.wood_groove_roughness=L(u,"scalars","wood_groove_roughness",0),n.wood_diffuse_lobe_weight=L(u,"scalars","wood_diffuse_lobe_weight",0),n.wood_curly_distortion_enable=L(u,"booleans","wood_curly_distortion_enable",0),n.wood_curly_distortion_scale=L(u,"scalars","wood_curly_distortion_scale",0),d.wood_curly_distortion_map=R(u,"scalars","wood_curly_distortion_map",null),k||function(){var e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t=new Uint8Array(e),n=new r.DataTexture(t,256,1,r.LuminanceFormat,r.UnsignedByteType,r.UVMapping,r.RepeatWrapping,r.RepeatWrapping,r.NearestFilter,r.NearestFilter,0);n.generateMipmaps=!1,n.flipY=!1,n.needsUpdate=!0;var i=new Uint8Array([225,39,122,231,29,173,15,159,75,88,233,19,179,79,72,94,54,73,151,161,171,113,221,144,127,83,168,19,88,122,62,225,109,128,246,247,172,101,61,139,211,168,64,210,224,82,87,97,119,250,201,44,242,239,154,99,126,13,44,70,246,170,100,52,135,28,187,22,207,119,199,1,235,187,55,131,190,124,222,249,236,53,225,231,71,30,173,185,153,47,79,133,225,10,140,62,17,99,100,29,137,95,142,244,76,5,83,124,38,216,253,195,44,210,148,185,188,39,78,195,132,30,60,73,92,223,133,80,230,56,118,207,79,15,251,211,111,21,79,23,240,146,150,207,3,61,103,27,148,6,31,127,235,58,173,244,116,81,34,120,192,213,188,226,97,23,16,161,106,80,242,148,35,37,91,117,51,216,97,193,126,222,39,38,133,217,215,23,237,57,205,42,222,165,126,133,33,8,227,154,27,18,56,11,192,120,80,92,236,38,210,207,128,31,135,39,123,5,49,127,107,200,34,14,153,239,134,19,248,162,58,201,159,198,243,158,72,5,138,184,222,200,34,141,233,40,195,238,191,122,171,32,66,254,229,197]),o=new r.DataTexture(i,256,1,r.LuminanceFormat,r.UnsignedByteType,r.UVMapping,r.RepeatWrapping,r.RepeatWrapping,r.NearestFilter,r.NearestFilter,0);o.generateMipmaps=!1,o.flipY=!1,o.needsUpdate=!0;for(var a,s,l,c,u,h,d,f,p=function(t){return e[t%256]},m=new Array(262144),g=0;g<256;++g)for(f=0;f<256;++f)a=p(f)+g,s=p(a),l=p(a+1),c=p(f+1)+g,u=p(c),h=p(c+1),m[d=4*(256*g+f)]=s,m[d+1]=l,m[d+2]=u,m[d+3]=h;var v=new Uint8Array(m),y=new r.DataTexture(v,256,256,r.RGBAFormat,r.UnsignedByteType,r.UVMapping,r.RepeatWrapping,r.RepeatWrapping,r.NearestFilter,r.NearestFilter,0);y.generateMipmaps=!1,y.flipY=!1,y.needsUpdate=!0;var _=[1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1,1,1,0,0,-1,1,-1,1,0,0,-1,-1],b=new Array(1024);for(f=0;f<256;++f){var x=e[f]%16;b[4*f]=127*_[3*x]+128,b[4*f+1]=127*_[3*x+1]+128,b[4*f+2]=127*_[3*x+2]+128,b[4*f+3]=0}var w=new Uint8Array(b),A=new r.DataTexture(w,256,1,r.RGBAFormat,r.UnsignedByteType,r.UVMapping,r.RepeatWrapping,r.RepeatWrapping,r.NearestFilter,r.NearestFilter,0);A.generateMipmaps=!1,A.flipY=!1,A.needsUpdate=!0,k={permutation:n,gradient:o,perm2D:y,permGrad:A}}(),n.uniforms.permutationMap.value=k.permutation,n.uniforms.gradientMap.value=k.gradient,n.uniforms.perm2DMap.value=k.perm2D,n.uniforms.permGradMap.value=k.permGrad;break;default:r.warn("Unknown prism type: "+n.prismType)}for(var f in n.enableImportantSampling&&(n.surface_anisotropy||n.surface_rotation||n.layered_anisotropy||n.layered_rotation)&&(N||function(){var e=new Uint8Array([0,128,64,191,32,160,96,223,16,143,80,207,48,175,112,239,8,135,72,199,40,167,103,231,25,151,88,215,56,183,120,250]),t=new r.DataTexture(e,32,1,r.LuminanceFormat,r.UnsignedByteType,r.UVMapping,r.RepeatWrapping,r.RepeatWrapping,r.NearestFilter,r.NearestFilter,0);t.generateMipmaps=!1,t.flipY=!1,t.needsUpdate=!0;for(var n,i,o=function(e,t){return Math.atan2(e*t,Math.sqrt(e*e+t*t+1))},a=new Uint8Array(16384),s=0;s<128;++s)for(var l=0;l<128;++l){n=s/128*2-1,i=l/128*2-1;var c=(n=Math.min(Math.max(1/128-1,n),1-1/128))-1/128,u=n+1/128,h=(i=Math.min(Math.max(1/128-1,i),1-1/128))-1/128,d=i+1/128,f=o(u,d)-o(c,d)-o(u,h)+o(c,h);a[128*s+l]=1e6*f}var p=new r.DataTexture(a,128,128,r.LuminanceFormat,r.UnsignedByteType,r.UVMapping,r.RepeatWrapping,r.RepeatWrapping,r.NearestFilter,r.NearestFilter,0);p.generateMipmaps=!1,p.flipY=!1,p.needsUpdate=!0,N={randomNum:t,solidAngle:p}}(),n.uniforms.importantSamplingRandomMap.value=N.randomNum,n.uniforms.importantSamplingSolidAngleMap.value=N.solidAngle),n.defines={},n.textureMaps={},d)if(d[f]){var p=a[d[f]];c=p.properties,p.matrix=ee(p,!0,t);var m="BumpMap"==p.definition?"bumpmap_Bitmap":"unifiedbitmap_Bitmap",g=c.uris[m].values,v=g[0];v&&(l={mapName:f,uri:v,uriPointer:g,textureObj:p,isPrism:!0},n.textureMaps[l.mapName]=l,n.defines["USE_"+f.toUpperCase()]="")}n.defines[n.prismType.toUpperCase()]="","PrismWood"==n.prismType&&n.enable3DWoodBump&&(n.defines.PRISMWOODBUMP=""),n.enableImportantSampling&&(n.defines.ENABLEIMPORTANTSAMPLING="")}else if(s&&!h&&"SimplePhong"==s.definition){n.tag=s.tag,n.proteinType=s.proteinType,void 0===n.proteinType&&(n.proteinType=null);var y=P(u,"generic_baked_lighting",!1);n.disableEnvMap=y;var _=n.ambient=S(u,"generic_ambient"),b=n.color=S(u,"generic_diffuse"),x=n.specular=S(u,"generic_specular"),w=n.emissive=S(u,"generic_emissive");n.shininess=C(u,"generic_glossiness",30),n.opacity=1-C(u,"generic_transparency",0),n.reflectivity=C(u,"generic_reflectivity_at_0deg",0);var A=P(u,"generic_bump_is_normal"),E=C(u,"generic_bump_amount",0);null==E&&(E=1),A?(E>1&&(E=1),n.normalScale=new r.Vector2(E,E)):(E>=1&&(E=.03),n.bumpScale=E);var M=P(u,"generic_is_metal");void 0!==M&&(n.metal=M);var T=P(u,"generic_backface_cull");void 0===T||T||(n.side=r.DoubleSide),n.transparent=s.transparent,n.textureMaps={};var D=s.textures;for(var I in D)if((l={}).textureObj=a[D[I].connections[0]],c=l.textureObj.properties,l.textureObj.matrix=ee(l.textureObj,!1,t),l.uriPointer=c.uris.unifiedbitmap_Bitmap.values,l.uri=l.uriPointer[0],l.uri){if("generic_diffuse"==I)l.mapName="map",(!n.color||0===n.color.r&&0===n.color.g&&0===n.color.b)&&n.color.setRGB(1,1,1);else if("generic_bump"==I)l.mapName=A?"normalMap":"bumpMap";else if("generic_specular"==I)l.mapName="specularMap";else{if("generic_alpha"!=I)continue;l.mapName="alphaMap",n.side=r.DoubleSide,n.transparent=!0}n.textureMaps[l.mapName]=l}0===b.r&&0===b.g&&0===b.b&&0===x.r&&0===x.g&&0===x.b&&0===_.r&&0===_.g&&0===_.b&&0===w.r&&0===w.g&&0===w.b&&(b.r=b.g=b.b=.4),n.extraDepthOffset=C(u,"generic_depth_offset"),n.extraDepthOffset&&(n.polygonOffset=!0,n.polygonOffsetFactor=n.extraDepthOffset,n.polygonOffsetUnits=0)}else n.ambient=new r.Color(197379),n.color=new r.Color(7829367),n.specular=new r.Color(3355443),n.shininess=30,n.shading=r.SmoothShading;return e.transparent=n.transparent,n},materialTilingPattern:function(e,t,n,i,o){var a,s,l=t.properties,c={overallTransform:new r.Matrix4,insetSize:0,hasRoundCorner:!1,cornerRoundingAngle:0,cornerRoundingSize:0,offsetVectorA:new r.Vector2,offsetVectorB:new r.Vector2},u=new r.Vector2(D(l,"scale_factor_x",o,1),D(l,"scale_factor_y",o,1)),h=D(l,"overall_offset_vector_x",o,1),d=D(l,"overall_offset_vector_y",o,1),f=C(l,"overall_rotation_angle",0)*Math.PI/180;!function(e,t,n,i){e.scale(i);var o=new r.Vector3(Math.sin(n.x),Math.sin(n.y),Math.sin(n.z)),a=new r.Vector3(Math.cos(n.x),Math.cos(n.y),Math.cos(n.z)),s=o.y*o.x,l=o.y*a.x,c=new r.Matrix4;c.set(a.z*a.y,o.z*a.y,-o.y,0,a.z*s-o.z*a.x,o.z*s+a.z*a.x,a.y*o.x,0,a.z*l+o.z*o.x,o.z*l-a.z*o.x,a.y*a.x,0,0,0,0,1),c.multiply(e),e.makeTranslation(t.x,t.y,t.z),e.multiply(c)}(c.overallTransform,new r.Vector3(-h,-d,0),new r.Vector3(0,0,-f),new r.Vector3(1,1,1)),c.insetSize=D(l,"inset_size",o,1),c.cornerRoundingAngle=C(l,"overall_corner_rounding_angle",0)*Math.PI/180,c.cornerRoundingSize=D(l,"overall_corner_rounding_size",o,1),c.offsetVectorA.x=C(l,"offset_vector_a_x",0)*u.x,c.offsetVectorA.y=C(l,"offset_vector_a_y",0)*u.y,c.offsetVectorB.x=C(l,"offset_vector_b_x",0)*u.x,c.offsetVectorB.y=C(l,"offset_vector_b_y",0)*u.y,c.hasRoundCorner=c.cornerRoundingAngle>0&&c.cornerRoundingSize>0;var p=[];for(a=0,s=n.length;a<s;a++){var m=n[a].properties,g={material:i[a].material,randomOffsetMode:0,rotation:0,vertices:[]};p[a]=g,g.randomOffsetMode=L(m,"choicelists","random_offset_mode",0),g.rotation=C(m,"rotation_angle",0)*Math.PI/180;for(var v=m.scalars.vertices.values,y=0;y<v.length;y+=2)g.vertices[y/2]=new r.Vector2(v[y],v[y+1]);for(var _=0;_<g.vertices.length;_++)g.vertices[_].multiply(u);g.material.useRandomOffset=0!=g.randomOffsetMode}!function(e,t){var n=new r.Box2;n.expandByPoint(new r.Vector2(0,0)),n.expandByPoint(e.offsetVectorA),n.expandByPoint(e.offsetVectorB);var i,o,a=new r.Vector2(e.offsetVectorA.x,e.offsetVectorA.y);for(a.add(e.offsetVectorB),n.expandByPoint(a),i=0,o=t.length;i<o;i++){var s=t[i];s.material.tilingRepeatRange=[],Y(e,s,s.material.tilingRepeatRange),s.bbox=new r.Box2;for(var l=0;l<s.vertices.length;++l)s.bbox.expandByPoint(s.vertices[l]);Q(e,s),e.hasRoundCorner&&W(e,s),s.material.useRandomOffset&&q(s,i),s.alignedVertices=[];for(var c=0;c<s.vertices.length;++c){var u=new r.Vector2(s.vertices[c].x,s.vertices[c].y);u.sub(s.bbox.min),s.alignedVertices.push(u)}s.material.tileAlignOffset=new r.Vector2(-s.bbox.min.x,-s.bbox.min.y)}}(c,p);var b,x,w,A,E=K([c.offsetVectorA.clone(),c.offsetVectorB.clone()]);for(a=0,s=p.length;a<s;a++){var M=p[a],T=M.material;T.tilingOverallTransform=c.overallTransform,T.hasRoundCorner=c.hasRoundCorner,T.tilingUVTransform=(b=M.rotation,x=void 0,w=void 0,A=void 0,x=Math.sin(b),w=Math.cos(b),(A=new r.Matrix4).set(w,-x,0,0,x,w,0,0,0,0,1,0,0,0,0,1),A),T.useRandomOffset&&U(T,M),T.tile2uv=new r.Vector4(c.offsetVectorA.x,c.offsetVectorA.y,c.offsetVectorB.x,c.offsetVectorB.y),T.uv2tile=new r.Vector4(E[0].x,E[0].y,E[1].x,E[1].y)}},convertTexture:function(e,t,n,i){"bumpMap"==e.mapName||"normalMap"==e.mapName?t.anisotropy=0:t.anisotropy=i||0,t.flipY=void 0===e.flipY||e.flipY,t.invert=!1,t.wrapS=r.RepeatWrapping,t.wrapT=r.RepeatWrapping,e.isPrism?J(e.textureObj,t,n):function(e,t){if(e){var n=e.properties;t.invert=P(n,"unifiedbitmap_Invert"),t.clampS=!P(n,"texture_URepeat",!0),t.clampT=!P(n,"texture_VRepeat",!0),t.wrapS=t.clampS?r.ClampToEdgeWrapping:r.RepeatWrapping,t.wrapT=t.clampT?r.ClampToEdgeWrapping:r.RepeatWrapping,t.matrix=e.matrix||(e.matrix=$(n))}}(e.textureObj,t)},get2DMapTransform:ee,isPrismMaterial:te,hasTiling:function(e){var t=e.materials[e.userassets[0]];return!(!t||"TilingPattern"!==t.definition)},convertMaterialGltf:function(e,t){var n=new r.MeshPhongMaterial;n.packedNormals=!0,n.textureMaps={};var i=e.values,o=i.diffuse;if(o)if(Array.isArray(o))n.color=new r.Color(o[0],o[1],o[2]);else if("string"==typeof o){n.color=new r.Color(1,1,1);var a={mapName:"map"},s=t.gltf.textures[o];a.uri=s.source,a.flipY=!1,n.textureMaps[a.mapName]=a}var l=i.specular;return l&&(n.specular=new r.Color(l[0],l[1],l[2])),i.shininess&&(n.shininess=i.shininess),n.reflectivity=0,n.transparent=!1,n},applyAppearanceHeuristics:function(e,t,n){var i=e.proteinMat?e.proteinMat:null,o=e.prismType&&-1!==e.prismType.indexOf("Prism");o&&e.transparent&&(e.side===r.FrontSide&&"PrismGlazing"!=e.prismType&&(e.side=r.DoubleSide),e.side===r.DoubleSide&&e.depthTest&&(e.twoPassTransparency=!0));var a=e.textureMaps||{};if(!t){var s=e.proteinType&&-1!==e.proteinType.indexOf("Prism");if(e.metal)e.reflectivity||(e.reflectivity=ne(e.specular)),i&&(1===e.reflectivity&&(e.reflectivity=ne(e.specular)),0===e.color.r&&0===e.color.g&&0===e.color.b||(e.color.r*=.1,e.color.g*=.1,e.color.b*=.1));else if(s){var l=!1;if("PrismLayered"===e.proteinType){e.clearcoat=!0,e.reflectivity=.06;var c=e.proteinCategories;c&&c.length&&-1!=c[0].indexOf("Metal")&&(l=!0)}e.reflectivity=Math.sqrt(e.reflectivity),l?e.specular.copy(e.color):(e.specular.r=e.reflectivity,e.specular.g=e.reflectivity,e.specular.b=e.reflectivity)}else e.reflectivity?e.reflectivity>.3?(e.metal=!0,e.specular.r=e.color.r,e.specular.g=e.color.g,e.specular.b=e.color.b,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1):(e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):1!==e.color.r||1!==e.color.g||1!==e.color.b||1!==e.specular.r||1!==e.specular.g||1!==e.specular.b||a.map||a.specularMap?(e.reflectivity=.01+.06*ne(e.specular),e.specular.r*=e.reflectivity,e.specular.g*=e.reflectivity,e.specular.b*=e.reflectivity):(e.metal=!0,e.reflectivity=.7,e.color.r*=.1,e.color.g*=.1,e.color.b*=.1),e.opacity<1&&(e.reflectivity=1);(e.transparent||a.map&&-1!==a.map.uri.toLowerCase().indexOf(".png")||a.alphaMap)&&(e.alphaTest=.01)}if(a.normalMap){var u=e.bumpScale;(void 0===u||u>=1)&&(u=1),e.normalScale=new r.Vector2(u,u)}else void 0===e.bumpScale&&(a.map||a.bumpMap)?e.bumpScale=.03:e.bumpScale>=1&&(e.bumpScale=.03);t&&!o||!e.transparent||(o?(e.lmv_depthWriteTransparent=!0,e.depthWrite=!!n):e.opacity>=1?a.alphaMap||(e.transparency=!1):(e.lmv_depthWriteTransparent=!0,e.depthWrite=!!n)),void 0!==e.shininess&&(e.shininess*=.25)},applyGeometryFlagsToMaterial:function(e,t){if(t.attributes.color&&(e.vertexColors=r.VertexColors,e.needsUpdate=!0),!e.proteinType&&t.attributes.uv&&t.attributes.uv.isPattern){var n=!1;e.map&&!e.bumpMap&&(e.bumpMap=e.map,e.needsUpdate=!0,n=!0),e.textureMaps&&e.textureMaps.map&&!e.textureMaps.bumpMap&&(e.textureMaps.bumpMap=e.textureMaps.map,e.needsUpdate=!0,n=!0),n&&void 0===e.bumpScale&&(e.bumpScale=.03)}},swapPrismWoodTextures:function(e){var t=k;return k=e,t},disposePrismWoodTextures:function(e){e&&(e.permutation.dispose(),e.gradient.dispose(),e.perm2D.dispose(),e.permGrad.dispose())}}},function(e,t,n){"use strict";n.r(t),n.d(t,"LmvBox3",(function(){return a}));var i,r,o=n(12),a=function(e,t){this.min=void 0!==e?e:new o.LmvVector3(1/0,1/0,1/0),this.max=void 0!==t?t:new o.LmvVector3(-1/0,-1/0,-1/0)};a.prototype={constructor:a,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromArray:function(e,t){return this.min.x=e[t],this.min.y=e[t+1],this.min.z=e[t+2],this.max.x=e[t+3],this.max.y=e[t+4],this.max.z=e[t+5],this},copyToArray:function(e,t){e[t]=this.min.x,e[t+1]=this.min.y,e[t+2]=this.min.z,e[t+3]=this.max.x,e[t+4]=this.max.y,e[t+5]=this.max.z},setFromCenterAndSize:(r=new o.LmvVector3,function(e,t){var n=r.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return(e||new o.LmvVector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new o.LmvVector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new o.LmvVector3).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},clampPoint:function(e,t){return(t||new o.LmvVector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new o.LmvVector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(i=[new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3,new o.LmvVector3],function(e){return i[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),i[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),i[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),i[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),i[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),i[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),i[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),i[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.makeEmpty(),this.setFromPoints(i),this}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}},function(e,t){e.exports="varying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"theExtensionManager",(function(){return l})),n.d(t,"ExtensionMixin",(function(){return c}));var i=n(1),r=n(109),o=n(3);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.registeredExtensions=new Map}var t,n,i;return t=e,(n=[{key:"registerExtension",value:function(e,t){if(this.registeredExtensions.has(e)){var n=this.registeredExtensions.get(e);if(n.EXTENSION_CLASS)return!1;n.EXTENSION_CLASS=t}else this.registeredExtensions.set(e,{EXTENSION_CLASS:t});return!0}},{key:"getExtensionClass",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).EXTENSION_CLASS:null}},{key:"unregisterExtension",value:function(e){return!!this.registeredExtensions.has(e)&&(this.registeredExtensions.delete(e),!0)}},{key:"registerExternalExtension",value:function(e,t){return!this.registeredExtensions.has(e)&&(this.registeredExtensions.set(e,{EXTENSION_CLASS:null,externalPath:t}),!0)}},{key:"getExternalPath",value:function(e){return this.registeredExtensions.has(e)?this.registeredExtensions.get(e).externalPath:null}},{key:"getRegisteredExtensions",value:function(){return Array.from(this.registeredExtensions).map((function(e){var t=a(e,2),n=t[0],i=t[1];return{id:n,inMemory:!!i.EXTENSION_CLASS,isAsync:!!i.externalPath}}))}},{key:"downloadExtension",value:function(e){if(!this.registeredExtensions.has(e))return Promise.reject("Extension not found: "+e+". Has it been registered(1)?");var t=this.registeredExtensions.get(e);return t.externalPath?t.downloadPromise?t.downloadPromise:(t.downloadPromise=r.theResourceLoader.loadScript(t.externalPath,e).then((function(){if(delete t.downloadPromise,!t.EXTENSION_CLASS)throw new Error("Extension not found: "+e+". Has it been registered(3)?");return t.EXTENSION_CLASS})),t.downloadPromise):Promise.reject("Extension not found: "+e+". Has it been registered(2)?")}},{key:"popuplateOptions",value:function(e){this.registeredExtensions.forEach((function(t){t.EXTENSION_CLASS.populateDefaultOptions(e)}))}},{key:"isDownloading",value:function(e){return!!this.registeredExtensions.has(e)&&!!this.registeredExtensions.get(e).downloadPromise}},{key:"isAvailable",value:function(e){return!!this.getExtensionClass(e)}}])&&s(t.prototype,n),i&&s(t,i),e}()),c=function(){};c.prototype={loadExtension:function(e,t){var n=this;return this.loadedExtensions=this.loadedExtensions||{},l.isAvailable(e)?this.loadExtensionLocal(e,t):(this.loadExtensionPromises=this.loadExtensionPromises||{},e in this.loadExtensionPromises?this.loadExtensionPromises[e]:(this.loadExtensionPromises[e]=l.downloadExtension(e).then((function(){if(delete n.loadExtensionPromises[e],n.loadedExtensions){if(n.cancelledExtensions&&e in n.cancelledExtensions)throw delete n.cancelledExtensions[e],new Error("Abort loadExtension('".concat(e,"') - extension has been unloaded"));return n.loadExtensionLocal(e,t)}i.logger.info("Abort loadExtension('".concat(e,"') - teardown in progress"))})),this.loadExtensionPromises[e]))},getExtension:function(e,t){var n=this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e]:null;return n&&t&&t(n),n},unloadExtension:function(e){if(this.cancelledExtensions=this.cancelledExtensions||{},l.isDownloading(e))return this.cancelledExtensions[e]=!0,!1;var t=!1,n=this.getExtension(e);return n?(t=n.unload(),i.logger.info("Extension unloaded: "+e),delete this.loadedExtensions[e],this.dispatchEvent({type:o.EXTENSION_UNLOADED_EVENT,extensionId:e})):i.logger.warn("Extension not found: "+e),t},loadExtensionLocal:function(t,n){var r=this,a=l.getExtensionClass(t);if(!a)return Promise.reject("Extension not found : "+t);var s=this.getExtension(t);if(s)return Promise.resolve(s);if(this.loadingExtensions&&t in this.loadingExtensions)return Promise.resolve(this.loadingExtensions[t]);(s=new a(this,n)).id=t;var c=s.load();if(!c)return Promise.reject("Extension failed to .load() : "+t);var u=function(){r.loadedExtensions[t]=s,r.onPostExtensionLoad(s),i.logger.info("Extension loaded: "+t),e((function(){r.getExtension(t)&&r.dispatchEvent({type:o.EXTENSION_LOADED_EVENT,extensionId:t})}))};return c instanceof Promise?(this.loadingExtensions=this.loadingExtensions||{},this.loadingExtensions[t]=s,c.then((function(){return u(),s})).finally((function(){delete r.loadingExtensions[t]}))):(u(),Promise.resolve(s))},onPostExtensionLoad:function(e){},forEachExtension:function(e){var t=this.loadedExtensions||{};for(var n in t)t.hasOwnProperty(n)&&e(t[n])},apply:function(e){var t=c.prototype;e.loadExtension=t.loadExtension,e.getExtension=t.getExtension,e.unloadExtension=t.unloadExtension,e.loadExtensionLocal=t.loadExtensionLocal,e.forEachExtension=t.forEachExtension,e.onPostExtensionLoad=t.onPostExtensionLoad}}}.call(this,n(257).setImmediate)},function(e,t,n){"use strict";n.r(t),n.d(t,"BubbleNode",(function(){return r}));var i=1;var r=function e(t,n){if(this.parent=n,this.id=i++,this.data=t,this.isLeaf="geometry"===t.type&&("3d"===t.role||"2d"===t.role||"lod"===t.role),Array.isArray(t.children)||Array.isArray(t.derivatives)){this.children=[];for(var r=t.children||t.derivatives,o=r.length,a=0;a<o;a++)this.children[a]=new e(r[a],this);this.children.length>1&&this.children.sort((function(e,t){return e.data.hasOwnProperty("order")&&t.data.hasOwnProperty("order")?e.data.order-t.data.order:0}));for(a=0;a<o;a++){var s="application/autodesk-db"==(l=r[a]).mime&&l.urn?0===l.urn.indexOf("urn:adsk.objects:os.object")?l.urn.substr(0,l.urn.lastIndexOf("%2F")+3):l.urn.substr(0,l.urn.lastIndexOf("/")+1):null;s&&(this.sharedPropertyDbPath=s),"lod"===r[a].role&&(this.lodNode=this.children[a])}}var l};r.prototype.constructor=r,r.prototype.setDocument=function(e){this.lmvDocument=e},r.prototype.getDocument=function(){for(var e=this;e.parent;)e=e.parent;return e.lmvDocument},r.prototype.isOtg=function(){return!!this._getOtgManifest()},r.prototype._getOtgManifest=function(){if("undefined"!=typeof DISABLE_OTG&&DISABLE_OTG)return null;var e=this.findViewableParent();return e?e.data.otg_manifest:null},r.prototype.getOtgGraphicsNode=function(){if(this.isViewPreset())return this.findParentGeom2Dor3D().getOtgGraphicsNode();var e=this._getOtgManifest();return e&&e.views&&e.views[this.guid()]},r.prototype.getPropertyDbManifest=function(){var e,t=this._getOtgManifest();if(t&&t.pdb_manifest){var n=t.pdb_manifest;e={propertydb:{},isOtg:!0};for(var i=0;i<n.assets.length;i++){var r=n.assets[i];o=r.isShared?t.paths.shared_root+n.pdb_shared_rel_path:t.paths.version_root+n.pdb_version_rel_path,e.propertydb[r.tag]=[{path:o+r.uri,isShared:r.isShared}]}this.getOtgGraphicsNode()||(e.needsDbIdRemap=!0)}else{var o;null===(o=this.findPropertyDbPath())&&(console.warn("Missing property database entry in manifest."),o=""),0===o.indexOf("$file$")&&(console.warn("Bubble local path given for shared property DB files. Assuming that sharedPropertyDbPath is specified correctly by loadDocumentNode()."),o=""),e={propertydb:{attrs:[{path:o+"objects_attrs.json.gz"}],values:[{path:o+"objects_vals.json.gz"}],avs:[{path:o+"objects_avs.json.gz"}],offsets:[{path:o+"objects_offs.json.gz"}],ids:[{path:o+"objects_ids.json.gz"}]}}}return e},r.prototype.getRootNode=function(){return this.parent?this.parent.getRootNode():this},r.prototype.isForgeManifest=function(){return"manifest"===this.getRootNode().data.type},r.prototype.findPropertyDbPath=function(){var e=this._getOtgManifest(),t=e&&e.pdb_manifest;return t&&t.assets&&t.assets.length?e.paths.version_root+e.pdb_manifest.pdb_version_rel_path:(e&&console.warn("Unexpected: OTG manifest exists, but it has no property database manifest."),this.sharedPropertyDbPath?this.sharedPropertyDbPath:this.parent?this.parent.findPropertyDbPath():null)},r.prototype._raw=function(){return this.data},r.prototype.name=function(){return this.data.name||""},r.prototype.guid=function(){return this.data.guid},r.prototype.type=function(){return this.data.type},r.prototype.extensions=function(){if(this.data.extensions)return Array.isArray(this.data.extensions)?this.data.extensions:[this.data.extensions]},r.prototype.urn=function(e){var t=this.data.urn;if(!e)return t;for(var n=this.parent;!t&&n;)t=n.data.urn,n=n.parent;return t},r.prototype.isGeomLeaf=function(){return this.isLeaf},r.prototype.isViewable=function(){return"viewable"===this.data.role||"svf"===this.data.outputType},r.prototype.getLodNode=function(){return this.lodNode},r.prototype.isGeometry=function(){return"geometry"===this.data.type},r.prototype.isViewPreset=function(){return"view"===this.data.type},r.prototype.is2D=function(){return"2d"===this.data.role},r.prototype.is3D=function(){return"3d"===this.data.role},r.prototype.is2DGeom=function(){return this.isGeometry()&&this.is2D()},r.prototype.is3DGeom=function(){return this.isGeometry()&&this.is3D()},r.prototype.useAsDefault=function(){return!0===this.data.useAsDefault},r.prototype.getDefaultGeometry=function(){for(var e=this.search({type:"geometry"}),t=0;t<e.length;++t)if(e[t].useAsDefault())return e[t];return e[0]},r.prototype.getPlacementTransform=function(){return console.warn("BubbleNode.getPlacementTransform is deprecated. Sheet placement information is stored in AECModelData.json"),null},r.prototype.getHash=function(){return console.warn("BubbleNode.getHash is deprecated and will be removed in a future release."),null},r.prototype.getViewBox=function(){return this.data.viewbox},r.prototype.isMetadata=function(){if(this.data.role){if(-1!==this.data.role.indexOf("Autodesk.CloudPlatform.DesignDescription"))return!0;if("Autodesk.CloudPlatform.PropertyDatabase"===this.data.role)return!0}return!1},r.prototype.findViewableParent=function(){for(var e=null,t=this;t;)t.isViewable()&&(e=t),t=t.parent;if(!e&&!this.parent&&this.children)for(var n=0;n<this.children.length;n++){var i=this.children[n];if(i.isViewable()){e=i;break}}return e},r.prototype.findParentGeom2Dor3D=function(e){for(var t=this;t&&!t.is2DGeom()&&!t.is3DGeom();)t=t.parent;!t&&this.isViewPreset()&&(t=this.findGeometryFromSiblings()[0],e&&e.fallbackParent&&(t=e.fallbackParent));return t},r.prototype.findGeometryFromSiblings=function(){var e=this.parent;if(!e)return[];for(var t=[],n=0,i=e.children.length;n<i;++n){var r,o=e.children[n];if(o!==this)o.traverse((function(e){if(e.isGeometry()&&(e.is2D()||e.is3D()))return r=e,!0})),r&&t.push(r)}return t},r.prototype.findAllViewables=function(){var e=[];this.isForgeManifest()&&(e=this.search({outputType:"svf"}));var t=this.search({role:"viewable"});return e.concat(t)},r.prototype.getViewableRootPath=function(e){var t=this.getOtgGraphicsNode();if(t&&!t.error)return this._getOtgManifest().paths.version_root+t.urn;if(!this.isGeomLeaf())return this.urn();if(!e&&this.is2D()){var n=this.search({role:"leaflet"});if(n&&n.length)return n[0].urn()}var i=this.is2D()?"application/autodesk-f2d":"application/autodesk-svf",r=this.search({mime:i});return r&&r.length?r[0].urn():null},r.prototype.getNamedViews=function(){var e=this.search({type:"view"});return e=e.filter((function(e){return!!e.data.name&&!!Array.isArray(e.data.camera)}))},r.prototype.findByGuid=function(e){var t=null;return this.traverse((function(n){if(n.data.guid===e)return t=n,!0})),t},r.prototype.search=function(e){var t=[];return this.traverse((function(n){var i=!0;for(var r in e)if(!n.data.hasOwnProperty(r)||n.data[r]!==e[r]){i=!1;break}i&&t.push(n)})),t},r.prototype.traverse=function(e){if(e(this))return!0;if(this.children)for(var t=0;t<this.children.length;t++)if(this.children[t].traverse(e))return!0;return!1},r.prototype.getShallowCopySource=function(e){if(!this.isViewable())return console.error("getShallowCopySource must be called with a viewable node."),null;e||(e=this.parent.urn());var t=this.urn();return t!==e&&(t?(console.log("Redirecting shallow copied URN ".concat(e," to ").concat(t)),e=t):console.warn("Unexpected: manifest viewable node does not have a urn property.\n".concat(JSON.stringify(this._raw())))),e},r.prototype.getAecModelData=function(){var e=this.findViewableParent();return e?(e.data.aec_model_data||console.warn("Use Document.getAecModelData(bubbleNode) instead of BubbleNode.getAecModelData(), or make sure Document.downloadAecModelData is loaded before using this API"),e.data.aec_model_data):null},r.prototype.extractRefPointTransform=function(){var e=this.getAecModelData();return e&&e.refPointTransformation&&r.readMatrixFromArray12(e.refPointTransformation)},r.prototype.extractCamera=function(){if(this.data.camera)return r.readCameraFromArray(this.data.camera);var e=this.isGeometry()&&this.search({type:"view"})[0];return e?e.extractCamera():null},r.prototype.getLevel=function(){var e=this.data.levelNumber;return Array.isArray(e)?e[0]:e},r.prototype.getLevelName=function(){return this.data.levelName||this.getLevel()},r.prototype.isSheet=function(){for(var e=this.parent;e;){if("Sheets"===e.name())return!0;e=e.parent}return!1},r.prototype.isMasterView=function(){for(var e=r.MASTER_VIEW_NODE.name,t=this;t;){if(t.name()===e)return!0;t=t.parent}return!1},r.readCameraFromArray=function(e,t){if(!Array.isArray(e))return null;if(t&&!t.elements){var n=new THREE.Matrix4;n.setPosition(t),t=n}var i={position:new THREE.Vector3(e[0],e[1],e[2]),target:new THREE.Vector3(e[3],e[4],e[5]),up:new THREE.Vector3(e[6],e[7],e[8]),aspect:e[9],fov:THREE.Math.radToDeg(e[10]),orthoScale:e[11],isPerspective:!e[12]};return t&&(i.position.applyMatrix4(t),i.target.applyMatrix4(t),i.up.transformDirection(t)),0===e[10]&&1===e[11]&&1===e[12]&&(i.orthoScale=i.position.distanceTo(i.target)),i},r.readMatrixFromArray12=function(e){return(new THREE.Matrix4).fromArray([e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,e[9],e[10],e[11],1])},r.MODEL_NODE={role:"3d",type:"geometry"},r.GEOMETRY_SVF_NODE={role:"graphics",mime:"application/autodesk-svf"},r.SHEET_NODE={role:"2d",type:"geometry"},r.LEAFLET_NODE={role:"leaflet"},r.PDF_PAGE_NODE={role:"pdf-page"},r.IMAGE_NODE={role:"image"},r.GEOMETRY_F2D_NODE={role:"graphics",mime:"application/autodesk-f2d"},r.VIEWABLE_NODE={role:"viewable"},r.AEC_MODEL_DATA={role:"Autodesk.AEC.ModelData"},r.MASTER_VIEW_NODE={name:"08f99ae5-b8be-4f8d-881b-128675723c10"}},function(e,t,n){"use strict";n.r(t),n.d(t,"TOOLBAR_CREATED_EVENT",(function(){return i})),n.d(t,"VIEW_CUBE_CREATED_EVENT",(function(){return r})),n.d(t,"TOOLBAR",(function(){return o}));var i="toolbarCreated",r="viewCubeCreated",o={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools",SETTINGSTOOLSID:"settingsTools",MEASURETOOLSID:"measureTools"}},function(e,t,n){var i=n(84);e.exports=function(e){return Object(i(e))}},function(e,t,n){"use strict";n.r(t),n.d(t,"SceneMath",(function(){return s}));var i=n(0),r=[new i.Vector3(1,0,0),new i.Vector3(0,1,0),new i.Vector3(0,0,1),new i.Vector3(-1,0,0),new i.Vector3(0,-1,0),new i.Vector3(0,0,-1)],o=new i.Plane;function a(e,t,n,r){var o=e;o.z=-1;var a=new i.Vector3(o.x,o.y,1);o=o.unproject(t),(a=a.unproject(t)).sub(o).normalize();var s,l=a;if(Math.abs(l[n])<1e-6)return null;s=t.isPerspective?t.position:o;var c=((r?r.min[n]:0)-s[n])/l[n];return l.multiplyScalar(c),l.add(s),l}var s={box2CutPlanes:function(e,t){for(var n=[],a=0;a<r.length;a++){o.normal.copy(r[a]);var s=a<3?e.max:e.min;o.constant=-o.normal.dot(s),t&&o.applyMatrix4(t),n.push(new i.Vector4(o.normal.x,o.normal.y,o.normal.z,o.constant))}return n},getPixelsPerUnit:function(e,t,n,r,o,s){var l;if(t){var c=a(new i.Vector3(0,0,1),e,"z",s);l=r/(2*(c?e.position.distanceTo(c):e.position.distanceTo(n.center()))*Math.tan(i.Math.degToRad(.5*e.fov)))}else{var u;if(o){var h=o,d=e.target.clone().sub(e.position).normalize(),f=d.dot(h);if(0===f)u=n.center();else{var p=-(e.position.clone().dot(h)+h.w)/f;u=n.clampPoint(d.multiplyScalar(p).add(e.position))}}else u=n.center();l=r/(2*e.position.distanceTo(u)*Math.tan(i.Math.degToRad(.5*e.fov)))}return l},intersectGroundViewport:a,getNormalizingMatrix:function(e,t){t=t||e.getData().bbox;var n=new i.Matrix4;n.makeTranslation(-t.min.x,-t.min.y,-t.min.z);var r=new i.Vector3(0,0,0).subVectors(t.max,t.min),o=new i.Matrix4;o.makeScale(1/r.x,1/r.y,1);var a=new i.Matrix4;return a.multiplyMatrices(o,n),a}}},function(e,t,n){"use strict";n.r(t),n.d(t,"ShadowMapShader",(function(){return _})),n.d(t,"GroundShadowShader",(function(){return b})),n.d(t,"ShadowMapOverrideMaterials",(function(){return x})),n.d(t,"ShadowConfig",(function(){return w})),n.d(t,"SHADOWMAP_NEEDS_UPDATE",(function(){return A})),n.d(t,"SHADOWMAP_INCOMPLETE",(function(){return E})),n.d(t,"SHADOWMAP_VALID",(function(){return M})),n.d(t,"ShadowMaps",(function(){return C})),n.d(t,"ShadowRender",(function(){return P}));var i=n(16),r=n(25),o=n(111),a=n(117),s=n(133),l=n(170),c=n(19),u=n(0),h=n(340),d=n.n(h),f=n(341),p=n.n(f),m=n(342),g=n.n(m),v=n(343),y=n.n(v),_={uniforms:u.UniformsUtils.merge([i.ShaderChunks.ShadowMapCommonUniforms,{shadowMapRangeMin:{type:"f",value:0},shadowMapRangeSize:{type:"f",value:0},shadowMinOpacity:{type:"f",value:0},map:{type:"t",value:null},alphaMap:{type:"t",value:null},texMatrix:{type:"m3",value:new u.Matrix3},texMatrixAlpha:{type:"m3",value:new u.Matrix3}},Object(o.GetPrismMapUniforms)("surface_cutout_map")]),vertexShader:d.a,fragmentShader:p.a},b={uniforms:i.ShaderChunks.ShadowMapUniforms,vertexShader:g.a,fragmentShader:y.a};function x(){var e=[],t=Object(r.createShaderMaterial)(_),n=new u.Material;n.visible=!1;var i=[];var o=new function(){this.init=function(){this.isPrism=!1,this.alphaMap=!1,this.alphaClampS=!1,this.alphaClampT=!1,this.alphaInvert=!1,this.rgbaMap=!1,this.rgbaClampS=!1,this.rgbaClampT=!1,this.rgbaInvert=!1,this.instanced=!1,this.decalIndex=-1},this.init(),this.getMaterialIndex=function(){return(this.isPrism?1:0)|(this.alphaMap?2:0)|(this.alphaClampS?4:0)|(this.alphaClampT?8:0)|(this.alphaInvert?16:0)|(this.rgbaMap?32:0)|(this.rgbaClampS?64:0)|(this.rgbaClampT?128:0)|(this.rgbaInvert?256:0)|(this.instanced?512:0)|1024*(this.decalIndex+1)}};function s(i,s){if((l=i)instanceof u.MeshPhongMaterial?l.opacity<w.ShadowMinOpacity:l.isPrismMaterial?"PrismTransparent"===l.prismType||"PrismGlazing"===l.prismType:!l.visible)return n;var l,c=i instanceof u.MeshPhongMaterial,h=i.isPrismMaterial;if(!c&&!h)return null;var d=c?i.alphaMap:i.surface_cutout_map,f=c&&i.alphaTest?i.map:null;if(!d&&!f&&!i.useInstancing)return null;var p=o;p.init(),p.isPrism=h,p.alphaMap=!!d,p.rgbaMap=!!f,p.instanced=i.useInstancing,p.decalIndex=void 0===s?-1:s,d&&(p.alphaClampS=d.clampS,p.alphaClampT=d.clampT,p.alphaInvert=d.invert),f&&(p.rgbaClampS=f.clampS,p.rgbaClampT=f.clampT,p.rgbaInvert=f.invert);var m=function(n,i){var o=n.getMaterialIndex();if(!e[o]){var s=t.clone();n.isPrism&&n.alphaMap&&(Object(r.setMacro)(s,"USE_SURFACE_CUTOUT_MAP"),s.fragmentShader=Object(a.GetPrismMapChunk)("surface_cutout",n.alphaClampS,n.alphaClampT)+"\n"+s.fragmentShader),n.instanced&&(s.useInstancing=!0),e[o]=s}return e[o]}(p);return d&&(c?(m.uniforms.alphaMap.value=d,m.uniforms.texMatrixAlpha.value=d.matrix,m.alphaMap=d,m.side=i.side):(m.uniforms.surface_cutout_map.value=d,m.uniforms.surface_cutout_map_texMatrix.value.copy(d.matrix),m.uniforms.surface_cutout_map_invert.value=d.invert,m.side=u.DoubleSide)),f&&(m.uniforms.map.value=f,m.uniforms.texMatrix.value=f.matrix,m.map=f),m}this.forEachMaterial=function(n){for(var i=0;i<e.length;i++){var r=e[i];r&&n(r)}n(t)},this.getCustomOverrideMaterial=function(e){var t=s(e);if(!t)return null;if(!e.decals)return t.decals=null,t;if(e.decals){i.length=0;for(var n=0;n<e.decals.length;n++){var r=e.decals[n],o=s(r.material,n);if(!o)return null;i.push({uv:r.uv,material:o})}}return t.decals=i,t},this.dispose=function(){this.forEachMaterial((function(e){e.dispose()}))}}var w={ShadowMapSize:1024,ShadowESMConstant:80,ShadowBias:.001,ShadowDarkness:.7,ShadowMapBlurRadius:4,ShadowMinOpacity:.9,UseHardShadows:!1,BlurShadowMap:!0},A=0,E=1,M=2;function T(){this.shadowMap=void 0,this.shadowMapSize=void 0,this.shadowMatrix=void 0,this.shadowLightDir=void 0,this.init=function(e){this.shadowMap=e,this.shadowMapSize=new u.Vector2(e.width,e.height),this.shadowMatrix=new u.Matrix4,this.shadowLightDir=new u.Vector3},this.apply=function(e){e.shadowMap=this.shadowMap,e.shadowMatrix=this.shadowMatrix,e.shadowLightDir=this.shadowLightDir,this.shadowMap?(Object(r.setMacro)(e,"USE_SHADOWMAP"),w.UseHardShadows&&Object(r.setMacro)(e,"USE_HARD_SHADOWS")):(Object(r.removeMacro)(e,"USE_SHADOWMAP"),Object(r.removeMacro)(e,"USE_HARD_SHADOWS"))}}var S=new T;function C(e){var t=null,n=null,i=new u.OrthographicCamera,o=Math.exp(w.ShadowESMConstant),a=w.UseHardShadows?new u.Color(1,1,1):new u.Color(o,1,1),h=e,d=null,f=null,p=null,m=Object(r.createShaderMaterial)(_),g=new x;m.getCustomOverrideMaterial=g.getCustomOverrideMaterial;var v=null;function y(e,t){e.forEach((function(e){t.apply(e)}))}function C(e){var t=new u.WebGLRenderTarget(e,e,{minFilter:u.LinearFilter,magFilter:u.LinearFilter,format:u.RGBAFormat,type:u.FloatType,stencilBuffer:!1,generateMipmaps:!1});return t.generateMipmaps=!1,t}function P(e){h.setRenderTarget(e),h.setClearColor(a,1),h.clear()}var L,D,R,I,O,N,k,F,V,B,U,z=(L=new u.Matrix4,D=new u.Matrix4,R=new u.Vector3(0,0,0),I=new u.Box3,O=new u.Vector3,N=new u.Vector3,function(e,t,n){e.position.copy(n),e.lookAt(R),L.makeRotationFromQuaternion(e.quaternion),D.getInverse(L),I.copy(t).applyMatrix4(D),N=I.center(N),O.set(N.x,N.y,I.max.z),O.applyMatrix4(L),e.position.copy(O),N=I.size(N),e.left=-.5*N.x,e.right=.5*N.x,e.bottom=-.5*N.y,e.top=.5*N.y,e.near=0,e.far=N.z,e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),e.updateProjectionMatrix()});function G(e){e.uniforms.shadowMapRangeMin.value=i.near,e.uniforms.shadowMapRangeSize.value=i.far-i.near,e.uniforms.shadowESMConstant.value=w.ShadowESMConstant,e.uniforms.shadowMinOpacity.value=w.ShadowMinOpacity}this.init=function(){(t=new T).init(C(w.ShadowMapSize)),n=w.BlurShadowMap?new l.a(w.ShadowMapSize,w.ShadowMapSize,w.ShadowMapBlurRadius,1,{type:t.shadowMap.type,format:t.shadowMap.format}):void 0,(d=Object(r.createShaderMaterial)(b)).depthWrite=!1,d.transparent=!0,f=Object(s.createGroundShape)(d),(p=new u.Scene).add(f),this.groundShapeBox=new u.Box3,P(v=C(1))},this.init(),this.state=A,this.startUpdate=function(e,t,n,r,o){var a=e.getVisibleBounds(!0);return this.beginShadowMapUpdate(n,a,r),e.reset(i,c.RenderFlags.RENDER_SHADOWMAP,!0),this.state=E,t=this.continueUpdate(e,t,o)},this.continueUpdate=function(e,n,i){return n=e.renderSome(this.renderSceneIntoShadowMap,n),e.isDone()?(this.state=M,this.finishShadowMapUpdate(i)):function(e){var n=t.shadowMap;t.shadowMap=v,y(e,t),t.apply(d),t.shadowMap=n}(i),n},this.beginShadowMapUpdate=function(e,n,o){z(i,n,o),G(m),g.forEachMaterial(G),w.UseHardShadows&&(Object(r.setMacro)(m,"USE_HARD_SHADOWS"),g.forEachMaterial((function(e){Object(r.setMacro)(e,"USE_HARD_SHADOWS")}))),P(t.shadowMap),this.renderSceneIntoShadowMap(p)},this.renderSceneIntoShadowMap=function(e){e.overrideMaterial=m,h.render(e,i,t.shadowMap),e.overrideMaterial=null},this.finishShadowMapUpdate=function(e){n&&!w.UseHardShadows&&n.render(h,t.shadowMap,t.shadowMap),t.shadowMatrix.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),t.shadowMapRangeMin=i.near,t.shadowMapRangeSize=i.far-i.near,t.shadowLightDir.copy(i.position).normalize(),y(e,t),t.apply(d),this.isValid=!0},this.cleanup=function(e){n&&n.cleanup(),t.shadowMap&&t.shadowMap.dispose(),y(e,S),m.dispose(),g.dispose(),d.dispose(),f.geometry.dispose()},this.setGroundShadowTransform=function(e,t,n,i){Object(s.setGroundShapeTransform)(f,e,t,n,i),this.groundShapeBox.setFromObject(f)},this.renderGroundShadow=function(e,t){h.render(p,e,t,!1)},this.expandByGroundShadow=(k=new u.Plane,F=new u.Ray,V=new u.Vector3,B=new u.Vector3,U=new u.Box3,function(e,t){k.normal.set(0,1,0),k.constant=-e.min.y,F.direction.copy(t).negate().normalize();var n,i,r,o=e.center(V),a=100*o.distanceToSquared(e.min)*100;U.makeEmpty();for(var s=0;s<8;s++){F.origin=(n=e,i=s,r=void 0,(r=new u.Vector3).x=1&i?n.max.x:n.min.x,r.y=2&i?n.max.y:n.min.y,r.z=4&i?n.max.z:n.min.z,r);var l=F.intersectPlane(k,B);l&&(l.distanceToSquared(o)>=a||U.expandByPoint(l))}e.union(U)}),this.getShadowParams=function(){return t},this.getShadowCamera=function(){return i}}var P=function(){};P.RefreshUniformsShadow=function(e,t){e.shadowMap&&(e.shadowMap.value=t.shadowMap),e.shadowMatrix&&(e.shadowMatrix.value=t.shadowMatrix),e.shadowLightDir&&(e.shadowLightDir.value=t.shadowLightDir),e.shadowESMConstant&&(e.shadowESMConstant.value=w.ShadowESMConstant),e.shadowBias&&(e.shadowBias.value=w.ShadowBias),e.shadowMapSize&&(e.shadowMapSize.value=w.ShadowMapSize),e.shadowDarkness&&(e.shadowDarkness.value=w.ShadowDarkness)}},function(e,t,n){"use strict";n.r(t),n.d(t,"RenderBatch",(function(){return u}));var i=n(113),r=n(43),o=n(8),a=n(19),s=n(1),l=new(n(48).LmvBox3),c=null;function u(e,t,n,i){this.frags=e,this.indices=t,this.start=n,this.count=i,this.lastItem=n,this.overrideMaterial=null,this.sortDone=!1,this.numAdded=0,this.avgFrameTime=void 0,this.nodeIndex=void 0,this.bboxes=new Array(12),this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-1/0,this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-1/0,this.sortObjects=!1,this.sortDone=!1,this.sortByShaderDone=!1,this.frustumCulled=!0,this.forceVisible=!1,this.renderImmediate=!e.useThreeMesh,this.renderImportance=0}function h(e,t,n,i,r){var s,l=o.MeshFlags.MESH_RENDERFLAG,c=t[n]&~l;switch(e){case a.RenderFlags.RENDER_HIDDEN:s=!(c&o.MeshFlags.MESH_VISIBLE);break;case a.RenderFlags.RENDER_HIGHLIGHTED:s=c&o.MeshFlags.MESH_HIGHLIGHTED;break;default:s=1==(c&(o.MeshFlags.MESH_VISIBLE|o.MeshFlags.MESH_HIGHLIGHTED|o.MeshFlags.MESH_HIDE))}if(i){var u=c&(o.MeshFlags.MESH_ISLINE|o.MeshFlags.MESH_ISWIDELINE);s=s&&!u}if(r){var h=c&o.MeshFlags.MESH_ISPOINT;s=s&&!h}return t[n]=c|(s?l:0),s}function d(e,t,n,i){var r=!1;return n.getWorldBounds(i,l),e&&!t.intersectsBox(l)&&(r=!0),!r&&t.boxOutsideCutPlanes(l)&&(r=!0),r}u.prototype.getIndices=function(){return Array.isArray(this.indices)?this.indices[0]:this.indices},u.prototype.sortByMaterial=function(){if(!(this.numAdded<this.count)){var e=this.frags,t=this.getIndices();if(t){var n=t.subarray(this.start,this.start+this.count);Array.prototype.sort.call(n,(function(t,n){var i=e.getMaterialId(t),r=e.getMaterialId(n);return void 0===i?r?1:0:void 0===r?-1:i-r})),this.numAdded=0,this.sortDone=!0}else s.logger.warn("Only indexed RenderSubsets can be sorted.")}},u.prototype.sortByShader=function(){if(this.sortDone&&!this.sortByShaderDone){var e=this.frags,t=this.getIndices().subarray(this.start,this.start+this.count);Array.prototype.sort.call(t,(function(t,n){var i=e.getMaterial(t),r=e.getMaterial(n),o=i.program.id-r.program.id;return o||i.id-r.id})),this.numAdded=0,this.sortByShaderDone=!0}},u.prototype.sortByDepth=function(e){var t=this.frags,n=this.getIndices(),i=e,r=l;if(n){(!c||c.length<this.count)&&(c=new Float32Array(this.count));var o,a,u=c,h=this.start;this.forEachNoMesh((function(e,n){t.getGeometry(e)?(t.getWorldBounds(e,r),u[n]=i.estimateDepth(r)):u[n]=-1/0}));for(var d=1;d<this.count;d++)for(var f=d;f>0&&u[f-1]<u[f];)o=u[f-1],u[f-1]=u[f],u[f]=o,a=n[h+f-1],n[h+f-1]=n[h+f],n[h+f]=a,f--}else s.logger.warn("Only indexed RenderSubsets can be sorted.")},u.prototype.addToBox=function(e,t){var n=t?6:0,i=this.bboxes;i[0+n]=Math.min(i[0+n],e.min.x),i[1+n]=Math.min(i[1+n],e.min.y),i[2+n]=Math.min(i[2+n],e.min.z),i[3+n]=Math.max(i[3+n],e.max.x),i[4+n]=Math.max(i[4+n],e.max.y),i[5+n]=Math.max(i[5+n],e.max.z)},u.prototype.getBoundingBox=function(e){e=e||l;var t=this.bboxes;return e.min.x=t[0],e.min.y=t[1],e.min.z=t[2],e.max.x=t[3],e.max.y=t[4],e.max.z=t[5],e},u.prototype.getBoundingBoxHidden=function(e){e=e||l;var t=this.bboxes;return e.min.x=t[6],e.min.y=t[7],e.min.z=t[8],e.max.x=t[9],e.max.y=t[10],e.max.z=t[11],e},u.prototype.onFragmentAdded=function(e){this.frags.getWorldBounds(e,l),this.addToBox(l,!1),this.sortDone=!1,this.lastItem<=e&&(this.lastItem=e+1,void 0!==this.visibleStats&&(this.visibleStats=0),this.numAdded++)},u.prototype.forEach=function(e,t,n){var i,r,a,s=this.getIndices(),l=this.frags,c=!this.sortByShaderDone;if(t||n||c)for(i=t===o.MeshFlags.MESH_RENDERFLAG&&this.hasOwnProperty("drawStart")?this.drawStart:this.start,r=this.lastItem;i<r;i++){a=s?s[i]:i;u=l.getVizmesh(a,this.renderImportance);!c||u&&u.material&&u.material.program&&!u.geometry_proxy||(c=!1),!(n||u&&u.geometry)||t&&!l.isFlagSet(a,t)||e(u,a)}else for(i=this.start,r=this.lastItem;i<r;i++){var u;a=s?s[i]:i,(u=l.getVizmesh(a,this.renderImportance))&&u.geometry&&e(u,a)}c&&this.sortByShader()},u.prototype.forEachNoMesh=function(e,t,n){for(var i=this.getIndices(),r=this.frags,o=this.start,a=this.lastItem;o<a;o++){var s,l=i?i[o]:o;if(r.useThreeMesh){var c=r.getVizmesh(l);c&&(s=c.geometry)}else s=r.getGeometry(l);!n&&!s||t&&!r.isFlagSet(l,t)||e(l,o-this.start)}},u.prototype.raycast=function(e,t,n){if(!1!==e.ray.isIntersectionBox(this.getBoundingBox())){var r=this,a=l;this.forEach((function(s,l){if(!r.frags.isFlagSet(l,o.MeshFlags.MESH_HIDE)){if(n&&n.length){var c=0|r.frags.getDbIds(l);if(-1===n.indexOf(c))return}r.frags.getWorldBounds(l,a),a.expandByScalar(.5),e.ray.isIntersectionBox(a)&&i.VBIntersector.rayCast(s,e,t)}}),o.MeshFlags.MESH_VISIBLE)}},u.prototype.calculateBounds=function(){var e,t,n,i;function r(r){t.getWorldBounds(r,n);var o=e[r];i.addToBox(n,!(1&o))}return function(){this.bboxes[0]=this.bboxes[1]=this.bboxes[2]=1/0,this.bboxes[3]=this.bboxes[4]=this.bboxes[5]=-1/0,this.bboxes[6]=this.bboxes[7]=this.bboxes[8]=1/0,this.bboxes[9]=this.bboxes[10]=this.bboxes[11]=-1/0,e=this.frags.vizflags,t=this.frags,n=l,i=this,this.forEachNoMesh(r,0,!0)}}(),u.prototype.applyVisibility=function(){var e,t,n,i,l,c;function u(r,a){if((r||!e.useThreeMesh)&&r.geometry){if(d(l,n,e,a))return r?r.visible=!1:s.logger.warn("Unexpected null mesh"),void(t[a]=t[a]&~o.MeshFlags.MESH_RENDERFLAG);var u=h(i,t,a,e.linesHidden,e.pointsHidden);r&&(r.visible=!!u),c=c&&!u}}function f(r){if(e.getGeometryId(r))if(d(l,n,e,r))t[r]=t[r]&~o.MeshFlags.MESH_RENDERFLAG;else{var a=h(i,t,r,e.linesHidden,e.pointsHidden);c=c&&!a}}return function(o,s){c=!0,n=s;var h=(i=o)===a.RenderFlags.RENDER_HIDDEN?this.getBoundingBoxHidden():this.getBoundingBox(),d=n.intersectsBox(h);return d===r.FrustumIntersector.OUTSIDE?c:s.boxOutsideCutPlanes(h)?c:(t=this.frags.vizflags,e=this.frags,l=d!==r.FrustumIntersector.CONTAINS,e.useThreeMesh?this.forEach(u,null):this.forEachNoMesh(f,0,!1),e=null,c)}}()},function(e,t,n){"use strict";n.r(t),n.d(t,"MeasurementTypes",(function(){return i}));var i={MEASUREMENT_DISTANCE:1,MEASUREMENT_ANGLE:2,MEASUREMENT_AREA:3,CALIBRATION:4}},function(e,t,n){"use strict";n.r(t),n.d(t,"SettingsPanel",(function(){return c}));var i=n(41),r=n(9),o=n(2),a=n(26);n(10);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=40;function c(e,t,n,r){i.DockingPanel.call(this,e,t,n,r),this.panelTabs=[],this.tabIdToIndex={},this.controls={},this.controlIdCount=0,this.shown=!1;var o=this,a=r&&void 0!==r.width?r.width:340;this.container.style.maxWidth="800px",this.container.style.minWidth=a+"px",this.container.style.top="10px",this.container.style.left=e.offsetWidth/2-170+"px",this.container.style.position="absolute";var s=this.getDocument();this.tabContainer=s.createElement("div"),this.tabContainer.classList.add("docking-panel-container-solid-color-b"),this.tabContainer.classList.add("settings-tabs"),this.tabContainer.classList.add("docking-panel-delimiter-shadow"),this.container.appendChild(this.tabContainer),this.tabs=s.createElement("ul"),this.tabContainer.appendChild(this.tabs),this.heightAdjustment=r&&r.heightAdjustment?r.heightAdjustment:179,r&&r.hideTabBar&&(this.heightAdjustment-=l,this.tabContainer.style.display="none",this.tabContainer.style.height=0),this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment,marginTop:0}),this.tablesContainer=s.createElement("div"),this.tablesContainer.classList.add("settings-tabs-tables-container"),r&&r.hideTabBar&&(this.scrollContainer.style.top=90-l+"px"),this.scrollContainer.appendChild(this.tablesContainer),this.mouseOver=!1,this.addEventListener(this.container,"mouseover",(function(e){var t=e.toElement||e.relatedTarget;if(o.mouseOver)return!0;for(var n=0,i=o.getWindow();t&&t.parentNode&&t.parentNode!=i;){if(t.parentNode==this||t==this){t.preventDefault&&t.preventDefault(),o.mouseOver=!0;for(n=0;n<o.panelTabs.length;n++)o.panelTabs[n].classList.remove("selectedmouseout");return!0}t=t.parentNode}})),this.addEventListener(this.container,"mouseout",(function(e){var t=e.toElement||e.relatedTarget;if(o.mouseOver){for(var n=o.getWindow();t&&t.parentNode&&t.parentNode!=n;){if(t.parentNode==this||t==this)return t.preventDefault&&t.preventDefault(),!1;t=t.parentNode}o.mouseOver=!1;for(var i=0;i<o.panelTabs.length;i++)o.panelTabs[i].classList.contains("tabselected")&&o.panelTabs[i].classList.add("selectedmouseout")}})),this.expandID=function(e){return t+"-"+e}}c.prototype=Object.create(i.DockingPanel.prototype),c.prototype.constructor=c,c.prototype.setVisible=function(e){e&&(this.container.style.display="block",this.shown||(this.resizeToContent(),this.container.style.left=this.parentContainer.offsetWidth/2-this.container.getBoundingClientRect().width/2+"px"),this.shown=!0),i.DockingPanel.prototype.setVisible.call(this,e)},c.prototype.addTab=function(e,t,n){var i=this;if(void 0!==this.tabIdToIndex[e])return!1;var a=n&&void 0!==n.className?n.className:null,s=n&&void 0!==n.width?n.width:200,l=n&&void 0!==n.index?n.index:this.panelTabs.length;var c=this.getDocument(),u=c.createElement("li");u._id=e,u.id=this.expandID(u._id),u.classList.add(a);var h=c.createElement("a"),d=c.createElement("span");d.setAttribute("data-i18n",t),d.textContent=r.i18n.translate(t),h.appendChild(d),u.appendChild(h),this.tabs.appendChild(u);var f=c.createElement("table");f._id=e+"-table",f.id=this.expandID(f._id),f.classList.add("settings-table"),f.classList.add("adsk-lmv-tftable"),f.classList.add(a);var p=c.createElement("tbody");return p.style.display="table",p.style.width="100%",f.appendChild(p),this.tablesContainer.appendChild(f),this.addEventListener(u,"touchstart",o.touchStartToClick),this.addEventListener(u,"click",(function(t){i.selectTab(e)})),this.panelTabs.push(u),this.tabIdToIndex[e]=l,s>(this.container.style.minWidth?parseInt(this.container.style.minWidth):0)&&(this.container.style.minWidth=s+"px"),!0},c.prototype.removeTab=function(e){var t=this.tabIdToIndex[e];if(!t)return!1;this.panelTabs.splice(t,1);var n=this.getDocument().getElementById(this.expandID(e));this.tabs.removeChild(n),this.tabIdToIndex={};for(var i=this.panelTabs.length,r=0;r<i;r++){var a=this.panelTabs[r];this.tabIdToIndex[a._id]=r,this.removeEventListener(a,"touchstart",o.touchStartToClick),this.removeEventListener(a,"click",select)}return!0},c.prototype.resizeTabs=function(){for(var e=this.tabs.getElementsByTagName("li"),t=100/e.length,n=0;n<e.length;n++)e[n].style.width=t+"%"},c.prototype.hasTab=function(e){var t=this.tabIdToIndex[e];return void 0!==this.panelTabs[t]},c.prototype.selectTab=function(e){if(this.isTabSelected(e))return!1;for(var t=this.getDocument(),n=this.panelTabs.length,i=0;i<n;i++){var r=this.panelTabs[i],o=t.getElementById(this.expandID(r._id+"-table"));e===r._id?(r.classList.add("tabselected"),o.classList.add("settings-selected-table"),this.mouseOver||r.classList.add("selectedmouseout")):(r.classList.remove("tabselected"),o.classList.remove("settings-selected-table"),this.mouseOver||this.panelTabs[i].classList.remove("selectedmouseout"))}return this.scrollContainer.scrollTop=0,!0},c.prototype.isTabSelected=function(e){var t=this.tabIdToIndex[e],n=this.panelTabs[t];return n&&n.classList.contains("tabselected")},c.prototype.getSelectedTabId=function(){for(var e in this.tabIdToIndex)if(this.isTabSelected(e))return e;return null},c.prototype.addLabel=function(e,t){var n,i=this.tabIdToIndex[e];if(-1===i)return!1;n=this.tablesContainer.childNodes[i];var r=new a.OptionLabel(t,n.tBodies[0]);return r.setGlobalManager(this.globalManager),r.sliderRow.classList.add("logical-group"),r},c.prototype.addButton=function(e,t){var n=this.tabIdToIndex[e];if(void 0===n)return null;var i=this.tablesContainer.childNodes[n],r=new a.OptionButton(t,i.tBodies[0]);return r.setGlobalManager(this.globalManager),this.addControl(e,r)},c.prototype.addCheckbox=function(e,t,n,i,r,o){if(void 0===this.tabIdToIndex[e])return null;var s=this.getDocument().getElementById(this.expandID(e+"-table")),l=new a.OptionCheckbox(t,s.tBodies[0],n,r,o);return l.setGlobalManager(this.globalManager),l.changeListener=function(e){var t=e.detail.target.checked;i(t)},this.addEventListener(l,"change",l.changeListener),this.addControl(e,l)},c.prototype.addRow=function(e,t,n,i){if(void 0===this.tabIdToIndex[e])return null;var r=this.getDocument().getElementById(this.expandID(e+"-table")),o=new a.OptionRow(t,r.tBodies[0],n,i);return o.setGlobalManager(this.globalManager),this.addControl(e,o)},c.prototype.addSlider=function(e,t,n,i,r,o,s){if(void 0===this.tabIdToIndex[e])return null;var l=this.getDocument().getElementById(this.expandID(e+"-table")),c=new a.OptionSlider(t,n,i,l.tBodies[0],s);c.setGlobalManager(this.globalManager),c.setValue(r);var u=1;return s&&s.step&&(u=s.step),c.sliderElement.step=c.stepperElement.step=u,this.addEventListener(c,"change",(function(e){o(e)})),this.addControl(e,c)},c.prototype.addSliderV2=function(e,t,n,i,r,o,a,s){(s=s||{}).hideStepper=!0,s.hideCaption=!0;var l=[];return l.push(this.addRow(e,t,n,s)),l.push(this.addSlider(e,t,i,r,o,a,s)),l},c.prototype.addDropDownMenu=function(e,t,n,i,r,o){if(void 0===this.tabIdToIndex[e])return null;var s=this.getDocument().getElementById(this.expandID(e+"-table")),l=new a.OptionDropDown(t,s.tBodies[0],n,i,null,this.globalManager,o);return l.setGlobalManager(this.globalManager),this.addEventListener(l,"change",(function(e){r(e)})),this.addControl(e,l)},c.prototype.addControl=function(e,t,n){if(void 0===this.tabIdToIndex[e])return null;if(!t.hasOwnProperty("sliderRow")){var i=n&&n.insertAtIndex?n.insertAtIndex:-1,o=n&&n.caption?n.caption:null,a=this.getDocument(),s=a.getElementById(this.expandID(e+"-table"));i>s.length&&(i=-1);var l=s.tBodies[0].insertRow(i),c=l.insertCell(0);if(o){var u=a.createElement("div");u.setAttribute("data-i18n",o),u.textContent=r.i18n.translate(o),c.appendChild(u),c=l.insertCell(1)}else c.colSpan=3;c.appendChild(t),t.sliderRow=l,t.tbody=s.tBodies[0]}var h=this.expandID("adsk_settings_control_id_"+this.controlIdCount.toString());return this.controlIdCount=this.controlIdCount+1,this.controls[h]=t,t.parent=this,h},c.prototype.removeButton=function(e){return this.removeControl(e)},c.prototype.removeCheckbox=function(e){return this.removeControl(e)},c.prototype.removeSlider=function(e){return this.removeControl(e)},c.prototype.removeDropdownMenu=function(e){return this.removeControl(e)},c.prototype.removeControl=function(e){var t;if("object"===s(e)&&e.tbody){for(var n in t=e,this.controls)if(this.controls[n]===t){e=n;break}}else t=this.controls[e];if(void 0===t)return!1;if(t.removeFromParent)t.removeFromParent();else{var i=t.tbody,r=t.sliderRow.rowIndex;i.deleteRow(r)}return delete this.controls[e],t.parent=void 0,!0},c.prototype.getControl=function(e){return this.controls[e]||null},c.prototype.getContentSize=function(){for(var e=this.heightAdjustment,t=0,n=this.getDocument(),i=0;i<this.panelTabs.length;i++){var r=this.panelTabs[i],o=n.getElementById(this.expandID(r._id+"-table")),a=o?o.clientHeight:0;t=Math.max(t,a)}return{height:e+t,width:this.container.clientWidth}},c.prototype.sizeToContent=function(e){var t=this.getContentSize().height+this.heightAdjustment,n=e.clientHeight-this.heightAdjustment,i=Math.min(t,n);this.container.style.height=parseInt(i)+"px"},c.prototype.addSimpleList=function(e,t,n){var i=new a.SimpleList(e,t,n);return i.setGlobalManager(this.globalManager),i},c.prototype.removeSimpleList=function(e){return!!e&&(e.removeFromParent(),!0)}},function(e,t,n){var i=n(20),r=n(62),o=n(61),a=n(100)("src"),s=n(383),l=(""+s).split("toString");n(34).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(o(n,"name")||r(n,"name",t)),e[t]!==n&&(c&&(o(n,a)||r(n,a,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=n:s?e[t]?e[t]=n:r(e,t,n):(delete e[t],r(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){var i=n(5),r=n(21),o=n(84),a=/"/g,s=function(e,t,n,i){var r=String(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(i).replace(a,"&quot;")+'"'),s+">"+r+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),i(i.P+i.F*r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var i=n(39),r=n(99);e.exports=n(38)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var i=n(142),r=n(84);e.exports=function(e){return i(r(e))}},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"MESH_RECEIVE_EVENT",(function(){return h})),n.d(t,"MESH_FAILED_EVENT",(function(){return d})),n.d(t,"MATERIAL_RECEIVE_EVENT",(function(){return f})),n.d(t,"MATERIAL_FAILED_EVENT",(function(){return p})),n.d(t,"OtgResourceCache",(function(){return _}));var i=n(2),r=n(69),o=n(40),a=n(6),s=n(32),l=n(3),c=n(13),u=n(249),h="meshReceived",d="meshFailed",f="materialReceived",p="materialFailed",m="true"===Object(c.getParameterByName)("disableIndexedDb").toLowerCase()||Object(i.getGlobal)().DISABLE_INDEXED_DB,g="true"===Object(c.getParameterByName)("disableWebSocket").toLowerCase()||Object(i.getGlobal)().DISABLE_WEBSOCKET;function v(e){var t=Object(a.initLoadContext)(e);return t.disableIndexedDb=m,t.disableWebSocket=g,t}function y(e,t){return e.importance-t.importance}function _(t){for(var n=new Map,a=new Map,s={},c=Object(i.isMobileDevice)()?2:8,m=[],g=0;g<c;g++)m.push(Object(o.createWorkerWithIntercept)());this.byteSize=0;var _=0,b=100,x=void 0,w=new u.a(t),A=this,E=0,M=t,T=!1;function S(){T=!1}function C(e){if(e.data)if(w.waitingTasks.length&&!x&&(x=setTimeout(L,0)),e.data.error){var t=e.data.error,i=t.args?t.args.hash:void 0,o=t.args?t.args.type:"g";i&&("m"===o?(a.set(i,t),A.fireEvent({type:p,error:t}),console.warn("Error loading material",i)):(n.set(i,t),A.fireEvent({type:d,error:t}),console.warn("Error loading mesh",i)),delete s[t.hash],_--)}else if(e.data.material){i=(m=e.data).hash;var l=m.material;a.set(i,l),A.fireEvent({type:f,material:l,hash:i}),delete s[m.hash],_--}else for(var c=e.data,u=0;u<c.length;u++){var m;if((m=c[u]).hash&&m.mesh){r.BufferGeometryUtils.meshToGeometry(m);i=m.hash;var g=m.geometry;n.set(i,g),A.byteSize+=g.byteSize,A.cleanup(),A.fireEvent({type:h,geom:g}),delete s[m.hash]}_--}}M.addEventListener(l.MODEL_UNLOADED_EVENT,S),this.dtor=function(){M.removeEventListener(l.MODEL_UNLOADED_EVENT,S),M=null;for(var e=0;e<c;e++)m[e].clearAllEventListenerWithIntercept(),m[e].terminate()};for(g=0;g<c;g++)m[g].addEventListenerWithIntercept(C);function P(e){return"number"==typeof e?e%c:0|Math.random()*c}function L(){var e=b*c-_;if(0!==e){w.updateRequestPriorities()||(e=Math.min(e,10*c));for(var t=[],n=0;!w.isEmpty()&&n<e;){var i=w.takeTask(),r=P(i.geomIdx);(a=t[r])?(a.urls.push(i.url),a.hashes.push(i.hash)):(a={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",urls:[i.url],hashes:[i.hash],isCDN:i.isCDN,queryParams:i.queryParams},t[r]=a),n++}for(var o=0;o<t.length;o++){var a;(a=t[o])&&(m[o].doOperation(v(a)),_+=a.urls.length)}x=void 0}else x=setTimeout(L,30)}this.initWorker=function(e){for(var t=0;t<c;t++){var n={operation:"INIT_WORKER_OTG",authorizeUrns:[e]};m[t].doOperation(v(n))}},this.updateMruTimestamps=function(){for(var e=0;e<c;e++){var t={operation:"UPDATE_MRU_TIMESTAMPS_OTG",endSession:w.isEmpty()};m[e].doOperation(v(t))}},this.requestGeometry=function(t,i,r,o,a){var l=this,c=n.get(r);if(c&&c.args)e((function(){return l.fireEvent({type:d,error:c,hash:r,repeated:!0})}));else if(c)e((function(){return l.fireEvent({type:h,geom:c})}));else{var u=s[r];if(u&&u.refcount)return u.importanceNeedsUpdate=!0,void u.refcount++;var f={operation:"LOAD_CDN_RESOURCE_OTG",type:"g",url:t,isCDN:i,hash:r,queryParams:a,importance:0,geomIdx:o,importanceNeedsUpdate:!0,refcount:1};w.addTask(f),s[r]=f,x||(x=setTimeout(L,0))}},this.requestMaterial=function(t,n,i,r,o){var l=this,c=a.get(i);if(c&&c.args)e((function(){return l.fireEvent({type:p,error:c,hash:i,repeated:!0})}));else if(c)e((function(){return l.fireEvent({type:f,material:c,hash:i})}));else{var u=s[i];if(u&&u.refcount)u.refcount++;else{var h={operation:"LOAD_CDN_RESOURCE_OTG",type:"m",urls:[t],hashes:[i],isCDN:n,queryParams:o,refcount:1};s[i]=h;var d=P(r);m[d].doOperation(v(h)),_++}}},this.cancelRequests=function(e){for(var t in e){var n=s[t];n&&n.refcount--}for(var i=[],r=0;r<w.waitingTasks.length;r++){var o=w.waitingTasks[r];s[o.hash].refcount?i.push(o):delete s[o.hash]}w.waitingTasks=i},this.updateGeomImportance=function(e,t){return Object(u.b)(e,t)},this.cleanup=function(){var e=[];if(!(this.byteSize<104857600)){var t=M.impl.modelQueue().getModels().concat(M.getHiddenModels());if(!T){E++;for(var i=0;i<t.length;i++){var r=t[i],o=r.getData();if(r.isOTG()){var a=o.geomMetadata.hashes;if(a)for(var s=a.length/o.geomMetadata.byteStride,l=1;l<s;l++){var c=o.getGeometryHash(l);(u=n.get(c))&&(u.timeStamp=E)}}}for(var c in e.length>0&&console.warn("OtgResourceCache.cleanup(): array must be empty"),n){(u=n.get(c)).timeStamp!==E&&e.push(u)}e.sort(y);for(i=0;i<e.length&&this.byteSize>=52428800;i++){var u=e[i];n.delete(u.hash),this.byteSize-=u.byteSize,u.dispose()}i===e.length&&(T=!0),e.length=0}}},this.waitForGeometry=function(e,t){var i=0,r=w.makeUrgent(e);if(0===r&&e)t(e);else for(var o in L(),this.addEventListener(h,l),this.addEventListener(d,c),e){var a=n.get(o);a&&s(o,a)}function s(n,o){w.removeUrgent(n),!0!=!e[n]&&(e[n]=o,++i<r||(A.removeEventListener(h,l),A.removeEventListener(d,c),t(e)))}function l(e){s(e.geom.hash,e.geom)}function c(e){s(e.error.args.hash,void 0)}},this.getGeometry=function(e){return n.get(e)}}s.EventDispatcher.prototype.apply(_.prototype)}.call(this,n(257).setImmediate)},function(e,t,n){"use strict";n.r(t),n.d(t,"PropertyPanel",(function(){return a}));var i=n(41),r=n(121),o=n(239);function a(e,t,n,a){i.DockingPanel.call(this,e,t,n,a),this.title.classList.add("docking-panel-delimiter-shadow"),this.container.classList.add("property-panel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:70,marginTop:0}),this.highlightableElements={};var s=this;var l=function(){var e=new r.TreeDelegate;function t(e){return"category"===e.type}return e.setGlobalManager(s.globalManager),e.getTreeNodeId=function(e){return e.name+(e.hasOwnProperty("value")?e.value:"")+(e.hasOwnProperty("category")?e.category:"")},e.getTreeNodeClass=function(e){return t(e)?s.getCategoryClass(e):s.getPropertyClass(e)},e.isTreeNodeGroup=function(e){return t(e)},e.onTreeNodeClick=function(e,n,i){t(n)?s.onCategoryClick(n,i):s.onPropertyClick(n,i)},e.onTreeNodeRightClick=function(e,n,i){t(n)?s.onCategoryRightClick(n,i):s.onPropertyRightClick(n,i)},e.onTreeNodeDoubleClick=function(e,n,i){t(n)?s.onCategoryDoubleClick(n,i):s.onPropertyDoubleClick(n,i)},e.onTreeNodeIconClick=function(e,n,i){t(n)?s.onCategoryIconClick(n,i):s.onPropertyIconClick(n,i)},e.createTreeNode=function(e,n,i){var r=null;(r=t(e)?s.displayCategory(e,n,i):s.displayProperty(e,n,i))&&(s.highlightableElements[this.getTreeNodeId(e)]=r)},e}();this.tree=new o.Tree(l,null,this.scrollContainer,{}),this.tree.setGlobalManager(this.globalManager)}a.prototype=Object.create(i.DockingPanel.prototype),a.prototype.constructor=a,a.prototype.setProperties=function(e,t){this.removeAllProperties();for(var n=[],i=[],r=0;r<e.length;r++){if(!(c=e[r]).hidden){var o=e[r].displayCategory;o&&"string"==typeof o&&""!==o?n.push(c):i.push(c)}}if(n.length+i.length!==0){i[0]&&"Name"===i[0].displayName&&(this.addProperty(i[0].displayName,i[0].displayValue),i.shift());for(r=0;r<n.length;r++){var a=(c=n[r]).precision||Autodesk.Viewing.Private.calculatePrecision(c.displayValue),s=Autodesk.Viewing.Private.formatValueWithUnits(c.displayValue,c.units,c.type,a);this.addProperty(c.displayName,s,c.displayCategory)}var l=n.length>0;for(r=0;r<i.length;r++){var c;a=(c=i[r]).precision||Autodesk.Viewing.Private.calculatePrecision(c.displayValue),s=Autodesk.Viewing.Private.formatValueWithUnits(c.displayValue,c.units,c.type,a);this.addProperty(c.displayName,s,l?"Other":"",l?{localizeCategory:!0}:{})}}else this.showNoProperties()},a.prototype.showNoProperties=function(){this.removeAllProperties();var e=this.tree.myRootContainer,t=this.getDocument().createElement("div");t.className="no-properties";var n="No properties to display";t.setAttribute("data-i18n",n),t.textContent=Autodesk.Viewing.i18n.translate(n),e.appendChild(t)},a.prototype.showDefaultProperties=function(){this.showNoProperties(),this.resizeToContent()},a.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()},a.prototype.addProperty=function(e,t,n,i){if(this.tree.getElementForNode({name:e,value:t,category:n}))return!1;var r=null,o={name:e,value:t,type:"property"};return n?((r=this.tree.getElementForNode({name:n}))||(r=this.tree.createElement_({name:n,type:"category"},this.tree.myRootContainer,i&&i.localizeCategory?{localize:!0}:null)),o.category=n):r=this.tree.myRootContainer,this.tree.createElement_(o,r,i&&i.localizeProperty?{localize:!0}:null),!0},a.prototype.hasProperties=function(){for(var e in this.highlightableElements)return!0;return!1},a.prototype.removeProperty=function(e,t,n,i){var r={name:e,value:t,category:n},o=this.tree.getElementForNode(r);return!!o&&(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(r)],o.parentNode.removeChild(o),!0)},a.prototype.removeAllProperties=function(){this.highlightableElements={},this.tree.clear()},a.prototype.setCategoryCollapsed=function(e,t){var n=this.tree.delegate().getTreeNodeId(e);this.tree.setCollapsed(n,t)},a.prototype.isCategoryCollapsed=function(e){var t=this.tree.delegate().getTreeNodeId(e);return this.tree.isCollapsed(t)},a.prototype.getContentSize=function(){var e=this.tree.myRootContainer;return{height:e.clientHeight+55,width:e.clientWidth}},a.prototype.highlight=function(e,t){function n(t){var n=t.innerHTML,i=n.replace(/(<highlight>|<\/highlight>)/gim,"");if(n!==i&&(t.innerHTML=i),e&&""!==e){var r=new RegExp("(\\b"+e+"\\b)","gim"),o=i.replace(r,"<highlight>$1</highlight>");t.innerHTML=o}}for(var i in this.highlightableElements)for(var r=this.highlightableElements[i],o=0;o<r.length;++o)n(r[o])},a.prototype.displayCategory=function(e,t,n){var i=this.getDocument().createElement("div"),r=e.name;return n&&n.localize&&(i.setAttribute("data-i18n",r),r=Autodesk.Viewing.i18n.translate(r)),i.textContent=r,i.title=r,i.className="category-name",t.appendChild(i),[i]},a.prototype.displayProperty=function(e,t,n){var i=this.getDocument(),r=i.createElement("div"),o=e.name;n&&n.localize&&(r.setAttribute("data-i18n",o),o=Autodesk.Viewing.i18n.translate(o)),r.textContent=o,r.title=o,r.className="property-name";var a=i.createElement("div");a.className="separator";var s=i.createElement("div");s.textContent=e.value;var l=e.value;return s.title=l,l=function(e){e=String(e);var t=' target="blank" class="propertyLink" ';return[{pattern:/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,value:"<a"+t+'href="$&">$&</a>'},{pattern:/(^|[^\/])(www\.[\S]+(\b|$))/gim,value:"$1<a"+t+'href="http://$2">$2</a>'}].reduce((function(e,t){return e.replace(t.pattern,t.value)}),e)}(l),s.innerHTML=l,s.className="property-value",t.appendChild(r),t.appendChild(a),t.appendChild(s),[r,s]},a.prototype.getCategoryClass=function(e){return"category"},a.prototype.getPropertyClass=function(e){return"property"},a.prototype.onCategoryClick=function(e,t){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},a.prototype.onPropertyClick=function(e,t){},a.prototype.onCategoryIconClick=function(e,t){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},a.prototype.onPropertyIconClick=function(e,t){},a.prototype.onCategoryDoubleClick=function(e,t){},a.prototype.onPropertyDoubleClick=function(e,t){},a.prototype.onCategoryRightClick=function(e,t){},a.prototype.onPropertyRightClick=function(e,t){}},function(e,t,n){"use strict";function i(e,t,n){this.level=e,this.x=t,this.y=n}function r(e){var t=((1<<2*e.level)-1)/3,n=1<<e.level;return t+e.y*n+e.x}function o(e){for(var t=new i(0,0,0);r(t)<=e;)t.level++;t.level--;var n=e-r(t),o=1<<t.level;return t.y=Math.floor(n/o),t.x=n%o,t}n.r(t),n.d(t,"TileCoords",(function(){return i})),n.d(t,"tile2Index",(function(){return r})),n.d(t,"index2Tile",(function(){return o})),i.prototype={constructor:i,copy:function(){return new i(this.level,this.x,this.y)},isValid:function(){return Number.isInteger(this.level)&&this.level>=0&&Number.isInteger(this.x)&&Number.isInteger(this.y)},getChild:function(e){var t=1&e?1:0,n=2&e?1:0;return new i(this.level+1,2*this.x+t,2*this.y+n)},getParent:function(){return 0==this.level?null:new i(this.level-1,Math.floor(this.x/2),Math.floor(this.y/2))},getParentAtLevel:function(e){if(e<0||e>this.level)return null;var t=this.level-e;return new i(e,Math.floor(this.x>>t),Math.floor(this.y>>t))},toString:function(){return"("+this.level+", "+this.x+", "+this.y+")"},equals:function(e,t,n){return e instanceof i?this.equals(e.level,e.x,e.y):this.level===e&&this.x===t&&this.y===n}}},function(e,t,n){"use strict";var i=n(21);e.exports=function(e,t){return!!e&&i((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){"use strict";n.r(t),n.d(t,"FileLoaderManager",(function(){return r}));var i={};var r={registerFileLoader:function(e,t,n){return!i[e]&&(i[e]={loader:n,extensions:t},!0)},getFileLoader:function(e){return i[e]?i[e].loader:null},getFileLoaderForExtension:function(e){for(var t in e=e?e.toLowerCase():"",i){var n=i[t];if(n)for(var r=0;r<n.extensions.length;r++)if(n.extensions[r].toLowerCase()===e)return n.loader}return null},unregisterFileLoader:function(e){return!!i[e]&&(delete i[e],!0)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"createBufferGeometry",(function(){return p})),n.d(t,"meshToGeometry",(function(){return m})),n.d(t,"BufferGeometryUtils",(function(){return g}));var i=n(35),r=n(2),o=n(0),a=n(1),s={};function l(e,t,n){var i;if(t.array)i=new o.BufferAttribute(t.array,t.itemSize);else{var r=e+"|"+t.bytesPerItem+"|"+t.normalize+"|"+t.isPattern+"|"+t.divisor+"|"+t.offset;if(i=s[r])return i;i=new o.BufferAttribute(void 0,t.itemSize),s[r]=i}return i.bytesPerItem=t.bytesPerItem,i.normalize=t.normalize,i.isPattern=t.isPattern,n&&(i.divisor=t.divisor),t.array||(t.hasOwnProperty("offset")?i.itemOffset=t.offset:a.logger.warn("VB attribute is neither interleaved nor separate. Something is wrong with the buffer specificaiton.")),i}var c,u,h,d={};var f=1;function p(){return h||((c=new o.BufferAttribute(void 0,1)).bytesPerItem=2,(u=new o.BufferAttribute(void 0,1)).bytesPerItem=4,(h=function(){this.id=f++,this.attributes={},this.__webglInit=void 0}).prototype=Object.create(o.BufferGeometry.prototype),h.prototype.constructor=h),new h}function m(e){var t=e.mesh,n=p();for(var a in Object(r.isNodeJS)()&&(n.packId=e.packId,n.meshIndex=e.meshIndex),n.byteSize=0,n.vb=t.vb,n.vbbuffer=void 0,n.vbNeedsUpdate=!0,n.byteSize+=t.vb.byteLength,n.hash=e.hash,n.vbstride=t.vbstride,t.isLines&&(n.isLines=t.isLines),t.isWideLines&&(n.isWideLines=!0,n.lineWidth=t.lineWidth),t.isPoints&&(n.isPoints=t.isPoints,n.pointSize=t.pointSize),e.is2d&&(n.is2d=!0),n.numInstances=t.numInstances,t.vblayout){var s=t.vblayout[a];n.attributes[a]=l(a,s,n.numInstances)}if(i.memoryOptimizedLoading)n.attributes.index=t.indices instanceof Uint32Array?u:c,n.ib=t.indices,n.ibbuffer=void 0,t.iblines&&(n.attributes.indexlines=t.iblines instanceof Uint32Array?u:c,n.iblines=t.iblines,n.iblinesbuffer=void 0);else{var h=new o.BufferAttribute(t.indices,1);h.bytesPerItem=t.indices instanceof Uint32Array?4:2,n.addAttribute("index",h)}n.attributesKeys=function(e){var t="";for(var n in e.attributes)t+=n+"|";var i=d[t];return i||(i=Object.keys(e.attributes),d[t]=i,i)}(n),n.byteSize+=t.indices.byteLength,n.boundingBox=(new o.Box3).copy(t.boundingBox),n.boundingSphere=(new o.Sphere).copy(t.boundingSphere),e.geometry=n,e.mesh=null}var g={meshToGeometry:m,createBufferGeometry:p,findBufferAttribute:l}},function(e,t,n){"use strict";n.r(t),n.d(t,"Profile",(function(){return s}));var i=n(4),r=n(96),o=n(2),a=Object(o.getGlobal)();function s(e){if(e){var t=Autodesk.Viewing,n=t.ProfileSettings.Default,o=[];if(this.name=e.hasOwnProperty("name")?e.name:"Custom",this.label=e.label,this.description=e.description,this.persistent=Array.isArray(e.persistent)?e.persistent:n.persistent,this.settings=Object.assign({},n.settings),e.hasOwnProperty("settings")){var s=e.settings;o=Object.keys(s),this.settings=Object.assign(this.settings,s)}var l=[],c=[];if(e.hasOwnProperty("extensions")){var u=e.extensions.load,h=e.extensions.unload;l=u?u.slice():l,c=h?h.slice():c}this.extensions={load:l,unload:c},this.apply=function(e){if(!e)return!1;!function(e,t){if(r.LocalStorage.isSupported()){a.localStorage.getItem("Autodesk.Viewing.ProfileName")!==e&&(r.LocalStorage.setItem("Autodesk.Viewing.ProfileName",e),t.clearWebStorage())}}(this.name,e);var n=this.settings,s=[t.ProfileSettings.Default.name,t.ProfileSettings.AEC.name],l=Object.values(i.Prefs3D),c=Object.values(i.Prefs2D);for(var u in n)if(n.hasOwnProperty(u)){var h=n[u],d=-1!==o.indexOf(u)&&-1===s.indexOf(this.name)?["ignore-producer"]:[];-1!==l.indexOf(u)?d.push("3d"):-1!==c.indexOf(u)?d.push("2d"):(d.push("2d"),d.push("3d")),-1===this.persistent.indexOf(u)&&d.push("no-storage");var f=e.get(u);void 0!==f?(e.addTags(u,d),f!==h&&e.set(u,h)):e.add(u,h,d,!0)}return!0}}}},function(e,t,n){"use strict";n.r(t);n(379);var i=n(0),r=n(2),o=n(1),a=n(70),s=n(4),l=n(209),c=n(210),u=n(13),h=n(7),d=n(32),f=n(118),p=n(82),m=n(50),g=n(211),v=n(88),y=n(212),_=n(213),b=n(214),x=n(89),w=n(9),A=(n(6),n(3)),E=n(68),M=n(86),T=n(109),S=n(148),C=n(217),P=n(219),L=n(220),D=n(221),R=n(51),I=n(79),O=n(33),N=n(11);function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var F=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.domElement=null}var t,n,i;return t=e,(n=[{key:"createDom",value:function(e){var t=this.getDocument(),n=t.createElement("div");n.className="spinner",e&&e.appendChild(n);for(var i=1;i<=3;i++){var r=t.createElement("div");r.className="bounce"+i,n.appendChild(r)}return this.domElement=n,this.hide(),n}},{key:"show",value:function(){this.domElement&&(this.domElement.style.display="block")}},{key:"hide",value:function(){this.domElement&&(this.domElement.style.display="None")}},{key:"destroy",value:function(){this.domElement=null}}])&&k(t.prototype,n),i&&k(t,i),e}();N.GlobalManagerMixin.call(F.prototype);var V=n(54),B=n(149),U=Object.freeze({pdf:"Autodesk.PDF",scalaris:"Autodesk.Scalaris"}),z=n(225),G=n(135),H=n(18);function W(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}n.d(t,"Viewer3D",(function(){return Y})),n.d(t,"waitForCompleteLoad",(function(){return K}));var j=Autodesk.Viewing;var X=0,q=["markups-svg","pushpin-container"];function Y(e,t){if(this.setGlobalManager(new G.GlobalManager),e){if(this.clientContainer=e,this.container=this.getDocument().createElement("div"),this.container.classList.add("adsk-viewing-viewer"),this.container.style.height="100%",this.container.style.width="100%",this.container.style.overflow="hidden",this.container.classList.add(Object(r.isTouchDevice)()?"touch":"notouch"),this.clientContainer.appendChild(this.container),this.config=t||{},this.contextMenu=null,this.contextMenuCallbacks={},this.started=!1,this.theme=this.config.theme||"dark-theme",this.container.classList.add(this.theme),this.containerLayerOrder=this.config.containerLayerOrder||q,Object(r.isChrome)()&&this.container.classList.add("quality-text"),"CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";this.canvasWrap=this.getDocument().createElement("div"),this.canvasWrap.classList.add("canvas-wrap"),this.canvas=this.getDocument().createElement("canvas"),this.canvas.tabIndex=0,this.canvas.setAttribute("data-viewer-canvas","true"),this.canvasWrap.appendChild(this.canvas),this.container.appendChild(this.canvasWrap),this.canvas.viewer=this}var n={prefix:"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.",localStorage:!Object(r.isNodeJS)()};this.prefs=new l.Preferences(this,n),this.profile=null,this.profileManager=new c.ProfileManager,this._hotkeyManager=new g.HotkeyManager,this.extensionCache=null,this.running=!1,this._pushedTool="",this._defaultNavigationTool="",this.id=X++,this.impl=new D.Viewer3DImpl(this.canvas,this),this.overlays=new z.OverlayManager(this.impl),this._loadingSpinner=new F,this._loadingSpinner.setGlobalManager(this.globalManager),this.trackADPTimer=[]}function K(e,t){return new Promise((function(n,i){var r=0;function o(t){2===r&&n({viewer:e,model:t})}e.addEventListener(A.GEOMETRY_LOADED_EVENT,(function n(a){a.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(A.GEOMETRY_LOADED_EVENT,n),r++,t.skipPropertyDb?o(a.model):a.model.getProperties(1,(function(e){return o(a.model)}),(function(e){return i(e)})))})),e.addEventListener(A.TEXTURES_LOADED_EVENT,(function n(i){i.model.getData().loadOptions.bubbleNode===t.bubbleNode&&(e.removeEventListener(A.TEXTURES_LOADED_EVENT,n),r++,o(i.model))}))}))}d.EventDispatcher.prototype.apply(Y.prototype),p.ScreenModeMixin.prototype.apply(Y.prototype),m.ExtensionMixin.prototype.apply(Y.prototype),N.GlobalManagerMixin.call(Y.prototype),Y.prototype.constructor=Y,Object.defineProperty(Y.prototype,"model",{get:function(){return this.impl.model},set:function(){throw"Do not set viewer.model"}}),Y.ViewerCount=0,Y.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"]},clickShift:{onObject:["selectToggle"]},disableSpinner:!1,disableMouseWheel:!1,disableTwoFingerSwipe:!1},Y.createHeadlessViewer=function(){var e=new Y;return e.impl.initialize(),e.impl.setLightPreset(0),e},Y.prototype.start=function(e,t,n,i){if(this.started)return 0;this.started=!0;var r=this,o=r.initialize();return 0!==o?(i&&setTimeout((function(){i(o)}),1),o):(setTimeout((function(){r.setUp(r.config)}),1),e&&this.loadModel(e,t,n,i),0)},Y.prototype.startWithDocumentNode=function(e,t,n){var i=this;return new Promise((function(r,o){if(i.started)return 0;i.started=!0;var a=i.initialize();0===a?(setTimeout((function(){i.setUp(i.config)}),1),i.loadDocumentNode(e,t,n).then(r).catch(o)):setTimeout((function(){o(a)}),1)}))},Y.prototype.registerUniversalHotkeys=function(){var e,t,n,i=this;e=function(){return i.navigation.setRequestFitToView(!0),!0},i._hotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[O.KeyCode.f],onPress:e}]),e=function(){return i.navigation.setRequestHomeView(!0),!0},i._hotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[O.KeyCode.h],onPress:e},{keycodes:[O.KeyCode.HOME],onPress:e}]),t=function(){return!(!i.objectContextMenu||!i.objectContextMenu.hide())||(i.dispatchEvent({type:A.ESCAPE_EVENT}),!0)},i._hotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[O.KeyCode.ESCAPE],onRelease:t}]),e=function(){return n=i.getActiveNavigationTool(),i.setActiveNavigationTool("pan")},t=function(){return i.setActiveNavigationTool(n)};var r=[{keycodes:[O.KeyCode.SHIFT],onPress:e,onRelease:t},{keycodes:[O.KeyCode.SPACE],onPress:e,onRelease:t}];i._hotkeyManager.pushHotkeys("Autodesk.Pan",r,{tryUntilSuccess:!0})},Y.prototype.createControls=function(){var e=this.impl;return this.navigation=new v.Navigation(e.camera),this.__initAutoCam(e),this.utilities=new _.ViewingUtilities(e,this.autocam,this.navigation),this.clickHandler=new b.DefaultHandler(e,this.navigation,this.utilities),this.toolController=new y.ToolController(e,this,this.autocam,this.utilities,this.clickHandler),this.toolController.registerTool(new x.GestureHandler(this)),this.toolController.registerTool(this._hotkeyManager),this.toolController.activateTool(this._hotkeyManager.getName()),this.registerUniversalHotkeys(),this.toolController.registerTool(new P.OrbitDollyPanTool(e,this,this.config.navToolsConfig)),this.toolController},Y.prototype.initialize=function(){this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0);var e=this.getDimensions();if(this.canvas.width=e.width,this.canvas.height=e.height,Object(r.isIOSDevice)()&&this.getWindow().devicePixelRatio&&(this.canvas.width/=this.getWindow().devicePixelRatio,this.canvas.height/=this.getWindow().devicePixelRatio),this.impl.initialize(),!this.impl.glrenderer()){var t=function(){if(j.getGlobal().WebGLRenderingContext){for(var e=j.getGlobal().document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],n=!1,i=0;i<4;i++)try{if((n=e.getContext(t[i]))&&"function"==typeof n.getParameter)return 1}catch(e){}return 0}return-1}();if(t<=0)return-1===t?h.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:h.ErrorCodes.BROWSER_WEBGL_DISABLED}var n,i=this;Object(r.isIOSDevice)()?this.onResizeCallback=function(e){clearTimeout(n),n=setTimeout(i.resize.bind(i),500)}:this.onResizeCallback=function(e){var t=i.impl.camera.clientWidth,n=i.impl.camera.clientHeight,r=i.container.clientWidth,o=i.container.clientHeight;t===r&&n===o||i.resize()};this.addWindowEventListener("resize",this.onResizeCallback,!1),this.onScrollCallback=function(e){i.impl.canvasBoundingclientRectDirty=!0},this.addWindowEventListener("scroll",this.onScrollCallback),this.initContextMenu(),this.localize(),this.impl.controls=this.createControls(),this.initializePrefListeners(),this.setDefaultNavigationTool("orbit"),this.impl.controls&&this.impl.controls.setAutocam(this.autocam);var o=this.config&&this.config.canvasConfig?this.config.canvasConfig:Y.kDefaultCanvasConfig;return this.setCanvasClickBehavior(o),o.disableSpinner||(this.loadSpinner=this._loadingSpinner.createDom(this.container)),this.viewerState=new S.ViewerState(this),this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run(),this.getWindow().NOP_VIEWER=this,this.addEventListener(A.MODEL_ADDED_EVENT,(function(e){i.onModelAdded(e.model,e.preserveTools)})),this.dispatchEvent(A.VIEWER_INITIALIZED),this.trackADPSettingsOptions(),this.trackADPExtensionsLoaded(),Y.ViewerCount++,0},Y.prototype.setUp=function(e){if(this.config=e||{},Array.isArray(this.config.extensions))for(var t=this.config.extensions,n=0;n<t.length;++n)this.loadExtension(t[n],this.config);"true"===Object(u.getParameterByName)("lmv_viewer_debug")&&this.loadExtension("Autodesk.Debug",this.config);var i=this.config.canvasConfig||Y.kDefaultCanvasConfig;this.setCanvasClickBehavior(i)},Y.prototype.tearDown=function(){if(this.clearSelection(),this.loadedExtensions){for(var e in this.loadedExtensions)try{this.unloadExtension(e)}catch(t){o.logger.error("Failed to unload extension: "+e,t,Object(h.errorCodeString)(h.ErrorCodes.VIEWER_INTERNAL_ERROR)),o.logger.track({category:"error_unload_extension",extensionId:e,error_message:t.message,call_stack:t.stack})}this.loadedExtensions=null}for(this.toolController&&(this.toolController.enableMouseButtons(!1),this.toolController.deactivateTool("gestures")),o.logger.reportRuntimeStats(!0),this._loadingSpinner.show(),this.liveReviewClient&&(this.liveReviewClient.destroy(),this.liveReviewClient=null);this.trackADPTimer.length>0;)clearTimeout(this.trackADPTimer.pop());this.impl.unloadCurrentModel(),this.impl.setCutPlaneSet("__set_view",void 0)},Y.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())},Y.prototype.localize=function(){w.i18n.localize()},Y.prototype.__initAutoCam=function(e){var t=this,n=e.camera;n.pivot||(n.pivot=new i.Vector3(0,0,0)),n.target||(n.target=new i.Vector3(0,0,0)),n.worldup||(n.worldup=n.up.clone()),t.autocamCamera=n.clone(),t.autocamCamera.target=n.target.clone(),t.autocamCamera.pivot=n.pivot.clone(),t.autocamCamera.worldup=n.worldup.clone(),t.autocam=new L.Autocam(t.autocamCamera,t.navigation,t.canvas),t.autocam.setGlobalManager(this.globalManager),t.autocam.registerCallbackCameraChanged((function(e){t.autocamCamera.isPerspective!==n.isPerspective&&(t.autocamCamera.isPerspective?t.navigation.toPerspective():t.navigation.toOrthographic()),t.navigation.setVerticalFov(t.autocamCamera.fov,!1),t.navigation.setView(t.autocamCamera.position,t.autocamCamera.target),t.navigation.setPivotPoint(t.autocamCamera.pivot),t.navigation.setCameraUpVector(t.autocamCamera.up),e&&t.navigation.setWorldUpVector(t.autocamCamera.worldup),t.impl.syncCamera(e)})),t.autocam.registerCallbackPivotDisplay((function(e){t.utilities?t.utilities.pivotActive(e,!1):t.impl.controls.pivotActive(e,!1)})),t.autocam.registerCallbackTransitionCompleted((function(){t.fireEvent({type:A.CAMERA_TRANSITION_COMPLETED})})),t.addEventListener("cameraChanged",(function(e){var n=e.camera;t.autocam.sync(n)})),t.autocam.sync(n)},Y.prototype.uninitialize=function(){this.removeWindowEventListener("resize",this.onResizeCallback,!1),this.onResizeCallback=null,this.removeWindowEventListener("scroll",this.onScrollCallback),this.onScrollCallback=null,this.canvas?this.canvas.removeEventListener("mousedown",this.onMouseDown):this.container&&this.container.removeEventListener("mousedown",this.onMouseDown),this.onMouseDown=null,this.canvas?this.canvas.removeEventListener("mouseup",this.onMouseUp):this.container&&this.container.removeEventListener("mouseup",this.onMouseUp),this.onMouseUp=null,this.canvas.parentNode.removeChild(this.canvas),this.canvas.viewer=null,this.canvas=null,this.canvasWrap=null,this.viewerState=null,o.logger.reportRuntimeStats(),o.logger.track({category:"viewer_destroy"},!0),this.toolController&&(this.toolController.uninitialize(),this.toolController=null,this.clickHandler=null,this.utilities=null),this.navigation&&(this.navigation.uninitialize(),this.navigation=null),this.impl&&(this.impl.dtor(),this.impl=null),this.overlays&&(this.overlays.dtor(),this.overlays=null),this.loadSpinner=null,this._loadingSpinner.destroy(),this.prefs&&this.prefs.clearListeners(),this.prefs=null,this.profile=null,this.profileManager=null,this.autocam.dtor(),this.autocam=null,this.autocamCamera=null,this._hotkeyManager.popHotkeys("Autodesk.FitToView"),this._hotkeyManager.popHotkeys("Autodesk.Home"),this._hotkeyManager.popHotkeys("Autodesk.Escape"),this._hotkeyManager.popHotkeys("Autodesk.Pan"),this._hotkeyManager.popHotkeys("Autodesk.Orbit"),Y.ViewerCount--,0===Y.ViewerCount&&Object(M.clearPropertyWorkerCache)(),this.onDefaultContextMenu&&(this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1),this.onDefaultContextMenu=null),this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.extensionCache=null,this.clientContainer=null,this.config=null,this.contextMenu=null,this.contextMenuCallbacks=null,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.dispatchEvent(A.VIEWER_UNINITIALIZED),this.listeners={},o.logger.log("viewer destroy")},Y.prototype.finish=function(){this.tearDown(),this.uninitialize()},Y.prototype.setLoadHeuristics=function(e){var t=e.bubbleNode;if(t){var n=t.findViewableParent();if(n){var i=n.name();e.fileExt=i.slice(i.length-3).toLowerCase();void 0===e.isAEC&&-1!==["rvt","nwd","nwc","ifc"].indexOf(e.fileExt)&&(e.isAEC=!0)}}if(e.isAEC){var o=Object(u.getParameterByName)("useConsolidation")||"";e.useConsolidation="true"===o||"false"!==o&&void 0,void 0===e.useConsolidation&&(e.useConsolidation=!Object(r.isMobileDevice)()&&!Object(r.isNodeJS)()),void 0===e.createWireframe&&(e.createWireframe=!Object(r.isMobileDevice)()),void 0===e.disablePrecomputedNodeBoxes&&(e.disablePrecomputedNodeBoxes=!0)}else void 0===e.createWireframe&&(e.createWireframe=!Object(r.isMobileDevice)()&&this.prefs.edgeRendering);e.useConsolidation&&!e.bvhOptions&&(e.bvhOptions={},I.Consolidation.applyBVHDefaults(e.bvhOptions))},Y.prototype.trackADPSettingsOptions=function(){var e=this;this.trackADPTimer.push(setTimeout((function(){if(e.prefs){var t={category:"settingOptionsStatus",switchSheetColorWhiteToBlack:e.prefs.swapBlackAndWhite,leftHandedMouseSetup:e.prefs.leftHandedMouseSetup,openPropertiesOnSelect:e.prefs.openPropertiesOnSelect,orbitPastWorldPoles:e.prefs.orbitPastWorldPoles,reverseMouseZoomDirection:e.prefs.reverseMouseZoomDir,fusionStyleOrbit:e.prefs.fusionOrbit,setPivotWithLeftMouseButton:e.prefs.clickToSetCOI,zoomTowardPivot:e.prefs.zoomTowardsPivot,viewCubeActsOnPivot:e.prefs.alwaysUsePivot,showViewCube:e.prefs.viewCube,environmentImageVisible:e.prefs.envMapBackground,displayEdges:e.prefs.edgeRendering,displayPoints:e.prefs.pointRendering,displayLines:e.prefs.lineRendering,ghostHiddenObjects:e.prefs.ghosting,groundReflection:e.prefs.groundReflection,groundShadow:e.prefs.groundShadow,ambientShadows:e.prefs.ambientShadows,antiAliasing:e.prefs.antialiasing,progressiveModelDisplay:e.prefs.progressiveRendering,smoothNavigation:e.prefs.optimizeNavigation};o.logger.track(t)}}),3e4))},Y.prototype.trackADPExtensionsLoaded=function(){var e=this,t={category:"loaded_extensions"};this.trackADPTimer.push(setTimeout((function(){if(e.loadedExtensions)for(var n in e.loadedExtensions)t[n]=n;o.logger.track(t)}),3e4))},Y.prototype.activateDefaultNavigationTools=function(e){if(!Object(r.isNodeJS)()){var t=e?"pan":"orbit";this.setDefaultNavigationTool(t),this.setActiveNavigationTool(t),this.toolController&&(this.toolController.enableMouseButtons(!0),this.toolController.activateTool("gestures"))}},Y.prototype.registerDimensionSpecificHotkeys=function(e){if(this._hotkeyManager)if(e)this._hotkeyManager.popHotkeys("Autodesk.Orbit");else{var t,n=this,i=[{keycodes:[O.KeyCode.ALT],onPress:function(){return t=n.getActiveNavigationTool(),n.setActiveNavigationTool("orbit")},onRelease:function(){return n.setActiveNavigationTool(t)}}];this._hotkeyManager.pushHotkeys("Autodesk.Orbit",i,{tryUntilSuccess:!0})}},Y.prototype.onModelAdded=function(e,t){1===this.impl.modelQueue().getModels().length&&this.initializeFirstModelPresets(e,t)},Y.prototype.initializeFirstModelPresets=function(e,t,n){e.is2d()&&this.activateLayerState("Initial"),n||e.getData().loadOptions.preserveView||(this.setActiveNavigationTool(),this.impl.setViewFromFile(e,!0),this.toolController.recordHomeView()),this.registerDimensionSpecificHotkeys(e.is2d()),t||this.activateDefaultNavigationTools(e.is2d()),this.navigation.setIs2D(this.impl.modelQueue().areAll2D());var i=e.getData();i.isLeaflet?this.navigation.setConstraints2D(i.bbox,i.maxPixelPerUnit):this.navigation.setConstraints2D()},Y.prototype.loadModel=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n,i,a,s){var l,c,d,f,p,m,g,v,y,_,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=function(e,t,n){l._loadingSpinner.hide(),a&&a(e,t,n)},f=function(e,t){l.impl._removeLoadingFile(d),e?p(e.code,e.msg,e.args):(t.getData().underlayRaster=n.underlayRaster&&t.getLeaflet(),n.loadAsHidden?l.impl.modelQueue().addHiddenModel(t):l.impl.addModel(t),t.loader&&t.loader.notifiesFirstPixel?l.addEventListener(A.RENDER_FIRST_PIXEL,(function(){l._loadingSpinner.hide()}),{once:!0}):l._loadingSpinner.hide(),i&&i(t))},l=this,void 0===(n=n||{}).skipPropertyDb&&(c=Object(u.getParameterByName)("skipPropertyDb")||"",n.skipPropertyDb="true"===c||"false"!==c&&void 0),m=t.toLowerCase().match(/\.([a-z0-9]+)(\?|$)/),g=m?m[1]:null,!(v=this.config&&this.config.loaderExtensions&&this.config.loaderExtensions[g]||g in U&&U[g])||this.isExtensionLoaded(v)){e.next=17;break}return e.prev=8,e.next=11,this.loadExtension(v);case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(8),a&&a(h.ErrorCodes.VIEWER_INTERNAL_ERROR,e.t0.toString()),e.abrupt("return",!1);case 17:if(y=n&&n.fileLoader?n.fileLoader:E.FileLoaderManager.getFileLoaderForExtension(g)){e.next=22;break}return o.logger.error("File extension not supported:"+g,Object(h.errorCodeString)(h.ErrorCodes.UNSUPORTED_FILE_EXTENSION)),p(h.ErrorCodes.UNSUPORTED_FILE_EXTENSION,"File extension not supported",0,g),e.abrupt("return",!1);case 22:return this.setLoadHeuristics(n),this.impl.hasModels()||this._loadingSpinner.show(),d=new y(this.impl,this.config),_=d.loadFile(t,n,f,s),this.fireEvent({type:A.LOADER_LOAD_FILE_EVENT,loader:d}),Object(r.isNodeJS)()||this.profile||(b=this.chooseProfile(n),this.setProfile(b)),this.impl.setRenderingPrefsFor2D(!d.is3d()),e.abrupt("return",_);case 30:case"end":return e.stop()}}),e,this,[[8,13]])})),function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){W(o,i,r,a,s,"next",e)}function s(e){W(o,i,r,a,s,"throw",e)}a(void 0)}))});return function(e,n,i,r,o){return t.apply(this,arguments)}}(),Y.prototype.unloadModel=function(e){e||(e=this.model),this.impl.unloadModel(e)},Y.prototype.loadDocumentNode=function(e,t,n){var i=this,r=t,o={},a=e.getViewableUrn(r,o),s=r.findPropertyDbPath();a=e.getFullPath(a);var l={sharedPropertyDbPath:s=e.getFullPath(s),acmSessionId:e.acmSessionId,bubbleNode:r,applyRefPoint:!1,loadOptions:o,page:o.page||1};for(var c in n=n||{},l)n.hasOwnProperty(c)||(n[c]=l[c]);if(!n.keepCurrentModels&&this.impl.hasModels()){var u=this.config;this.tearDown(),this.setUp(u)}var h=r.findParentGeom2Dor3D().extensions();Array.isArray(h)&&h.forEach((function(e){i.loadExtension(e,i.config)}));var d=this,f=o.isPdf?this.loadExtension("Autodesk.PDF",this.config):Promise.resolve(),p=!n.disableUnderlayRaster&&o.tempRasterPath?this._loadTempRasterModel(e,n,r):Promise.resolve();return f.then(p).then((function(){return new Promise((function(e,t){d.loadModel(a,n,(function(t){n.loadAsHidden||n.preserveView||"view"!==r.type()||d.setView(r,{skipTransition:!0}),e(t)}),(function(e){t(e)}))}))}))},Y.prototype.unloadDocumentNode=function(e){var t=this.impl.findModel(e,!0);if(t)return this.impl.unloadModel(t),!0;if(!this.impl.loaders)return!1;for(var n=0;n<this.impl.loaders.length;n++){var i=this.impl.loaders[n];if((i.options&&i.options.bubbleNode)===e)return i.dtor(),this.impl.loaders.splice(n,1),!0}return!1},Y.prototype._loadTempRasterModel=function(e,t,n){var i=this;return new Promise((function(r,o){if(t.loadAsHidden)return r();t.underlayRaster=!0,t.loadOptions.fitPaperSize=!0;var a=function(e){return e.getDocumentNode().getDocument().getPath()===n.getDocument().getPath()&&e.getDocumentNode().guid()===n.guid()&&!e.getData().isLeaflet},s=function e(t){var n=t.model;a(n)&&(i.initializeFirstModelPresets(n,!1,!0),i.removeEventListener(A.MODEL_ADDED_EVENT,e))};i.addEventListener(A.MODEL_ADDED_EVENT,s);var l,c=function e(t){var n=t.model;a(n)&&(n.getFragmentList().setObject2DVisible(-1,!0),i.removeEventListener(A.MODEL_REMOVED_EVENT,e),i.removeEventListener(A.MODEL_ADDED_EVENT,s),i.removeEventListener(A.GEOMETRY_LOADED_EVENT,u))};i.addEventListener(A.MODEL_REMOVED_EVENT,c);var u=function e(t){var n=t.model;a(n)&&(n.getFragmentList().setObject2DVisible(-1,!0),i.removeEventListener(A.MODEL_REMOVED_EVENT,c),l&&(i.unloadModel(l),l=null),i.removeEventListener(A.GEOMETRY_LOADED_EVENT,e))};i.addEventListener(A.GEOMETRY_LOADED_EVENT,u);var h=e.getFullPath(t.loadOptions.tempRasterPath);i.loadModel(h,t,(function(e){l=e,t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,t.hideBackground=!0,r()}),(function(){t.loadOptions.fitPaperSize=void 0,t.underlayRaster=void 0,r()}))}))},Y.prototype.getDimensions=function(){if(this.container){var e={};return this.getScreenMode()===p.ScreenMode.kFullScreen?(e.width=screen.width,e.height=screen.height):e=this.container.getBoundingClientRect(),{width:e.width,height:e.height}}return null},Y.prototype.resize=function(){this.container.clientWidth>0&&this.container.clientHeight>0&&this.impl.resize(this.container.clientWidth,this.container.clientHeight)},Y.prototype.getHotkeyManager=function(){return this._hotkeyManager},Y.prototype.getCamera=function(){return this.impl.camera},Y.prototype.getState=function(e){return this.viewerState.getState(e)},Y.prototype.restoreState=function(e,t,n){var i=this.viewerState.restoreState(e,t,n);return i&&this.dispatchEvent({type:A.VIEWER_STATE_RESTORED_EVENT,value:i}),i},Y.prototype.setView=function(e,t){if(!this.model)return!1;if(!(e&&e instanceof R.BubbleNode))return!1;var n=!!t&&t.skipTransition,r=!t||t.useExactCamera;if(e.getViewBox())return this.setViewFromViewBox(e.getViewBox(),e.name(),n),this.dispatchEvent({type:A.SET_VIEW_EVENT,view:e}),!0;var o=this.getCameraFromViewArray(e.data.camera);if(!o)return!1;this.impl.setViewFromCamera(o,n,r);var a=e.data.sectionPlane,s=e.data.sectionBox,l=e.data.sectionBoxTransform,c=this.model.getData().globalOffset;if(a){for(var u=[],h=0;h<a.length;h+=4){var d=new i.Vector4(a[h+0],a[h+1],a[h+2],a[h+3]);c&&(d.w+=i.Vector3.prototype.dot.call(c,new i.Vector3(a[h+0],a[h+1],a[h+2]))),u.push(d)}this.impl.setCutPlaneSet("__set_view",u)}else if(s&&l){var f=(new i.Matrix4).fromArray([l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],l[8],l[9],l[10],l[11],l[12],l[13],l[14],l[15]]);if(c){var p=(new i.Matrix4).makeTranslation(-c.x,-c.y,-c.z);f.multiply(p)}var m=new i.Vector3(s[0],s[1],s[2]),g=new i.Vector3(s[3],s[4],s[5]),v=new i.Box3(m,g);v.applyMatrix4(f);var y=V.SceneMath.box2CutPlanes(v);this.impl.setCutPlaneSet("__set_view",y)}else this.impl.setCutPlaneSet("__set_view",void 0);return this.dispatchEvent({type:A.SET_VIEW_EVENT,view:e}),!0},Y.prototype.setViewFromArray=function(e){var t=this.getCameraFromViewArray(e);this.impl.setViewFromCamera(t,!1,!0)},Y.prototype.getCameraFromViewArray=function(e,t){t=t||this.model;var n=this.model&&this.model.getData().placementWithOffset;return R.BubbleNode.readCameraFromArray(e,n)},Y.prototype.getViewArrayFromCamera=function(){var e=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0};return this.impl.getViewArrayFromCamera(e)},Y.prototype.setViewFromViewBox=function(e,t,n){var i=this.model;if(!i||i.is2d()){if(t&&t.length){var r,a=i.getData().metadata.views;for(r=0;r<a.length&&a[r].name!=t;r++);if(r<a.length){var s=a[r].layer_state;s&&this.activateLayerState(s)}}this.impl.setViewFromViewBox(this.model,e,t,n)}else o.logger.warn("Viewer3D.setViewFromViewBox is not applicable to 3D")},Y.prototype.activateLayerState=function(e){this.impl.layers.activateLayerState(e),this.dispatchEvent({type:A.LAYER_VISIBILITY_CHANGED_EVENT})},Y.prototype.getLayerStates=function(){return this.impl.layers.getLayerStates()},Y.prototype.setViewFromFile=function(e){this.setActiveNavigationTool(),this.impl.setViewFromFile(e||this.model)},Y.prototype.getProperties=function(e,t,n){this.model?this.model.getProperties(e,t,n):n&&n(h.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist")},Y.prototype.getObjectTree=function(e,t){this.model?this.model.getObjectTree(e,t):t&&t(h.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist")},Y.prototype.setCanvasClickBehavior=function(e){if(this.impl.controls.hasOwnProperty("setClickBehavior")&&this.impl.controls.setClickBehavior(e),this.clickHandler&&this.clickHandler.setClickBehavior(e),e&&e.disableMouseWheel&&this.toolController.setMouseWheelInputEnabled(!1),e&&e.disableTwoFingerSwipe){var t=this.toolController.getTool("gestures");t&&t.disableTwoFingerSwipe()}},Y.prototype.search=function(e,t,n,i){this.searchText=e,this.model?this.model.search(e,t,n,i):n&&n(h.ErrorCodes.BAD_DATA,"Search failed since model does not exist")},Y.prototype.getHiddenNodes=function(e){return e=e||this.model,this.impl.visibilityManager.getHiddenNodes(e)},Y.prototype.getIsolatedNodes=function(e){return(e=e||this.model)&&e.is2d()?(o.logger.warn("Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes(e)},Y.prototype.isolate=function(e,t){if(t=t||this.model){t.getData();this.impl.visibilityManager.isolate(e,t)}},Y.prototype.setBackgroundColor=function(e,t,n,i,r,o){this.impl.setClearColors(e,t,n,i,r,o)},Y.prototype.setBackgroundOpacity=function(e){this.impl.setClearAlpha(e)},Y.prototype.toggleSelect=function(e,t,n){(t=t||this.model)&&t.is2d()?o.logger.warn("Viewer3D.toggleSelect is not yet implemented for 2D"):this.impl.selector.toggleSelection(e,t,n)},Y.prototype.select=function(e,t,n){"number"==typeof e&&(e=[e]),t=t||this.model,this.impl.selector.setSelection(e,t,n)},Y.prototype.clearSelection=function(){this.impl.selector.clearSelection()},Y.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()},Y.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()},Y.prototype.setSelectionMode=function(e){this.prefs.set(s.Prefs3D.SELECTION_MODE,e)},Y.prototype.getSelection=function(){return this.impl.selector.getSelection()},Y.prototype.lockSelection=function(e,t,n){n=n||this.model,this.impl.selector.lockSelection(e,t,n)},Y.prototype.unlockSelection=function(e,t){this.impl.selector.unlockSelection(e,t)},Y.prototype.isSelectionLocked=function(e,t){return this.impl.selector.isNodeSelectionLocked(e,t)},Y.prototype.getAggregateSelection=function(e){var t=this.impl.selector.getAggregateSelection();if(e)for(var n=0;n<t.length;n++)for(var i=0;i<t[n].selection.length;i++)e(t[n].model,t[n].selection[i]);return t},Y.prototype.getAggregateIsolation=function(){return this.impl.visibilityManager.getAggregateIsolatedNodes()},Y.prototype.getAggregateHiddenNodes=function(){return this.impl.visibilityManager.getAggregateHiddenNodes()},Y.prototype.hide=function(e,t){t=t||this.model,this.impl.visibilityManager.hide(e,t)},Y.prototype.show=function(e,t){t=t||this.model,this.impl.visibilityManager.show(e,t)},Y.prototype.showAll=function(){this.impl.visibilityManager.aggregateIsolate([]),this.impl.layers.showAllLayers(),this.fireEvent({type:A.SHOW_ALL_EVENT})},Y.prototype.toggleVisibility=function(e,t){this.impl.visibilityManager.toggleVisibility(e,t)},Y.prototype.areAllVisible=function(){return this.impl.isWholeModelVisible(this.model)},Y.prototype.isNodeVisible=function(e,t){return t=t||this.model,this.impl.isNodeVisible(e,t)},Y.prototype.lockVisible=function(e,t,n){n=n||this.model,this.impl.visibilityManager.lockNodeVisible(e,t,n)},Y.prototype.toggleLockVisible=function(e,t){this.impl.visibilityManager.toggleVisibleLocked(e,t)},Y.prototype.isVisibleLocked=function(e,t){return this.impl.visibilityManager.isNodeVisibleLocked(e,t)},Y.prototype.explode=function(e){this.model&&(this.model.is2d()?o.logger.warn("Viewer3D.explode is not applicable to 2D"):this.impl.explode(e)&&o.logger.track({name:"explode_count",aggregate:"count"}))},Y.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(o.logger.warn("Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()},Y.prototype.lockExplode=function(e,t,n){return(n=n||this.model)&&n.is2d()?(o.logger.warn("Viewer3D.lockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,t,n)},Y.prototype.isExplodeLocked=function(e,t){return(t=t||this.model)&&t.is2d()?(o.logger.warn("Viewer3D.isExplodeLocked is not applicable to 2D"),0):this.impl.isExplodeLocked(e,t)},Y.prototype.toggleLockExplode=function(e,t){return(t=t||this.model)&&t.is2d()?(o.logger.warn("Viewer3D.toggleLockExplode is not applicable to 2D"),0):this.impl.lockExplode(e,!this.isExplodeLocked(e,t),t)},Y.prototype.setQualityLevel=function(e,t){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set(s.Prefs3D.AMBIENT_SHADOWS,e),this.prefs.set(s.Prefs3D.ANTIALIASING,t))},Y.prototype.setGhosting=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGhosting is not applicable to 2D"):this.prefs.set(s.Prefs3D.GHOSTING,e)},Y.prototype.setGroundShadow=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadow is not applicable to 2D"):this.prefs.set(s.Prefs3D.GROUND_SHADOW,e)},Y.prototype.setGroundReflection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflection is not applicable to 2D"):this.prefs.set(s.Prefs3D.GROUND_REFLECTION,e)},Y.prototype.setEnvMapBackground=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setEnvMapBackground is not applicable to 2D"):this.prefs.set(s.Prefs3D.ENV_MAP_BACKGROUND,e)},Y.prototype.setFirstPersonToolPopup=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setFirstPersonToolPopup is not applicable to 2D"):this.prefs.set(s.Prefs3D.FIRST_PERSON_TOOL_POPUP,e)},Y.prototype.getFirstPersonToolPopup=function(){if(!this.model||!this.model.is2d())return this.prefs.firstPersonToolPopup;o.logger.warn("Viewer3D.getFirstPersonToolPopup is not applicable to 2D")},Y.prototype.setBimWalkToolPopup=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setBimWalkToolPopup is not applicable to 2D"):this.prefs.set(s.Prefs3D.BIM_WALK_TOOL_POPUP,e)},Y.prototype.getBimWalkToolPopup=function(){if(!this.model||!this.model.is2d())return this.prefs.bimWalkToolPopup;o.logger.warn("Viewer3D.getBimWalkToolPopup is not applicable to 2D")},Y.prototype.setProgressiveRendering=function(e){this.prefs.set(s.Prefs.PROGRESSIVE_RENDERING,e)},Y.prototype.setGrayscale=function(e){this.model&&this.model.is3d()?o.logger.warn("Viewer3D.setGrayscale is not applicable to 3D"):this.prefs.set(s.Prefs2D.GRAYSCALE,e)},Y.prototype.setSwapBlackAndWhite=function(e){this.model&&this.model.is3d()?o.logger.warn("Viewer3D.setSwapBlackAndWhite is not applicable to 3D"):this.prefs.set(s.Prefs2D.SWAP_BLACK_AND_WHITE,e)},Y.prototype.setOptimizeNavigation=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setOptimizeNaviation is not applicable to 2D"):this.prefs.set(s.Prefs3D.OPTIMIZE_NAVIGATION,e)},Y.prototype.initializePrefListeners=function(){var e=this;this.prefs.addListeners(s.Prefs3D.ANTIALIASING,(function(t){var n=e.prefs.get(s.Prefs3D.AMBIENT_SHADOWS);e.impl.togglePostProcess(n,t)})),this.prefs.addListeners(s.Prefs3D.AMBIENT_SHADOWS,(function(t){var n=e.prefs.get(s.Prefs3D.ANTIALIASING);e.impl.togglePostProcess(t,n)})),this.prefs.addListeners(s.Prefs3D.GROUND_SHADOW,(function(t){e.impl.toggleGroundShadow(t)})),this.prefs.addListeners(s.Prefs3D.GROUND_REFLECTION,(function(t){e.impl.toggleGroundReflection(t)})),this.prefs.addListeners(s.Prefs3D.ENV_MAP_BACKGROUND,(function(t){e.impl.toggleEnvMapBackground(t)})),this.prefs.addListeners(s.Prefs.PROGRESSIVE_RENDERING,(function(t){e.impl.toggleProgressive(t)})),this.prefs.addListeners(s.Prefs2D.GRAYSCALE,(function(t){e.impl.toggleGrayscale(t)})),this.prefs.addListeners(s.Prefs2D.SWAP_BLACK_AND_WHITE,(function(t){e.impl.toggleSwapBlackAndWhite(t)})),this.prefs.addListeners(s.Prefs3D.OPTIMIZE_NAVIGATION,(function(t){e.impl.setOptimizeNavigation(t)})),this.prefs.addListeners(s.Prefs3D.GHOSTING,(function(t){e.impl.toggleGhosting(t)})),this.prefs.addListeners(s.Prefs3D.LINE_RENDERING,(function(t){e.impl.hideLines(!t)})),this.prefs.addListeners(s.Prefs.POINT_RENDERING,(function(t){e.impl.hidePoints(!t)})),this.prefs.addListeners(s.Prefs3D.EDGE_RENDERING,(function(t){e.impl.setDisplayEdges(t)})),this.prefs.addListeners(s.Prefs3D.LIGHT_PRESET,(function(t){if("string"==typeof t){for(var n=t,i=-1,r=0;r<H.LightPresets.length;r++)if(H.LightPresets[r].name===n){i=r;break}if(!(i>=0))return void o.logger.warn("Invalid Prefs3D.LIGHT_PRESET: "+t);t=i}e.impl.setLightPreset(t)})),this.prefs.addListeners(s.Prefs3D.ALWAYS_USE_PIVOT,(function(t){e.navigation.setUsePivotAlways(t)})),this.prefs.addListeners(s.Prefs.REVERSE_MOUSE_ZOOM_DIR,(function(t){e.navigation.setReverseZoomDirection(t)})),this.prefs.addListeners(s.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,(function(t){e.navigation.setReverseHorizontalLookDirection(t)})),this.prefs.addListeners(s.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,(function(t){e.navigation.setReverseVerticalLookDirection(t)})),this.prefs.addListeners(s.Prefs3D.ZOOM_TOWARDS_PIVOT,(function(t){e.navigation.setZoomTowardsPivot(t)})),this.prefs.addListeners(s.Prefs3D.ORBIT_PAST_WORLD_POLES,(function(t){e.navigation.setOrbitPastWorldPoles(t)})),this.prefs.addListeners(s.Prefs.LEFT_HANDED_MOUSE_SETUP,(function(t){e.navigation.setUseLeftHandedInput(t),f.EventUtils.setUseLeftHandedInput(t)})),this.prefs.addListeners(s.Prefs.WHEEL_SETS_PIVOT,(function(t){e.navigation.setWheelSetsPivot(t)})),this.prefs.addListeners(s.Prefs3D.SELECTION_MODE,(function(t){e.impl.selector.setSelectionMode(t)})),this.prefs.addListeners(s.Prefs.BACKGROUND_COLOR_PRESET,(function(t){if(t)try{var n=JSON.parse(t);e.impl.setClearColors(n[0],n[1],n[2],n[3],n[4],n[5])}catch(e){o.logger.warn("Invalid Prefs.BACKGROUND_COLOR_PRESET: "+n)}}))},Y.prototype.setNavigationLock=function(e){this.navigation.getIsLocked()!==e&&(this.navigation.setIsLocked(e),this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()}))},Y.prototype.getNavigationLock=function(){return this.navigation.getIsLocked()},Y.prototype.setNavigationLockSettings=function(e){this.navigation.setLockSettings(e),this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this.getActiveNavigationTool()})},Y.prototype.getNavigationLockSettings=function(){return this.navigation.getLockSettings()},Y.prototype.setActiveNavigationTool=function(e){if(e===this._pushedTool||!e&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this.impl.controls.setToolActiveName(this.getDefaultNavigationToolName()),this._pushedTool=null}return(!e||e===this.getDefaultNavigationToolName())&&null===this._pushedTool?(this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),!0):!!this.impl.controls.activateTool(e)&&(this._pushedTool=e,this.dispatchEvent({type:A.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0)},Y.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool},Y.prototype.setDefaultNavigationTool=function(e){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool);var t=this._pushedTool;this._pushedTool=null,t&&this.impl.controls.deactivateTool(t),this.impl.controls.activateTool(e),this._defaultNavigationTool=e,t&&(this.impl.controls.activateTool(t),this._pushedTool=t)},Y.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool},Y.prototype.getFOV=function(){return this.navigation.getVerticalFov()},Y.prototype.setFOV=function(e){this.navigation.setVerticalFov(e,!0)},Y.prototype.getFocalLength=function(){return this.navigation.getFocalLength()},Y.prototype.setFocalLength=function(e){this.navigation.setFocalLength(e,!0)},Y.prototype.hideLines=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.hideLines is not applicable to 2D"):this.prefs.set(s.Prefs3D.LINE_RENDERING,!e)},Y.prototype.hidePoints=function(e){this.prefs.set(s.Prefs.POINT_RENDERING,!e)},Y.prototype.setDisplayEdges=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setDisplayEdges is not applicable to 2D"):this.prefs.set(s.Prefs3D.EDGE_RENDERING,e)},Y.prototype.applyCamera=function(e,t){this.impl.setViewFromCamera(e,!0),t&&this.fitToView()},Y.prototype.fitToView=function(e,t,n){var i=[];e&&(e.length>0&&e[0].model?i=e:e.length>0&&i.push({model:t||this.model,selection:e})),this.impl.fitToView(i,n)},Y.prototype.setClickConfig=function(e,t,n){var i=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in i){var r=i[e];if(t in r)return r[t]=n,!0}return!1},Y.prototype.getClickConfig=function(e,t){var n=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();if(e in n){var i=n[e];if(t in i)return i[t]}return null},Y.prototype.setClickToSetCOI=function(e,t){!1!==t&&this.prefs.set(s.Prefs3D.CLICK_TO_SET_COI,e);var n=this.getClickConfig("click","onObject");e?-1===n.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):n.indexOf("setCOI")>=0&&this.setClickConfig("click","onObject",["selectOnly"])},Y.prototype.setProfile=function(e){var t=this;if(!e)return!1;this.profile=e,this.profile.apply(this.prefs);var n=this.profile.extensions&&this.profile.extensions.unload||[],i=this.profile.extensions&&this.profile.extensions.load||[];n.forEach((function(e){t.isExtensionLoaded(e)&&t.unloadExtension(e)})),i.forEach((function(e){t.isExtensionLoaded(e)||t.loadExtension(e,t.config)})),this.dispatchEvent({type:Autodesk.Viewing.PROFILE_CHANGE_EVENT,profile:e})},Y.prototype.initSettings=function(e){if(!this.profile){var t=new a.Profile(e);this.setProfile(t)}},Y.prototype.setLightPreset=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setLightPreset is not applicable to 2D"):this.prefs.set(s.Prefs3D.LIGHT_PRESET,e)},Y.prototype.setUsePivotAlways=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setUsePivotAlways is not applicable to 2D"):this.prefs.set(s.Prefs3D.ALWAYS_USE_PIVOT,e)},Y.prototype.setReverseZoomDirection=function(e){this.prefs.set(s.Prefs.REVERSE_MOUSE_ZOOM_DIR,e)},Y.prototype.setReverseHorizontalLookDirection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):this.prefs.set(s.Prefs3D.REVERSE_HORIZONTAL_LOOK_DIRECTION,e)},Y.prototype.setReverseVerticalLookDirection=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):this.prefs.set(s.Prefs3D.REVERSE_VERTICAL_LOOK_DIRECTION,e)},Y.prototype.setZoomTowardsPivot=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setZoomTowardsPivot is not applicable to 2D"):this.prefs.set(s.Prefs3D.ZOOM_TOWARDS_PIVOT,e)},Y.prototype.setOrbitPastWorldPoles=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):this.prefs.set(s.Prefs3D.ORBIT_PAST_WORLD_POLES,e)},Y.prototype.setUseLeftHandedInput=function(e){this.prefs.set(s.Prefs.LEFT_HANDED_MOUSE_SETUP,e)},Y.prototype.setLayerVisible=function(e,t,n){var i=this.impl.layers;null===e?t?i.showAllLayers():i.hideAllLayers():(Array.isArray(e)||(e=[e]),n&&i.hideAllLayers(),this.impl.setLayerVisible(e,t)),this.dispatchEvent({type:A.LAYER_VISIBILITY_CHANGED_EVENT})},Y.prototype.isLayerVisible=function(e){return!!(e&&e.isLayer&&this.impl.isLayerVisible(e))},Y.prototype.anyLayerHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,n=t?t.length:0,i=0;i<n;++i)if(!this.impl.layers.isLayerVisible(t[i]))return!0;return!1},Y.prototype.allLayersHidden=function(){for(var e=this.impl.getLayersRoot(),t=e&&e.children,n=t?t.length:0,i=0;i<n;++i)if(this.impl.layers.isLayerVisible(t[i]))return!1;return!0},Y.prototype.setGroundShadowColor=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadowColor is not applicable to 2D"):this.impl.setGroundShadowColor(e)},Y.prototype.setGroundShadowAlpha=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundShadowAlpha is not applicable to 2D"):this.impl.setGroundShadowAlpha(e)},Y.prototype.setGroundReflectionColor=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflectionColor is not applicable to 2D"):this.impl.setGroundReflectionColor(e)},Y.prototype.setGroundReflectionAlpha=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.setGroundReflectionAlpha is not applicable to 2D"):this.impl.setGroundReflectionAlpha(e)},Y.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(o.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()},Y.prototype.setCutPlanes=function(e){this.model&&this.model.is2d()?o.logger.warn("Viewer3D.getCutPlanes is not applicable to 2D"):this.impl.setCutPlaneSet("__set_view",e)},Y.prototype.getScreenShot=function(e,t,n,i){return B.ScreenShot.getScreenShotLegacy(this,e,t,n,i)},Y.prototype.setContextMenu=function(e){this.contextMenu&&this.contextMenu.hide(),this.contextMenu=e||null},Y.prototype.setDefaultContextMenu=function(){var e=Autodesk.Viewing.Extensions;return!(!e||!e.ViewerObjectContextMenu)&&(this.setContextMenu(new e.ViewerObjectContextMenu(this)),!0)},Y.prototype.triggerContextMenu=function(e){return this.config&&this.config.onTriggerContextMenuCallback&&this.config.onTriggerContextMenuCallback(e),!!this.contextMenu&&(this.contextMenu.show(e),!0)},Y.prototype.triggerSelectionChanged=function(e){this.config&&this.config.onTriggerSelectionChangedCallback&&this.config.onTriggerSelectionChangedCallback(e)},Y.prototype.triggerDoubleTapCallback=function(e){this.config&&this.config.onTriggerDoubleTapCallback&&this.config.onTriggerDoubleTapCallback(e)},Y.prototype.triggerSingleTapCallback=function(e){this.config&&this.config.onTriggerSingleTapCallback&&this.config.onTriggerSingleTapCallback(e)},Y.prototype.triggerSwipeCallback=function(e){this.config&&this.config.onTriggerSwipeCallback&&this.config.onTriggerSwipeCallback(e)},Y.prototype.initContextMenu=function(){(!this.config||!this.config.hasOwnProperty("disableBrowserContextMenu")||this.config.disableBrowserContextMenu)&&(this.onDefaultContextMenu=function(e){e.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1));var e=this,t=this.canvas||this.container;this.onMouseDown=function(t){f.EventUtils.isRightClick(t)&&(e.startX=t.clientX,e.startY=t.clientY)},t.addEventListener("mousedown",this.onMouseDown),this.onMouseUp=function(t){return f.EventUtils.isRightClick(t)&&t.clientX===e.startX&&t.clientY===e.startY&&e.triggerContextMenu(t),!0},t.addEventListener("mouseup",this.onMouseUp,!1)},Y.prototype.registerContextMenuCallback=function(e,t){this.contextMenuCallbacks[e]=t},Y.prototype.unregisterContextMenuCallback=function(e){return e in this.contextMenuCallbacks&&(delete this.contextMenuCallbacks[e],!0)},Y.prototype.runContextMenuCallbacks=function(e,t){for(var n in this.contextMenuCallbacks)this.contextMenuCallbacks.hasOwnProperty(n)&&this.contextMenuCallbacks[n](e,t)},Y.prototype.joinLiveReview=function(e){var t=this;this.liveReviewClient||(this.liveReviewClient=new C.LiveReviewClient(this)),T.theResourceLoader.loadScript("socket.io-1.3.5.js","lmv_io").then((function(){t.liveReviewClient.joinLiveReviewSession(e)}))},Y.prototype.leaveLiveReview=function(){this.liveReviewClient&&this.liveReviewClient.leaveLiveReviewSession()},Y.prototype.setModelUnits=function(e){this.model&&(this.model.getData().overriddenUnits=e)},Y.prototype.worldToClient=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.impl.camera;return this.impl.worldToClient(e,t)},Y.prototype.clientToWorld=function(e,t,n){return this.impl.clientToWorld(e,t,n)},Y.prototype.modelHasTopology=function(){return!(!this.model||!this.model.hasTopology())},Y.prototype.setSelectionColor=function(e,t){this.impl.setSelectionColor(e,t)},Y.prototype.set2dSelectionColor=function(e,t){this.impl.set2dSelectionColor(e,t)},Y.prototype.setTheme=function(e){for(var t=this.container.classList,n=0;n<t.length;++n){-1!==t[n].indexOf("-theme")&&t.remove(t[n--])}t.add(e)},Y.prototype.setThemingColor=function(e,t,n,i){(n=n||this.model).setThemingColor(e,t,i),this.impl.invalidate(!0)},Y.prototype.clearThemingColors=function(e){(e=e||this.model).clearThemingColors(),this.impl.invalidate(!0)},Y.prototype.transferModel=function(e,t){var n=this.impl.findModel(e);if(n){var i=[];this.getAggregateSelection((function(t,n){t.id==e&&i.push(n)}));var r=this.impl.visibilityManager.getIsolatedNodes(n),o=this.impl.visibilityManager.getHiddenNodes(n),a=this.impl.matman().exportModelMaterials(n),s=n.loader;n.loader=null,this.impl.unloadModel(n),n.loader=s,n.isAEC()&&n.is3d()&&t.impl.setLightPresetForAec(),t.impl.setRenderingPrefsFor2D(n.is2d()),t.impl.addModel(n),t.impl.matman().importModelMaterials(a,e),t._loadingSpinner.hide(),n.loader&&n.loader.viewer3DImpl===this.impl&&(n.loader.viewer3DImpl=t.impl),n.getData().loadDone&&t.impl.onLoadComplete(n),t.impl.selector.setSelection(i,n),0!=r.length?t.impl.visibilityManager.isolate(r,n):0!=o.length&&t.impl.visibilityManager.hide(o,n)}},Y.prototype.hideModel=function(e){var t=this.impl.modelQueue();return!!(e="number"==typeof e?t.findModel(e):e)&&(this.impl.removeModel(e),t.addHiddenModel(e),!0)},Y.prototype.showModel=function(e,t){var n=this.impl.modelQueue();return!!(e="number"==typeof e?n.findHiddenModel(e):e)&&(n.removeHiddenModel(e),this.impl.addModel(e,t),!0)},Y.prototype.getVisibleModels=function(){return this.impl.modelQueue().getModels().slice()},Y.prototype.getHiddenModels=function(){return this.impl.modelQueue().getHiddenModels().slice()},Y.prototype.restoreDefaultSettings=function(){var e=this.model,t=e.is2d()?"2d":"3d";this.prefs.reset(t),this.impl.setupLighting(e),e.isAEC()&&e.is3d()&&this.impl.setLightPresetForAec(),this.impl.setRenderingPrefsFor2D(!e.is3d()),this.fireEvent({type:A.RESTORE_DEFAULT_SETTINGS_EVENT})},Y.prototype.disableHighlight=function(e){this.impl.disableHighlight(e)},Y.prototype.disableSelection=function(e){e&&this.clearSelection(),this.impl.disableSelection(e)},Y.prototype.isHighlightDisabled=function(){return this.impl.selector.highlightDisabled},Y.prototype.isHighlightPaused=function(){return this.impl.selector.highlightPaused},Y.prototype.isHighlightActive=function(){return!(this.impl.selector.highlightDisabled||this.impl.selector.highlightPaused)},Y.prototype.isSelectionDisabled=function(){return this.impl.selector.selectionDisabled},Y.prototype.activateExtension=function(e,t){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].activate(t):(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},Y.prototype.deactivateExtension=function(e){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].deactivate():(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},Y.prototype.isExtensionActive=function(e,t){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].isActive(t):(o.logger.warn("Extension is not loaded or doesn't exist"),!1)},Y.prototype.isExtensionLoaded=function(e){return this.loadedExtensions&&e in this.loadedExtensions},Y.prototype.getLoadedExtensions=function(){return this.loadedExtensions||[]},Y.prototype.getExtensionModes=function(e){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e].getModes():(console.warn("Extension is not loaded or doesn't exist"),[])},Y.prototype.reorderElements=function(e){var t=e.getAttribute("layer-order-id"),n=this.containerLayerOrder.indexOf(t),i=null;if(-1!==n)for(var r=n+1;r<this.containerLayerOrder.length&&!i;r++)i=this.container.querySelector('[layer-order-id="'+this.containerLayerOrder[r]+'"]');i?this.container.insertBefore(e,i):this.container.appendChild(e)},Y.prototype.appendOrderedElementToViewer=function(e){var t=this.container.querySelector('[layer-order-id="'+e+'"]');if(t)return t;var n=this.getDocument().createElement("div");return n.setAttribute("layer-order-id",e),this.reorderElements(n),n},Y.prototype.hitTest=function(e,t,n){return this.impl.hitTest(e,t,n)},Y.prototype.refresh=function(e){this.impl.invalidate(e,!1,!e)},Y.prototype.chooseProfile=function(e){var t=this.profileManager.PROFILE_DEFAULT;return this.config&&this.config.profileSettings?t=new a.Profile(this.config.profileSettings):e&&e.useFileProfile?t=this.profileManager.getProfileOrDefault(e.fileExt):e.isAEC&&(t=this.profileManager.PROFILE_AEC),t}},function(e,t,n){var i=n(73);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){var i=n(143),r=n(99),o=n(63),a=n(94),s=n(61),l=n(258),c=Object.getOwnPropertyDescriptor;t.f=n(38)?c:function(e,t){if(e=o(e),t=a(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return r(!i.f.call(e,t),e[t])}},function(e,t,n){var i=n(5),r=n(34),o=n(21);e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],a={};a[e]=t(n),i(i.S+i.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){var i=n(72),r=n(142),o=n(53),a=n(31),s=n(274);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,h=6==e,d=5==e||h,f=t||s;return function(t,s,p){for(var m,g,v=o(t),y=r(v),_=i(s,p,3),b=a(y.length),x=0,w=n?f(t,b):l?f(t,0):void 0;b>x;x++)if((d||x in y)&&(g=_(m=y[x],x,v),e))if(n)w[x]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return x;case 2:w.push(m)}else if(u)return!1;return h?-1:c||u?u:w}}},function(e,t,n){"use strict";n.r(t),n.d(t,"token",(function(){return p})),n.d(t,"getWebGLHelpLink",(function(){return g})),n.d(t,"EnvironmentConfigurations",(function(){return E})),n.d(t,"initializeEnvironmentVariable",(function(){return M})),n.d(t,"initializeResourceRoot",(function(){return T})),n.d(t,"initializeServiceEndPoints",(function(){return S})),n.d(t,"refreshCookie",(function(){return C})),n.d(t,"refreshRequestHeader",(function(){return P})),n.d(t,"refreshToken",(function(){return L})),n.d(t,"initializeAuth",(function(){return D})),n.d(t,"initializeLogger",(function(){return R})),n.d(t,"Initializer",(function(){return O})),n.d(t,"shutdown",(function(){return N}));var i=n(13),r=n(109),o=n(1),a=n(6),s=n(2),l=n(40),c=n(14),u=n(110),h=(n(50),Object(s.getGlobal)()),d=h,f={accessToken:null,getAccessToken:null,tokenRefreshInterval:null},p=f,m=null;function g(){return m}var v={local:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},y={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},_="https://us.otgs-dev.autodesk.com",b="https://us.otgs-stg.autodesk.com",x="https://us.otgs.autodesk.com",w="https://eu.otgs-stg.autodesk.com",A="https://eu.otgs.autodesk.com",E={Local:{ROOT:"",LMV:v.local},Development:{ROOT:y.dev,LMV:v.dev,bubbleManifest:!0},Staging:{ROOT:y.stg,LMV:v.stg,bubbleManifest:!0},Production:{ROOT:y.prod,LMV:v.prod,bubbleManifest:!0},AutodeskDevelopment:{ROOT:y.dev,LMV:v.dev},AutodeskStaging:{ROOT:y.stg,LMV:v.stg},AutodeskProduction:{ROOT:y.prod,LMV:v.prod},FluentDev:{ROOT:_,LMV:v.dev},FluentStaging:{ROOT:b,LMV:v.stg},FluentProduction:{ROOT:x,LMV:v.prod},FluentStagingEU:{ROOT:w,LMV:v.stg},FluentProductionEU:{ROOT:A,LMV:v.prod}};function M(e){var t;if(e&&e.env&&(t=e.env),t||(t=Object(i.getParameterByName)("env")),Object(a.setOfflineResourcePrefix)(e&&e.offlineResourcePrefix||""),Object(a.setOffline)(e&&"true"===e.offline),!t)switch(d.location.hostname){case"developer-dev.api.autodesk.com":t="AutodeskDevelopment";break;case"developer-stg.api.autodesk.com":t="AutodeskStaging";break;case"developer.api.autodesk.com":t="AutodeskProduction";break;case"localhost.autodesk.com":case"":case"127.0.0.1":t="Local";break;default:t="AutodeskProduction"}Object(a.setEnv)(t),"undefined"!=typeof window&&o.logger.info("Host name : "+window.location.hostname),o.logger.info("Environment initialized as : "+t)}function T(e){var t,n,r=["viewer3D.js","viewer3D.min.js","viewerCE.js","viewerCE.min.js"];e&&e.hasOwnProperty("libraryName")&&r.push(e.libraryName);for(var o=!1,a=0;a<r.length;a++){var s=Object(i.getScript)(r[a]),l=(n=s?s.src:"").indexOf(r[a]);if(l>=0){t=n.substr(0,l),(n.indexOf("&v=",l)>0||n.indexOf("?v=",l)>0)&&(o=!0);break}}if(h.LMV_RESOURCE_ROOT=t||h.LMV_RESOURCE_ROOT,o){var c=!1,u=["dev","stg","prod"];for(a=0;a<u.length;++a){var d=y[u[a]];if(-1!==h.LMV_RESOURCE_ROOT.indexOf(d)){c=!0;break}}c&&(h.LMV_RESOURCE_ROOT+=h.LMV_VIEWER_VERSION+"/")}}function S(e){var t=e.endpoint;t||(t=E[Object(a.getEnv)()].ROOT);var n=e.api||t.ENDPOINT_API_DERIVATIVE_SERVICE_V2;if(a.endpoint.setEndpointAndApi(t,n),!Object(s.isNodeJS)())return T(e),Promise.resolve()}function C(e,t,n){t=t||function(){},c.ViewingService.rawGet(a.endpoint.getApiEndpoint(),null,"/auth/settoken",t,n,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0,postData:"access-token="+e})}function P(e){a.endpoint.HTTP_REQUEST_HEADERS.Authorization="Bearer "+e}function L(e,t,n){if(f.accessToken=e,a.endpoint.getUseCookie()){C(e,t,(function(t){o.logger.warn("Failed to set token in cookie. Will use header instead."),a.endpoint.setUseCookie(!1),P(e),n&&n(t)}))}else P(e),t&&t()}function D(e,t){var n,r=t?t.shouldInitializeAuth:void 0;void 0===r&&(r="false"!==Object(i.getParameterByName)("auth").toLowerCase());if("Local"==Object(a.getEnv)()||!r)return setTimeout(e,0),void a.endpoint.setUseCredentials(void 0!==t.useCredentials&&t.useCredentials);a.endpoint.setUseCredentials(void 0===t.useCredentials||t.useCredentials),a.endpoint.setUseCookie(t.useCookie),f.tokenRefreshInterval&&(clearTimeout(f.tokenRefreshInterval),f.tokenRefreshInterval=null),t&&t.getAccessToken?(f.getAccessToken=t.getAccessToken,"string"==typeof(n=t.getAccessToken((function i(r,o){n=r,!f.tokenRefreshInterval?L(n,e,e):L(n),"number"!=typeof o&&(o=3599);var a=o-5;a<=0&&(a=o),f.tokenRefreshInterval=setTimeout((function(){t.getAccessToken(i)}),1e3*a)})))&&n&&L(n,e)):t&&t.accessToken?L(n=t.accessToken,e):((n=Object(i.getParameterByName)("accessToken"))||o.logger.error("No access token is provided, but authorization requested. This is a problem."),L(n,e))}function R(e){o.logger.initialize(e);var t=Object(i.getParameterByName)("logLevel");t&&o.logger.setLevel(parseInt(t))}function I(e){e&&"Local"===e.env||a.endpoint.getCdnRedirectUrl()&&c.ViewingService.rawGet(a.endpoint.getCdnRedirectUrl(),null,null,(function(e){e&&e.length&&(a.endpoint.setCdnUrl(e),o.logger.info("CDN_ROOT is: "+e))}),(function(){}),{withCredentials:!1,responseType:"text"})}function O(e,t){if(Object(s.isNodeJS)())return M(e),S(e),R(e),I(e),void D(t,e);e.webGLHelpLink&&(m=e.webGLHelpLink),r.theResourceLoader.loadPromiseLibrary((function(){M(e);var n=S(e);R(e),I(e),Object(u.initializeLocalization)(e),Object(s.disableDocumentTouchSafari)(),Object(l.initWorkerScript)();var i=function(e){return new Promise((function(t){D(t,e)}))}(e);Promise.all([n,i]).then(t)}))}function N(){o.logger.shutdown(),Autodesk.Viewing.Private.shutdownPropWorker()}},function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(45),o=n(69),a=n(151),s=n(40),l=n(17),c=n(12);function u(e,t,n,i){var o=function(e){for(var t=new Uint16Array(e.length+1),n=0,i=0;i<e.length;i++)t[i]=n,n+=Object(r.getVertexCount)(e[i]);return t[i]=n,t}(e),s=new a.GeomMergeTask;return s.vb=t.vb,s.vbstride=t.vbstride,s.posOffset=t.attributes.position.itemOffset,s.normalOffset=t.attributes.normal?t.attributes.normal.itemOffset:-1,s.matrices=n,s.ranges=o,s.dbIds=i,s}function h(e,t){t.vb=e.vb,t.attributes.id.array=e.vertexIds,t.needsUpdate=!0}function d(e){var t=0,n={},i=[],r=e,o=new Array(2);function a(e){for(var i=e.data,a=0;a<i.length;a++){var s=i[a],l=s.taskId;h(s,n[l]),delete n[l]}if(0===--t)for(r.inProgress=!1,a=0;a<o.length;a++)o[a].clearAllEventListenerWithIntercept(),o[a].terminate(),o[a]=null}this.addMergeTask=function(e,t,r,o){var a=u(e,t,r,o);i.push(a),n[a.id]=t},this.runTasks=function(){for(var e=0;e<2;e++)o[e]=d.createWorker(),o[e].addEventListenerWithIntercept(a);for(var n=i.length,s=Math.floor(n/2),l=0;l<2;l++){var c=l*s,u=1===l?n:c+s,h=[],f=new Array(4*(u-c)),p=0;for(e=c;e<u;e++){var m=i[e];f[p++]=m.vb.buffer,f[p++]=m.matrices.buffer,f[p++]=m.ranges.buffer,f[p++]=m.dbIds.buffer,h.push(m)}var g={operation:"MERGE_GEOMETRY",tasks:h};o[l].doOperation(g,f),t++}r.inProgress=!0}}d.createWorker=s.createWorkerWithIntercept;var f=n(1),p=n(116),m=n(8),g=n(19);n.d(t,"isVisible",(function(){return P})),n.d(t,"copyVertexFormat",(function(){return D})),n.d(t,"copyPrimitiveProps",(function(){return R})),n.d(t,"mergeGeometries",(function(){return I})),n.d(t,"Consolidation",(function(){return N})),n.d(t,"ConsolidationBuilder",(function(){return k}));var v={UNKNOWN:0,TRIANGLES:1,LINES:2,WIDE_LINES:3,POINTS:4};function y(e){return e.isLines?v.LINES:e.isPoints?v.POINTS:e.isWideLines?v.WIDE_LINES:v.TRIANGLES}function _(e,t){switch(!0===e.isLines&&(e.isLines=void 0),!0===e.isWideLines&&(e.isWideLines=void 0),!0===e.isPoints&&(e.isPoints=void 0),t){case v.LINES:e.isLines=!0;break;case v.WIDE_LINES:e.isWideLines=!0;break;case v.POINTS:e.isPoints=!0}}var b=m.MeshFlags.MESH_HIGHLIGHTED,x=m.MeshFlags.MESH_VISIBLE|m.MeshFlags.MESH_HIDE|b,w=m.MeshFlags.MESH_VISIBLE,A=m.MeshFlags.MESH_VISIBLE|m.MeshFlags.MESH_HIDE,E=0,M=m.MeshFlags.MESH_HIGHLIGHTED|m.MeshFlags.MESH_HIDE,T=m.MeshFlags.MESH_HIGHLIGHTED,S=g.RenderFlags.RENDER_HIDDEN,C=g.RenderFlags.RENDER_HIGHLIGHTED;function P(e,t){switch(t){case S:return(e&A)===E;case C:return(e&M)===T}return(e&x)==w}function L(e){this.geoms=[],this.matrices=[],this.vertexCount=0,this.material=e,this.fragIds=[],this.worldBox=new i.Box3}function D(e,t){for(var n in e.vb&&e.vbstride||f.logger.warn("copyVertexFormat() supports only interleaved buffers"),e.attributes)t.attributes[n]=e.attributes[n];t.attributesKeys=e.attributesKeys.slice(0),t.vbstride=e.vbstride}function R(e,t){_(t,y(e)),t.lineWidth=e.lineWidth,t.pointSize=e.pointSize}function I(e,t,n,a,s){var d=function(e){for(var t=e[0].vbstride,n=0,a=0,s=0,l=0;l<e.length;l++){var c=e[l];n+=e[l].ib.length,a+=Object(r.getVertexCount)(c),e[l].iblines&&(s+=e[l].iblines.length)}var u=Object(o.createBufferGeometry)();u.vb=new Float32Array(a*t),u.ib=new Uint16Array(n),s&&(u.iblines=new Uint16Array(s)),u.byteSize=u.vb.byteLength+u.ib.byteLength,u.iblines&&(u.byteSize+=u.iblines.byteLength),R(e[0],u),D(e[0],u);var h=new i.BufferAttribute(null,3);h.normalize=!0,h.bytesPerItem=1,u.addAttribute("id",h);var d=e[0];return _(u,y(d)),d.isPoints&&(u=d.pointSize),d.isWideLines&&(u=d.lineWidth),u}(e);return d.boundingBox=a.clone(),function(e,t){for(var n=0,i=0,o=0,a=0,s=0;s<e.length;s++){for(var l=e[s],c=Object(r.getVertexCount)(l),u=0;u<l.ib.length;u++)t.ib[o+u]=l.ib[u]+i;if(l.iblines){for(u=0;u<l.iblines.length;u++)t.iblines[a+u]=l.iblines[u]+i;a+=l.iblines.length}t.vb.set(l.vb,n),n+=l.vb.length,i+=c,o+=l.ib.length}}(e,d),s?s.addMergeTask(e,d,t,n):function(e,t,n,i){var r=u(e,t,n,i),o=new c.LmvVector3,a=new l.LmvMatrix4;h(r.run(a,o),t)}(e,d,t,n),d}function O(e,t){if(e.vbstride!=t.vbstride)return!1;if(y(e)!==y(t))return!1;if(e.isPoints&&e.pointSize!==t.pointSize)return!1;if(e.isWideLines&&e.lineWidth!==t.lineWidth)return!1;if(e.attributesKeys.length!=t.attributesKeys.length)return!1;for(var n=0,i=e.attributesKeys.length;n<i;n++){var r=e.attributesKeys[n],o=e.attributes[r],a=t.attributes[r];if(!a)return!1;if(o!==a&&(o.itemOffset!==a.itemOffset||o.normalize!==a.normalize||o.itemSize!==a.itemSize||o.bytesPerItem!==a.bytesPerItem||o.isPattern!==a.isPattern))return!1}return!0}function N(e){this.meshes=[],this.fragId2MeshIndex=new Int32Array(e);for(var t=0;t<this.fragId2MeshIndex.length;t++)this.fragId2MeshIndex[t]=-1;this.byteSize=0,this.consolidationMap=null}function k(){this.buckets={},this.bucketCount=0,this.costs=0}function F(e,t){this.fragOrder=new Uint32Array(e),this.ranges=new Uint32Array(t),this.boxes=new Array(t),this.numConsolidated=-1}L.prototype={constructor:L,addGeom:function(e,t,n){this.geoms.push(e),this.fragIds.push(n),this.worldBox.union(t),this.vertexCount+=Object(r.getVertexCount)(e);var i=this.geoms.length;return 1==i?0:(void 0===e.byteSize&&f.logger.warn("Error in consolidation: Geometry must contain byteSize."),e.byteSize+(2==i?this.geoms[0].byteSize:0))}},N.prototype={constructor:N,addContainerMesh:function(e,t,n,r,o){var a=new i.Mesh(e,t);this.meshes.push(a),this.byteSize+=e.byteSize;var s=r||0,l=s+(o||n.length);a.frustumCulled=!1;for(var c=this.meshes.length-1,u=s;u<l;u++){var h=n[u];this.fragId2MeshIndex[h]=c}},addSingleMesh:function(e,t,n,r,o){var a=new i.Mesh(e,t);a.matrix.copy(r),a.matrixAutoUpdate=!1,a.dbId=o,a.fragId=n,this.meshes.push(a),a.frustumCulled=!1,this.fragId2MeshIndex[n]=this.meshes.length-1},addSingleFragment:function(e,t){var n=e.getVizmesh(t);this.addSingleMesh(n.geometry,n.material,t,n.matrixWorld,n.dbId)},applyAttributes:function(e,t,n,i){var r,o,a=this.meshes[e],s=a.geometry,l=t.vizflags,c=this.consolidationMap,u=c.fragOrder,h=s.numInstances,d=t.db2ThemingColor,f=d.length>0||void 0;if(h?o=(r=a.rangeStart)+a.geometry.numInstances:s.attributes.id?(r=c.ranges[e],o=e+1>=c.ranges.length?c.numConsolidated:c.ranges[e+1]):A=a.fragId,!i||void 0!==A)return s.offsets&&void 0===A&&(s.offsets=s.drawcalls=void 0),a.visible=P(l[void 0===A?u[r]:A],n),a.themingColor=f&&d[t.fragments.fragId2dbId[A]],a;var p,m,g=0,v=0,y=0,_=0,b=0;function x(){if(p){s.drawcalls=s.offsets=s.offsets||[];var e=s.offsets[b]||{index:0};s.offsets[b++]=e,h?(e.start=0,e.count=s.ib.length,s.iblines&&(e.edgeStart=0,e.edgeCount=s.iblines.length),e.instanceStart=g,e.numInstances=v-g):(e.start=g,e.count=v-g,s.iblines&&(e.edgeStart=y,e.edgeCount=_-y)),e.themingColor=m}}for(var w=r;w<o;++w){var A,E=P(l[A=u[w]],n),M=f&&t.db2ThemingColor[t.fragments.fragId2dbId[A]];if((E!==p||E&&M!==m)&&(v>g&&x(),g=v,y=_,p=E,m=M),h)v+=1;else{var T=t.getGeometry(A);v+=T.ib.length,T.iblines&&(_+=T.iblines.length)}}return 0===g?(a.themingColor=m,a.visible=p):(a.visible=!0,x()),s.offsets&&(s.offsets.length=b),a}},k.prototype={addGeom:function(e,t,n,i){var o=null,a=this.buckets[t.id];if(a)for(var s=0;s<a.length;s++){var l=a[s];if(O(l.geoms[0],e))if(!(Object(r.getVertexCount)(e)+l.vertexCount>65535)){o=l;break}}o||(o=new L(t),this.bucketCount++,this.buckets[t.id]?this.buckets[t.id].push(o):this.buckets[t.id]=[o]),this.costs+=o.addGeom(e,n,i)},createConsolidationMap:function(e,t){var n=new F(e.length,this.bucketCount),i=0,r=0;for(var o in this.buckets)for(var a=this.buckets[o],s=0;s<a.length;s++){var l=a[s];n.ranges[r]=i,n.boxes[r]=l.worldBox,n.fragOrder.set(l.fragIds,i),i+=l.fragIds.length,r++}n.numConsolidated=t;for(var c=t;c<e.length;c++)n.fragOrder[c]=e[c];return n}},F.prototype={buildConsolidation:function(e,t,n){var r=this.fragOrder,o=e.getCount(),a=this.ranges.length,s=new N(o),l=null;d.createWorker&&(l=new d(s));for(var c=[],u=new i.Matrix4,h=0;h<a;h++){var f=this.ranges[h],m=(h===a-1?this.numConsolidated:this.ranges[h+1])-f;if(1!==m){c.length=m;for(var g=new Float32Array(16*m),v=new Uint32Array(m),y=0;y<m;y++)E=r[f+y],c[y]=e.getGeometry(E),e.getOriginalWorldMatrix(E,u),g.set(u.elements,16*y),v[y]=e.getDbIds(E);var _=this.boxes[h],b=r[f],x=e.getMaterial(b),w=I(c,g,v,_,l),A=t.getMaterialVariant(x,p.MATERIAL_VARIANT.VERTEX_IDS,n);s.addContainerMesh(w,A,r,f,m)}else{var E=r[f];s.addSingleFragment(e,E,s)}}return l&&l.runTasks(),s.consolidationMap=this,s}},N.applyBVHDefaults=function(e){e.frags_per_leaf_node=512,e.max_polys_per_node=1e5},N.getDefaultBVHOptions=function(){var e={};return N.applyBVHDefaults(e),e}},function(e,t,n){"use strict";function i(e,t,n){var i,r,o,a,s,l;for(i="",o=n,r=0;r<o;)switch((a=e[t+r++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(a);break;case 12:case 13:s=e[t+r++],i+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=e[t+r++],l=e[t+r++],i+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&l)<<0)}return i}function r(e,t,n){var i,r,o,a=n||0;if(r=e.length,t)for(i=0;i<r;i++)(o=e.charCodeAt(i))>=1&&o<=127?t[a++]=o:o>2047?(t[a++]=224|o>>12&15,t[a++]=128|o>>6&63,t[a++]=128|o>>0&63):(t[a++]=192|o>>6&31,t[a++]=128|o>>0&63);else for(i=0;i<r;i++)(o=e.charCodeAt(i))>=1&&o<=127?a++:a+=o>2047?3:2;return a-(n||0)}n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l}));var o=!0,a=1048576;function s(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=e.length),o)return n>a?function(e,t,n){var i,r,o,a,s,l,c,u;for(i="",s=[],o=n,l=0,r=0;r<o;){switch((a=e[t+r++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:s.push(String.fromCharCode(a));break;case 12:case 13:c=e[t+r++],s.push(String.fromCharCode((31&a)<<6|63&c));break;case 14:c=e[t+r++],u=e[t+r++],s.push(String.fromCharCode((15&a)<<12|(63&c)<<6|(63&u)<<0))}(++l>=32768||r>=o)&&(i+=s.join(""),s.length=0,l=0)}return i}(e,t,n):i(e,t,n);for(var r="",s=t,l=t+n;s<l;s++)r+=String.fromCharCode(e[s]);return decodeURIComponent(escape(r))}function l(e){var t=s(e,0,e.length);return JSON.parse(t)}},function(e,t,n){"use strict";n.r(t),n.d(t,"RadioButtonGroup",(function(){return a}));var i=n(42),r=n(10),o=n(28);function a(e,t){i.ControlGroup.call(this,e,t);var n=this;this._activeButton=null,this._handleButtonStateChange=function(e){var t=r.Button.State;e.state===t.ACTIVE?(n._activeButton=e.target,n.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!0}),n._controls.forEach((function(n){n!==e.target&&n.getState()!==t.DISABLED&&n.setState(t.INACTIVE)}))):e.target===n._activeButton&&(n._activeButton=null,n.dispatchEvent({type:a.Event.ACTIVE_BUTTON_CHANGED,button:e.target,isActiveButton:!1}))}}a.Event={ACTIVE_BUTTON_CHANGED:"RadioButtonGroup.ActiveButtonChanged",VISIBILITY_CHANGED:o.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:o.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:i.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:i.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:i.ControlGroup.Event.SIZE_CHANGED},a.prototype=Object.create(i.ControlGroup.prototype),a.prototype.constructor=a,a.prototype.addControl=function(e,t){return e instanceof r.Button&&(!!i.ControlGroup.prototype.addControl.call(this,e,t)&&(e.addEventListener(r.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0))},a.prototype.removeControl=function(e){var t="string"==typeof e?this.getControl(e):e;return!(null===t||!i.ControlGroup.prototype.removeControl.call(this,t))&&(t.removeEventListener(r.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0)},a.prototype.getActiveButton=function(){return this._activeButton}},function(e,t,n){"use strict";n.r(t),n.d(t,"ScreenMode",(function(){return c})),n.d(t,"ScreenModeDelegate",(function(){return u})),n.d(t,"AppScreenModeDelegate",(function(){return h})),n.d(t,"ApplicationScreenModeDelegate",(function(){return d})),n.d(t,"NullScreenModeDelegate",(function(){return f})),n.d(t,"ScreenModeMixin",(function(){return p}));var i=n(2),r=n(3),o=n(1),a=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"];function s(e,t){for(var n=0;n<a.length;++n)t.addDocumentEventListener(a[n],e,!1)}function l(e,t){for(var n=0;n<a.length;++n)t.removeDocumentEventListener(a[n],e,!1)}var c={kNormal:0,kFullBrowser:1,kFullScreen:2};function u(e){this.viewer=e,this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this),this.getMode()===c.kFullScreen&&s(this.bindFullscreenEventListener,this.viewer.globalManager)}function h(e){u.call(this,e)}u.prototype.uninitialize=function(){l(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer=null},u.prototype.isModeSupported=function(e){return!0},u.prototype.setMode=function(e){var t=this.getMode();return!(e===t||!this.isModeSupported(e))&&(this.doScreenModeChange(t,e),this.onScreenModeChanged(t,e),!0)},u.prototype.getMode=function(){throw"Implement getMode() in derived class"},u.prototype.getNextMode=function(){var e,t=this.getMode(),n=c;return t===n.kNormal&&this.isModeSupported(n.kFullBrowser)?e=n.kFullBrowser:t===n.kNormal&&this.isModeSupported(n.kFullScreen)?e=n.kFullScreen:t===n.kFullBrowser&&this.isModeSupported(n.kFullScreen)?e=n.kFullScreen:t===n.kFullBrowser&&this.isModeSupported(n.kNormal)?e=n.kNormal:t===n.kFullScreen&&this.isModeSupported(n.kNormal)?e=n.kNormal:t===n.kFullScreen&&this.isModeSupported(n.kFullBrowser)&&(e=n.kFullBrowser),e},u.prototype.getEscapeMode=function(){return this.getMode()!==c.kNormal?c.kNormal:void 0},u.prototype.fullscreenEventListener=function(){var e=this.viewer.globalManager.getDocument();Object(i.inFullscreen)(e)?this.viewer.resize():(this.doScreenModeChange(c.kFullScreen,c.kNormal),this.onScreenModeChanged(c.kFullScreen,c.kNormal))},u.prototype.doScreenModeChange=function(e,t){throw"Implement doScreenModeChange() in derived class"},u.prototype.onScreenModeChanged=function(e,t){e===c.kFullScreen?l(this.bindFullscreenEventListener,this.viewer.globalManager):t===c.kFullScreen&&s(this.bindFullscreenEventListener,this.viewer.globalManager),this.viewer.resize(),this.viewer.dispatchEvent({type:r.FULLSCREEN_MODE_EVENT,mode:t})},h.prototype=Object.create(u.prototype),h.prototype.constructor=h,h.prototype.isModeSupported=function(e){return e!==c.kFullBrowser},h.prototype.getMode=function(){var e=this.viewer.globalManager.getDocument();return Object(i.inFullscreen)(e)?c.kFullScreen:c.kNormal},h.prototype.doScreenModeChange=function(e,t){var n=this.viewer.container;if(t===c.kNormal){n.classList.remove("viewer-fill-browser");var r=this.viewer.globalManager.getDocument();Object(i.exitFullscreen)(r)}else t===c.kFullScreen&&(n.classList.add("viewer-fill-browser"),Object(i.launchFullscreen)(n))};var d=h;function f(e){u.call(this,e)}function p(){}f.prototype=Object.create(u.prototype),f.prototype.constructor=u,f.prototype.isModeSupported=function(e){return!1},f.prototype.getMode=function(){return c.kNormal},p.prototype={setScreenModeDelegate:function(e){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.screenModeDelegateClass=e||(null===e?f:h)},getScreenModeDelegate:function(){return this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this)),this.screenModeDelegate},isScreenModeSupported:function(e){return this.getScreenModeDelegate().isModeSupported(e)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(e){var t={category:"screen_mode",value:e};return o.logger.track(t),this.getScreenModeDelegate().setMode(e)},getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var e=this.getScreenModeDelegate().getNextMode();return void 0!==e&&this.setScreenMode(e)},escapeScreenMode:function(){var e=this.getScreenModeDelegate().getEscapeMode();return void 0!==e&&this.setScreenMode(e)},apply:function(e){var t=p.prototype;e.setScreenModeDelegate=t.setScreenModeDelegate,e.getScreenModeDelegate=t.getScreenModeDelegate,e.isScreenModeSupported=t.isScreenModeSupported,e.canChangeScreenMode=t.canChangeScreenMode,e.setScreenMode=t.setScreenMode,e.getScreenMode=t.getScreenMode,e.nextScreenMode=t.nextScreenMode,e.escapeScreenMode=t.escapeScreenMode}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";if(n(38)){var i=n(101),r=n(20),o=n(21),a=n(5),s=n(168),l=n(201),c=n(72),u=n(131),h=n(99),d=n(62),f=n(132),p=n(74),m=n(31),g=n(285),v=n(103),y=n(94),_=n(61),b=n(144),x=n(23),w=n(53),A=n(193),E=n(104),M=n(106),T=n(105).f,S=n(195),C=n(100),P=n(29),L=n(77),D=n(158),R=n(145),I=n(197),O=n(129),N=n(161),k=n(130),F=n(196),V=n(276),B=n(39),U=n(75),z=B.f,G=U.f,H=r.RangeError,W=r.TypeError,j=r.Uint8Array,X=Array.prototype,q=l.ArrayBuffer,Y=l.DataView,K=L(0),Z=L(2),Q=L(3),J=L(4),$=L(5),ee=L(6),te=D(!0),ne=D(!1),ie=I.values,re=I.keys,oe=I.entries,ae=X.lastIndexOf,se=X.reduce,le=X.reduceRight,ce=X.join,ue=X.sort,he=X.slice,de=X.toString,fe=X.toLocaleString,pe=P("iterator"),me=P("toStringTag"),ge=C("typed_constructor"),ve=C("def_constructor"),ye=s.CONSTR,_e=s.TYPED,be=s.VIEW,xe=L(1,(function(e,t){return Te(R(e,e[ve]),t)})),we=o((function(){return 1===new j(new Uint16Array([1]).buffer)[0]})),Ae=!!j&&!!j.prototype.set&&o((function(){new j(1).set({})})),Ee=function(e,t){var n=p(e);if(n<0||n%t)throw H("Wrong offset!");return n},Me=function(e){if(x(e)&&_e in e)return e;throw W(e+" is not a typed array!")},Te=function(e,t){if(!(x(e)&&ge in e))throw W("It is not a typed array constructor!");return new e(t)},Se=function(e,t){return Ce(R(e,e[ve]),t)},Ce=function(e,t){for(var n=0,i=t.length,r=Te(e,i);i>n;)r[n]=t[n++];return r},Pe=function(e,t,n){z(e,t,{get:function(){return this._d[n]}})},Le=function(e){var t,n,i,r,o,a,s=w(e),l=arguments.length,u=l>1?arguments[1]:void 0,h=void 0!==u,d=S(s);if(null!=d&&!A(d)){for(a=d.call(s),i=[],t=0;!(o=a.next()).done;t++)i.push(o.value);s=i}for(h&&l>2&&(u=c(u,arguments[2],2)),t=0,n=m(s.length),r=Te(this,n);n>t;t++)r[t]=h?u(s[t],t):s[t];return r},De=function(){for(var e=0,t=arguments.length,n=Te(this,t);t>e;)n[e]=arguments[e++];return n},Re=!!j&&o((function(){fe.call(new j(1))})),Ie=function(){return fe.apply(Re?he.call(Me(this)):Me(this),arguments)},Oe={copyWithin:function(e,t){return V.call(Me(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return J(Me(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return F.apply(Me(this),arguments)},filter:function(e){return Se(this,Z(Me(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return $(Me(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Me(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){K(Me(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(Me(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Me(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ce.apply(Me(this),arguments)},lastIndexOf:function(e){return ae.apply(Me(this),arguments)},map:function(e){return xe(Me(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(Me(this),arguments)},reduceRight:function(e){return le.apply(Me(this),arguments)},reverse:function(){for(var e,t=Me(this).length,n=Math.floor(t/2),i=0;i<n;)e=this[i],this[i++]=this[--t],this[t]=e;return this},some:function(e){return Q(Me(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(Me(this),e)},subarray:function(e,t){var n=Me(this),i=n.length,r=v(e,i);return new(R(n,n[ve]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,m((void 0===t?i:v(t,i))-r))}},Ne=function(e,t){return Se(this,he.call(Me(this),e,t))},ke=function(e){Me(this);var t=Ee(arguments[1],1),n=this.length,i=w(e),r=m(i.length),o=0;if(r+t>n)throw H("Wrong length!");for(;o<r;)this[t+o]=i[o++]},Fe={entries:function(){return oe.call(Me(this))},keys:function(){return re.call(Me(this))},values:function(){return ie.call(Me(this))}},Ve=function(e,t){return x(e)&&e[_e]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Be=function(e,t){return Ve(e,t=y(t,!0))?h(2,e[t]):G(e,t)},Ue=function(e,t,n){return!(Ve(e,t=y(t,!0))&&x(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?z(e,t,n):(e[t]=n.value,e)};ye||(U.f=Be,B.f=Ue),a(a.S+a.F*!ye,"Object",{getOwnPropertyDescriptor:Be,defineProperty:Ue}),o((function(){de.call({})}))&&(de=fe=function(){return ce.call(this)});var ze=f({},Oe);f(ze,Fe),d(ze,pe,Fe.values),f(ze,{slice:Ne,set:ke,constructor:function(){},toString:de,toLocaleString:Ie}),Pe(ze,"buffer","b"),Pe(ze,"byteOffset","o"),Pe(ze,"byteLength","l"),Pe(ze,"length","e"),z(ze,me,{get:function(){return this[_e]}}),e.exports=function(e,t,n,l){var c=e+((l=!!l)?"Clamped":"")+"Array",h="get"+e,f="set"+e,p=r[c],v=p||{},y=p&&M(p),_=!p||!s.ABV,w={},A=p&&p.prototype,S=function(e,n){z(e,n,{get:function(){return function(e,n){var i=e._d;return i.v[h](n*t+i.o,we)}(this,n)},set:function(e){return function(e,n,i){var r=e._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),r.v[f](n*t+r.o,i,we)}(this,n,e)},enumerable:!0})};_?(p=n((function(e,n,i,r){u(e,p,c,"_d");var o,a,s,l,h=0,f=0;if(x(n)){if(!(n instanceof q||"ArrayBuffer"==(l=b(n))||"SharedArrayBuffer"==l))return _e in n?Ce(p,n):Le.call(p,n);o=n,f=Ee(i,t);var v=n.byteLength;if(void 0===r){if(v%t)throw H("Wrong length!");if((a=v-f)<0)throw H("Wrong length!")}else if((a=m(r)*t)+f>v)throw H("Wrong length!");s=a/t}else s=g(n),o=new q(a=s*t);for(d(e,"_d",{b:o,o:f,l:a,e:s,v:new Y(o)});h<s;)S(e,h++)})),A=p.prototype=E(ze),d(A,"constructor",p)):o((function(){p(1)}))&&o((function(){new p(-1)}))&&N((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=n((function(e,n,i,r){var o;return u(e,p,c),x(n)?n instanceof q||"ArrayBuffer"==(o=b(n))||"SharedArrayBuffer"==o?void 0!==r?new v(n,Ee(i,t),r):void 0!==i?new v(n,Ee(i,t)):new v(n):_e in n?Ce(p,n):Le.call(p,n):new v(g(n))})),K(y!==Function.prototype?T(v).concat(T(y)):T(v),(function(e){e in p||d(p,e,v[e])})),p.prototype=A,i||(A.constructor=p));var C=A[pe],P=!!C&&("values"==C.name||null==C.name),L=Fe.values;d(p,ge,!0),d(A,_e,c),d(A,be,!0),d(A,ve,p),(l?new p(1)[me]==c:me in A)||z(A,me,{get:function(){return c}}),w[c]=p,a(a.G+a.W+a.F*(p!=v),w),a(a.S,c,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o((function(){v.of.call(p,1)})),c,{from:Le,of:De}),"BYTES_PER_ELEMENT"in A||d(A,"BYTES_PER_ELEMENT",t),a(a.P,c,Oe),k(c),a(a.P+a.F*Ae,c,{set:ke}),a(a.P+a.F*!P,c,Fe),i||A.toString==de||(A.toString=de),a(a.P+a.F*o((function(){new p(1).slice()})),c,{slice:Ne}),a(a.P+a.F*(o((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!o((function(){A.toLocaleString.call([1,2])}))),c,{toLocaleString:Ie}),O[c]=P?C:L,i||P||d(A,pe,L)}}else e.exports=function(){}},function(e,t,n){"use strict";n.r(t),n.d(t,"getPropWorker",(function(){return b})),n.d(t,"shutdownPropWorker",(function(){return x})),n.d(t,"clearPropertyWorkerCache",(function(){return w})),n.d(t,"PropDbLoader",(function(){return S}));var i=n(1),r=n(14),o=n(7),a=n(3),s=n(6),l=n(215),c=n(216),u=n(40),h=n(32);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p,m="UNLOAD_PROPERTYDB",g=1,v={};function y(e){var t=e.data;if(t&&t.debug)i.logger.debug(t.message);else{var n=t&&t.cbId&&v[t.cbId];n&&(t.progress?n[2]&&n[2](t.progress):(t.error?n[1]&&n[1](t.error):n[0]&&n[0](t.result),delete v[t.cbId]))}}function _(e,t,n){var i=g++;return v[i]=[e,t,n],i}function b(){return p}function x(){p&&(p.clearAllEventListenerWithIntercept(),p.terminate(),p=void 0)}function w(){p&&p.doOperation({operation:m,clearCaches:!0})}var A=0,E=1,M=2,T=3,S=function(e,t,n){this.eventTarget=n||new h.EventDispatcher,this.model=t,this.svf=t&&t.getData(),this.dbPath="",this.sharedDbPath=!1;var o=this.svf&&this.svf.is2d&&this.svf.loadOptions.bubbleNode&&this.svf.loadOptions.bubbleNode.findViewableParent()._getOtgManifest();if(this.svf&&!o&&this.svf.propertydb&&this.svf.propertydb.avs.length){for(var a in this.dbFiles=this.svf.propertydb,this.dbFiles)this.dbFiles[a][0]&&(this.dbFiles[a][0].path=this.dbFiles[a][0].path.replace(/\\/g,"/"));var s=Object(r.pathToURL)(this.svf.basePath);if(e){var l=r.ViewingService.simplifyPath(s+this.svf.propertydb.avs[0].path);if((l=l.slice(0,l.lastIndexOf("/")+1))===e){var c={};for(var a in this.dbFiles){var u=this.dbFiles[a][0],d=u.path;0===(d=r.ViewingService.simplifyPath(s+d)).indexOf(e)&&(d=d.slice(e.length)),c[a]=[{path:d,isShared:u.isShared}]}this.dbFiles=c,this.dbPath=e,this.sharedDbPath=!0}else this.dbPath=s,this.sharedDbPath=!1}else this.dbPath=s,this.sharedDbPath=!1}else{if(this.sharedDbPath=!0,this.svf&&this.svf.loadOptions.bubbleNode){this.dbPath=e;var f=this.svf.loadOptions.bubbleNode.getPropertyDbManifest();this.dbFiles=f.propertydb,this.needsDbIdRemap=f.needsDbIdRemap}else i.logger.warn("Deprecated shared property database initialization without bubbleNode in Model load options."),this.dbPath=e,this.dbFiles={attrs:[],avs:[],ids:[],values:[],offsets:[]};i.logger.log("Using shared db path "+e)}this.queryParams="",this.svf&&this.svf.acmSessionId&&(this.queryParams="acmsession="+this.svf.acmSessionId),this.loadProgress=0,this.cbId=void 0,this.idLoadState=A,this.waitingForExternalIds=[]};S.prototype.dtor=function(){this.asyncPropertyOperation({operation:m},(function(){}),(function(){}));var e,t=Boolean(this.cbId),n=this.instanceTree||this.propertyDbError;t&&!n&&(e=this.cbId,delete v[e],this.propertyDbError={propDbWasUnloaded:!0},this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_UNAVAILABLE_EVENT,svf:this.svf,model:this.model,target:this})),this.model=null,this.svf=null},S.prototype.processLoadResult=function(e){if(e.instanceTreeStorage){var t=new c.InstanceTreeAccess(e.instanceTreeStorage,e.rootId,e.instanceBoxes);this.instanceTree=new l.InstanceTree(t,e.objectCount,e.maxTreeDepth),this.svf&&(this.svf.instanceTree=this.instanceTree,this.instanceTree.setFragmentList(this.model.getFragmentList()))}e.objectCount&&(this.hasObjectProperties=e.objectCount,this.svf&&(this.svf.hasObjectProperties=e.objectCount)),e.dbidOldToNew&&this.model.setDbIdRemap(e.dbidOldToNew),this.onLoadProgress(100),this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_CREATED_EVENT,svf:this.svf,model:this.model,target:this})},S.prototype.processLoadError=function(e){this.propertyDbError=e,this.onLoadProgress(100),this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_UNAVAILABLE_EVENT,svf:this.svf,model:this.model,target:this})},S.prototype.load=function(e){var t=this;if(e=e||{},this.svf&&this.svf.instanceTree&&this.svf.instanceBoxes)setTimeout((function(){t.processLoadResult(t.svf)}),0);else{p||(p=Object(u.createWorkerWithIntercept)()).addEventListenerWithIntercept(y);this.cbId=_((function(e){t.processLoadResult(e)}),(function(e){t.processLoadError(e)}),(function(e){t.onLoadProgress(e.percent)}));var n=this.svf&&this.svf.loadOptions,i=!(n&&n.disablePrecomputedNodeBoxes),r=!(!n||!n.skipExternalIds);r||(this.idLoadState=E);var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({operation:"LOAD_PROPERTYDB",dbPath:this.dbPath,sharedDbPath:this.sharedDbPath,propertydb:this.dbFiles,fragToDbId:this.svf&&this.svf.fragments.fragId2dbId,fragBoxes:i&&this.svf&&this.svf.fragments.boxes,needsDbIdRemap:this.needsDbIdRemap,cbId:this.cbId,queryParams:this.queryParams,skipExternalIds:r},e);p.doOperation(Object(s.initLoadContext)(o))}},S.prototype.asyncPropertyOperation=function(e,t,n,i){var r=this;if(e.dbPath=this.dbPath,r.instanceTree||r.hasObjectProperties)e.cbId=_(t,n,i),p.doOperation(e);else if(r.propertyDbError)n&&n(r.propertyDbError);else{var s=function s(l){r.eventTarget.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,s),r.eventTarget.removeEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,s),r.instanceTree||r.hasObjectProperties||r.propertyDbError?r.asyncPropertyOperation(e,t,n,i):n&&n({code:o.ErrorCodes.UNKNOWN_FAILURE,msg:"Failed to load properties"})};r.eventTarget.addEventListener(a.OBJECT_TREE_CREATED_EVENT,s),r.eventTarget.addEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,s)}},S.prototype.getProperties=function(e,t,n){this.idLoadState===A&&i.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getProperties2(e,t,n,{needsExternalId:!0})},S.prototype.getProperties2=function(e,t,n,i){var r=this,o=function(){r.asyncPropertyOperation({operation:"GET_PROPERTIES",dbId:e},t,n)};i&&i.needsExternalId?this.loadExternalIds().then(o).catch(n):o()},S.prototype.getBulkProperties=function(e,t,n,r,o){var a={ignoreHidden:o,propFilter:t,needsExternalId:!t||t.includes("externalId")};a.needsExternalId&&this.idLoadState===A&&i.logger.warn("Calling getProperties() will cause loading of the potentially large externalIDs file. Use getProperties2() to avoid this warning."),this.getBulkProperties2(e,a,n,r)},S.prototype.getBulkProperties2=function(e,t,n,i){var r=this,o=function(){r.asyncPropertyOperation({operation:"GET_PROPERTIES",dbIds:e,propFilter:t.propFilter,ignoreHidden:t.ignoreHidden},n,i)};(t=t||{})&&t.needsExternalId?this.loadExternalIds().then(o).catch(i):o()},S.prototype.searchProperties=function(e,t,n,i){this.asyncPropertyOperation({operation:"SEARCH_PROPERTIES",searchText:e,attributeNames:t},n,i)},S.prototype.findProperty=function(e){var t=this;return new Promise((function(n,i){t.asyncPropertyOperation({operation:"FIND_PROPERTY",propertyName:e},n,i)}))},S.prototype.diffProperties=function(e,t,n,i,r){this.asyncPropertyOperation({operation:"DIFF_PROPERTIES",dbPath2:e,diffOptions:i},t,n,r)},S.prototype.findLayers=function(){var e=this;return new Promise((function(t,n){e.asyncPropertyOperation({operation:"FIND_LAYERS"},t,n)}))},S.prototype.getExternalIdMapping=function(e,t,n){var i=this;return this.loadExternalIds().then((function(){i.asyncPropertyOperation({operation:"BUILD_EXTERNAL_ID_MAPPING",extIdFilter:n},e,t)}))},S.prototype.getLayerToNodeIdMapping=function(e,t){this.asyncPropertyOperation({operation:"BUILD_LAYER_TO_NODE_ID_MAPPING"},e,t)},S.prototype.executeUserFunction=function(e,t){var n,i=this;if("function"==typeof e)e=e.toString();else if("string"!=typeof e)return Promise.reject("Expected Function or string.");try{n=new Blob([e],{type:"application/javascript"})}catch(t){var r=new BlobBuilder;r.append(e),n=r.getBlob()}var o=URL.createObjectURL(n);return new Promise((function(e,n){i.asyncPropertyOperation({operation:"USER_FUNCTION",userFunction:o,userData:t},e,n)}))},S.prototype.isObjectTreeLoaded=function(){return!!this.instanceTree},S.prototype.getObjectTree=function(e,t){var n=this;if(n.instanceTree)e(n.instanceTree);else if(n.propertyDbError)t&&t(n.propertyDbError);else if("hasObjectProperties"in n)n.svf&&n.svf.is2d&&t?t("F2D files do not have an InstanceTree."):e(null);else{var i=function i(){n.eventTarget.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,i),n.eventTarget.removeEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,i),n.getObjectTree(e,t)};n.eventTarget.addEventListener(a.OBJECT_TREE_CREATED_EVENT,i),n.eventTarget.addEventListener(a.OBJECT_TREE_UNAVAILABLE_EVENT,i)}},S.prototype.onLoadProgress=function(e){this.eventTarget.dispatchEvent({type:a.OBJECT_TREE_LOAD_PROGRESS_EVENT,percent:e,svf:this.svf,model:this.model,target:this}),this.loadProgress=e},S.prototype.getLoadProgress=function(){return this.loadProgress},S.prototype.isLoadDone=function(){return 100==this.loadProgress},S.prototype.loadExternalIds=function(){var e=this;switch(this.idLoadState){case E:return Promise.resolve();case T:return Promise.reject();case A:this.idLoadState=M;var t={operation:"LOAD_EXTERNAL_IDS",idsFile:this.dbFiles.ids[0],queryParams:this.queryParams};Object(s.initLoadContext)(t),this.asyncPropertyOperation(t,(function(){e.idLoadState=E,e.waitingForExternalIds.forEach((function(e){return e.resolve()}))}),(function(){e.idLoadState=T,e.waitingForExternalIds.forEach((function(e){return e.reject()}))}))}return new Promise((function(t,n){e.waitingForExternalIds.push({resolve:t,reject:n})}))}},function(e,t,n){"use strict";n.r(t),n.d(t,"ModelUnits",(function(){return c})),n.d(t,"Model",(function(){return u}));var i=n(169),r=(n(96),n(32)),o=n(14),a=(n(1),n(17)),s=n(2),l=n(112),c={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in",POINT:"pt"};function u(e){i.RenderModel.call(this,e),this.myData=e,this.topology=null,this.topologyPromise=null,this.svfUUID=null,this.defaultCameraHash=null,this.getInstanceTree=function(){return this.myData?this.myData.instanceTree:null},this.getBoundingBox=function(){return this.myData?this.myData.bbox:null},this.is2d=function(){return!(!this.myData||!this.myData.is2d)},this.is3d=function(){return!this.is2d()},this.isOTG=function(){return this.myData&&!!this.myData.isOTG},this.isPdf=function(){return!(!this.myData||!this.myData.isPdf)},this.isLeaflet=function(){return!(!this.myData||!this.myData.isLeaflet)}}r.EventDispatcher.prototype.apply(u.prototype),u.prototype.constructor=u,u.prototype.getData=function(){return this.myData},u.prototype.setUUID=function(e){this.svfUUID=btoa(Object(o.pathToURL)(e))},u.prototype.getDocumentNode=function(){var e=this.getData();return e.loadOptions&&e.loadOptions.bubbleNode||null},u.prototype.getRoot=function(){var e=this.getData();return e&&e.instanceTree?e.instanceTree.root:null},u.prototype.getRootId=function(){var e=this.getData();return e&&e.instanceTree&&e.instanceTree.getRootId()||0},u.prototype.getUnitData=function(e){var t={unitString:null,unitScale:1};switch(e){case"meter":case"meters":case"m":return t.unitString=c.METER,t.unitScale=1,t;case"foot":case"feet":case"ft":return t.unitString=c.FOOT,t.unitScale=.3048,t;case"feet and inches":case"inch":case"inches":case"in":return t.unitString=c.INCH,t.unitScale=.0254,t;case"centimeter":case"centimeters":case"cm":return t.unitString=c.CENTIMETER,t.unitScale=.01,t;case"millimeter":case"millimeters":case"mm":return t.unitString=c.MILLIMETER,t.unitScale=.001,t;case"point":case"points":case"pt":return t.unitString=c.POINT,t.unitScale=.0254/72,t;default:return t}},u.prototype.getUnitScale=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.overriddenUnits?t.overriddenUnits:t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return e&&(e=e.toLowerCase()),this.getUnitData(e).unitScale},u.prototype.getUnitString=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.overriddenUnits?t.overriddenUnits:t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return e&&(e=e.toLowerCase()),this.getUnitData(e).unitString},u.prototype.getDisplayUnit=function(){var e;if(this.is2d())e=this.getMetadata("page_dimensions","model_units",null)||this.getMetadata("page_dimensions","page_units",null);else{var t=this.getData();e=t&&t.scalingUnit?t.scalingUnit:this.getMetadata("distance unit","value",null)}return e&&(e=e.toLowerCase()),this.getUnitData(e).unitString},u.prototype.getMetadata=function(e,t,n){var i=this.getData();if(i){var r=i.metadata;if(r){var o=r[e];if(void 0!==o){if(!t)return o;var a=o[t];if(void 0!==a)return a}}}return n},u.prototype.getDefaultCamera=function(){var e=this.getData();if(!e)return null;var t=null,n=e.cameras?e.cameras.length:0;if(0<n){var i=this.getMetadata("default camera","index",null);if(null!==i&&e.cameras[i])t=e.cameras[i];else{for(var r=0;r<n;r++){var o=e.cameras[r];if(o.isPerspective){t=o;break}}t||(t=e.cameras[0])}}return t},u.prototype.isAEC=function(){return!!this.getData().loadOptions.isAEC},u.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)},u.prototype.geomPolyCount=function(){var e=this.getGeometryList();return e?e.geomPolyCount:null},u.prototype.instancePolyCount=function(){var e=this.getGeometryList();return e?e.instancePolyCount:null},u.prototype.isLoadDone=function(){var e=this.getData();return!(!e||!e.loadDone)},u.prototype.isObjectTreeCreated=function(){return!!this.getData().instanceTree},u.prototype.getPropertyDb=function(){var e=this.getData();return e&&e.propDbLoader},u.prototype.getProperties=function(e,t,n){var i=this.getPropertyDb();!i||e<=0?n&&n():i.getProperties(e,t,n)},u.prototype.getProperties2=function(e,t,n,i){var r=this.getPropertyDb();!r||e<=0?n&&n():r.getProperties2(e,t,n,i)},u.prototype.getBulkProperties=function(e,t,n,i){Array.isArray(t)&&(t={propFilter:t});var r=(t=t||{}).propFilter||null,o=t.ignoreHidden||!1,a=this.getPropertyDb();a?a.getBulkProperties(e,r,n,i,o):i&&i()},u.prototype.getBulkProperties2=function(e,t,n,i){var r=this.getPropertyDb();r?r.getBulkProperties2(e,t,n,i):i&&i()},u.prototype.getExternalIdMapping=function(e,t){var n=this.getPropertyDb();n?n.getExternalIdMapping(e,t):t&&t()},u.prototype.getLayerToNodeIdMapping=function(e,t){var n=this.getPropertyDb();n?n.getLayerToNodeIdMapping(e,t):t&&t()},u.prototype.getObjectTree=function(e,t){var n=this.getPropertyDb();n?n.getObjectTree(e,t):t&&t()},u.prototype.isObjectTreeLoaded=function(){var e=this.getPropertyDb();return!!e&&e.isObjectTreeLoaded()},u.prototype.search=function(e,t,n,i){var r=this.getPropertyDb();r?r.searchProperties(e,i,t,n):n&&n()},u.prototype.findProperty=function(e){var t=this.getPropertyDb();return t?t.findProperty(e):Promise.reject("Model doesn't have any properties.")};var h=function(e,t,n,i){var r,o,a,s,l,c,u=!1;a=i[n[n.length-1]].x,r=(s=i[n[n.length-1]].y)>=t;for(var h=0,d=n.length;h<d;++h)l=i[n[h]].x,r!=(o=(c=i[n[h]].y)>=t)&&(c-t)*(a-l)>=(l-e)*(s-c)==o&&(u=!u),r=o,a=l,s=c;return u};u.prototype.pointInPolygon=function(e,t,n,i){for(var r=!1,o=0;o<n.length;o++)h(e,t,n[o],i)&&(r=!r);return r},u.prototype.getPageToModelTransform=function(e){var t=this.getData();if(t.pageToModelTransform)return t.pageToModelTransform;var n=t,i=n.metadata.page_dimensions,r=n.viewports[e];if(!r)return new THREE.Matrix4;n.viewportTransforms||(n.viewportTransforms=new Array(n.viewports.length))